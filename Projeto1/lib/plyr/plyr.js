<!DOCTYPE html><html lang="en"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-140352188-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-140352188-1');</script><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="description" content="The CDN for plyr"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/><meta name="timestamp" content="2023-04-17T23:31:00.130Z"/><link rel="shortcut icon" href="/favicon.ico"/><title>UNPKG - plyr</title><script>window.Promise || document.write('\x3Cscript src="/es6-promise@4.2.5/dist/es6-promise.min.js">\x3C/script>\x3Cscript>ES6Promise.polyfill()\x3C/script>')</script><script>window.fetch || document.write('\x3Cscript src="/whatwg-fetch@3.0.0/dist/fetch.umd.js">\x3C/script>')</script><script>window.__DATA__ = {"packageName":"plyr","packageVersion":"3.7.8","availableVersions":["1.5.9","1.5.10","1.5.11","1.5.12","1.5.13","1.5.14","1.5.16","1.5.17","1.5.18","1.5.19","1.5.20","1.6.0","1.6.1","1.6.4","1.6.5","1.6.6","1.6.7","1.6.8","1.6.9","1.6.10","1.6.12","1.6.14","1.6.15","1.6.16","1.6.17","1.6.18","1.6.19","1.6.20","1.7.0","1.8.0","1.8.1","1.8.2","1.8.4","1.8.5","1.8.6","1.8.7","1.8.8","1.8.9","1.8.10","1.8.11","1.8.12","1.9.0","2.0.0","2.0.1","2.0.3","2.0.4","2.0.5","2.0.6","2.0.7","2.0.8","2.0.9","2.0.10","2.0.11","2.0.12","2.0.13","2.0.14","2.0.15","2.0.16","2.0.17","2.0.18","3.0.0-beta.6","3.0.0-beta.7","3.0.0-beta.8","3.0.0-beta.9","3.0.0-beta.10","3.0.0-beta.11","3.0.0-beta.12","3.0.0-beta.13","3.0.0-beta.14","3.0.0-beta.15","3.0.0-beta.16","3.0.0-beta.17","3.0.0-beta.18","3.0.0-beta.19","3.0.0-beta.20","3.0.0","3.0.1","3.0.2","3.0.3","3.0.4","3.0.5","3.0.6","3.0.7","3.0.8","3.0.9","3.0.10","3.0.11","3.1.0-beta.1","3.1.0-beta.2","3.1.0","3.2.0","3.2.1","3.2.2","3.2.3","3.2.4","3.3.3","3.3.5","3.3.6","3.3.7","3.3.8","3.3.9","3.3.10","3.3.11","3.3.12","3.3.13","3.3.14","3.3.15","3.3.16","3.3.17","3.3.18","3.3.19","3.3.20","3.3.21","3.3.22","3.3.23","3.4.0-beta.1","3.4.0-beta.2","3.4.0","3.4.1","3.4.2","3.4.3","3.4.4","3.4.5","3.4.6","3.4.7","3.4.8","3.5.0","3.5.1","3.5.2","3.5.3","3.5.4","3.5.5","3.5.6","3.5.7-beta.0","3.5.7","3.5.8","3.5.9","3.5.10","3.6.1","3.6.2","3.6.3","3.6.4","3.6.5","3.6.6","3.6.7","3.6.8","3.6.9","3.6.10","3.6.11","3.6.12","3.7.0","3.7.1","3.7.2","3.7.3","3.7.4","3.7.5","3.7.6","3.7.7","3.7.8"],"filename":"/dist/plyr.js","target":{"path":"/dist/plyr.js","type":"file","details":{"contentType":"application/javascript","integrity":"sha384-VdJImnFBt2KcuUqiJBzfERB/cMgmONqYOEDKQKguQxqS1uuYDC9EtmB+DaBxO/4s","language":"JavaScript","size":299253,"uri":null,"highlights":["<span class=\"code-keyword\">typeof</span> navigator === <span class=\"code-string\">\"object\"</span> &amp;&amp; (<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">global, factory</span>) </span>{\n","  <span class=\"code-keyword\">typeof</span> exports === <span class=\"code-string\">'object'</span> &amp;&amp; <span class=\"code-keyword\">typeof</span> <span class=\"code-built_in\">module</span> !== <span class=\"code-string\">'undefined'</span> ? <span class=\"code-built_in\">module</span>.exports = factory() :\n","  <span class=\"code-keyword\">typeof</span> define === <span class=\"code-string\">'function'</span> &amp;&amp; define.amd ? define(<span class=\"code-string\">'Plyr'</span>, factory) :\n","  (global = <span class=\"code-keyword\">typeof</span> globalThis !== <span class=\"code-string\">'undefined'</span> ? globalThis : global || self, global.Plyr = factory());\n","})(<span class=\"code-keyword\">this</span>, (<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{ <span class=\"code-string\">'use strict'</span>;\n","\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_defineProperty$1</span>(<span class=\"code-params\">obj, key, value</span>) </span>{\n","    key = _toPropertyKey(key);\n","    <span class=\"code-keyword\">if</span> (key <span class=\"code-keyword\">in</span> obj) {\n","      <span class=\"code-built_in\">Object</span>.defineProperty(obj, key, {\n","        value: value,\n","        enumerable: <span class=\"code-literal\">true</span>,\n","        configurable: <span class=\"code-literal\">true</span>,\n","        writable: <span class=\"code-literal\">true</span>\n","      });\n","    } <span class=\"code-keyword\">else</span> {\n","      obj[key] = value;\n","    }\n","    <span class=\"code-keyword\">return</span> obj;\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_toPrimitive</span>(<span class=\"code-params\">input, hint</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">typeof</span> input !== <span class=\"code-string\">\"object\"</span> || input === <span class=\"code-literal\">null</span>) <span class=\"code-keyword\">return</span> input;\n","    <span class=\"code-keyword\">var</span> prim = input[<span class=\"code-built_in\">Symbol</span>.toPrimitive];\n","    <span class=\"code-keyword\">if</span> (prim !== <span class=\"code-literal\">undefined</span>) {\n","      <span class=\"code-keyword\">var</span> res = prim.call(input, hint || <span class=\"code-string\">\"default\"</span>);\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">typeof</span> res !== <span class=\"code-string\">\"object\"</span>) <span class=\"code-keyword\">return</span> res;\n","      <span class=\"code-keyword\">throw</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">TypeError</span>(<span class=\"code-string\">\"@@toPrimitive must return a primitive value.\"</span>);\n","    }\n","    <span class=\"code-keyword\">return</span> (hint === <span class=\"code-string\">\"string\"</span> ? <span class=\"code-built_in\">String</span> : <span class=\"code-built_in\">Number</span>)(input);\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_toPropertyKey</span>(<span class=\"code-params\">arg</span>) </span>{\n","    <span class=\"code-keyword\">var</span> key = _toPrimitive(arg, <span class=\"code-string\">\"string\"</span>);\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">typeof</span> key === <span class=\"code-string\">\"symbol\"</span> ? key : <span class=\"code-built_in\">String</span>(key);\n","  }\n","\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_classCallCheck</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!(e <span class=\"code-keyword\">instanceof</span> t)) <span class=\"code-keyword\">throw</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">TypeError</span>(<span class=\"code-string\">\"Cannot call a class as a function\"</span>);\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_defineProperties</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">for</span> (<span class=\"code-keyword\">var</span> n = <span class=\"code-number\">0</span>; n &lt; t.length; n++) {\n","      <span class=\"code-keyword\">var</span> r = t[n];\n","      r.enumerable = r.enumerable || !<span class=\"code-number\">1</span>, r.configurable = !<span class=\"code-number\">0</span>, <span class=\"code-string\">\"value\"</span> <span class=\"code-keyword\">in</span> r &amp;&amp; (r.writable = !<span class=\"code-number\">0</span>), <span class=\"code-built_in\">Object</span>.defineProperty(e, r.key, r);\n","    }\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_createClass</span>(<span class=\"code-params\">e, t, n</span>) </span>{\n","    <span class=\"code-keyword\">return</span> t &amp;&amp; _defineProperties(e.prototype, t), n &amp;&amp; _defineProperties(e, n), e;\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_defineProperty</span>(<span class=\"code-params\">e, t, n</span>) </span>{\n","    <span class=\"code-keyword\">return</span> t <span class=\"code-keyword\">in</span> e ? <span class=\"code-built_in\">Object</span>.defineProperty(e, t, {\n","      value: n,\n","      enumerable: !<span class=\"code-number\">0</span>,\n","      configurable: !<span class=\"code-number\">0</span>,\n","      writable: !<span class=\"code-number\">0</span>\n","    }) : e[t] = n, e;\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">ownKeys</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">var</span> n = <span class=\"code-built_in\">Object</span>.keys(e);\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.getOwnPropertySymbols) {\n","      <span class=\"code-keyword\">var</span> r = <span class=\"code-built_in\">Object</span>.getOwnPropertySymbols(e);\n","      t &amp;&amp; (r = r.filter(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Object</span>.getOwnPropertyDescriptor(e, t).enumerable;\n","      })), n.push.apply(n, r);\n","    }\n","    <span class=\"code-keyword\">return</span> n;\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">_objectSpread2</span>(<span class=\"code-params\">e</span>) </span>{\n","    <span class=\"code-keyword\">for</span> (<span class=\"code-keyword\">var</span> t = <span class=\"code-number\">1</span>; t &lt; <span class=\"code-built_in\">arguments</span>.length; t++) {\n","      <span class=\"code-keyword\">var</span> n = <span class=\"code-literal\">null</span> != <span class=\"code-built_in\">arguments</span>[t] ? <span class=\"code-built_in\">arguments</span>[t] : {};\n","      t % <span class=\"code-number\">2</span> ? ownKeys(<span class=\"code-built_in\">Object</span>(n), !<span class=\"code-number\">0</span>).forEach(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        _defineProperty(e, t, n[t]);\n","      }) : <span class=\"code-built_in\">Object</span>.getOwnPropertyDescriptors ? <span class=\"code-built_in\">Object</span>.defineProperties(e, <span class=\"code-built_in\">Object</span>.getOwnPropertyDescriptors(n)) : ownKeys(<span class=\"code-built_in\">Object</span>(n)).forEach(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        <span class=\"code-built_in\">Object</span>.defineProperty(e, t, <span class=\"code-built_in\">Object</span>.getOwnPropertyDescriptor(n, t));\n","      });\n","    }\n","    <span class=\"code-keyword\">return</span> e;\n","  }\n","  <span class=\"code-keyword\">var</span> defaults$<span class=\"code-number\">1</span> = {\n","    addCSS: !<span class=\"code-number\">0</span>,\n","    thumbWidth: <span class=\"code-number\">15</span>,\n","    watch: !<span class=\"code-number\">0</span>\n","  };\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">matches$1</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Array</span>.from(<span class=\"code-built_in\">document</span>.querySelectorAll(t)).includes(<span class=\"code-keyword\">this</span>);\n","    }.call(e, t);\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">trigger</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (e &amp;&amp; t) {\n","      <span class=\"code-keyword\">var</span> n = <span class=\"code-keyword\">new</span> Event(t, {\n","        bubbles: !<span class=\"code-number\">0</span>\n","      });\n","      e.dispatchEvent(n);\n","    }\n","  }\n","  <span class=\"code-keyword\">var</span> getConstructor$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span> != e ? e.constructor : <span class=\"code-literal\">null</span>;\n","    },\n","    instanceOf$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e, t</span>) </span>{\n","      <span class=\"code-keyword\">return</span> !!(e &amp;&amp; t &amp;&amp; e <span class=\"code-keyword\">instanceof</span> t);\n","    },\n","    isNullOrUndefined$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span> == e;\n","    },\n","    isObject$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> getConstructor$<span class=\"code-number\">1</span>(e) === <span class=\"code-built_in\">Object</span>;\n","    },\n","    isNumber$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> getConstructor$<span class=\"code-number\">1</span>(e) === <span class=\"code-built_in\">Number</span> &amp;&amp; !<span class=\"code-built_in\">Number</span>.isNaN(e);\n","    },\n","    isString$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> getConstructor$<span class=\"code-number\">1</span>(e) === <span class=\"code-built_in\">String</span>;\n","    },\n","    isBoolean$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> getConstructor$<span class=\"code-number\">1</span>(e) === <span class=\"code-built_in\">Boolean</span>;\n","    },\n","    isFunction$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> getConstructor$<span class=\"code-number\">1</span>(e) === <span class=\"code-built_in\">Function</span>;\n","    },\n","    isArray$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Array</span>.isArray(e);\n","    },\n","    isNodeList$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> instanceOf$<span class=\"code-number\">1</span>(e, NodeList);\n","    },\n","    isElement$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> instanceOf$<span class=\"code-number\">1</span>(e, Element);\n","    },\n","    isEvent$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> instanceOf$<span class=\"code-number\">1</span>(e, Event);\n","    },\n","    isEmpty$<span class=\"code-number\">1</span> = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","      <span class=\"code-keyword\">return</span> isNullOrUndefined$<span class=\"code-number\">1</span>(e) || (isString$<span class=\"code-number\">1</span>(e) || isArray$<span class=\"code-number\">1</span>(e) || isNodeList$<span class=\"code-number\">1</span>(e)) &amp;&amp; !e.length || isObject$<span class=\"code-number\">1</span>(e) &amp;&amp; !<span class=\"code-built_in\">Object</span>.keys(e).length;\n","    },\n","    is$<span class=\"code-number\">1</span> = {\n","      nullOrUndefined: isNullOrUndefined$<span class=\"code-number\">1</span>,\n","      object: isObject$<span class=\"code-number\">1</span>,\n","      number: isNumber$<span class=\"code-number\">1</span>,\n","      string: isString$<span class=\"code-number\">1</span>,\n","      boolean: isBoolean$<span class=\"code-number\">1</span>,\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span>: <span class=\"code-title\">isFunction$1</span>,\n</span>","<span class=\"code-function\">      <span class=\"code-title\">array</span>: <span class=\"code-title\">isArray$1</span>,\n</span>","<span class=\"code-function\">      <span class=\"code-title\">nodeList</span>: <span class=\"code-title\">isNodeList$1</span>,\n</span>","<span class=\"code-function\">      <span class=\"code-title\">element</span>: <span class=\"code-title\">isElement$1</span>,\n</span>","<span class=\"code-function\">      <span class=\"code-title\">event</span>: <span class=\"code-title\">isEvent$1</span>,\n</span>","<span class=\"code-function\">      <span class=\"code-title\">empty</span>: <span class=\"code-title\">isEmpty$1</span>\n</span>","<span class=\"code-function\">    };\n</span>","<span class=\"code-function\">  <span class=\"code-title\">function</span> <span class=\"code-title\">getDecimalPlaces</span>(<span class=\"code-params\">e</span>) </span>{\n","    <span class=\"code-keyword\">var</span> t = <span class=\"code-string\">\"\"</span>.concat(e).match(<span class=\"code-regexp\">/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/</span>);\n","    <span class=\"code-keyword\">return</span> t ? <span class=\"code-built_in\">Math</span>.max(<span class=\"code-number\">0</span>, (t[<span class=\"code-number\">1</span>] ? t[<span class=\"code-number\">1</span>].length : <span class=\"code-number\">0</span>) - (t[<span class=\"code-number\">2</span>] ? +t[<span class=\"code-number\">2</span>] : <span class=\"code-number\">0</span>)) : <span class=\"code-number\">0</span>;\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">round</span>(<span class=\"code-params\">e, t</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-number\">1</span> &gt; t) {\n","      <span class=\"code-keyword\">var</span> n = getDecimalPlaces(t);\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">parseFloat</span>(e.toFixed(n));\n","    }\n","    <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Math</span>.round(e / t) * t;\n","  }\n","  <span class=\"code-keyword\">var</span> RangeTouch = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{\n","    <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">e</span>(<span class=\"code-params\">t, n</span>) </span>{\n","      _classCallCheck(<span class=\"code-keyword\">this</span>, e), is$<span class=\"code-number\">1.</span>element(t) ? <span class=\"code-keyword\">this</span>.element = t : is$<span class=\"code-number\">1.</span>string(t) &amp;&amp; (<span class=\"code-keyword\">this</span>.element = <span class=\"code-built_in\">document</span>.querySelector(t)), is$<span class=\"code-number\">1.</span>element(<span class=\"code-keyword\">this</span>.element) &amp;&amp; is$<span class=\"code-number\">1.</span>empty(<span class=\"code-keyword\">this</span>.element.rangeTouch) &amp;&amp; (<span class=\"code-keyword\">this</span>.config = _objectSpread2({}, defaults$<span class=\"code-number\">1</span>, {}, n), <span class=\"code-keyword\">this</span>.init());\n","    }\n","    <span class=\"code-keyword\">return</span> _createClass(e, [{\n","      key: <span class=\"code-string\">\"init\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{\n","        e.enabled &amp;&amp; (<span class=\"code-keyword\">this</span>.config.addCSS &amp;&amp; (<span class=\"code-keyword\">this</span>.element.style.userSelect = <span class=\"code-string\">\"none\"</span>, <span class=\"code-keyword\">this</span>.element.style.webKitUserSelect = <span class=\"code-string\">\"none\"</span>, <span class=\"code-keyword\">this</span>.element.style.touchAction = <span class=\"code-string\">\"manipulation\"</span>), <span class=\"code-keyword\">this</span>.listeners(!<span class=\"code-number\">0</span>), <span class=\"code-keyword\">this</span>.element.rangeTouch = <span class=\"code-keyword\">this</span>);\n","      }\n","    }, {\n","      key: <span class=\"code-string\">\"destroy\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{\n","        e.enabled &amp;&amp; (<span class=\"code-keyword\">this</span>.config.addCSS &amp;&amp; (<span class=\"code-keyword\">this</span>.element.style.userSelect = <span class=\"code-string\">\"\"</span>, <span class=\"code-keyword\">this</span>.element.style.webKitUserSelect = <span class=\"code-string\">\"\"</span>, <span class=\"code-keyword\">this</span>.element.style.touchAction = <span class=\"code-string\">\"\"</span>), <span class=\"code-keyword\">this</span>.listeners(!<span class=\"code-number\">1</span>), <span class=\"code-keyword\">this</span>.element.rangeTouch = <span class=\"code-literal\">null</span>);\n","      }\n","    }, {\n","      key: <span class=\"code-string\">\"listeners\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","        <span class=\"code-keyword\">var</span> t = <span class=\"code-keyword\">this</span>,\n","          n = e ? <span class=\"code-string\">\"addEventListener\"</span> : <span class=\"code-string\">\"removeEventListener\"</span>;\n","        [<span class=\"code-string\">\"touchstart\"</span>, <span class=\"code-string\">\"touchmove\"</span>, <span class=\"code-string\">\"touchend\"</span>].forEach(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","          t.element[n](e, <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">e</span>) </span>{\n","            <span class=\"code-keyword\">return</span> t.set(e);\n","          }, !<span class=\"code-number\">1</span>);\n","        });\n","      }\n","    }, {\n","      key: <span class=\"code-string\">\"get\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        <span class=\"code-keyword\">if</span> (!e.enabled || !is$<span class=\"code-number\">1.</span>event(t)) <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        <span class=\"code-keyword\">var</span> n,\n","          r = t.target,\n","          i = t.changedTouches[<span class=\"code-number\">0</span>],\n","          o = <span class=\"code-built_in\">parseFloat</span>(r.getAttribute(<span class=\"code-string\">\"min\"</span>)) || <span class=\"code-number\">0</span>,\n","          s = <span class=\"code-built_in\">parseFloat</span>(r.getAttribute(<span class=\"code-string\">\"max\"</span>)) || <span class=\"code-number\">100</span>,\n","          u = <span class=\"code-built_in\">parseFloat</span>(r.getAttribute(<span class=\"code-string\">\"step\"</span>)) || <span class=\"code-number\">1</span>,\n","          c = r.getBoundingClientRect(),\n","          a = <span class=\"code-number\">100</span> / c.width * (<span class=\"code-keyword\">this</span>.config.thumbWidth / <span class=\"code-number\">2</span>) / <span class=\"code-number\">100</span>;\n","        <span class=\"code-keyword\">return</span> <span class=\"code-number\">0</span> &gt; (n = <span class=\"code-number\">100</span> / c.width * (i.clientX - c.left)) ? n = <span class=\"code-number\">0</span> : <span class=\"code-number\">100</span> &lt; n &amp;&amp; (n = <span class=\"code-number\">100</span>), <span class=\"code-number\">50</span> &gt; n ? n -= (<span class=\"code-number\">100</span> - <span class=\"code-number\">2</span> * n) * a : <span class=\"code-number\">50</span> &lt; n &amp;&amp; (n += <span class=\"code-number\">2</span> * (n - <span class=\"code-number\">50</span>) * a), o + round(n / <span class=\"code-number\">100</span> * (s - o), u);\n","      }\n","    }, {\n","      key: <span class=\"code-string\">\"set\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        e.enabled &amp;&amp; is$<span class=\"code-number\">1.</span>event(t) &amp;&amp; !t.target.disabled &amp;&amp; (t.preventDefault(), t.target.value = <span class=\"code-keyword\">this</span>.get(t), trigger(t.target, <span class=\"code-string\">\"touchend\"</span> === t.type ? <span class=\"code-string\">\"change\"</span> : <span class=\"code-string\">\"input\"</span>));\n","      }\n","    }], [{\n","      key: <span class=\"code-string\">\"setup\"</span>,\n","      value: <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","        <span class=\"code-keyword\">var</span> n = <span class=\"code-number\">1</span> &lt; <span class=\"code-built_in\">arguments</span>.length &amp;&amp; <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> !== <span class=\"code-built_in\">arguments</span>[<span class=\"code-number\">1</span>] ? <span class=\"code-built_in\">arguments</span>[<span class=\"code-number\">1</span>] : {},\n","          r = <span class=\"code-literal\">null</span>;\n","        <span class=\"code-keyword\">if</span> (is$<span class=\"code-number\">1.</span>empty(t) || is$<span class=\"code-number\">1.</span>string(t) ? r = <span class=\"code-built_in\">Array</span>.from(<span class=\"code-built_in\">document</span>.querySelectorAll(is$<span class=\"code-number\">1.</span>string(t) ? t : <span class=\"code-string\">'input[type=\"range\"]'</span>)) : is$<span class=\"code-number\">1.</span>element(t) ? r = [t] : is$<span class=\"code-number\">1.</span>nodeList(t) ? r = <span class=\"code-built_in\">Array</span>.from(t) : is$<span class=\"code-number\">1.</span>array(t) &amp;&amp; (r = t.filter(is$<span class=\"code-number\">1.</span>element)), is$<span class=\"code-number\">1.</span>empty(r)) <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        <span class=\"code-keyword\">var</span> i = _objectSpread2({}, defaults$<span class=\"code-number\">1</span>, {}, n);\n","        <span class=\"code-keyword\">if</span> (is$<span class=\"code-number\">1.</span>string(t) &amp;&amp; i.watch) {\n","          <span class=\"code-keyword\">var</span> o = <span class=\"code-keyword\">new</span> MutationObserver(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">n</span>) </span>{\n","            <span class=\"code-built_in\">Array</span>.from(n).forEach(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">n</span>) </span>{\n","              <span class=\"code-built_in\">Array</span>.from(n.addedNodes).forEach(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">n</span>) </span>{\n","                is$<span class=\"code-number\">1.</span>element(n) &amp;&amp; matches$<span class=\"code-number\">1</span>(n, t) &amp;&amp; <span class=\"code-keyword\">new</span> e(n, i);\n","              });\n","            });\n","          });\n","          o.observe(<span class=\"code-built_in\">document</span>.body, {\n","            childList: !<span class=\"code-number\">0</span>,\n","            subtree: !<span class=\"code-number\">0</span>\n","          });\n","        }\n","        <span class=\"code-keyword\">return</span> r.map(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">t</span>) </span>{\n","          <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> e(t, n);\n","        });\n","      }\n","    }, {\n","      key: <span class=\"code-string\">\"enabled\"</span>,\n","      <span class=\"code-keyword\">get</span>: function () {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-string\">\"ontouchstart\"</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.documentElement;\n","      }\n","    }]), e;\n","  }();\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Type checking utils</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> getConstructor = <span class=\"code-function\"><span class=\"code-params\">input</span> =&gt;</span> input !== <span class=\"code-literal\">null</span> &amp;&amp; <span class=\"code-keyword\">typeof</span> input !== <span class=\"code-string\">'undefined'</span> ? input.constructor : <span class=\"code-literal\">null</span>;\n","  <span class=\"code-keyword\">const</span> instanceOf = <span class=\"code-function\">(<span class=\"code-params\">input, constructor</span>) =&gt;</span> <span class=\"code-built_in\">Boolean</span>(input &amp;&amp; <span class=\"code-keyword\">constructor</span> &amp;&amp; input instanceof <span class=\"code-keyword\">constructor</span>);\n","  const isNullOrUndefined = input =&gt; input === null || typeof input === 'undefined';\n","  const isObject = input =&gt; getConstructor(input) === Object;\n","  const isNumber = input =&gt; getConstructor(input) === Number &amp;&amp; !Number.isNaN(input);\n","  const isString = input =&gt; getConstructor(input) === String;\n","  const isBoolean = input =&gt; getConstructor(input) === Boolean;\n","  const isFunction = input =&gt; typeof input === 'function';\n","  const isArray = input =&gt; Array.isArray(input);\n","  const isWeakMap = input =&gt; instanceOf(input, WeakMap);\n","  const isNodeList = input =&gt; instanceOf(input, NodeList);\n","  const isTextNode = input =&gt; getConstructor(input) === Text;\n","  const isEvent = input =&gt; instanceOf(input, Event);\n","  const isKeyboardEvent = input =&gt; instanceOf(input, KeyboardEvent);\n","  const isCue = input =&gt; instanceOf(input, window.TextTrackCue) || instanceOf(input, window.VTTCue);\n","  const isTrack = input =&gt; instanceOf(input, TextTrack) || !isNullOrUndefined(input) &amp;&amp; isString(input.kind);\n","  const isPromise = input =&gt; instanceOf(input, Promise) &amp;&amp; isFunction(input.then);\n","  const isElement = input =&gt; input !== null &amp;&amp; typeof input === 'object' &amp;&amp; input.nodeType === 1 &amp;&amp; typeof input.style === 'object' &amp;&amp; typeof input.ownerDocument === 'object';\n","  const isEmpty = input =&gt; isNullOrUndefined(input) || (isString(input) || isArray(input) || isNodeList(input)) &amp;&amp; !input.length || isObject(input) &amp;&amp; !Object.keys(input).length;\n","  const isUrl = input =&gt; {\n","    <span class=\"code-comment\">// Accept a URL object</span>\n","    <span class=\"code-keyword\">if</span> (instanceOf(input, <span class=\"code-built_in\">window</span>.URL)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Must be string from here</span>\n","    <span class=\"code-keyword\">if</span> (!isString(input)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Add the protocol if required</span>\n","    <span class=\"code-keyword\">let</span> string = input;\n","    <span class=\"code-keyword\">if</span> (!input.startsWith(<span class=\"code-string\">'http://'</span>) || !input.startsWith(<span class=\"code-string\">'https://'</span>)) {\n","      string = <span class=\"code-string\">`http://<span class=\"code-subst\">${input}</span>`</span>;\n","    }\n","    <span class=\"code-keyword\">try</span> {\n","      <span class=\"code-keyword\">return</span> !isEmpty(<span class=\"code-keyword\">new</span> URL(string).hostname);\n","    } <span class=\"code-keyword\">catch</span> (_) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","    }\n","  };\n","  <span class=\"code-keyword\">var</span> is = {\n","    nullOrUndefined: isNullOrUndefined,\n","    object: isObject,\n","    number: isNumber,\n","    string: isString,\n","    boolean: isBoolean,\n","    <span class=\"code-function\"><span class=\"code-keyword\">function</span>: <span class=\"code-title\">isFunction</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">array</span>: <span class=\"code-title\">isArray</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">weakMap</span>: <span class=\"code-title\">isWeakMap</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">nodeList</span>: <span class=\"code-title\">isNodeList</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">element</span>: <span class=\"code-title\">isElement</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">textNode</span>: <span class=\"code-title\">isTextNode</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">event</span>: <span class=\"code-title\">isEvent</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">keyboardEvent</span>: <span class=\"code-title\">isKeyboardEvent</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">cue</span>: <span class=\"code-title\">isCue</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">track</span>: <span class=\"code-title\">isTrack</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">promise</span>: <span class=\"code-title\">isPromise</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">url</span>: <span class=\"code-title\">isUrl</span>,\n</span>","<span class=\"code-function\">    <span class=\"code-title\">empty</span>: <span class=\"code-title\">isEmpty</span>\n</span>","<span class=\"code-function\">  };\n</span>","<span class=\"code-function\">\n</span>","<span class=\"code-function\">  // ==========================================================================\n</span>","<span class=\"code-function\">  <span class=\"code-title\">const</span> <span class=\"code-title\">transitionEndEvent</span> = (<span class=\"code-params\">(</span>) =&gt; </span>{\n","    <span class=\"code-keyword\">const</span> element = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'span'</span>);\n","    <span class=\"code-keyword\">const</span> events = {\n","      WebkitTransition: <span class=\"code-string\">'webkitTransitionEnd'</span>,\n","      MozTransition: <span class=\"code-string\">'transitionend'</span>,\n","      OTransition: <span class=\"code-string\">'oTransitionEnd otransitionend'</span>,\n","      transition: <span class=\"code-string\">'transitionend'</span>\n","    };\n","    <span class=\"code-keyword\">const</span> type = <span class=\"code-built_in\">Object</span>.keys(events).find(<span class=\"code-function\"><span class=\"code-params\">event</span> =&gt;</span> element.style[event] !== <span class=\"code-literal\">undefined</span>);\n","    <span class=\"code-keyword\">return</span> is.string(type) ? events[type] : <span class=\"code-literal\">false</span>;\n","  })();\n","\n","  <span class=\"code-comment\">// Force repaint of element</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">repaint</span>(<span class=\"code-params\">element, delay</span>) </span>{\n","    setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        element.hidden = <span class=\"code-literal\">true</span>;\n","\n","        <span class=\"code-comment\">// eslint-disable-next-line no-unused-expressions</span>\n","        element.offsetHeight;\n","\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        element.hidden = <span class=\"code-literal\">false</span>;\n","      } <span class=\"code-keyword\">catch</span> (_) {\n","        <span class=\"code-comment\">// Do nothing</span>\n","      }\n","    }, delay);\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Browser sniffing</span>\n","  <span class=\"code-comment\">// Unfortunately, due to mixed support, UA sniffing is required</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> isIE = <span class=\"code-built_in\">Boolean</span>(<span class=\"code-built_in\">window</span>.document.documentMode);\n","  <span class=\"code-keyword\">const</span> isEdge = <span class=\"code-regexp\">/Edge/g</span>.test(navigator.userAgent);\n","  <span class=\"code-keyword\">const</span> isWebKit = <span class=\"code-string\">'WebkitAppearance'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.documentElement.style &amp;&amp; !<span class=\"code-regexp\">/Edge/g</span>.test(navigator.userAgent);\n","  <span class=\"code-keyword\">const</span> isIPhone = <span class=\"code-regexp\">/iPhone|iPod/gi</span>.test(navigator.userAgent) &amp;&amp; navigator.maxTouchPoints &gt; <span class=\"code-number\">1</span>;\n","  <span class=\"code-comment\">// navigator.platform may be deprecated but this check is still required</span>\n","  <span class=\"code-keyword\">const</span> isIPadOS = navigator.platform === <span class=\"code-string\">'MacIntel'</span> &amp;&amp; navigator.maxTouchPoints &gt; <span class=\"code-number\">1</span>;\n","  <span class=\"code-keyword\">const</span> isIos = <span class=\"code-regexp\">/iPad|iPhone|iPod/gi</span>.test(navigator.userAgent) &amp;&amp; navigator.maxTouchPoints &gt; <span class=\"code-number\">1</span>;\n","  <span class=\"code-keyword\">var</span> browser = {\n","    isIE,\n","    isEdge,\n","    isWebKit,\n","    isIPhone,\n","    isIPadOS,\n","    isIos\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Clone nested objects</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">cloneDeep</span>(<span class=\"code-params\">object</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">JSON</span>.parse(<span class=\"code-built_in\">JSON</span>.stringify(object));\n","  }\n","\n","  <span class=\"code-comment\">// Get a nested value in an object</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getDeep</span>(<span class=\"code-params\">object, path</span>) </span>{\n","    <span class=\"code-keyword\">return</span> path.split(<span class=\"code-string\">'.'</span>).reduce(<span class=\"code-function\">(<span class=\"code-params\">obj, key</span>) =&gt;</span> obj &amp;&amp; obj[key], object);\n","  }\n","\n","  <span class=\"code-comment\">// Deep extend destination object with N more objects</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">extend</span>(<span class=\"code-params\">target = {}, ...sources</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!sources.length) {\n","      <span class=\"code-keyword\">return</span> target;\n","    }\n","    <span class=\"code-keyword\">const</span> source = sources.shift();\n","    <span class=\"code-keyword\">if</span> (!is.object(source)) {\n","      <span class=\"code-keyword\">return</span> target;\n","    }\n","    <span class=\"code-built_in\">Object</span>.keys(source).forEach(<span class=\"code-function\"><span class=\"code-params\">key</span> =&gt;</span> {\n","      <span class=\"code-keyword\">if</span> (is.object(source[key])) {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-built_in\">Object</span>.keys(target).includes(key)) {\n","          <span class=\"code-built_in\">Object</span>.assign(target, {\n","            [key]: {}\n","          });\n","        }\n","        extend(target[key], source[key]);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-built_in\">Object</span>.assign(target, {\n","          [key]: source[key]\n","        });\n","      }\n","    });\n","    <span class=\"code-keyword\">return</span> extend(target, ...sources);\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Wrap an element</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">wrap</span>(<span class=\"code-params\">elements, wrapper</span>) </span>{\n","    <span class=\"code-comment\">// Convert `elements` to an array, if necessary.</span>\n","    <span class=\"code-keyword\">const</span> targets = elements.length ? elements : [elements];\n","\n","    <span class=\"code-comment\">// Loops backwards to prevent having to clone the wrapper on the</span>\n","    <span class=\"code-comment\">// first element (see `child` below).</span>\n","    <span class=\"code-built_in\">Array</span>.from(targets).reverse().forEach(<span class=\"code-function\">(<span class=\"code-params\">element, index</span>) =&gt;</span> {\n","      <span class=\"code-keyword\">const</span> child = index &gt; <span class=\"code-number\">0</span> ? wrapper.cloneNode(<span class=\"code-literal\">true</span>) : wrapper;\n","      <span class=\"code-comment\">// Cache the current parent and sibling.</span>\n","      <span class=\"code-keyword\">const</span> parent = element.parentNode;\n","      <span class=\"code-keyword\">const</span> sibling = element.nextSibling;\n","\n","      <span class=\"code-comment\">// Wrap the element (is automatically removed from its current</span>\n","      <span class=\"code-comment\">// parent).</span>\n","      child.appendChild(element);\n","\n","      <span class=\"code-comment\">// If the element had a sibling, insert the wrapper before</span>\n","      <span class=\"code-comment\">// the sibling to maintain the HTML structure; otherwise, just</span>\n","      <span class=\"code-comment\">// append it to the parent.</span>\n","      <span class=\"code-keyword\">if</span> (sibling) {\n","        parent.insertBefore(child, sibling);\n","      } <span class=\"code-keyword\">else</span> {\n","        parent.appendChild(child);\n","      }\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// Set attributes</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">setAttributes</span>(<span class=\"code-params\">element, attributes</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(element) || is.empty(attributes)) <span class=\"code-keyword\">return</span>;\n","\n","    <span class=\"code-comment\">// Assume null and undefined attributes should be left out,</span>\n","    <span class=\"code-comment\">// Setting them would otherwise convert them to \"null\" and \"undefined\"</span>\n","    <span class=\"code-built_in\">Object</span>.entries(attributes).filter(<span class=\"code-function\">(<span class=\"code-params\">[, value]</span>) =&gt;</span> !is.nullOrUndefined(value)).forEach(<span class=\"code-function\">(<span class=\"code-params\">[key, value]</span>) =&gt;</span> element.setAttribute(key, value));\n","  }\n","\n","  <span class=\"code-comment\">// Create a DocumentFragment</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">createElement</span>(<span class=\"code-params\">type, attributes, text</span>) </span>{\n","    <span class=\"code-comment\">// Create a new &lt;element&gt;</span>\n","    <span class=\"code-keyword\">const</span> element = <span class=\"code-built_in\">document</span>.createElement(type);\n","\n","    <span class=\"code-comment\">// Set all passed attributes</span>\n","    <span class=\"code-keyword\">if</span> (is.object(attributes)) {\n","      setAttributes(element, attributes);\n","    }\n","\n","    <span class=\"code-comment\">// Add text node</span>\n","    <span class=\"code-keyword\">if</span> (is.string(text)) {\n","      element.innerText = text;\n","    }\n","\n","    <span class=\"code-comment\">// Return built element</span>\n","    <span class=\"code-keyword\">return</span> element;\n","  }\n","\n","  <span class=\"code-comment\">// Insert an element after another</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">insertAfter</span>(<span class=\"code-params\">element, target</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(element) || !is.element(target)) <span class=\"code-keyword\">return</span>;\n","    target.parentNode.insertBefore(element, target.nextSibling);\n","  }\n","\n","  <span class=\"code-comment\">// Insert a DocumentFragment</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">insertElement</span>(<span class=\"code-params\">type, parent, attributes, text</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(parent)) <span class=\"code-keyword\">return</span>;\n","    parent.appendChild(createElement(type, attributes, text));\n","  }\n","\n","  <span class=\"code-comment\">// Remove element(s)</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">removeElement</span>(<span class=\"code-params\">element</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.nodeList(element) || is.array(element)) {\n","      <span class=\"code-built_in\">Array</span>.from(element).forEach(removeElement);\n","      <span class=\"code-keyword\">return</span>;\n","    }\n","    <span class=\"code-keyword\">if</span> (!is.element(element) || !is.element(element.parentNode)) {\n","      <span class=\"code-keyword\">return</span>;\n","    }\n","    element.parentNode.removeChild(element);\n","  }\n","\n","  <span class=\"code-comment\">// Remove all child elements</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">emptyElement</span>(<span class=\"code-params\">element</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(element)) <span class=\"code-keyword\">return</span>;\n","    <span class=\"code-keyword\">let</span> {\n","      length\n","    } = element.childNodes;\n","    <span class=\"code-keyword\">while</span> (length &gt; <span class=\"code-number\">0</span>) {\n","      element.removeChild(element.lastChild);\n","      length -= <span class=\"code-number\">1</span>;\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// Replace element</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">replaceElement</span>(<span class=\"code-params\">newChild, oldChild</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(oldChild) || !is.element(oldChild.parentNode) || !is.element(newChild)) <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    oldChild.parentNode.replaceChild(newChild, oldChild);\n","    <span class=\"code-keyword\">return</span> newChild;\n","  }\n","\n","  <span class=\"code-comment\">// Get an attribute object from a string selector</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getAttributesFromSelector</span>(<span class=\"code-params\">sel, existingAttributes</span>) </span>{\n","    <span class=\"code-comment\">// For example:</span>\n","    <span class=\"code-comment\">// '.test' to { class: 'test' }</span>\n","    <span class=\"code-comment\">// '#test' to { id: 'test' }</span>\n","    <span class=\"code-comment\">// '[data-test=\"test\"]' to { 'data-test': 'test' }</span>\n","\n","    <span class=\"code-keyword\">if</span> (!is.string(sel) || is.empty(sel)) <span class=\"code-keyword\">return</span> {};\n","    <span class=\"code-keyword\">const</span> attributes = {};\n","    <span class=\"code-keyword\">const</span> existing = extend({}, existingAttributes);\n","    sel.split(<span class=\"code-string\">','</span>).forEach(<span class=\"code-function\"><span class=\"code-params\">s</span> =&gt;</span> {\n","      <span class=\"code-comment\">// Remove whitespace</span>\n","      <span class=\"code-keyword\">const</span> selector = s.trim();\n","      <span class=\"code-keyword\">const</span> className = selector.replace(<span class=\"code-string\">'.'</span>, <span class=\"code-string\">''</span>);\n","      <span class=\"code-keyword\">const</span> stripped = selector.replace(<span class=\"code-regexp\">/[[\\]]/g</span>, <span class=\"code-string\">''</span>);\n","      <span class=\"code-comment\">// Get the parts and value</span>\n","      <span class=\"code-keyword\">const</span> parts = stripped.split(<span class=\"code-string\">'='</span>);\n","      <span class=\"code-keyword\">const</span> [key] = parts;\n","      <span class=\"code-keyword\">const</span> value = parts.length &gt; <span class=\"code-number\">1</span> ? parts[<span class=\"code-number\">1</span>].replace(<span class=\"code-regexp\">/[\"']/g</span>, <span class=\"code-string\">''</span>) : <span class=\"code-string\">''</span>;\n","      <span class=\"code-comment\">// Get the first character</span>\n","      <span class=\"code-keyword\">const</span> start = selector.charAt(<span class=\"code-number\">0</span>);\n","      <span class=\"code-keyword\">switch</span> (start) {\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'.'</span>:\n","          <span class=\"code-comment\">// Add to existing classname</span>\n","          <span class=\"code-keyword\">if</span> (is.string(existing.class)) {\n","            attributes.class = <span class=\"code-string\">`<span class=\"code-subst\">${existing.class}</span> <span class=\"code-subst\">${className}</span>`</span>;\n","          } <span class=\"code-keyword\">else</span> {\n","            attributes.class = className;\n","          }\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'#'</span>:\n","          <span class=\"code-comment\">// ID selector</span>\n","          attributes.id = selector.replace(<span class=\"code-string\">'#'</span>, <span class=\"code-string\">''</span>);\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'['</span>:\n","          <span class=\"code-comment\">// Attribute selector</span>\n","          attributes[key] = value;\n","          <span class=\"code-keyword\">break</span>;\n","      }\n","    });\n","    <span class=\"code-keyword\">return</span> extend(existing, attributes);\n","  }\n","\n","  <span class=\"code-comment\">// Toggle hidden</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">toggleHidden</span>(<span class=\"code-params\">element, hidden</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(element)) <span class=\"code-keyword\">return</span>;\n","    <span class=\"code-keyword\">let</span> hide = hidden;\n","    <span class=\"code-keyword\">if</span> (!is.boolean(hide)) {\n","      hide = !element.hidden;\n","    }\n","\n","    <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","    element.hidden = hide;\n","  }\n","\n","  <span class=\"code-comment\">// Mirror Element.classList.toggle, with IE compatibility for \"force\" argument</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">toggleClass</span>(<span class=\"code-params\">element, className, force</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.nodeList(element)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Array</span>.from(element).map(<span class=\"code-function\"><span class=\"code-params\">e</span> =&gt;</span> toggleClass(e, className, force));\n","    }\n","    <span class=\"code-keyword\">if</span> (is.element(element)) {\n","      <span class=\"code-keyword\">let</span> method = <span class=\"code-string\">'toggle'</span>;\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">typeof</span> force !== <span class=\"code-string\">'undefined'</span>) {\n","        method = force ? <span class=\"code-string\">'add'</span> : <span class=\"code-string\">'remove'</span>;\n","      }\n","      element.classList[method](className);\n","      <span class=\"code-keyword\">return</span> element.classList.contains(className);\n","    }\n","    <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","  }\n","\n","  <span class=\"code-comment\">// Has class name</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">hasClass</span>(<span class=\"code-params\">element, className</span>) </span>{\n","    <span class=\"code-keyword\">return</span> is.element(element) &amp;&amp; element.classList.contains(className);\n","  }\n","\n","  <span class=\"code-comment\">// Element matches selector</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">matches</span>(<span class=\"code-params\">element, selector</span>) </span>{\n","    <span class=\"code-keyword\">const</span> {\n","      prototype\n","    } = Element;\n","    <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">match</span>(<span class=\"code-params\"></span>) </span>{\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Array</span>.from(<span class=\"code-built_in\">document</span>.querySelectorAll(selector)).includes(<span class=\"code-keyword\">this</span>);\n","    }\n","    <span class=\"code-keyword\">const</span> method = prototype.matches || prototype.webkitMatchesSelector || prototype.mozMatchesSelector || prototype.msMatchesSelector || match;\n","    <span class=\"code-keyword\">return</span> method.call(element, selector);\n","  }\n","\n","  <span class=\"code-comment\">// Closest ancestor element matching selector (also tests element itself)</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">closest$1</span>(<span class=\"code-params\">element, selector</span>) </span>{\n","    <span class=\"code-keyword\">const</span> {\n","      prototype\n","    } = Element;\n","\n","    <span class=\"code-comment\">// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill</span>\n","    <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">closestElement</span>(<span class=\"code-params\"></span>) </span>{\n","      <span class=\"code-keyword\">let</span> el = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">do</span> {\n","        <span class=\"code-keyword\">if</span> (matches.matches(el, selector)) <span class=\"code-keyword\">return</span> el;\n","        el = el.parentElement || el.parentNode;\n","      } <span class=\"code-keyword\">while</span> (el !== <span class=\"code-literal\">null</span> &amp;&amp; el.nodeType === <span class=\"code-number\">1</span>);\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","    <span class=\"code-keyword\">const</span> method = prototype.closest || closestElement;\n","    <span class=\"code-keyword\">return</span> method.call(element, selector);\n","  }\n","\n","  <span class=\"code-comment\">// Find all elements</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getElements</span>(<span class=\"code-params\">selector</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.elements.container.querySelectorAll(selector);\n","  }\n","\n","  <span class=\"code-comment\">// Find a single element</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getElement</span>(<span class=\"code-params\">selector</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.elements.container.querySelector(selector);\n","  }\n","\n","  <span class=\"code-comment\">// Set focus and tab focus class</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">setFocus</span>(<span class=\"code-params\">element = null, focusVisible = false</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.element(element)) <span class=\"code-keyword\">return</span>;\n","\n","    <span class=\"code-comment\">// Set regular focus</span>\n","    element.focus({\n","      preventScroll: <span class=\"code-literal\">true</span>,\n","      focusVisible\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Default codecs for checking mimetype support</span>\n","  <span class=\"code-keyword\">const</span> defaultCodecs = {\n","    <span class=\"code-string\">'audio/ogg'</span>: <span class=\"code-string\">'vorbis'</span>,\n","    <span class=\"code-string\">'audio/wav'</span>: <span class=\"code-string\">'1'</span>,\n","    <span class=\"code-string\">'video/webm'</span>: <span class=\"code-string\">'vp8, vorbis'</span>,\n","    <span class=\"code-string\">'video/mp4'</span>: <span class=\"code-string\">'avc1.42E01E, mp4a.40.2'</span>,\n","    <span class=\"code-string\">'video/ogg'</span>: <span class=\"code-string\">'theora'</span>\n","  };\n","\n","  <span class=\"code-comment\">// Check for feature support</span>\n","  <span class=\"code-keyword\">const</span> support = {\n","    <span class=\"code-comment\">// Basic support</span>\n","    audio: <span class=\"code-string\">'canPlayType'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'audio'</span>),\n","    video: <span class=\"code-string\">'canPlayType'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'video'</span>),\n","    <span class=\"code-comment\">// Check for support</span>\n","    <span class=\"code-comment\">// Basic functionality vs full UI</span>\n","    check(type, provider) {\n","      <span class=\"code-keyword\">const</span> api = support[type] || provider !== <span class=\"code-string\">'html5'</span>;\n","      <span class=\"code-keyword\">const</span> ui = api &amp;&amp; support.rangeInput;\n","      <span class=\"code-keyword\">return</span> {\n","        api,\n","        ui\n","      };\n","    },\n","    <span class=\"code-comment\">// Picture-in-picture support</span>\n","    <span class=\"code-comment\">// Safari &amp; Chrome only currently</span>\n","    pip: <span class=\"code-function\">(<span class=\"code-params\">(</span>) =&gt;</span> {\n","      <span class=\"code-comment\">// While iPhone's support picture-in-picture for some apps, seemingly Safari isn't one of them</span>\n","      <span class=\"code-comment\">// It will throw the following error when trying to enter picture-in-picture</span>\n","      <span class=\"code-comment\">// `NotSupportedError: The Picture-in-Picture mode is not supported.`</span>\n","      <span class=\"code-keyword\">if</span> (browser.isIPhone) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Safari</span>\n","      <span class=\"code-comment\">// https://developer.apple.com/documentation/webkitjs/adding_picture_in_picture_to_your_safari_media_controls</span>\n","      <span class=\"code-keyword\">if</span> (is.function(createElement(<span class=\"code-string\">'video'</span>).webkitSetPresentationMode)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Chrome</span>\n","      <span class=\"code-comment\">// https://developers.google.com/web/updates/2018/10/watch-video-using-picture-in-picture</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">document</span>.pictureInPictureEnabled &amp;&amp; !createElement(<span class=\"code-string\">'video'</span>).disablePictureInPicture) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      }\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","    })(),\n","    <span class=\"code-comment\">// Airplay support</span>\n","    <span class=\"code-comment\">// Safari only currently</span>\n","    airplay: is.function(<span class=\"code-built_in\">window</span>.WebKitPlaybackTargetAvailabilityEvent),\n","    <span class=\"code-comment\">// Inline playback support</span>\n","    <span class=\"code-comment\">// https://webkit.org/blog/6784/new-video-policies-for-ios/</span>\n","    playsinline: <span class=\"code-string\">'playsInline'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'video'</span>),\n","    <span class=\"code-comment\">// Check for mime type support against a player instance</span>\n","    <span class=\"code-comment\">// Credits: http://diveintohtml5.info/everything.html</span>\n","    <span class=\"code-comment\">// Related: http://www.leanbackplayer.com/test/h5mt.html</span>\n","    mime(input) {\n","      <span class=\"code-keyword\">if</span> (is.empty(input)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> [mediaType] = input.split(<span class=\"code-string\">'/'</span>);\n","      <span class=\"code-keyword\">let</span> type = input;\n","\n","      <span class=\"code-comment\">// Verify we're using HTML5 and there's no media type mismatch</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isHTML5 || mediaType !== <span class=\"code-keyword\">this</span>.type) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Add codec if required</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(defaultCodecs).includes(type)) {\n","        type += <span class=\"code-string\">`; codecs=\"<span class=\"code-subst\">${defaultCodecs[input]}</span>\"`</span>;\n","      }\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(type &amp;&amp; <span class=\"code-keyword\">this</span>.media.canPlayType(type).replace(<span class=\"code-regexp\">/no/</span>, <span class=\"code-string\">''</span>));\n","      } <span class=\"code-keyword\">catch</span> (_) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","    },\n","    <span class=\"code-comment\">// Check for textTracks support</span>\n","    textTracks: <span class=\"code-string\">'textTracks'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'video'</span>),\n","    <span class=\"code-comment\">// &lt;input type=\"range\"&gt; Sliders</span>\n","    rangeInput: <span class=\"code-function\">(<span class=\"code-params\">(</span>) =&gt;</span> {\n","      <span class=\"code-keyword\">const</span> range = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'input'</span>);\n","      range.type = <span class=\"code-string\">'range'</span>;\n","      <span class=\"code-keyword\">return</span> range.type === <span class=\"code-string\">'range'</span>;\n","    })(),\n","    <span class=\"code-comment\">// Touch</span>\n","    <span class=\"code-comment\">// <span class=\"code-doctag\">NOTE:</span> Remember a device can be mouse + touch enabled so we check on first touch event</span>\n","    touch: <span class=\"code-string\">'ontouchstart'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">document</span>.documentElement,\n","    <span class=\"code-comment\">// Detect transitions support</span>\n","    transitions: transitionEndEvent !== <span class=\"code-literal\">false</span>,\n","    <span class=\"code-comment\">// Reduced motion iOS &amp; MacOS setting</span>\n","    <span class=\"code-comment\">// https://webkit.org/blog/7551/responsive-design-for-motion/</span>\n","    reducedMotion: <span class=\"code-string\">'matchMedia'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">window</span> &amp;&amp; <span class=\"code-built_in\">window</span>.matchMedia(<span class=\"code-string\">'(prefers-reduced-motion)'</span>).matches\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Check for passive event listener support</span>\n","  <span class=\"code-comment\">// https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md</span>\n","  <span class=\"code-comment\">// https://www.youtube.com/watch?v=NPM6172J22g</span>\n","  <span class=\"code-keyword\">const</span> supportsPassiveListeners = <span class=\"code-function\">(<span class=\"code-params\">(</span>) =&gt;</span> {\n","    <span class=\"code-comment\">// Test via a getter in the options object to see if the passive property is accessed</span>\n","    <span class=\"code-keyword\">let</span> supported = <span class=\"code-literal\">false</span>;\n","    <span class=\"code-keyword\">try</span> {\n","      <span class=\"code-keyword\">const</span> options = <span class=\"code-built_in\">Object</span>.defineProperty({}, <span class=\"code-string\">'passive'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          supported = <span class=\"code-literal\">true</span>;\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","      });\n","      <span class=\"code-built_in\">window</span>.addEventListener(<span class=\"code-string\">'test'</span>, <span class=\"code-literal\">null</span>, options);\n","      <span class=\"code-built_in\">window</span>.removeEventListener(<span class=\"code-string\">'test'</span>, <span class=\"code-literal\">null</span>, options);\n","    } <span class=\"code-keyword\">catch</span> (_) {\n","      <span class=\"code-comment\">// Do nothing</span>\n","    }\n","    <span class=\"code-keyword\">return</span> supported;\n","  })();\n","\n","  <span class=\"code-comment\">// Toggle event listener</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">toggleListener</span>(<span class=\"code-params\">element, event, callback, toggle = false, passive = true, capture = false</span>) </span>{\n","    <span class=\"code-comment\">// Bail if no element, event, or callback</span>\n","    <span class=\"code-keyword\">if</span> (!element || !(<span class=\"code-string\">'addEventListener'</span> <span class=\"code-keyword\">in</span> element) || is.empty(event) || !is.function(callback)) {\n","      <span class=\"code-keyword\">return</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Allow multiple events</span>\n","    <span class=\"code-keyword\">const</span> events = event.split(<span class=\"code-string\">' '</span>);\n","    <span class=\"code-comment\">// Build options</span>\n","    <span class=\"code-comment\">// Default to just the capture boolean for browsers with no passive listener support</span>\n","    <span class=\"code-keyword\">let</span> options = capture;\n","\n","    <span class=\"code-comment\">// If passive events listeners are supported</span>\n","    <span class=\"code-keyword\">if</span> (supportsPassiveListeners) {\n","      options = {\n","        <span class=\"code-comment\">// Whether the listener can be passive (i.e. default never prevented)</span>\n","        passive,\n","        <span class=\"code-comment\">// Whether the listener is a capturing listener or not</span>\n","        capture\n","      };\n","    }\n","\n","    <span class=\"code-comment\">// If a single node is passed, bind the event listener</span>\n","    events.forEach(<span class=\"code-function\"><span class=\"code-params\">type</span> =&gt;</span> {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span> &amp;&amp; <span class=\"code-keyword\">this</span>.eventListeners &amp;&amp; toggle) {\n","        <span class=\"code-comment\">// Cache event listener</span>\n","        <span class=\"code-keyword\">this</span>.eventListeners.push({\n","          element,\n","          type,\n","          callback,\n","          options\n","        });\n","      }\n","      element[toggle ? <span class=\"code-string\">'addEventListener'</span> : <span class=\"code-string\">'removeEventListener'</span>](type, callback, options);\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// Bind event handler</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">on</span>(<span class=\"code-params\">element, events = <span class=\"code-string\">''</span>, callback, passive = true, capture = false</span>) </span>{\n","    toggleListener.call(<span class=\"code-keyword\">this</span>, element, events, callback, <span class=\"code-literal\">true</span>, passive, capture);\n","  }\n","\n","  <span class=\"code-comment\">// Unbind event handler</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">off</span>(<span class=\"code-params\">element, events = <span class=\"code-string\">''</span>, callback, passive = true, capture = false</span>) </span>{\n","    toggleListener.call(<span class=\"code-keyword\">this</span>, element, events, callback, <span class=\"code-literal\">false</span>, passive, capture);\n","  }\n","\n","  <span class=\"code-comment\">// Bind once-only event handler</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">once</span>(<span class=\"code-params\">element, events = <span class=\"code-string\">''</span>, callback, passive = true, capture = false</span>) </span>{\n","    <span class=\"code-keyword\">const</span> onceCallback = <span class=\"code-function\">(<span class=\"code-params\">...args</span>) =&gt;</span> {\n","      off(element, events, onceCallback, passive, capture);\n","      callback.apply(<span class=\"code-keyword\">this</span>, args);\n","    };\n","    toggleListener.call(<span class=\"code-keyword\">this</span>, element, events, onceCallback, <span class=\"code-literal\">true</span>, passive, capture);\n","  }\n","\n","  <span class=\"code-comment\">// Trigger event</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">triggerEvent</span>(<span class=\"code-params\">element, type = <span class=\"code-string\">''</span>, bubbles = false, detail = {}</span>) </span>{\n","    <span class=\"code-comment\">// Bail if no element</span>\n","    <span class=\"code-keyword\">if</span> (!is.element(element) || is.empty(type)) {\n","      <span class=\"code-keyword\">return</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Create and dispatch the event</span>\n","    <span class=\"code-keyword\">const</span> event = <span class=\"code-keyword\">new</span> CustomEvent(type, {\n","      bubbles,\n","      detail: {\n","        ...detail,\n","        plyr: <span class=\"code-keyword\">this</span>\n","      }\n","    });\n","\n","    <span class=\"code-comment\">// Dispatch the event</span>\n","    element.dispatchEvent(event);\n","  }\n","\n","  <span class=\"code-comment\">// Unbind all cached event listeners</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">unbindListeners</span>(<span class=\"code-params\"></span>) </span>{\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span> &amp;&amp; <span class=\"code-keyword\">this</span>.eventListeners) {\n","      <span class=\"code-keyword\">this</span>.eventListeners.forEach(<span class=\"code-function\"><span class=\"code-params\">item</span> =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> {\n","          element,\n","          type,\n","          callback,\n","          options\n","        } = item;\n","        element.removeEventListener(type, callback, options);\n","      });\n","      <span class=\"code-keyword\">this</span>.eventListeners = [];\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// Run method when / if player is ready</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">ready</span>(<span class=\"code-params\"></span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\"><span class=\"code-params\">resolve</span> =&gt;</span> <span class=\"code-keyword\">this</span>.ready ? setTimeout(resolve, <span class=\"code-number\">0</span>) : on.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-string\">'ready'</span>, resolve)).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","  }\n","\n","  <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">   * Silence a Promise-like object.\n</span>","<span class=\"code-comment\">   * This is useful for avoiding non-harmful, but potentially confusing \"uncaught\n</span>","<span class=\"code-comment\">   * play promise\" rejection error messages.\n</span>","<span class=\"code-comment\">   * @param  {Object} value An object that may or may not be `Promise`-like.\n</span>","<span class=\"code-comment\">   */</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">silencePromise</span>(<span class=\"code-params\">value</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.promise(value)) {\n","      value.then(<span class=\"code-literal\">null</span>, () =&gt; {});\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Remove duplicates in an array</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">dedupe</span>(<span class=\"code-params\">array</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.array(array)) {\n","      <span class=\"code-keyword\">return</span> array;\n","    }\n","    <span class=\"code-keyword\">return</span> array.filter(<span class=\"code-function\">(<span class=\"code-params\">item, index</span>) =&gt;</span> array.indexOf(item) === index);\n","  }\n","\n","  <span class=\"code-comment\">// Get the closest value in an array</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">closest</span>(<span class=\"code-params\">array, value</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.array(array) || !array.length) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","    <span class=\"code-keyword\">return</span> array.reduce(<span class=\"code-function\">(<span class=\"code-params\">prev, curr</span>) =&gt;</span> <span class=\"code-built_in\">Math</span>.abs(curr - value) &lt; <span class=\"code-built_in\">Math</span>.abs(prev - value) ? curr : prev);\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Check support for a CSS declaration</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">supportsCSS</span>(<span class=\"code-params\">declaration</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!<span class=\"code-built_in\">window</span> || !<span class=\"code-built_in\">window</span>.CSS) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","    }\n","    <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">window</span>.CSS.supports(declaration);\n","  }\n","\n","  <span class=\"code-comment\">// Standard/common aspect ratios</span>\n","  <span class=\"code-keyword\">const</span> standardRatios = [[<span class=\"code-number\">1</span>, <span class=\"code-number\">1</span>], [<span class=\"code-number\">4</span>, <span class=\"code-number\">3</span>], [<span class=\"code-number\">3</span>, <span class=\"code-number\">4</span>], [<span class=\"code-number\">5</span>, <span class=\"code-number\">4</span>], [<span class=\"code-number\">4</span>, <span class=\"code-number\">5</span>], [<span class=\"code-number\">3</span>, <span class=\"code-number\">2</span>], [<span class=\"code-number\">2</span>, <span class=\"code-number\">3</span>], [<span class=\"code-number\">16</span>, <span class=\"code-number\">10</span>], [<span class=\"code-number\">10</span>, <span class=\"code-number\">16</span>], [<span class=\"code-number\">16</span>, <span class=\"code-number\">9</span>], [<span class=\"code-number\">9</span>, <span class=\"code-number\">16</span>], [<span class=\"code-number\">21</span>, <span class=\"code-number\">9</span>], [<span class=\"code-number\">9</span>, <span class=\"code-number\">21</span>], [<span class=\"code-number\">32</span>, <span class=\"code-number\">9</span>], [<span class=\"code-number\">9</span>, <span class=\"code-number\">32</span>]].reduce(<span class=\"code-function\">(<span class=\"code-params\">out, [x, y]</span>) =&gt;</span> ({\n","    ...out,\n","    [x / y]: [x, y]\n","  }), {});\n","\n","  <span class=\"code-comment\">// Validate an aspect ratio</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">validateAspectRatio</span>(<span class=\"code-params\">input</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.array(input) &amp;&amp; (!is.string(input) || !input.includes(<span class=\"code-string\">':'</span>))) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","    }\n","    <span class=\"code-keyword\">const</span> ratio = is.array(input) ? input : input.split(<span class=\"code-string\">':'</span>);\n","    <span class=\"code-keyword\">return</span> ratio.map(<span class=\"code-built_in\">Number</span>).every(is.number);\n","  }\n","\n","  <span class=\"code-comment\">// Reduce an aspect ratio to it's lowest form</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">reduceAspectRatio</span>(<span class=\"code-params\">ratio</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.array(ratio) || !ratio.every(is.number)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","    <span class=\"code-keyword\">const</span> [width, height] = ratio;\n","    <span class=\"code-keyword\">const</span> getDivider = <span class=\"code-function\">(<span class=\"code-params\">w, h</span>) =&gt;</span> h === <span class=\"code-number\">0</span> ? w : getDivider(h, w % h);\n","    <span class=\"code-keyword\">const</span> divider = getDivider(width, height);\n","    <span class=\"code-keyword\">return</span> [width / divider, height / divider];\n","  }\n","\n","  <span class=\"code-comment\">// Calculate an aspect ratio</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getAspectRatio</span>(<span class=\"code-params\">input</span>) </span>{\n","    <span class=\"code-keyword\">const</span> parse = <span class=\"code-function\"><span class=\"code-params\">ratio</span> =&gt;</span> validateAspectRatio(ratio) ? ratio.split(<span class=\"code-string\">':'</span>).map(<span class=\"code-built_in\">Number</span>) : <span class=\"code-literal\">null</span>;\n","    <span class=\"code-comment\">// Try provided ratio</span>\n","    <span class=\"code-keyword\">let</span> ratio = parse(input);\n","\n","    <span class=\"code-comment\">// Get from config</span>\n","    <span class=\"code-keyword\">if</span> (ratio === <span class=\"code-literal\">null</span>) {\n","      ratio = parse(<span class=\"code-keyword\">this</span>.config.ratio);\n","    }\n","\n","    <span class=\"code-comment\">// Get from embed</span>\n","    <span class=\"code-keyword\">if</span> (ratio === <span class=\"code-literal\">null</span> &amp;&amp; !is.empty(<span class=\"code-keyword\">this</span>.embed) &amp;&amp; is.array(<span class=\"code-keyword\">this</span>.embed.ratio)) {\n","      ({\n","        ratio\n","      } = <span class=\"code-keyword\">this</span>.embed);\n","    }\n","\n","    <span class=\"code-comment\">// Get from HTML5 video</span>\n","    <span class=\"code-keyword\">if</span> (ratio === <span class=\"code-literal\">null</span> &amp;&amp; <span class=\"code-keyword\">this</span>.isHTML5) {\n","      <span class=\"code-keyword\">const</span> {\n","        videoWidth,\n","        videoHeight\n","      } = <span class=\"code-keyword\">this</span>.media;\n","      ratio = [videoWidth, videoHeight];\n","    }\n","    <span class=\"code-keyword\">return</span> reduceAspectRatio(ratio);\n","  }\n","\n","  <span class=\"code-comment\">// Set aspect ratio for responsive container</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">setAspectRatio</span>(<span class=\"code-params\">input</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo) {\n","      <span class=\"code-keyword\">return</span> {};\n","    }\n","    <span class=\"code-keyword\">const</span> {\n","      wrapper\n","    } = <span class=\"code-keyword\">this</span>.elements;\n","    <span class=\"code-keyword\">const</span> ratio = getAspectRatio.call(<span class=\"code-keyword\">this</span>, input);\n","    <span class=\"code-keyword\">if</span> (!is.array(ratio)) {\n","      <span class=\"code-keyword\">return</span> {};\n","    }\n","    <span class=\"code-keyword\">const</span> [x, y] = reduceAspectRatio(ratio);\n","    <span class=\"code-keyword\">const</span> useNative = supportsCSS(<span class=\"code-string\">`aspect-ratio: <span class=\"code-subst\">${x}</span>/<span class=\"code-subst\">${y}</span>`</span>);\n","    <span class=\"code-keyword\">const</span> padding = <span class=\"code-number\">100</span> / x * y;\n","    <span class=\"code-keyword\">if</span> (useNative) {\n","      wrapper.style.aspectRatio = <span class=\"code-string\">`<span class=\"code-subst\">${x}</span>/<span class=\"code-subst\">${y}</span>`</span>;\n","    } <span class=\"code-keyword\">else</span> {\n","      wrapper.style.paddingBottom = <span class=\"code-string\">`<span class=\"code-subst\">${padding}</span>%`</span>;\n","    }\n","\n","    <span class=\"code-comment\">// For Vimeo we have an extra &lt;div&gt; to hide the standard controls and UI</span>\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo &amp;&amp; !<span class=\"code-keyword\">this</span>.config.vimeo.premium &amp;&amp; <span class=\"code-keyword\">this</span>.supported.ui) {\n","      <span class=\"code-keyword\">const</span> height = <span class=\"code-number\">100</span> / <span class=\"code-keyword\">this</span>.media.offsetWidth * <span class=\"code-built_in\">parseInt</span>(<span class=\"code-built_in\">window</span>.getComputedStyle(<span class=\"code-keyword\">this</span>.media).paddingBottom, <span class=\"code-number\">10</span>);\n","      <span class=\"code-keyword\">const</span> offset = (height - padding) / (height / <span class=\"code-number\">50</span>);\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.fullscreen.active) {\n","        wrapper.style.paddingBottom = <span class=\"code-literal\">null</span>;\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">this</span>.media.style.transform = <span class=\"code-string\">`translateY(-<span class=\"code-subst\">${offset}</span>%)`</span>;\n","      }\n","    } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","      wrapper.classList.add(<span class=\"code-keyword\">this</span>.config.classNames.videoFixedRatio);\n","    }\n","    <span class=\"code-keyword\">return</span> {\n","      padding,\n","      ratio\n","    };\n","  }\n","\n","  <span class=\"code-comment\">// Round an aspect ratio to closest standard ratio</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">roundAspectRatio</span>(<span class=\"code-params\">x, y, tolerance = <span class=\"code-number\">0.05</span></span>) </span>{\n","    <span class=\"code-keyword\">const</span> ratio = x / y;\n","    <span class=\"code-keyword\">const</span> closestRatio = closest(<span class=\"code-built_in\">Object</span>.keys(standardRatios), ratio);\n","\n","    <span class=\"code-comment\">// Check match is within tolerance</span>\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Math</span>.abs(closestRatio - ratio) &lt;= tolerance) {\n","      <span class=\"code-keyword\">return</span> standardRatios[closestRatio];\n","    }\n","\n","    <span class=\"code-comment\">// No match</span>\n","    <span class=\"code-keyword\">return</span> [x, y];\n","  }\n","\n","  <span class=\"code-comment\">// Get the size of the viewport</span>\n","  <span class=\"code-comment\">// https://stackoverflow.com/questions/1248081/how-to-get-the-browser-viewport-dimensions</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getViewportSize</span>(<span class=\"code-params\"></span>) </span>{\n","    <span class=\"code-keyword\">const</span> width = <span class=\"code-built_in\">Math</span>.max(<span class=\"code-built_in\">document</span>.documentElement.clientWidth || <span class=\"code-number\">0</span>, <span class=\"code-built_in\">window</span>.innerWidth || <span class=\"code-number\">0</span>);\n","    <span class=\"code-keyword\">const</span> height = <span class=\"code-built_in\">Math</span>.max(<span class=\"code-built_in\">document</span>.documentElement.clientHeight || <span class=\"code-number\">0</span>, <span class=\"code-built_in\">window</span>.innerHeight || <span class=\"code-number\">0</span>);\n","    <span class=\"code-keyword\">return</span> [width, height];\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-keyword\">const</span> html5 = {\n","    getSources() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">return</span> [];\n","      }\n","      <span class=\"code-keyword\">const</span> sources = <span class=\"code-built_in\">Array</span>.from(<span class=\"code-keyword\">this</span>.media.querySelectorAll(<span class=\"code-string\">'source'</span>));\n","\n","      <span class=\"code-comment\">// Filter out unsupported sources (if type is specified)</span>\n","      <span class=\"code-keyword\">return</span> sources.filter(<span class=\"code-function\"><span class=\"code-params\">source</span> =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> type = source.getAttribute(<span class=\"code-string\">'type'</span>);\n","        <span class=\"code-keyword\">if</span> (is.empty(type)) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","        }\n","        <span class=\"code-keyword\">return</span> support.mime.call(<span class=\"code-keyword\">this</span>, type);\n","      });\n","    },\n","    <span class=\"code-comment\">// Get quality levels</span>\n","    getQualityOptions() {\n","      <span class=\"code-comment\">// Whether we're forcing all options (e.g. for streaming)</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.quality.forced) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.config.quality.options;\n","      }\n","\n","      <span class=\"code-comment\">// Get sizes from &lt;source&gt; elements</span>\n","      <span class=\"code-keyword\">return</span> html5.getSources.call(<span class=\"code-keyword\">this</span>).map(<span class=\"code-function\"><span class=\"code-params\">source</span> =&gt;</span> <span class=\"code-built_in\">Number</span>(source.getAttribute(<span class=\"code-string\">'size'</span>))).filter(<span class=\"code-built_in\">Boolean</span>);\n","    },\n","    setup() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> player = <span class=\"code-keyword\">this</span>;\n","\n","      <span class=\"code-comment\">// Set speed options from config</span>\n","      player.options.speed = player.config.speed.options;\n","\n","      <span class=\"code-comment\">// Set aspect ratio if fixed</span>\n","      <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.config.ratio)) {\n","        setAspectRatio.call(player);\n","      }\n","\n","      <span class=\"code-comment\">// Quality</span>\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'quality'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-comment\">// Get sources</span>\n","          <span class=\"code-keyword\">const</span> sources = html5.getSources.call(player);\n","          <span class=\"code-keyword\">const</span> source = sources.find(<span class=\"code-function\"><span class=\"code-params\">s</span> =&gt;</span> s.getAttribute(<span class=\"code-string\">'src'</span>) === player.source);\n","\n","          <span class=\"code-comment\">// Return size, if match is found</span>\n","          <span class=\"code-keyword\">return</span> source &amp;&amp; <span class=\"code-built_in\">Number</span>(source.getAttribute(<span class=\"code-string\">'size'</span>));\n","        },\n","        <span class=\"code-keyword\">set</span>(input) {\n","          <span class=\"code-keyword\">if</span> (player.quality === input) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// If we're using an external handler...</span>\n","          <span class=\"code-keyword\">if</span> (player.config.quality.forced &amp;&amp; is.function(player.config.quality.onChange)) {\n","            player.config.quality.onChange(input);\n","          } <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-comment\">// Get sources</span>\n","            <span class=\"code-keyword\">const</span> sources = html5.getSources.call(player);\n","            <span class=\"code-comment\">// Get first match for requested size</span>\n","            <span class=\"code-keyword\">const</span> source = sources.find(<span class=\"code-function\"><span class=\"code-params\">s</span> =&gt;</span> <span class=\"code-built_in\">Number</span>(s.getAttribute(<span class=\"code-string\">'size'</span>)) === input);\n","\n","            <span class=\"code-comment\">// No matching source found</span>\n","            <span class=\"code-keyword\">if</span> (!source) {\n","              <span class=\"code-keyword\">return</span>;\n","            }\n","\n","            <span class=\"code-comment\">// Get current state</span>\n","            <span class=\"code-keyword\">const</span> {\n","              currentTime,\n","              paused,\n","              preload,\n","              readyState,\n","              playbackRate\n","            } = player.media;\n","\n","            <span class=\"code-comment\">// Set new source</span>\n","            player.media.src = source.getAttribute(<span class=\"code-string\">'src'</span>);\n","\n","            <span class=\"code-comment\">// Prevent loading if preload=\"none\" and the current source isn't loaded (#1044)</span>\n","            <span class=\"code-keyword\">if</span> (preload !== <span class=\"code-string\">'none'</span> || readyState) {\n","              <span class=\"code-comment\">// Restore time</span>\n","              player.once(<span class=\"code-string\">'loadedmetadata'</span>, () =&gt; {\n","                player.speed = playbackRate;\n","                player.currentTime = currentTime;\n","\n","                <span class=\"code-comment\">// Resume playing</span>\n","                <span class=\"code-keyword\">if</span> (!paused) {\n","                  silencePromise(player.play());\n","                }\n","              });\n","\n","              <span class=\"code-comment\">// Load new source</span>\n","              player.media.load();\n","            }\n","          }\n","\n","          <span class=\"code-comment\">// Trigger change event</span>\n","          triggerEvent.call(player, player.media, <span class=\"code-string\">'qualitychange'</span>, <span class=\"code-literal\">false</span>, {\n","            quality: input\n","          });\n","        }\n","      });\n","    },\n","    <span class=\"code-comment\">// Cancel current network requests</span>\n","    <span class=\"code-comment\">// See https://github.com/sampotts/plyr/issues/174</span>\n","    cancelRequests() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Remove child sources</span>\n","      removeElement(html5.getSources.call(<span class=\"code-keyword\">this</span>));\n","\n","      <span class=\"code-comment\">// Set blank video src attribute</span>\n","      <span class=\"code-comment\">// This is to prevent a MEDIA_ERR_SRC_NOT_SUPPORTED error</span>\n","      <span class=\"code-comment\">// Info: http://stackoverflow.com/questions/32231579/how-to-properly-dispose-of-an-html5-video-and-close-socket-or-connection</span>\n","      <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'src'</span>, <span class=\"code-keyword\">this</span>.config.blankVideo);\n","\n","      <span class=\"code-comment\">// Load the new empty source</span>\n","      <span class=\"code-comment\">// This will cancel existing requests</span>\n","      <span class=\"code-comment\">// See https://github.com/sampotts/plyr/issues/174</span>\n","      <span class=\"code-keyword\">this</span>.media.load();\n","\n","      <span class=\"code-comment\">// Debugging</span>\n","      <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">'Cancelled network requests'</span>);\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Generate a random ID</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">generateId</span>(<span class=\"code-params\">prefix</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-string\">`<span class=\"code-subst\">${prefix}</span>-<span class=\"code-subst\">${<span class=\"code-built_in\">Math</span>.floor(<span class=\"code-built_in\">Math</span>.random() * <span class=\"code-number\">10000</span>)}</span>`</span>;\n","  }\n","\n","  <span class=\"code-comment\">// Format string</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">format</span>(<span class=\"code-params\">input, ...args</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.empty(input)) <span class=\"code-keyword\">return</span> input;\n","    <span class=\"code-keyword\">return</span> input.toString().replace(<span class=\"code-regexp\">/{(\\d+)}/g</span>, (_, i) =&gt; args[i].toString());\n","  }\n","\n","  <span class=\"code-comment\">// Get percentage</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getPercentage</span>(<span class=\"code-params\">current, max</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (current === <span class=\"code-number\">0</span> || max === <span class=\"code-number\">0</span> || <span class=\"code-built_in\">Number</span>.isNaN(current) || <span class=\"code-built_in\">Number</span>.isNaN(max)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-number\">0</span>;\n","    }\n","    <span class=\"code-keyword\">return</span> (current / max * <span class=\"code-number\">100</span>).toFixed(<span class=\"code-number\">2</span>);\n","  }\n","\n","  <span class=\"code-comment\">// Replace all occurrences of a string in a string</span>\n","  <span class=\"code-keyword\">const</span> replaceAll = <span class=\"code-function\">(<span class=\"code-params\">input = <span class=\"code-string\">''</span>, find = <span class=\"code-string\">''</span>, replace = <span class=\"code-string\">''</span></span>) =&gt;</span> input.replace(<span class=\"code-keyword\">new</span> <span class=\"code-built_in\">RegExp</span>(find.toString().replace(<span class=\"code-regexp\">/([.*+?^=!:${}()|[\\]/\\\\])/g</span>, <span class=\"code-string\">'\\\\$1'</span>), <span class=\"code-string\">'g'</span>), replace.toString());\n","\n","  <span class=\"code-comment\">// Convert to title case</span>\n","  <span class=\"code-keyword\">const</span> toTitleCase = <span class=\"code-function\">(<span class=\"code-params\">input = <span class=\"code-string\">''</span></span>) =&gt;</span> input.toString().replace(<span class=\"code-regexp\">/\\w\\S*/g</span>, text =&gt; text.charAt(<span class=\"code-number\">0</span>).toUpperCase() + text.slice(<span class=\"code-number\">1</span>).toLowerCase());\n","\n","  <span class=\"code-comment\">// Convert string to pascalCase</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">toPascalCase</span>(<span class=\"code-params\">input = <span class=\"code-string\">''</span></span>) </span>{\n","    <span class=\"code-keyword\">let</span> string = input.toString();\n","\n","    <span class=\"code-comment\">// Convert kebab case</span>\n","    string = replaceAll(string, <span class=\"code-string\">'-'</span>, <span class=\"code-string\">' '</span>);\n","\n","    <span class=\"code-comment\">// Convert snake case</span>\n","    string = replaceAll(string, <span class=\"code-string\">'_'</span>, <span class=\"code-string\">' '</span>);\n","\n","    <span class=\"code-comment\">// Convert to title case</span>\n","    string = toTitleCase(string);\n","\n","    <span class=\"code-comment\">// Convert to pascal case</span>\n","    <span class=\"code-keyword\">return</span> replaceAll(string, <span class=\"code-string\">' '</span>, <span class=\"code-string\">''</span>);\n","  }\n","\n","  <span class=\"code-comment\">// Convert string to pascalCase</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">toCamelCase</span>(<span class=\"code-params\">input = <span class=\"code-string\">''</span></span>) </span>{\n","    <span class=\"code-keyword\">let</span> string = input.toString();\n","\n","    <span class=\"code-comment\">// Convert to pascal case</span>\n","    string = toPascalCase(string);\n","\n","    <span class=\"code-comment\">// Convert first character to lowercase</span>\n","    <span class=\"code-keyword\">return</span> string.charAt(<span class=\"code-number\">0</span>).toLowerCase() + string.slice(<span class=\"code-number\">1</span>);\n","  }\n","\n","  <span class=\"code-comment\">// Remove HTML from a string</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">stripHTML</span>(<span class=\"code-params\">source</span>) </span>{\n","    <span class=\"code-keyword\">const</span> fragment = <span class=\"code-built_in\">document</span>.createDocumentFragment();\n","    <span class=\"code-keyword\">const</span> element = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'div'</span>);\n","    fragment.appendChild(element);\n","    element.innerHTML = source;\n","    <span class=\"code-keyword\">return</span> fragment.firstChild.innerText;\n","  }\n","\n","  <span class=\"code-comment\">// Like outerHTML, but also works for DocumentFragment</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getHTML</span>(<span class=\"code-params\">element</span>) </span>{\n","    <span class=\"code-keyword\">const</span> wrapper = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'div'</span>);\n","    wrapper.appendChild(element);\n","    <span class=\"code-keyword\">return</span> wrapper.innerHTML;\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Skip i18n for abbreviations and brand names</span>\n","  <span class=\"code-keyword\">const</span> resources = {\n","    pip: <span class=\"code-string\">'PIP'</span>,\n","    airplay: <span class=\"code-string\">'AirPlay'</span>,\n","    html5: <span class=\"code-string\">'HTML5'</span>,\n","    vimeo: <span class=\"code-string\">'Vimeo'</span>,\n","    youtube: <span class=\"code-string\">'YouTube'</span>\n","  };\n","  <span class=\"code-keyword\">const</span> i18n = {\n","    <span class=\"code-keyword\">get</span>(key = '', config = {}) {\n","      <span class=\"code-keyword\">if</span> (is.empty(key) || is.empty(config)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-string\">''</span>;\n","      }\n","      <span class=\"code-keyword\">let</span> string = getDeep(config.i18n, key);\n","      <span class=\"code-keyword\">if</span> (is.empty(string)) {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(resources).includes(key)) {\n","          <span class=\"code-keyword\">return</span> resources[key];\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-string\">''</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> replace = {\n","        <span class=\"code-string\">'{seektime}'</span>: config.seekTime,\n","        <span class=\"code-string\">'{title}'</span>: config.title\n","      };\n","      <span class=\"code-built_in\">Object</span>.entries(replace).forEach(<span class=\"code-function\">(<span class=\"code-params\">[k, v]</span>) =&gt;</span> {\n","        string = replaceAll(string, k, v);\n","      });\n","      <span class=\"code-keyword\">return</span> string;\n","    }\n","  };\n","\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Storage</span> </span>{\n","    <span class=\"code-keyword\">constructor</span>(player) {\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"get\"</span>, key =&gt; {\n","        <span class=\"code-keyword\">if</span> (!Storage.supported || !<span class=\"code-keyword\">this</span>.enabled) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> store = <span class=\"code-built_in\">window</span>.localStorage.getItem(<span class=\"code-keyword\">this</span>.key);\n","        <span class=\"code-keyword\">if</span> (is.empty(store)) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> json = <span class=\"code-built_in\">JSON</span>.parse(store);\n","        <span class=\"code-keyword\">return</span> is.string(key) &amp;&amp; key.length ? json[key] : json;\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"set\"</span>, object =&gt; {\n","        <span class=\"code-comment\">// Bail if we don't have localStorage support or it's disabled</span>\n","        <span class=\"code-keyword\">if</span> (!Storage.supported || !<span class=\"code-keyword\">this</span>.enabled) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Can only store objectst</span>\n","        <span class=\"code-keyword\">if</span> (!is.object(object)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Get current storage</span>\n","        <span class=\"code-keyword\">let</span> storage = <span class=\"code-keyword\">this</span>.get();\n","\n","        <span class=\"code-comment\">// Default to empty object</span>\n","        <span class=\"code-keyword\">if</span> (is.empty(storage)) {\n","          storage = {};\n","        }\n","\n","        <span class=\"code-comment\">// Update the working copy of the values</span>\n","        extend(storage, object);\n","\n","        <span class=\"code-comment\">// Update storage</span>\n","        <span class=\"code-keyword\">try</span> {\n","          <span class=\"code-built_in\">window</span>.localStorage.setItem(<span class=\"code-keyword\">this</span>.key, <span class=\"code-built_in\">JSON</span>.stringify(storage));\n","        } <span class=\"code-keyword\">catch</span> (_) {\n","          <span class=\"code-comment\">// Do nothing</span>\n","        }\n","      });\n","      <span class=\"code-keyword\">this</span>.enabled = player.config.storage.enabled;\n","      <span class=\"code-keyword\">this</span>.key = player.config.storage.key;\n","    }\n","\n","    <span class=\"code-comment\">// Check for actual support (see if we can use it)</span>\n","    <span class=\"code-keyword\">static</span> <span class=\"code-keyword\">get</span> supported() {\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-keyword\">if</span> (!(<span class=\"code-string\">'localStorage'</span> <span class=\"code-keyword\">in</span> <span class=\"code-built_in\">window</span>)) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> test = <span class=\"code-string\">'___test'</span>;\n","\n","        <span class=\"code-comment\">// Try to use it (it might be disabled, e.g. user is in private mode)</span>\n","        <span class=\"code-comment\">// see: https://github.com/sampotts/plyr/issues/131</span>\n","        <span class=\"code-built_in\">window</span>.localStorage.setItem(test, test);\n","        <span class=\"code-built_in\">window</span>.localStorage.removeItem(test);\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      } <span class=\"code-keyword\">catch</span> (_) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Fetch wrapper</span>\n","  <span class=\"code-comment\">// Using XHR to avoid issues with older browsers</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">fetch</span>(<span class=\"code-params\">url, responseType = <span class=\"code-string\">'text'</span></span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\">(<span class=\"code-params\">resolve, reject</span>) =&gt;</span> {\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-keyword\">const</span> request = <span class=\"code-keyword\">new</span> XMLHttpRequest();\n","\n","        <span class=\"code-comment\">// Check for CORS support</span>\n","        <span class=\"code-keyword\">if</span> (!(<span class=\"code-string\">'withCredentials'</span> <span class=\"code-keyword\">in</span> request)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        request.addEventListener(<span class=\"code-string\">'load'</span>, () =&gt; {\n","          <span class=\"code-keyword\">if</span> (responseType === <span class=\"code-string\">'text'</span>) {\n","            <span class=\"code-keyword\">try</span> {\n","              resolve(<span class=\"code-built_in\">JSON</span>.parse(request.responseText));\n","            } <span class=\"code-keyword\">catch</span> (_) {\n","              resolve(request.responseText);\n","            }\n","          } <span class=\"code-keyword\">else</span> {\n","            resolve(request.response);\n","          }\n","        });\n","        request.addEventListener(<span class=\"code-string\">'error'</span>, () =&gt; {\n","          <span class=\"code-keyword\">throw</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Error</span>(request.status);\n","        });\n","        request.open(<span class=\"code-string\">'GET'</span>, url, <span class=\"code-literal\">true</span>);\n","\n","        <span class=\"code-comment\">// Set the required response type</span>\n","        request.responseType = responseType;\n","        request.send();\n","      } <span class=\"code-keyword\">catch</span> (error) {\n","        reject(error);\n","      }\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Load an external SVG sprite</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadSprite</span>(<span class=\"code-params\">url, id</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (!is.string(url)) {\n","      <span class=\"code-keyword\">return</span>;\n","    }\n","    <span class=\"code-keyword\">const</span> prefix = <span class=\"code-string\">'cache'</span>;\n","    <span class=\"code-keyword\">const</span> hasId = is.string(id);\n","    <span class=\"code-keyword\">let</span> isCached = <span class=\"code-literal\">false</span>;\n","    <span class=\"code-keyword\">const</span> exists = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> <span class=\"code-built_in\">document</span>.getElementById(id) !== <span class=\"code-literal\">null</span>;\n","    <span class=\"code-keyword\">const</span> update = <span class=\"code-function\">(<span class=\"code-params\">container, data</span>) =&gt;</span> {\n","      <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","      container.innerHTML = data;\n","\n","      <span class=\"code-comment\">// Check again incase of race condition</span>\n","      <span class=\"code-keyword\">if</span> (hasId &amp;&amp; exists()) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Inject the SVG to the body</span>\n","      <span class=\"code-built_in\">document</span>.body.insertAdjacentElement(<span class=\"code-string\">'afterbegin'</span>, container);\n","    };\n","\n","    <span class=\"code-comment\">// Only load once if ID set</span>\n","    <span class=\"code-keyword\">if</span> (!hasId || !exists()) {\n","      <span class=\"code-keyword\">const</span> useStorage = Storage.supported;\n","      <span class=\"code-comment\">// Create container</span>\n","      <span class=\"code-keyword\">const</span> container = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'div'</span>);\n","      container.setAttribute(<span class=\"code-string\">'hidden'</span>, <span class=\"code-string\">''</span>);\n","      <span class=\"code-keyword\">if</span> (hasId) {\n","        container.setAttribute(<span class=\"code-string\">'id'</span>, id);\n","      }\n","\n","      <span class=\"code-comment\">// Check in cache</span>\n","      <span class=\"code-keyword\">if</span> (useStorage) {\n","        <span class=\"code-keyword\">const</span> cached = <span class=\"code-built_in\">window</span>.localStorage.getItem(<span class=\"code-string\">`<span class=\"code-subst\">${prefix}</span>-<span class=\"code-subst\">${id}</span>`</span>);\n","        isCached = cached !== <span class=\"code-literal\">null</span>;\n","        <span class=\"code-keyword\">if</span> (isCached) {\n","          <span class=\"code-keyword\">const</span> data = <span class=\"code-built_in\">JSON</span>.parse(cached);\n","          update(container, data.content);\n","        }\n","      }\n","\n","      <span class=\"code-comment\">// Get the sprite</span>\n","      fetch(url).then(<span class=\"code-function\"><span class=\"code-params\">result</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (is.empty(result)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        <span class=\"code-keyword\">if</span> (useStorage) {\n","          <span class=\"code-keyword\">try</span> {\n","            <span class=\"code-built_in\">window</span>.localStorage.setItem(<span class=\"code-string\">`<span class=\"code-subst\">${prefix}</span>-<span class=\"code-subst\">${id}</span>`</span>, <span class=\"code-built_in\">JSON</span>.stringify({\n","              content: result\n","            }));\n","          } <span class=\"code-keyword\">catch</span> (_) {\n","            <span class=\"code-comment\">// Do nothing</span>\n","          }\n","        }\n","        update(container, result);\n","      }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Time helpers</span>\n","  <span class=\"code-keyword\">const</span> getHours = <span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> <span class=\"code-built_in\">Math</span>.trunc(value / <span class=\"code-number\">60</span> / <span class=\"code-number\">60</span> % <span class=\"code-number\">60</span>, <span class=\"code-number\">10</span>);\n","  <span class=\"code-keyword\">const</span> getMinutes = <span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> <span class=\"code-built_in\">Math</span>.trunc(value / <span class=\"code-number\">60</span> % <span class=\"code-number\">60</span>, <span class=\"code-number\">10</span>);\n","  <span class=\"code-keyword\">const</span> getSeconds = <span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> <span class=\"code-built_in\">Math</span>.trunc(value % <span class=\"code-number\">60</span>, <span class=\"code-number\">10</span>);\n","\n","  <span class=\"code-comment\">// Format time to UI friendly string</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">formatTime</span>(<span class=\"code-params\">time = <span class=\"code-number\">0</span>, displayHours = false, inverted = false</span>) </span>{\n","    <span class=\"code-comment\">// Bail if the value isn't a number</span>\n","    <span class=\"code-keyword\">if</span> (!is.number(time)) {\n","      <span class=\"code-keyword\">return</span> formatTime(<span class=\"code-literal\">undefined</span>, displayHours, inverted);\n","    }\n","\n","    <span class=\"code-comment\">// Format time component to add leading zero</span>\n","    <span class=\"code-keyword\">const</span> format = <span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> <span class=\"code-string\">`0<span class=\"code-subst\">${value}</span>`</span>.slice(<span class=\"code-number\">-2</span>);\n","    <span class=\"code-comment\">// Breakdown to hours, mins, secs</span>\n","    <span class=\"code-keyword\">let</span> hours = getHours(time);\n","    <span class=\"code-keyword\">const</span> mins = getMinutes(time);\n","    <span class=\"code-keyword\">const</span> secs = getSeconds(time);\n","\n","    <span class=\"code-comment\">// Do we need to display hours?</span>\n","    <span class=\"code-keyword\">if</span> (displayHours || hours &gt; <span class=\"code-number\">0</span>) {\n","      hours = <span class=\"code-string\">`<span class=\"code-subst\">${hours}</span>:`</span>;\n","    } <span class=\"code-keyword\">else</span> {\n","      hours = <span class=\"code-string\">''</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Render</span>\n","    <span class=\"code-keyword\">return</span> <span class=\"code-string\">`<span class=\"code-subst\">${inverted &amp;&amp; time &gt; <span class=\"code-number\">0</span> ? <span class=\"code-string\">'-'</span> : <span class=\"code-string\">''</span>}</span><span class=\"code-subst\">${hours}</span><span class=\"code-subst\">${format(mins)}</span>:<span class=\"code-subst\">${format(secs)}</span>`</span>;\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Don't export a massive object - break down and create class</span>\n","  <span class=\"code-keyword\">const</span> controls = {\n","    <span class=\"code-comment\">// Get icon URL</span>\n","    getIconUrl() {\n","      <span class=\"code-keyword\">const</span> url = <span class=\"code-keyword\">new</span> URL(<span class=\"code-keyword\">this</span>.config.iconUrl, <span class=\"code-built_in\">window</span>.location);\n","      <span class=\"code-keyword\">const</span> host = <span class=\"code-built_in\">window</span>.location.host ? <span class=\"code-built_in\">window</span>.location.host : <span class=\"code-built_in\">window</span>.top.location.host;\n","      <span class=\"code-keyword\">const</span> cors = url.host !== host || browser.isIE &amp;&amp; !<span class=\"code-built_in\">window</span>.svg4everybody;\n","      <span class=\"code-keyword\">return</span> {\n","        url: <span class=\"code-keyword\">this</span>.config.iconUrl,\n","        cors\n","      };\n","    },\n","    <span class=\"code-comment\">// Find the UI controls</span>\n","    findElements() {\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-keyword\">this</span>.elements.controls = getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.controls.wrapper);\n","\n","        <span class=\"code-comment\">// Buttons</span>\n","        <span class=\"code-keyword\">this</span>.elements.buttons = {\n","          play: getElements.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.play),\n","          pause: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.pause),\n","          restart: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.restart),\n","          rewind: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.rewind),\n","          fastForward: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.fastForward),\n","          mute: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.mute),\n","          pip: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.pip),\n","          airplay: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.airplay),\n","          settings: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.settings),\n","          captions: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.captions),\n","          fullscreen: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.buttons.fullscreen)\n","        };\n","\n","        <span class=\"code-comment\">// Progress</span>\n","        <span class=\"code-keyword\">this</span>.elements.progress = getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.progress);\n","\n","        <span class=\"code-comment\">// Inputs</span>\n","        <span class=\"code-keyword\">this</span>.elements.inputs = {\n","          seek: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.inputs.seek),\n","          volume: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.inputs.volume)\n","        };\n","\n","        <span class=\"code-comment\">// Display</span>\n","        <span class=\"code-keyword\">this</span>.elements.display = {\n","          buffer: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.display.buffer),\n","          currentTime: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.display.currentTime),\n","          duration: getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.config.selectors.display.duration)\n","        };\n","\n","        <span class=\"code-comment\">// Seek tooltip</span>\n","        <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.elements.progress)) {\n","          <span class=\"code-keyword\">this</span>.elements.display.seekTooltip = <span class=\"code-keyword\">this</span>.elements.progress.querySelector(<span class=\"code-string\">`.<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.classNames.tooltip}</span>`</span>);\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      } <span class=\"code-keyword\">catch</span> (error) {\n","        <span class=\"code-comment\">// Log it</span>\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'It looks like there is a problem with your custom controls HTML'</span>, error);\n","\n","        <span class=\"code-comment\">// Restore native video controls</span>\n","        <span class=\"code-keyword\">this</span>.toggleNativeControls(<span class=\"code-literal\">true</span>);\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      }\n","    },\n","    <span class=\"code-comment\">// Create &lt;svg&gt; icon</span>\n","    createIcon(type, attributes) {\n","      <span class=\"code-keyword\">const</span> namespace = <span class=\"code-string\">'http://www.w3.org/2000/svg'</span>;\n","      <span class=\"code-keyword\">const</span> iconUrl = controls.getIconUrl.call(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">const</span> iconPath = <span class=\"code-string\">`<span class=\"code-subst\">${!iconUrl.cors ? iconUrl.url : <span class=\"code-string\">''</span>}</span>#<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.iconPrefix}</span>`</span>;\n","      <span class=\"code-comment\">// Create &lt;svg&gt;</span>\n","      <span class=\"code-keyword\">const</span> icon = <span class=\"code-built_in\">document</span>.createElementNS(namespace, <span class=\"code-string\">'svg'</span>);\n","      setAttributes(icon, extend(attributes, {\n","        <span class=\"code-string\">'aria-hidden'</span>: <span class=\"code-string\">'true'</span>,\n","        focusable: <span class=\"code-string\">'false'</span>\n","      }));\n","\n","      <span class=\"code-comment\">// Create the &lt;use&gt; to reference sprite</span>\n","      <span class=\"code-keyword\">const</span> use = <span class=\"code-built_in\">document</span>.createElementNS(namespace, <span class=\"code-string\">'use'</span>);\n","      <span class=\"code-keyword\">const</span> path = <span class=\"code-string\">`<span class=\"code-subst\">${iconPath}</span>-<span class=\"code-subst\">${type}</span>`</span>;\n","\n","      <span class=\"code-comment\">// Set `href` attributes</span>\n","      <span class=\"code-comment\">// https://github.com/sampotts/plyr/issues/460</span>\n","      <span class=\"code-comment\">// https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/xlink:href</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-string\">'href'</span> <span class=\"code-keyword\">in</span> use) {\n","        use.setAttributeNS(<span class=\"code-string\">'http://www.w3.org/1999/xlink'</span>, <span class=\"code-string\">'href'</span>, path);\n","      }\n","\n","      <span class=\"code-comment\">// Always set the older attribute even though it's \"deprecated\" (it'll be around for ages)</span>\n","      use.setAttributeNS(<span class=\"code-string\">'http://www.w3.org/1999/xlink'</span>, <span class=\"code-string\">'xlink:href'</span>, path);\n","\n","      <span class=\"code-comment\">// Add &lt;use&gt; to &lt;svg&gt;</span>\n","      icon.appendChild(use);\n","      <span class=\"code-keyword\">return</span> icon;\n","    },\n","    <span class=\"code-comment\">// Create hidden text label</span>\n","    createLabel(key, attr = {}) {\n","      <span class=\"code-keyword\">const</span> text = i18n.get(key, <span class=\"code-keyword\">this</span>.config);\n","      <span class=\"code-keyword\">const</span> attributes = {\n","        ...attr,\n","        class: [attr.class, this.config.classNames.hidden].filter(Boolean).join(' ')\n","      };\n","      <span class=\"code-keyword\">return</span> createElement(<span class=\"code-string\">'span'</span>, attributes, text);\n","    },\n","    <span class=\"code-comment\">// Create a badge</span>\n","    createBadge(text) {\n","      <span class=\"code-keyword\">if</span> (is.empty(text)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> badge = createElement(<span class=\"code-string\">'span'</span>, {\n","        class: this.config.classNames.menu.value\n","      });\n","      badge.appendChild(createElement(<span class=\"code-string\">'span'</span>, {\n","        class: this.config.classNames.menu.badge\n","      }, text));\n","      <span class=\"code-keyword\">return</span> badge;\n","    },\n","    <span class=\"code-comment\">// Create a &lt;button&gt;</span>\n","    createButton(buttonType, attr) {\n","      <span class=\"code-keyword\">const</span> attributes = extend({}, attr);\n","      <span class=\"code-keyword\">let</span> type = toCamelCase(buttonType);\n","      <span class=\"code-keyword\">const</span> props = {\n","        element: <span class=\"code-string\">'button'</span>,\n","        toggle: <span class=\"code-literal\">false</span>,\n","        label: <span class=\"code-literal\">null</span>,\n","        icon: <span class=\"code-literal\">null</span>,\n","        labelPressed: <span class=\"code-literal\">null</span>,\n","        iconPressed: <span class=\"code-literal\">null</span>\n","      };\n","      [<span class=\"code-string\">'element'</span>, <span class=\"code-string\">'icon'</span>, <span class=\"code-string\">'label'</span>].forEach(<span class=\"code-function\"><span class=\"code-params\">key</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(attributes).includes(key)) {\n","          props[key] = attributes[key];\n","          <span class=\"code-keyword\">delete</span> attributes[key];\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Default to 'button' type to prevent form submission</span>\n","      <span class=\"code-keyword\">if</span> (props.element === <span class=\"code-string\">'button'</span> &amp;&amp; !<span class=\"code-built_in\">Object</span>.keys(attributes).includes(<span class=\"code-string\">'type'</span>)) {\n","        attributes.type = <span class=\"code-string\">'button'</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set class name</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(attributes).includes(<span class=\"code-string\">'class'</span>)) {\n","        <span class=\"code-keyword\">if</span> (!attributes.class.split(<span class=\"code-string\">' '</span>).some(<span class=\"code-function\"><span class=\"code-params\">c</span> =&gt;</span> c === <span class=\"code-keyword\">this</span>.config.classNames.control)) {\n","          extend(attributes, {\n","            class: `${attributes.class} ${this.config.classNames.control}`\n","          });\n","        }\n","      } <span class=\"code-keyword\">else</span> {\n","        attributes.class = <span class=\"code-keyword\">this</span>.config.classNames.control;\n","      }\n","\n","      <span class=\"code-comment\">// Large play button</span>\n","      <span class=\"code-keyword\">switch</span> (buttonType) {\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'play'</span>:\n","          props.toggle = <span class=\"code-literal\">true</span>;\n","          props.label = <span class=\"code-string\">'play'</span>;\n","          props.labelPressed = <span class=\"code-string\">'pause'</span>;\n","          props.icon = <span class=\"code-string\">'play'</span>;\n","          props.iconPressed = <span class=\"code-string\">'pause'</span>;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'mute'</span>:\n","          props.toggle = <span class=\"code-literal\">true</span>;\n","          props.label = <span class=\"code-string\">'mute'</span>;\n","          props.labelPressed = <span class=\"code-string\">'unmute'</span>;\n","          props.icon = <span class=\"code-string\">'volume'</span>;\n","          props.iconPressed = <span class=\"code-string\">'muted'</span>;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'captions'</span>:\n","          props.toggle = <span class=\"code-literal\">true</span>;\n","          props.label = <span class=\"code-string\">'enableCaptions'</span>;\n","          props.labelPressed = <span class=\"code-string\">'disableCaptions'</span>;\n","          props.icon = <span class=\"code-string\">'captions-off'</span>;\n","          props.iconPressed = <span class=\"code-string\">'captions-on'</span>;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'fullscreen'</span>:\n","          props.toggle = <span class=\"code-literal\">true</span>;\n","          props.label = <span class=\"code-string\">'enterFullscreen'</span>;\n","          props.labelPressed = <span class=\"code-string\">'exitFullscreen'</span>;\n","          props.icon = <span class=\"code-string\">'enter-fullscreen'</span>;\n","          props.iconPressed = <span class=\"code-string\">'exit-fullscreen'</span>;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'play-large'</span>:\n","          attributes.class += <span class=\"code-string\">` <span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.classNames.control}</span>--overlaid`</span>;\n","          type = <span class=\"code-string\">'play'</span>;\n","          props.label = <span class=\"code-string\">'play'</span>;\n","          props.icon = <span class=\"code-string\">'play'</span>;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">default</span>:\n","          <span class=\"code-keyword\">if</span> (is.empty(props.label)) {\n","            props.label = type;\n","          }\n","          <span class=\"code-keyword\">if</span> (is.empty(props.icon)) {\n","            props.icon = buttonType;\n","          }\n","      }\n","      <span class=\"code-keyword\">const</span> button = createElement(props.element);\n","\n","      <span class=\"code-comment\">// Setup toggle icon and labels</span>\n","      <span class=\"code-keyword\">if</span> (props.toggle) {\n","        <span class=\"code-comment\">// Icon</span>\n","        button.appendChild(controls.createIcon.call(<span class=\"code-keyword\">this</span>, props.iconPressed, {\n","          class: 'icon--pressed'\n","        }));\n","        button.appendChild(controls.createIcon.call(<span class=\"code-keyword\">this</span>, props.icon, {\n","          class: 'icon--not-pressed'\n","        }));\n","\n","        <span class=\"code-comment\">// Label/Tooltip</span>\n","        button.appendChild(controls.createLabel.call(<span class=\"code-keyword\">this</span>, props.labelPressed, {\n","          class: 'label--pressed'\n","        }));\n","        button.appendChild(controls.createLabel.call(<span class=\"code-keyword\">this</span>, props.label, {\n","          class: 'label--not-pressed'\n","        }));\n","      } <span class=\"code-keyword\">else</span> {\n","        button.appendChild(controls.createIcon.call(<span class=\"code-keyword\">this</span>, props.icon));\n","        button.appendChild(controls.createLabel.call(<span class=\"code-keyword\">this</span>, props.label));\n","      }\n","\n","      <span class=\"code-comment\">// Merge and set attributes</span>\n","      extend(attributes, getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.buttons[type], attributes));\n","      setAttributes(button, attributes);\n","\n","      <span class=\"code-comment\">// We have multiple play buttons</span>\n","      <span class=\"code-keyword\">if</span> (type === <span class=\"code-string\">'play'</span>) {\n","        <span class=\"code-keyword\">if</span> (!is.array(<span class=\"code-keyword\">this</span>.elements.buttons[type])) {\n","          <span class=\"code-keyword\">this</span>.elements.buttons[type] = [];\n","        }\n","        <span class=\"code-keyword\">this</span>.elements.buttons[type].push(button);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">this</span>.elements.buttons[type] = button;\n","      }\n","      <span class=\"code-keyword\">return</span> button;\n","    },\n","    <span class=\"code-comment\">// Create an &lt;input type='range'&gt;</span>\n","    createRange(type, attributes) {\n","      <span class=\"code-comment\">// Seek input</span>\n","      <span class=\"code-keyword\">const</span> input = createElement(<span class=\"code-string\">'input'</span>, extend(getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.inputs[type]), {\n","        type: <span class=\"code-string\">'range'</span>,\n","        min: <span class=\"code-number\">0</span>,\n","        max: <span class=\"code-number\">100</span>,\n","        step: <span class=\"code-number\">0.01</span>,\n","        value: <span class=\"code-number\">0</span>,\n","        autocomplete: <span class=\"code-string\">'off'</span>,\n","        <span class=\"code-comment\">// A11y fixes for https://github.com/sampotts/plyr/issues/905</span>\n","        role: <span class=\"code-string\">'slider'</span>,\n","        <span class=\"code-string\">'aria-label'</span>: i18n.get(type, <span class=\"code-keyword\">this</span>.config),\n","        <span class=\"code-string\">'aria-valuemin'</span>: <span class=\"code-number\">0</span>,\n","        <span class=\"code-string\">'aria-valuemax'</span>: <span class=\"code-number\">100</span>,\n","        <span class=\"code-string\">'aria-valuenow'</span>: <span class=\"code-number\">0</span>\n","      }, attributes));\n","      <span class=\"code-keyword\">this</span>.elements.inputs[type] = input;\n","\n","      <span class=\"code-comment\">// Set the fill for webkit now</span>\n","      controls.updateRangeFill.call(<span class=\"code-keyword\">this</span>, input);\n","\n","      <span class=\"code-comment\">// Improve support on touch devices</span>\n","      RangeTouch.setup(input);\n","      <span class=\"code-keyword\">return</span> input;\n","    },\n","    <span class=\"code-comment\">// Create a &lt;progress&gt;</span>\n","    createProgress(type, attributes) {\n","      <span class=\"code-keyword\">const</span> progress = createElement(<span class=\"code-string\">'progress'</span>, extend(getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.display[type]), {\n","        min: <span class=\"code-number\">0</span>,\n","        max: <span class=\"code-number\">100</span>,\n","        value: <span class=\"code-number\">0</span>,\n","        role: <span class=\"code-string\">'progressbar'</span>,\n","        <span class=\"code-string\">'aria-hidden'</span>: <span class=\"code-literal\">true</span>\n","      }, attributes));\n","\n","      <span class=\"code-comment\">// Create the label inside</span>\n","      <span class=\"code-keyword\">if</span> (type !== <span class=\"code-string\">'volume'</span>) {\n","        progress.appendChild(createElement(<span class=\"code-string\">'span'</span>, <span class=\"code-literal\">null</span>, <span class=\"code-string\">'0'</span>));\n","        <span class=\"code-keyword\">const</span> suffixKey = {\n","          played: <span class=\"code-string\">'played'</span>,\n","          buffer: <span class=\"code-string\">'buffered'</span>\n","        }[type];\n","        <span class=\"code-keyword\">const</span> suffix = suffixKey ? i18n.get(suffixKey, <span class=\"code-keyword\">this</span>.config) : <span class=\"code-string\">''</span>;\n","        progress.innerText = <span class=\"code-string\">`% <span class=\"code-subst\">${suffix.toLowerCase()}</span>`</span>;\n","      }\n","      <span class=\"code-keyword\">this</span>.elements.display[type] = progress;\n","      <span class=\"code-keyword\">return</span> progress;\n","    },\n","    <span class=\"code-comment\">// Create time display</span>\n","    createTime(type, attrs) {\n","      <span class=\"code-keyword\">const</span> attributes = getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.display[type], attrs);\n","      <span class=\"code-keyword\">const</span> container = createElement(<span class=\"code-string\">'div'</span>, extend(attributes, {\n","        class: `${attributes.class ? attributes.class : ''} ${this.config.classNames.display.time} `.trim(),\n","        <span class=\"code-string\">'aria-label'</span>: i18n.get(type, <span class=\"code-keyword\">this</span>.config),\n","        role: <span class=\"code-string\">'timer'</span>\n","      }), <span class=\"code-string\">'00:00'</span>);\n","\n","      <span class=\"code-comment\">// Reference for updates</span>\n","      <span class=\"code-keyword\">this</span>.elements.display[type] = container;\n","      <span class=\"code-keyword\">return</span> container;\n","    },\n","    <span class=\"code-comment\">// Bind keyboard shortcuts for a menu item</span>\n","    <span class=\"code-comment\">// We have to bind to keyup otherwise Firefox triggers a click when a keydown event handler shifts focus</span>\n","    <span class=\"code-comment\">// https://bugzilla.mozilla.org/show_bug.cgi?id=1220143</span>\n","    bindMenuItemShortcuts(menuItem, type) {\n","      <span class=\"code-comment\">// Navigate through menus via arrow keys and space</span>\n","      on.call(<span class=\"code-keyword\">this</span>, menuItem, <span class=\"code-string\">'keydown keyup'</span>, event =&gt; {\n","        <span class=\"code-comment\">// We only care about space and \u2B06\uFE0F \u2B07\uFE0F\uFE0F \u27A1\uFE0F</span>\n","        <span class=\"code-keyword\">if</span> (![<span class=\"code-string\">' '</span>, <span class=\"code-string\">'ArrowUp'</span>, <span class=\"code-string\">'ArrowDown'</span>, <span class=\"code-string\">'ArrowRight'</span>].includes(event.key)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Prevent play / seek</span>\n","        event.preventDefault();\n","        event.stopPropagation();\n","\n","        <span class=\"code-comment\">// We're just here to prevent the keydown bubbling</span>\n","        <span class=\"code-keyword\">if</span> (event.type === <span class=\"code-string\">'keydown'</span>) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> isRadioButton = matches(menuItem, <span class=\"code-string\">'[role=\"menuitemradio\"]'</span>);\n","\n","        <span class=\"code-comment\">// Show the respective menu</span>\n","        <span class=\"code-keyword\">if</span> (!isRadioButton &amp;&amp; [<span class=\"code-string\">' '</span>, <span class=\"code-string\">'ArrowRight'</span>].includes(event.key)) {\n","          controls.showMenuPanel.call(<span class=\"code-keyword\">this</span>, type, <span class=\"code-literal\">true</span>);\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-keyword\">let</span> target;\n","          <span class=\"code-keyword\">if</span> (event.key !== <span class=\"code-string\">' '</span>) {\n","            <span class=\"code-keyword\">if</span> (event.key === <span class=\"code-string\">'ArrowDown'</span> || isRadioButton &amp;&amp; event.key === <span class=\"code-string\">'ArrowRight'</span>) {\n","              target = menuItem.nextElementSibling;\n","              <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","                target = menuItem.parentNode.firstElementChild;\n","              }\n","            } <span class=\"code-keyword\">else</span> {\n","              target = menuItem.previousElementSibling;\n","              <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","                target = menuItem.parentNode.lastElementChild;\n","              }\n","            }\n","            setFocus.call(<span class=\"code-keyword\">this</span>, target, <span class=\"code-literal\">true</span>);\n","          }\n","        }\n","      }, <span class=\"code-literal\">false</span>);\n","\n","      <span class=\"code-comment\">// Enter will fire a `click` event but we still need to manage focus</span>\n","      <span class=\"code-comment\">// So we bind to keyup which fires after and set focus here</span>\n","      on.call(<span class=\"code-keyword\">this</span>, menuItem, <span class=\"code-string\">'keyup'</span>, event =&gt; {\n","        <span class=\"code-keyword\">if</span> (event.key !== <span class=\"code-string\">'Return'</span>) <span class=\"code-keyword\">return</span>;\n","        controls.focusFirstMenuItem.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">null</span>, <span class=\"code-literal\">true</span>);\n","      });\n","    },\n","    <span class=\"code-comment\">// Create a settings menu item</span>\n","    createMenuItem({\n","      value,\n","      list,\n","      type,\n","      title,\n","      badge = <span class=\"code-literal\">null</span>,\n","      checked = <span class=\"code-literal\">false</span>\n","    }) {\n","      <span class=\"code-keyword\">const</span> attributes = getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.inputs[type]);\n","      <span class=\"code-keyword\">const</span> menuItem = createElement(<span class=\"code-string\">'button'</span>, extend(attributes, {\n","        type: <span class=\"code-string\">'button'</span>,\n","        role: <span class=\"code-string\">'menuitemradio'</span>,\n","        class: `${this.config.classNames.control} ${attributes.class ? attributes.class : ''}`.trim(),\n","        <span class=\"code-string\">'aria-checked'</span>: checked,\n","        value\n","      }));\n","      <span class=\"code-keyword\">const</span> flex = createElement(<span class=\"code-string\">'span'</span>);\n","\n","      <span class=\"code-comment\">// We have to set as HTML incase of special characters</span>\n","      flex.innerHTML = title;\n","      <span class=\"code-keyword\">if</span> (is.element(badge)) {\n","        flex.appendChild(badge);\n","      }\n","      menuItem.appendChild(flex);\n","\n","      <span class=\"code-comment\">// Replicate radio button behavior</span>\n","      <span class=\"code-built_in\">Object</span>.defineProperty(menuItem, <span class=\"code-string\">'checked'</span>, {\n","        enumerable: <span class=\"code-literal\">true</span>,\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> menuItem.getAttribute(<span class=\"code-string\">'aria-checked'</span>) === <span class=\"code-string\">'true'</span>;\n","        },\n","        <span class=\"code-keyword\">set</span>(check) {\n","          <span class=\"code-comment\">// Ensure exclusivity</span>\n","          <span class=\"code-keyword\">if</span> (check) {\n","            <span class=\"code-built_in\">Array</span>.from(menuItem.parentNode.children).filter(<span class=\"code-function\"><span class=\"code-params\">node</span> =&gt;</span> matches(node, <span class=\"code-string\">'[role=\"menuitemradio\"]'</span>)).forEach(<span class=\"code-function\"><span class=\"code-params\">node</span> =&gt;</span> node.setAttribute(<span class=\"code-string\">'aria-checked'</span>, <span class=\"code-string\">'false'</span>));\n","          }\n","          menuItem.setAttribute(<span class=\"code-string\">'aria-checked'</span>, check ? <span class=\"code-string\">'true'</span> : <span class=\"code-string\">'false'</span>);\n","        }\n","      });\n","      <span class=\"code-keyword\">this</span>.listeners.bind(menuItem, <span class=\"code-string\">'click keyup'</span>, event =&gt; {\n","        <span class=\"code-keyword\">if</span> (is.keyboardEvent(event) &amp;&amp; event.key !== <span class=\"code-string\">' '</span>) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        event.preventDefault();\n","        event.stopPropagation();\n","        menuItem.checked = <span class=\"code-literal\">true</span>;\n","        <span class=\"code-keyword\">switch</span> (type) {\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'language'</span>:\n","            <span class=\"code-keyword\">this</span>.currentTrack = <span class=\"code-built_in\">Number</span>(value);\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'quality'</span>:\n","            <span class=\"code-keyword\">this</span>.quality = value;\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'speed'</span>:\n","            <span class=\"code-keyword\">this</span>.speed = <span class=\"code-built_in\">parseFloat</span>(value);\n","            <span class=\"code-keyword\">break</span>;\n","        }\n","        controls.showMenuPanel.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'home'</span>, is.keyboardEvent(event));\n","      }, type, <span class=\"code-literal\">false</span>);\n","      controls.bindMenuItemShortcuts.call(<span class=\"code-keyword\">this</span>, menuItem, type);\n","      list.appendChild(menuItem);\n","    },\n","    <span class=\"code-comment\">// Format a time for display</span>\n","    formatTime(time = <span class=\"code-number\">0</span>, inverted = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-comment\">// Bail if the value isn't a number</span>\n","      <span class=\"code-keyword\">if</span> (!is.number(time)) {\n","        <span class=\"code-keyword\">return</span> time;\n","      }\n","\n","      <span class=\"code-comment\">// Always display hours if duration is over an hour</span>\n","      <span class=\"code-keyword\">const</span> forceHours = getHours(<span class=\"code-keyword\">this</span>.duration) &gt; <span class=\"code-number\">0</span>;\n","      <span class=\"code-keyword\">return</span> formatTime(time, forceHours, inverted);\n","    },\n","    <span class=\"code-comment\">// Update the displayed time</span>\n","    updateTimeDisplay(target = <span class=\"code-literal\">null</span>, time = <span class=\"code-number\">0</span>, inverted = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-comment\">// Bail if there's no element to display or the value isn't a number</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(target) || !is.number(time)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","      target.innerText = controls.formatTime(time, inverted);\n","    },\n","    <span class=\"code-comment\">// Update volume UI and storage</span>\n","    updateVolume() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Update range</span>\n","      <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.elements.inputs.volume)) {\n","        controls.setRange.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.inputs.volume, <span class=\"code-keyword\">this</span>.muted ? <span class=\"code-number\">0</span> : <span class=\"code-keyword\">this</span>.volume);\n","      }\n","\n","      <span class=\"code-comment\">// Update mute state</span>\n","      <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.elements.buttons.mute)) {\n","        <span class=\"code-keyword\">this</span>.elements.buttons.mute.pressed = <span class=\"code-keyword\">this</span>.muted || <span class=\"code-keyword\">this</span>.volume === <span class=\"code-number\">0</span>;\n","      }\n","    },\n","    <span class=\"code-comment\">// Update seek value and lower fill</span>\n","    setRange(target, value = <span class=\"code-number\">0</span>) {\n","      <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// eslint-disable-next-line</span>\n","      target.value = value;\n","\n","      <span class=\"code-comment\">// Webkit range fill</span>\n","      controls.updateRangeFill.call(<span class=\"code-keyword\">this</span>, target);\n","    },\n","    <span class=\"code-comment\">// Update &lt;progress&gt; elements</span>\n","    updateProgress(event) {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui || !is.event(event)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">let</span> value = <span class=\"code-number\">0</span>;\n","      <span class=\"code-keyword\">const</span> setProgress = <span class=\"code-function\">(<span class=\"code-params\">target, input</span>) =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> val = is.number(input) ? input : <span class=\"code-number\">0</span>;\n","        <span class=\"code-keyword\">const</span> progress = is.element(target) ? target : <span class=\"code-keyword\">this</span>.elements.display.buffer;\n","\n","        <span class=\"code-comment\">// Update value and label</span>\n","        <span class=\"code-keyword\">if</span> (is.element(progress)) {\n","          progress.value = val;\n","\n","          <span class=\"code-comment\">// Update text label inside</span>\n","          <span class=\"code-keyword\">const</span> label = progress.getElementsByTagName(<span class=\"code-string\">'span'</span>)[<span class=\"code-number\">0</span>];\n","          <span class=\"code-keyword\">if</span> (is.element(label)) {\n","            label.childNodes[<span class=\"code-number\">0</span>].nodeValue = val;\n","          }\n","        }\n","      };\n","      <span class=\"code-keyword\">if</span> (event) {\n","        <span class=\"code-keyword\">switch</span> (event.type) {\n","          <span class=\"code-comment\">// Video playing</span>\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'timeupdate'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'seeking'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'seeked'</span>:\n","            value = getPercentage(<span class=\"code-keyword\">this</span>.currentTime, <span class=\"code-keyword\">this</span>.duration);\n","\n","            <span class=\"code-comment\">// Set seek range value only if it's a 'natural' time event</span>\n","            <span class=\"code-keyword\">if</span> (event.type === <span class=\"code-string\">'timeupdate'</span>) {\n","              controls.setRange.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.inputs.seek, value);\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","\n","          <span class=\"code-comment\">// Check buffer status</span>\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'playing'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'progress'</span>:\n","            setProgress(<span class=\"code-keyword\">this</span>.elements.display.buffer, <span class=\"code-keyword\">this</span>.buffered * <span class=\"code-number\">100</span>);\n","            <span class=\"code-keyword\">break</span>;\n","        }\n","      }\n","    },\n","    <span class=\"code-comment\">// Webkit polyfill for lower fill range</span>\n","    updateRangeFill(target) {\n","      <span class=\"code-comment\">// Get range from event if event passed</span>\n","      <span class=\"code-keyword\">const</span> range = is.event(target) ? target.target : target;\n","\n","      <span class=\"code-comment\">// Needs to be a valid &lt;input type='range'&gt;</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(range) || range.getAttribute(<span class=\"code-string\">'type'</span>) !== <span class=\"code-string\">'range'</span>) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set aria values for https://github.com/sampotts/plyr/issues/905</span>\n","      <span class=\"code-keyword\">if</span> (matches(range, <span class=\"code-keyword\">this</span>.config.selectors.inputs.seek)) {\n","        range.setAttribute(<span class=\"code-string\">'aria-valuenow'</span>, <span class=\"code-keyword\">this</span>.currentTime);\n","        <span class=\"code-keyword\">const</span> currentTime = controls.formatTime(<span class=\"code-keyword\">this</span>.currentTime);\n","        <span class=\"code-keyword\">const</span> duration = controls.formatTime(<span class=\"code-keyword\">this</span>.duration);\n","        <span class=\"code-keyword\">const</span> format = i18n.get(<span class=\"code-string\">'seekLabel'</span>, <span class=\"code-keyword\">this</span>.config);\n","        range.setAttribute(<span class=\"code-string\">'aria-valuetext'</span>, format.replace(<span class=\"code-string\">'{currentTime}'</span>, currentTime).replace(<span class=\"code-string\">'{duration}'</span>, duration));\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (matches(range, <span class=\"code-keyword\">this</span>.config.selectors.inputs.volume)) {\n","        <span class=\"code-keyword\">const</span> percent = range.value * <span class=\"code-number\">100</span>;\n","        range.setAttribute(<span class=\"code-string\">'aria-valuenow'</span>, percent);\n","        range.setAttribute(<span class=\"code-string\">'aria-valuetext'</span>, <span class=\"code-string\">`<span class=\"code-subst\">${percent.toFixed(<span class=\"code-number\">1</span>)}</span>%`</span>);\n","      } <span class=\"code-keyword\">else</span> {\n","        range.setAttribute(<span class=\"code-string\">'aria-valuenow'</span>, range.value);\n","      }\n","\n","      <span class=\"code-comment\">// WebKit only</span>\n","      <span class=\"code-keyword\">if</span> (!browser.isWebKit &amp;&amp; !browser.isIPadOS) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set CSS custom property</span>\n","      range.style.setProperty('--value', `${range.value / range.max * 100}%`);\n","    },\n","    <span class=\"code-comment\">// Update hover tooltip for seeking</span>\n","    updateSeekTooltip(event) {\n","      <span class=\"code-keyword\">var</span> _this$config$markers, _this$config$markers$;\n","      <span class=\"code-comment\">// Bail if setting not true</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.config.tooltips.seek || !is.element(<span class=\"code-keyword\">this</span>.elements.inputs.seek) || !is.element(<span class=\"code-keyword\">this</span>.elements.display.seekTooltip) || <span class=\"code-keyword\">this</span>.duration === <span class=\"code-number\">0</span>) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> tipElement = <span class=\"code-keyword\">this</span>.elements.display.seekTooltip;\n","      <span class=\"code-keyword\">const</span> visible = <span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.classNames.tooltip}</span>--visible`</span>;\n","      <span class=\"code-keyword\">const</span> toggle = <span class=\"code-function\"><span class=\"code-params\">show</span> =&gt;</span> toggleClass(tipElement, visible, show);\n","\n","      <span class=\"code-comment\">// Hide on touch</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.touch) {\n","        toggle(<span class=\"code-literal\">false</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Determine percentage, if already visible</span>\n","      <span class=\"code-keyword\">let</span> percent = <span class=\"code-number\">0</span>;\n","      <span class=\"code-keyword\">const</span> clientRect = <span class=\"code-keyword\">this</span>.elements.progress.getBoundingClientRect();\n","      <span class=\"code-keyword\">if</span> (is.event(event)) {\n","        percent = <span class=\"code-number\">100</span> / clientRect.width * (event.pageX - clientRect.left);\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (hasClass(tipElement, visible)) {\n","        percent = <span class=\"code-built_in\">parseFloat</span>(tipElement.style.left, <span class=\"code-number\">10</span>);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set bounds</span>\n","      <span class=\"code-keyword\">if</span> (percent &lt; <span class=\"code-number\">0</span>) {\n","        percent = <span class=\"code-number\">0</span>;\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (percent &gt; <span class=\"code-number\">100</span>) {\n","        percent = <span class=\"code-number\">100</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> time = <span class=\"code-keyword\">this</span>.duration / <span class=\"code-number\">100</span> * percent;\n","\n","      <span class=\"code-comment\">// Display the time a click would seek to</span>\n","      tipElement.innerText = controls.formatTime(time);\n","\n","      <span class=\"code-comment\">// Get marker point for time</span>\n","      <span class=\"code-keyword\">const</span> point = (_this$config$markers = <span class=\"code-keyword\">this</span>.config.markers) === <span class=\"code-literal\">null</span> || _this$config$markers === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : (_this$config$markers$ = _this$config$markers.points) === <span class=\"code-literal\">null</span> || _this$config$markers$ === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : _this$config$markers$.find(({\n","        time: t\n","      }) =&gt; t === <span class=\"code-built_in\">Math</span>.round(time));\n","\n","      <span class=\"code-comment\">// Append the point label to the tooltip</span>\n","      <span class=\"code-keyword\">if</span> (point) {\n","        tipElement.insertAdjacentHTML(<span class=\"code-string\">'afterbegin'</span>, <span class=\"code-string\">`<span class=\"code-subst\">${point.label}</span>&lt;br&gt;`</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Set position</span>\n","      tipElement.style.left = <span class=\"code-string\">`<span class=\"code-subst\">${percent}</span>%`</span>;\n","\n","      <span class=\"code-comment\">// Show/hide the tooltip</span>\n","      <span class=\"code-comment\">// If the event is a moues in/out and percentage is inside bounds</span>\n","      <span class=\"code-keyword\">if</span> (is.event(event) &amp;&amp; [<span class=\"code-string\">'mouseenter'</span>, <span class=\"code-string\">'mouseleave'</span>].includes(event.type)) {\n","        toggle(event.type === <span class=\"code-string\">'mouseenter'</span>);\n","      }\n","    },\n","    <span class=\"code-comment\">// Handle time change event</span>\n","    timeUpdate(event) {\n","      <span class=\"code-comment\">// Only invert if only one time element is displayed and used for both duration and currentTime</span>\n","      <span class=\"code-keyword\">const</span> invert = !is.element(<span class=\"code-keyword\">this</span>.elements.display.duration) &amp;&amp; <span class=\"code-keyword\">this</span>.config.invertTime;\n","\n","      <span class=\"code-comment\">// Duration</span>\n","      controls.updateTimeDisplay.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.display.currentTime, invert ? <span class=\"code-keyword\">this</span>.duration - <span class=\"code-keyword\">this</span>.currentTime : <span class=\"code-keyword\">this</span>.currentTime, invert);\n","\n","      <span class=\"code-comment\">// Ignore updates while seeking</span>\n","      <span class=\"code-keyword\">if</span> (event &amp;&amp; event.type === <span class=\"code-string\">'timeupdate'</span> &amp;&amp; <span class=\"code-keyword\">this</span>.media.seeking) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Playing progress</span>\n","      controls.updateProgress.call(<span class=\"code-keyword\">this</span>, event);\n","    },\n","    <span class=\"code-comment\">// Show the duration on metadataloaded or durationchange events</span>\n","    durationUpdate() {\n","      <span class=\"code-comment\">// Bail if no UI or durationchange event triggered after playing/seek when invertTime is false</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui || !<span class=\"code-keyword\">this</span>.config.invertTime &amp;&amp; <span class=\"code-keyword\">this</span>.currentTime) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// If duration is the 2**32 (shaka), Infinity (HLS), DASH-IF (Number.MAX_SAFE_INTEGER || Number.MAX_VALUE) indicating live we hide the currentTime and progressbar.</span>\n","      <span class=\"code-comment\">// https://github.com/video-dev/hls.js/blob/5820d29d3c4c8a46e8b75f1e3afa3e68c1a9a2db/src/controller/buffer-controller.js#L415</span>\n","      <span class=\"code-comment\">// https://github.com/google/shaka-player/blob/4d889054631f4e1cf0fbd80ddd2b71887c02e232/lib/media/streaming_engine.js#L1062</span>\n","      <span class=\"code-comment\">// https://github.com/Dash-Industry-Forum/dash.js/blob/69859f51b969645b234666800d4cb596d89c602d/src/dash/models/DashManifestModel.js#L338</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.duration &gt;= <span class=\"code-number\">2</span> ** <span class=\"code-number\">32</span>) {\n","        toggleHidden(<span class=\"code-keyword\">this</span>.elements.display.currentTime, <span class=\"code-literal\">true</span>);\n","        toggleHidden(<span class=\"code-keyword\">this</span>.elements.progress, <span class=\"code-literal\">true</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Update ARIA values</span>\n","      <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.elements.inputs.seek)) {\n","        <span class=\"code-keyword\">this</span>.elements.inputs.seek.setAttribute(<span class=\"code-string\">'aria-valuemax'</span>, <span class=\"code-keyword\">this</span>.duration);\n","      }\n","\n","      <span class=\"code-comment\">// If there's a spot to display duration</span>\n","      <span class=\"code-keyword\">const</span> hasDuration = is.element(<span class=\"code-keyword\">this</span>.elements.display.duration);\n","\n","      <span class=\"code-comment\">// If there's only one time display, display duration there</span>\n","      <span class=\"code-keyword\">if</span> (!hasDuration &amp;&amp; <span class=\"code-keyword\">this</span>.config.displayDuration &amp;&amp; <span class=\"code-keyword\">this</span>.paused) {\n","        controls.updateTimeDisplay.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.display.currentTime, <span class=\"code-keyword\">this</span>.duration);\n","      }\n","\n","      <span class=\"code-comment\">// If there's a duration element, update content</span>\n","      <span class=\"code-keyword\">if</span> (hasDuration) {\n","        controls.updateTimeDisplay.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.display.duration, <span class=\"code-keyword\">this</span>.duration);\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.markers.enabled) {\n","        controls.setMarkers.call(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Update the tooltip (if visible)</span>\n","      controls.updateSeekTooltip.call(<span class=\"code-keyword\">this</span>);\n","    },\n","    <span class=\"code-comment\">// Hide/show a tab</span>\n","    toggleMenuButton(setting, toggle) {\n","      toggleHidden(<span class=\"code-keyword\">this</span>.elements.settings.buttons[setting], !toggle);\n","    },\n","    <span class=\"code-comment\">// Update the selected setting</span>\n","    updateSetting(setting, container, input) {\n","      <span class=\"code-keyword\">const</span> pane = <span class=\"code-keyword\">this</span>.elements.settings.panels[setting];\n","      <span class=\"code-keyword\">let</span> value = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">let</span> list = container;\n","      <span class=\"code-keyword\">if</span> (setting === <span class=\"code-string\">'captions'</span>) {\n","        value = <span class=\"code-keyword\">this</span>.currentTrack;\n","      } <span class=\"code-keyword\">else</span> {\n","        value = !is.empty(input) ? input : <span class=\"code-keyword\">this</span>[setting];\n","\n","        <span class=\"code-comment\">// Get default</span>\n","        <span class=\"code-keyword\">if</span> (is.empty(value)) {\n","          value = <span class=\"code-keyword\">this</span>.config[setting].default;\n","        }\n","\n","        <span class=\"code-comment\">// Unsupported value</span>\n","        <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.options[setting]) &amp;&amp; !<span class=\"code-keyword\">this</span>.options[setting].includes(value)) {\n","          <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">`Unsupported value of '<span class=\"code-subst\">${value}</span>' for <span class=\"code-subst\">${setting}</span>`</span>);\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Disabled value</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.config[setting].options.includes(value)) {\n","          <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">`Disabled value of '<span class=\"code-subst\">${value}</span>' for <span class=\"code-subst\">${setting}</span>`</span>);\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","      }\n","\n","      <span class=\"code-comment\">// Get the list if we need to</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(list)) {\n","        list = pane &amp;&amp; pane.querySelector(<span class=\"code-string\">'[role=\"menu\"]'</span>);\n","      }\n","\n","      <span class=\"code-comment\">// If there's no list it means it's not been rendered...</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(list)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Update the label</span>\n","      <span class=\"code-keyword\">const</span> label = <span class=\"code-keyword\">this</span>.elements.settings.buttons[setting].querySelector(<span class=\"code-string\">`.<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.classNames.menu.value}</span>`</span>);\n","      label.innerHTML = controls.getLabel.call(<span class=\"code-keyword\">this</span>, setting, value);\n","\n","      <span class=\"code-comment\">// Find the radio option and check it</span>\n","      <span class=\"code-keyword\">const</span> target = list &amp;&amp; list.querySelector(<span class=\"code-string\">`[value=\"<span class=\"code-subst\">${value}</span>\"]`</span>);\n","      <span class=\"code-keyword\">if</span> (is.element(target)) {\n","        target.checked = <span class=\"code-literal\">true</span>;\n","      }\n","    },\n","    <span class=\"code-comment\">// Translate a value into a nice label</span>\n","    getLabel(setting, value) {\n","      <span class=\"code-keyword\">switch</span> (setting) {\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'speed'</span>:\n","          <span class=\"code-keyword\">return</span> value === <span class=\"code-number\">1</span> ? i18n.get(<span class=\"code-string\">'normal'</span>, <span class=\"code-keyword\">this</span>.config) : <span class=\"code-string\">`<span class=\"code-subst\">${value}</span>&amp;times;`</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'quality'</span>:\n","          <span class=\"code-keyword\">if</span> (is.number(value)) {\n","            <span class=\"code-keyword\">const</span> label = i18n.get(<span class=\"code-string\">`qualityLabel.<span class=\"code-subst\">${value}</span>`</span>, <span class=\"code-keyword\">this</span>.config);\n","            <span class=\"code-keyword\">if</span> (!label.length) {\n","              <span class=\"code-keyword\">return</span> <span class=\"code-string\">`<span class=\"code-subst\">${value}</span>p`</span>;\n","            }\n","            <span class=\"code-keyword\">return</span> label;\n","          }\n","          <span class=\"code-keyword\">return</span> toTitleCase(value);\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'captions'</span>:\n","          <span class=\"code-keyword\">return</span> captions.getLabel.call(<span class=\"code-keyword\">this</span>);\n","        <span class=\"code-keyword\">default</span>:\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","    },\n","    <span class=\"code-comment\">// Set the quality menu</span>\n","    setQualityMenu(options) {\n","      <span class=\"code-comment\">// Menu required</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.settings.panels.quality)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> type = <span class=\"code-string\">'quality'</span>;\n","      <span class=\"code-keyword\">const</span> list = <span class=\"code-keyword\">this</span>.elements.settings.panels.quality.querySelector(<span class=\"code-string\">'[role=\"menu\"]'</span>);\n","\n","      <span class=\"code-comment\">// Set options if passed and filter based on uniqueness and config</span>\n","      <span class=\"code-keyword\">if</span> (is.array(options)) {\n","        <span class=\"code-keyword\">this</span>.options.quality = dedupe(options).filter(<span class=\"code-function\"><span class=\"code-params\">quality</span> =&gt;</span> <span class=\"code-keyword\">this</span>.config.quality.options.includes(quality));\n","      }\n","\n","      <span class=\"code-comment\">// Toggle the pane and tab</span>\n","      <span class=\"code-keyword\">const</span> toggle = !is.empty(<span class=\"code-keyword\">this</span>.options.quality) &amp;&amp; <span class=\"code-keyword\">this</span>.options.quality.length &gt; <span class=\"code-number\">1</span>;\n","      controls.toggleMenuButton.call(<span class=\"code-keyword\">this</span>, type, toggle);\n","\n","      <span class=\"code-comment\">// Empty the menu</span>\n","      emptyElement(list);\n","\n","      <span class=\"code-comment\">// Check if we need to toggle the parent</span>\n","      controls.checkMenu.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// If we're hiding, nothing more to do</span>\n","      <span class=\"code-keyword\">if</span> (!toggle) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Get the badge HTML for HD, 4K etc</span>\n","      <span class=\"code-keyword\">const</span> getBadge = <span class=\"code-function\"><span class=\"code-params\">quality</span> =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> label = i18n.get(<span class=\"code-string\">`qualityBadge.<span class=\"code-subst\">${quality}</span>`</span>, <span class=\"code-keyword\">this</span>.config);\n","        <span class=\"code-keyword\">if</span> (!label.length) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","        <span class=\"code-keyword\">return</span> controls.createBadge.call(<span class=\"code-keyword\">this</span>, label);\n","      };\n","\n","      <span class=\"code-comment\">// Sort options by the config and then render options</span>\n","      <span class=\"code-keyword\">this</span>.options.quality.sort(<span class=\"code-function\">(<span class=\"code-params\">a, b</span>) =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> sorting = <span class=\"code-keyword\">this</span>.config.quality.options;\n","        <span class=\"code-keyword\">return</span> sorting.indexOf(a) &gt; sorting.indexOf(b) ? <span class=\"code-number\">1</span> : <span class=\"code-number\">-1</span>;\n","      }).forEach(<span class=\"code-function\"><span class=\"code-params\">quality</span> =&gt;</span> {\n","        controls.createMenuItem.call(<span class=\"code-keyword\">this</span>, {\n","          value: quality,\n","          list,\n","          type,\n","          title: controls.getLabel.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'quality'</span>, quality),\n","          badge: getBadge(quality)\n","        });\n","      });\n","      controls.updateSetting.call(<span class=\"code-keyword\">this</span>, type, list);\n","    },\n","    <span class=\"code-comment\">// Set the looping options</span>\n","    <span class=\"code-comment\">/* setLoopMenu() {\n</span>","<span class=\"code-comment\">          // Menu required\n</span>","<span class=\"code-comment\">          if (!is.element(this.elements.settings.panels.loop)) {\n</span>","<span class=\"code-comment\">              return;\n</span>","<span class=\"code-comment\">          }\n</span>","<span class=\"code-comment\">           const options = ['start', 'end', 'all', 'reset'];\n</span>","<span class=\"code-comment\">          const list = this.elements.settings.panels.loop.querySelector('[role=\"menu\"]');\n</span>","<span class=\"code-comment\">           // Show the pane and tab\n</span>","<span class=\"code-comment\">          toggleHidden(this.elements.settings.buttons.loop, false);\n</span>","<span class=\"code-comment\">          toggleHidden(this.elements.settings.panels.loop, false);\n</span>","<span class=\"code-comment\">           // Toggle the pane and tab\n</span>","<span class=\"code-comment\">          const toggle = !is.empty(this.loop.options);\n</span>","<span class=\"code-comment\">          controls.toggleMenuButton.call(this, 'loop', toggle);\n</span>","<span class=\"code-comment\">           // Empty the menu\n</span>","<span class=\"code-comment\">          emptyElement(list);\n</span>","<span class=\"code-comment\">           options.forEach(option =&gt; {\n</span>","<span class=\"code-comment\">              const item = createElement('li');\n</span>","<span class=\"code-comment\">               const button = createElement(\n</span>","<span class=\"code-comment\">                  'button',\n</span>","<span class=\"code-comment\">                  extend(getAttributesFromSelector(this.config.selectors.buttons.loop), {\n</span>","<span class=\"code-comment\">                      type: 'button',\n</span>","<span class=\"code-comment\">                      class: this.config.classNames.control,\n</span>","<span class=\"code-comment\">                      'data-plyr-loop-action': option,\n</span>","<span class=\"code-comment\">                  }),\n</span>","<span class=\"code-comment\">                  i18n.get(option, this.config)\n</span>","<span class=\"code-comment\">              );\n</span>","<span class=\"code-comment\">               if (['start', 'end'].includes(option)) {\n</span>","<span class=\"code-comment\">                  const badge = controls.createBadge.call(this, '00:00');\n</span>","<span class=\"code-comment\">                  button.appendChild(badge);\n</span>","<span class=\"code-comment\">              }\n</span>","<span class=\"code-comment\">               item.appendChild(button);\n</span>","<span class=\"code-comment\">              list.appendChild(item);\n</span>","<span class=\"code-comment\">          });\n</span>","<span class=\"code-comment\">      }, */</span>\n","\n","    <span class=\"code-comment\">// Get current selected caption language</span>\n","    <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> rework this to user the getter in the API?</span>\n","\n","    <span class=\"code-comment\">// Set a list of available captions languages</span>\n","    setCaptionsMenu() {\n","      <span class=\"code-comment\">// Menu required</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.settings.panels.captions)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Captions or language? Currently it's mixed</span>\n","      <span class=\"code-keyword\">const</span> type = <span class=\"code-string\">'captions'</span>;\n","      <span class=\"code-keyword\">const</span> list = <span class=\"code-keyword\">this</span>.elements.settings.panels.captions.querySelector(<span class=\"code-string\">'[role=\"menu\"]'</span>);\n","      <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">const</span> toggle = <span class=\"code-built_in\">Boolean</span>(tracks.length);\n","\n","      <span class=\"code-comment\">// Toggle the pane and tab</span>\n","      controls.toggleMenuButton.call(<span class=\"code-keyword\">this</span>, type, toggle);\n","\n","      <span class=\"code-comment\">// Empty the menu</span>\n","      emptyElement(list);\n","\n","      <span class=\"code-comment\">// Check if we need to toggle the parent</span>\n","      controls.checkMenu.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// If there's no captions, bail</span>\n","      <span class=\"code-keyword\">if</span> (!toggle) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Generate options data</span>\n","      <span class=\"code-keyword\">const</span> options = tracks.map(<span class=\"code-function\">(<span class=\"code-params\">track, value</span>) =&gt;</span> ({\n","        value,\n","        checked: <span class=\"code-keyword\">this</span>.captions.toggled &amp;&amp; <span class=\"code-keyword\">this</span>.currentTrack === value,\n","        title: captions.getLabel.call(<span class=\"code-keyword\">this</span>, track),\n","        badge: track.language &amp;&amp; controls.createBadge.call(<span class=\"code-keyword\">this</span>, track.language.toUpperCase()),\n","        list,\n","        type: <span class=\"code-string\">'language'</span>\n","      }));\n","\n","      <span class=\"code-comment\">// Add the \"Disabled\" option to turn off captions</span>\n","      options.unshift({\n","        value: <span class=\"code-number\">-1</span>,\n","        checked: !<span class=\"code-keyword\">this</span>.captions.toggled,\n","        title: i18n.get(<span class=\"code-string\">'disabled'</span>, <span class=\"code-keyword\">this</span>.config),\n","        list,\n","        type: <span class=\"code-string\">'language'</span>\n","      });\n","\n","      <span class=\"code-comment\">// Generate options</span>\n","      options.forEach(controls.createMenuItem.bind(<span class=\"code-keyword\">this</span>));\n","      controls.updateSetting.call(<span class=\"code-keyword\">this</span>, type, list);\n","    },\n","    <span class=\"code-comment\">// Set a list of available captions languages</span>\n","    setSpeedMenu() {\n","      <span class=\"code-comment\">// Menu required</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.settings.panels.speed)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> type = <span class=\"code-string\">'speed'</span>;\n","      <span class=\"code-keyword\">const</span> list = <span class=\"code-keyword\">this</span>.elements.settings.panels.speed.querySelector(<span class=\"code-string\">'[role=\"menu\"]'</span>);\n","\n","      <span class=\"code-comment\">// Filter out invalid speeds</span>\n","      <span class=\"code-keyword\">this</span>.options.speed = <span class=\"code-keyword\">this</span>.options.speed.filter(<span class=\"code-function\"><span class=\"code-params\">o</span> =&gt;</span> o &gt;= <span class=\"code-keyword\">this</span>.minimumSpeed &amp;&amp; o &lt;= <span class=\"code-keyword\">this</span>.maximumSpeed);\n","\n","      <span class=\"code-comment\">// Toggle the pane and tab</span>\n","      <span class=\"code-keyword\">const</span> toggle = !is.empty(<span class=\"code-keyword\">this</span>.options.speed) &amp;&amp; <span class=\"code-keyword\">this</span>.options.speed.length &gt; <span class=\"code-number\">1</span>;\n","      controls.toggleMenuButton.call(<span class=\"code-keyword\">this</span>, type, toggle);\n","\n","      <span class=\"code-comment\">// Empty the menu</span>\n","      emptyElement(list);\n","\n","      <span class=\"code-comment\">// Check if we need to toggle the parent</span>\n","      controls.checkMenu.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// If we're hiding, nothing more to do</span>\n","      <span class=\"code-keyword\">if</span> (!toggle) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Create items</span>\n","      <span class=\"code-keyword\">this</span>.options.speed.forEach(<span class=\"code-function\"><span class=\"code-params\">speed</span> =&gt;</span> {\n","        controls.createMenuItem.call(<span class=\"code-keyword\">this</span>, {\n","          value: speed,\n","          list,\n","          type,\n","          title: controls.getLabel.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'speed'</span>, speed)\n","        });\n","      });\n","      controls.updateSetting.call(<span class=\"code-keyword\">this</span>, type, list);\n","    },\n","    <span class=\"code-comment\">// Check if we need to hide/show the settings menu</span>\n","    checkMenu() {\n","      <span class=\"code-keyword\">const</span> {\n","        buttons\n","      } = <span class=\"code-keyword\">this</span>.elements.settings;\n","      <span class=\"code-keyword\">const</span> visible = !is.empty(buttons) &amp;&amp; <span class=\"code-built_in\">Object</span>.values(buttons).some(<span class=\"code-function\"><span class=\"code-params\">button</span> =&gt;</span> !button.hidden);\n","      toggleHidden(<span class=\"code-keyword\">this</span>.elements.settings.menu, !visible);\n","    },\n","    <span class=\"code-comment\">// Focus the first menu item in a given (or visible) menu</span>\n","    focusFirstMenuItem(pane, focusVisible = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements.settings.popup.hidden) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">let</span> target = pane;\n","      <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","        target = <span class=\"code-built_in\">Object</span>.values(<span class=\"code-keyword\">this</span>.elements.settings.panels).find(<span class=\"code-function\"><span class=\"code-params\">p</span> =&gt;</span> !p.hidden);\n","      }\n","      <span class=\"code-keyword\">const</span> firstItem = target.querySelector(<span class=\"code-string\">'[role^=\"menuitem\"]'</span>);\n","      setFocus.call(<span class=\"code-keyword\">this</span>, firstItem, focusVisible);\n","    },\n","    <span class=\"code-comment\">// Show/hide menu</span>\n","    toggleMenu(input) {\n","      <span class=\"code-keyword\">const</span> {\n","        popup\n","      } = <span class=\"code-keyword\">this</span>.elements.settings;\n","      <span class=\"code-keyword\">const</span> button = <span class=\"code-keyword\">this</span>.elements.buttons.settings;\n","\n","      <span class=\"code-comment\">// Menu and button are required</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(popup) || !is.element(button)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// True toggle by default</span>\n","      <span class=\"code-keyword\">const</span> {\n","        hidden\n","      } = popup;\n","      <span class=\"code-keyword\">let</span> show = hidden;\n","      <span class=\"code-keyword\">if</span> (is.boolean(input)) {\n","        show = input;\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.keyboardEvent(input) &amp;&amp; input.key === <span class=\"code-string\">'Escape'</span>) {\n","        show = <span class=\"code-literal\">false</span>;\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.event(input)) {\n","        <span class=\"code-comment\">// If Plyr is in a shadowDOM, the event target is set to the component, instead of the</span>\n","        <span class=\"code-comment\">// Element in the shadowDOM. The path, if available, is complete.</span>\n","        <span class=\"code-keyword\">const</span> target = is.function(input.composedPath) ? input.composedPath()[<span class=\"code-number\">0</span>] : input.target;\n","        <span class=\"code-keyword\">const</span> isMenuItem = popup.contains(target);\n","\n","        <span class=\"code-comment\">// If the click was inside the menu or if the click</span>\n","        <span class=\"code-comment\">// wasn't the button or menu item and we're trying to</span>\n","        <span class=\"code-comment\">// show the menu (a doc click shouldn't show the menu)</span>\n","        <span class=\"code-keyword\">if</span> (isMenuItem || !isMenuItem &amp;&amp; input.target !== button &amp;&amp; show) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","      }\n","\n","      <span class=\"code-comment\">// Set button attributes</span>\n","      button.setAttribute(<span class=\"code-string\">'aria-expanded'</span>, show);\n","\n","      <span class=\"code-comment\">// Show the actual popup</span>\n","      toggleHidden(popup, !show);\n","\n","      <span class=\"code-comment\">// Add class hook</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.menu.open, show);\n","\n","      <span class=\"code-comment\">// Focus the first item if key interaction</span>\n","      <span class=\"code-keyword\">if</span> (show &amp;&amp; is.keyboardEvent(input)) {\n","        controls.focusFirstMenuItem.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">null</span>, <span class=\"code-literal\">true</span>);\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!show &amp;&amp; !hidden) {\n","        <span class=\"code-comment\">// If closing, re-focus the button</span>\n","        setFocus.call(<span class=\"code-keyword\">this</span>, button, is.keyboardEvent(input));\n","      }\n","    },\n","    <span class=\"code-comment\">// Get the natural size of a menu panel</span>\n","    getMenuSize(tab) {\n","      <span class=\"code-keyword\">const</span> clone = tab.cloneNode(<span class=\"code-literal\">true</span>);\n","      clone.style.position = <span class=\"code-string\">'absolute'</span>;\n","      clone.style.opacity = <span class=\"code-number\">0</span>;\n","      clone.removeAttribute(<span class=\"code-string\">'hidden'</span>);\n","\n","      <span class=\"code-comment\">// Append to parent so we get the \"real\" size</span>\n","      tab.parentNode.appendChild(clone);\n","\n","      <span class=\"code-comment\">// Get the sizes before we remove</span>\n","      <span class=\"code-keyword\">const</span> width = clone.scrollWidth;\n","      <span class=\"code-keyword\">const</span> height = clone.scrollHeight;\n","\n","      <span class=\"code-comment\">// Remove from the DOM</span>\n","      removeElement(clone);\n","      <span class=\"code-keyword\">return</span> {\n","        width,\n","        height\n","      };\n","    },\n","    <span class=\"code-comment\">// Show a panel in the menu</span>\n","    showMenuPanel(type = <span class=\"code-string\">''</span>, focusVisible = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-keyword\">const</span> target = <span class=\"code-keyword\">this</span>.elements.container.querySelector(<span class=\"code-string\">`#plyr-settings-<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.id}</span>-<span class=\"code-subst\">${type}</span>`</span>);\n","\n","      <span class=\"code-comment\">// Nothing to show, bail</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Hide all other panels</span>\n","      <span class=\"code-keyword\">const</span> container = target.parentNode;\n","      <span class=\"code-keyword\">const</span> current = <span class=\"code-built_in\">Array</span>.from(container.children).find(<span class=\"code-function\"><span class=\"code-params\">node</span> =&gt;</span> !node.hidden);\n","\n","      <span class=\"code-comment\">// If we can do fancy animations, we'll animate the height/width</span>\n","      <span class=\"code-keyword\">if</span> (support.transitions &amp;&amp; !support.reducedMotion) {\n","        <span class=\"code-comment\">// Set the current width as a base</span>\n","        container.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${current.scrollWidth}</span>px`</span>;\n","        container.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${current.scrollHeight}</span>px`</span>;\n","\n","        <span class=\"code-comment\">// Get potential sizes</span>\n","        <span class=\"code-keyword\">const</span> size = controls.getMenuSize.call(<span class=\"code-keyword\">this</span>, target);\n","\n","        <span class=\"code-comment\">// Restore auto height/width</span>\n","        <span class=\"code-keyword\">const</span> restore = <span class=\"code-function\"><span class=\"code-params\">event</span> =&gt;</span> {\n","          <span class=\"code-comment\">// We're only bothered about height and width on the container</span>\n","          <span class=\"code-keyword\">if</span> (event.target !== container || ![<span class=\"code-string\">'width'</span>, <span class=\"code-string\">'height'</span>].includes(event.propertyName)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Revert back to auto</span>\n","          container.style.width = <span class=\"code-string\">''</span>;\n","          container.style.height = <span class=\"code-string\">''</span>;\n","\n","          <span class=\"code-comment\">// Only listen once</span>\n","          off.call(<span class=\"code-keyword\">this</span>, container, transitionEndEvent, restore);\n","        };\n","\n","        <span class=\"code-comment\">// Listen for the transition finishing and restore auto height/width</span>\n","        on.call(<span class=\"code-keyword\">this</span>, container, transitionEndEvent, restore);\n","\n","        <span class=\"code-comment\">// Set dimensions to target</span>\n","        container.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${size.width}</span>px`</span>;\n","        container.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${size.height}</span>px`</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set attributes on current tab</span>\n","      toggleHidden(current, <span class=\"code-literal\">true</span>);\n","\n","      <span class=\"code-comment\">// Set attributes on target</span>\n","      toggleHidden(target, <span class=\"code-literal\">false</span>);\n","\n","      <span class=\"code-comment\">// Focus the first item</span>\n","      controls.focusFirstMenuItem.call(<span class=\"code-keyword\">this</span>, target, focusVisible);\n","    },\n","    <span class=\"code-comment\">// Set the download URL</span>\n","    setDownloadUrl() {\n","      <span class=\"code-keyword\">const</span> button = <span class=\"code-keyword\">this</span>.elements.buttons.download;\n","\n","      <span class=\"code-comment\">// Bail if no button</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(button)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Set attribute</span>\n","      button.setAttribute(<span class=\"code-string\">'href'</span>, <span class=\"code-keyword\">this</span>.download);\n","    },\n","    <span class=\"code-comment\">// Build the default HTML</span>\n","    create(data) {\n","      <span class=\"code-keyword\">const</span> {\n","        bindMenuItemShortcuts,\n","        createButton,\n","        createProgress,\n","        createRange,\n","        createTime,\n","        setQualityMenu,\n","        setSpeedMenu,\n","        showMenuPanel\n","      } = controls;\n","      <span class=\"code-keyword\">this</span>.elements.controls = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Larger overlaid play button</span>\n","      <span class=\"code-keyword\">if</span> (is.array(<span class=\"code-keyword\">this</span>.config.controls) &amp;&amp; <span class=\"code-keyword\">this</span>.config.controls.includes(<span class=\"code-string\">'play-large'</span>)) {\n","        <span class=\"code-keyword\">this</span>.elements.container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'play-large'</span>));\n","      }\n","\n","      <span class=\"code-comment\">// Create the container</span>\n","      <span class=\"code-keyword\">const</span> container = createElement(<span class=\"code-string\">'div'</span>, getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.controls.wrapper));\n","      <span class=\"code-keyword\">this</span>.elements.controls = container;\n","\n","      <span class=\"code-comment\">// Default item attributes</span>\n","      <span class=\"code-keyword\">const</span> defaultAttributes = {\n","        class: 'plyr__controls__item'\n","      };\n","\n","      <span class=\"code-comment\">// Loop through controls in order</span>\n","      dedupe(is.array(<span class=\"code-keyword\">this</span>.config.controls) ? <span class=\"code-keyword\">this</span>.config.controls : []).forEach(<span class=\"code-function\"><span class=\"code-params\">control</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Restart button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'restart'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'restart'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Rewind button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'rewind'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'rewind'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Play/Pause button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'play'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'play'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Fast forward button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'fast-forward'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'fast-forward'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Progress</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'progress'</span>) {\n","          <span class=\"code-keyword\">const</span> progressContainer = createElement(<span class=\"code-string\">'div'</span>, {\n","            class: `${defaultAttributes.class} plyr__progress__container`\n","          });\n","          <span class=\"code-keyword\">const</span> progress = createElement(<span class=\"code-string\">'div'</span>, getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.progress));\n","\n","          <span class=\"code-comment\">// Seek range slider</span>\n","          progress.appendChild(createRange.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'seek'</span>, {\n","            id: <span class=\"code-string\">`plyr-seek-<span class=\"code-subst\">${data.id}</span>`</span>\n","          }));\n","\n","          <span class=\"code-comment\">// Buffer progress</span>\n","          progress.appendChild(createProgress.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'buffer'</span>));\n","\n","          <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Add loop display indicator</span>\n","\n","          <span class=\"code-comment\">// Seek tooltip</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.tooltips.seek) {\n","            <span class=\"code-keyword\">const</span> tooltip = createElement(<span class=\"code-string\">'span'</span>, {\n","              class: this.config.classNames.tooltip\n","            }, <span class=\"code-string\">'00:00'</span>);\n","            progress.appendChild(tooltip);\n","            <span class=\"code-keyword\">this</span>.elements.display.seekTooltip = tooltip;\n","          }\n","          <span class=\"code-keyword\">this</span>.elements.progress = progress;\n","          progressContainer.appendChild(<span class=\"code-keyword\">this</span>.elements.progress);\n","          container.appendChild(progressContainer);\n","        }\n","\n","        <span class=\"code-comment\">// Media current time display</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'current-time'</span>) {\n","          container.appendChild(createTime.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'currentTime'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Media duration display</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'duration'</span>) {\n","          container.appendChild(createTime.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'duration'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Volume controls</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'mute'</span> || control === <span class=\"code-string\">'volume'</span>) {\n","          <span class=\"code-keyword\">let</span> {\n","            volume\n","          } = <span class=\"code-keyword\">this</span>.elements;\n","\n","          <span class=\"code-comment\">// Create the volume container if needed</span>\n","          <span class=\"code-keyword\">if</span> (!is.element(volume) || !container.contains(volume)) {\n","            volume = createElement(<span class=\"code-string\">'div'</span>, extend({}, defaultAttributes, {\n","              class: `${defaultAttributes.class} plyr__volume`.trim()\n","            }));\n","            <span class=\"code-keyword\">this</span>.elements.volume = volume;\n","            container.appendChild(volume);\n","          }\n","\n","          <span class=\"code-comment\">// Toggle mute button</span>\n","          <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'mute'</span>) {\n","            volume.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'mute'</span>));\n","          }\n","\n","          <span class=\"code-comment\">// Volume range control</span>\n","          <span class=\"code-comment\">// Ignored on iOS as it's handled globally</span>\n","          <span class=\"code-comment\">// https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html</span>\n","          <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'volume'</span> &amp;&amp; !browser.isIos &amp;&amp; !browser.isIPadOS) {\n","            <span class=\"code-comment\">// Set the attributes</span>\n","            <span class=\"code-keyword\">const</span> attributes = {\n","              max: <span class=\"code-number\">1</span>,\n","              step: <span class=\"code-number\">0.05</span>,\n","              value: <span class=\"code-keyword\">this</span>.config.volume\n","            };\n","\n","            <span class=\"code-comment\">// Create the volume range slider</span>\n","            volume.appendChild(createRange.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'volume'</span>, extend(attributes, {\n","              id: <span class=\"code-string\">`plyr-volume-<span class=\"code-subst\">${data.id}</span>`</span>\n","            })));\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Toggle captions button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'captions'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'captions'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Settings button / menu</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'settings'</span> &amp;&amp; !is.empty(<span class=\"code-keyword\">this</span>.config.settings)) {\n","          <span class=\"code-keyword\">const</span> wrapper = createElement(<span class=\"code-string\">'div'</span>, extend({}, defaultAttributes, {\n","            class: `${defaultAttributes.class} plyr__menu`.trim(),\n","            hidden: <span class=\"code-string\">''</span>\n","          }));\n","          wrapper.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'settings'</span>, {\n","            <span class=\"code-string\">'aria-haspopup'</span>: <span class=\"code-literal\">true</span>,\n","            <span class=\"code-string\">'aria-controls'</span>: <span class=\"code-string\">`plyr-settings-<span class=\"code-subst\">${data.id}</span>`</span>,\n","            <span class=\"code-string\">'aria-expanded'</span>: <span class=\"code-literal\">false</span>\n","          }));\n","          <span class=\"code-keyword\">const</span> popup = createElement(<span class=\"code-string\">'div'</span>, {\n","            class: 'plyr__menu__container',\n","            id: <span class=\"code-string\">`plyr-settings-<span class=\"code-subst\">${data.id}</span>`</span>,\n","            hidden: <span class=\"code-string\">''</span>\n","          });\n","          <span class=\"code-keyword\">const</span> inner = createElement(<span class=\"code-string\">'div'</span>);\n","          <span class=\"code-keyword\">const</span> home = createElement(<span class=\"code-string\">'div'</span>, {\n","            id: <span class=\"code-string\">`plyr-settings-<span class=\"code-subst\">${data.id}</span>-home`</span>\n","          });\n","\n","          <span class=\"code-comment\">// Create the menu</span>\n","          <span class=\"code-keyword\">const</span> menu = createElement(<span class=\"code-string\">'div'</span>, {\n","            role: <span class=\"code-string\">'menu'</span>\n","          });\n","          home.appendChild(menu);\n","          inner.appendChild(home);\n","          <span class=\"code-keyword\">this</span>.elements.settings.panels.home = home;\n","\n","          <span class=\"code-comment\">// Build the menu items</span>\n","          <span class=\"code-keyword\">this</span>.config.settings.forEach(<span class=\"code-function\"><span class=\"code-params\">type</span> =&gt;</span> {\n","            <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> bundle this with the createMenuItem helper and bindings</span>\n","            <span class=\"code-keyword\">const</span> menuItem = createElement(<span class=\"code-string\">'button'</span>, extend(getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.buttons.settings), {\n","              type: <span class=\"code-string\">'button'</span>,\n","              class: `${this.config.classNames.control} ${this.config.classNames.control}--forward`,\n","              role: <span class=\"code-string\">'menuitem'</span>,\n","              <span class=\"code-string\">'aria-haspopup'</span>: <span class=\"code-literal\">true</span>,\n","              hidden: <span class=\"code-string\">''</span>\n","            }));\n","\n","            <span class=\"code-comment\">// Bind menu shortcuts for keyboard users</span>\n","            bindMenuItemShortcuts.call(<span class=\"code-keyword\">this</span>, menuItem, type);\n","\n","            <span class=\"code-comment\">// Show menu on click</span>\n","            on.call(<span class=\"code-keyword\">this</span>, menuItem, <span class=\"code-string\">'click'</span>, () =&gt; {\n","              showMenuPanel.call(<span class=\"code-keyword\">this</span>, type, <span class=\"code-literal\">false</span>);\n","            });\n","            <span class=\"code-keyword\">const</span> flex = createElement(<span class=\"code-string\">'span'</span>, <span class=\"code-literal\">null</span>, i18n.get(type, <span class=\"code-keyword\">this</span>.config));\n","            <span class=\"code-keyword\">const</span> value = createElement(<span class=\"code-string\">'span'</span>, {\n","              class: this.config.classNames.menu.value\n","            });\n","\n","            <span class=\"code-comment\">// Speed contains HTML entities</span>\n","            value.innerHTML = data[type];\n","            flex.appendChild(value);\n","            menuItem.appendChild(flex);\n","            menu.appendChild(menuItem);\n","\n","            <span class=\"code-comment\">// Build the panes</span>\n","            <span class=\"code-keyword\">const</span> pane = createElement(<span class=\"code-string\">'div'</span>, {\n","              id: <span class=\"code-string\">`plyr-settings-<span class=\"code-subst\">${data.id}</span>-<span class=\"code-subst\">${type}</span>`</span>,\n","              hidden: <span class=\"code-string\">''</span>\n","            });\n","\n","            <span class=\"code-comment\">// Back button</span>\n","            <span class=\"code-keyword\">const</span> backButton = createElement(<span class=\"code-string\">'button'</span>, {\n","              type: <span class=\"code-string\">'button'</span>,\n","              class: `${this.config.classNames.control} ${this.config.classNames.control}--back`\n","            });\n","\n","            <span class=\"code-comment\">// Visible label</span>\n","            backButton.appendChild(createElement(<span class=\"code-string\">'span'</span>, {\n","              <span class=\"code-string\">'aria-hidden'</span>: <span class=\"code-literal\">true</span>\n","            }, i18n.get(type, <span class=\"code-keyword\">this</span>.config)));\n","\n","            <span class=\"code-comment\">// Screen reader label</span>\n","            backButton.appendChild(createElement(<span class=\"code-string\">'span'</span>, {\n","              class: this.config.classNames.hidden\n","            }, i18n.get(<span class=\"code-string\">'menuBack'</span>, <span class=\"code-keyword\">this</span>.config)));\n","\n","            <span class=\"code-comment\">// Go back via keyboard</span>\n","            on.call(<span class=\"code-keyword\">this</span>, pane, <span class=\"code-string\">'keydown'</span>, event =&gt; {\n","              <span class=\"code-keyword\">if</span> (event.key !== <span class=\"code-string\">'ArrowLeft'</span>) <span class=\"code-keyword\">return</span>;\n","\n","              <span class=\"code-comment\">// Prevent seek</span>\n","              event.preventDefault();\n","              event.stopPropagation();\n","\n","              <span class=\"code-comment\">// Show the respective menu</span>\n","              showMenuPanel.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'home'</span>, <span class=\"code-literal\">true</span>);\n","            }, <span class=\"code-literal\">false</span>);\n","\n","            <span class=\"code-comment\">// Go back via button click</span>\n","            on.call(<span class=\"code-keyword\">this</span>, backButton, <span class=\"code-string\">'click'</span>, () =&gt; {\n","              showMenuPanel.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'home'</span>, <span class=\"code-literal\">false</span>);\n","            });\n","\n","            <span class=\"code-comment\">// Add to pane</span>\n","            pane.appendChild(backButton);\n","\n","            <span class=\"code-comment\">// Menu</span>\n","            pane.appendChild(createElement(<span class=\"code-string\">'div'</span>, {\n","              role: <span class=\"code-string\">'menu'</span>\n","            }));\n","            inner.appendChild(pane);\n","            <span class=\"code-keyword\">this</span>.elements.settings.buttons[type] = menuItem;\n","            <span class=\"code-keyword\">this</span>.elements.settings.panels[type] = pane;\n","          });\n","          popup.appendChild(inner);\n","          wrapper.appendChild(popup);\n","          container.appendChild(wrapper);\n","          <span class=\"code-keyword\">this</span>.elements.settings.popup = popup;\n","          <span class=\"code-keyword\">this</span>.elements.settings.menu = wrapper;\n","        }\n","\n","        <span class=\"code-comment\">// Picture in picture button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'pip'</span> &amp;&amp; support.pip) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'pip'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Airplay button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'airplay'</span> &amp;&amp; support.airplay) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'airplay'</span>, defaultAttributes));\n","        }\n","\n","        <span class=\"code-comment\">// Download button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'download'</span>) {\n","          <span class=\"code-keyword\">const</span> attributes = extend({}, defaultAttributes, {\n","            element: <span class=\"code-string\">'a'</span>,\n","            href: <span class=\"code-keyword\">this</span>.download,\n","            target: <span class=\"code-string\">'_blank'</span>\n","          });\n","\n","          <span class=\"code-comment\">// Set download attribute for HTML5 only</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","            attributes.download = <span class=\"code-string\">''</span>;\n","          }\n","          <span class=\"code-keyword\">const</span> {\n","            download\n","          } = <span class=\"code-keyword\">this</span>.config.urls;\n","          <span class=\"code-keyword\">if</span> (!is.url(download) &amp;&amp; <span class=\"code-keyword\">this</span>.isEmbed) {\n","            extend(attributes, {\n","              icon: <span class=\"code-string\">`logo-<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.provider}</span>`</span>,\n","              label: <span class=\"code-keyword\">this</span>.provider\n","            });\n","          }\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'download'</span>, attributes));\n","        }\n","\n","        <span class=\"code-comment\">// Toggle fullscreen button</span>\n","        <span class=\"code-keyword\">if</span> (control === <span class=\"code-string\">'fullscreen'</span>) {\n","          container.appendChild(createButton.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'fullscreen'</span>, defaultAttributes));\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Set available quality levels</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","        setQualityMenu.call(<span class=\"code-keyword\">this</span>, html5.getQualityOptions.call(<span class=\"code-keyword\">this</span>));\n","      }\n","      setSpeedMenu.call(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">return</span> container;\n","    },\n","    <span class=\"code-comment\">// Insert controls</span>\n","    inject() {\n","      <span class=\"code-comment\">// Sprite</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.loadSprite) {\n","        <span class=\"code-keyword\">const</span> icon = controls.getIconUrl.call(<span class=\"code-keyword\">this</span>);\n","\n","        <span class=\"code-comment\">// Only load external sprite using AJAX</span>\n","        <span class=\"code-keyword\">if</span> (icon.cors) {\n","          loadSprite(icon.url, <span class=\"code-string\">'sprite-plyr'</span>);\n","        }\n","      }\n","\n","      <span class=\"code-comment\">// Create a unique ID</span>\n","      <span class=\"code-keyword\">this</span>.id = <span class=\"code-built_in\">Math</span>.floor(<span class=\"code-built_in\">Math</span>.random() * <span class=\"code-number\">10000</span>);\n","\n","      <span class=\"code-comment\">// Null by default</span>\n","      <span class=\"code-keyword\">let</span> container = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.elements.controls = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Set template properties</span>\n","      <span class=\"code-keyword\">const</span> props = {\n","        id: <span class=\"code-keyword\">this</span>.id,\n","        seektime: <span class=\"code-keyword\">this</span>.config.seekTime,\n","        title: <span class=\"code-keyword\">this</span>.config.title\n","      };\n","      <span class=\"code-keyword\">let</span> update = <span class=\"code-literal\">true</span>;\n","\n","      <span class=\"code-comment\">// If function, run it and use output</span>\n","      <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-keyword\">this</span>.config.controls)) {\n","        <span class=\"code-keyword\">this</span>.config.controls = <span class=\"code-keyword\">this</span>.config.controls.call(<span class=\"code-keyword\">this</span>, props);\n","      }\n","\n","      <span class=\"code-comment\">// Convert falsy controls to empty array (primarily for empty strings)</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.config.controls) {\n","        <span class=\"code-keyword\">this</span>.config.controls = [];\n","      }\n","      <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.config.controls) || is.string(<span class=\"code-keyword\">this</span>.config.controls)) {\n","        <span class=\"code-comment\">// HTMLElement or Non-empty string passed as the option</span>\n","        container = <span class=\"code-keyword\">this</span>.config.controls;\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-comment\">// Create controls</span>\n","        container = controls.create.call(<span class=\"code-keyword\">this</span>, {\n","          id: <span class=\"code-keyword\">this</span>.id,\n","          seektime: <span class=\"code-keyword\">this</span>.config.seekTime,\n","          speed: <span class=\"code-keyword\">this</span>.speed,\n","          quality: <span class=\"code-keyword\">this</span>.quality,\n","          captions: captions.getLabel.call(<span class=\"code-keyword\">this</span>)\n","          <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Looping</span>\n","          <span class=\"code-comment\">// loop: 'None',</span>\n","        });\n","\n","        update = <span class=\"code-literal\">false</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Replace props with their value</span>\n","      <span class=\"code-keyword\">const</span> replace = <span class=\"code-function\"><span class=\"code-params\">input</span> =&gt;</span> {\n","        <span class=\"code-keyword\">let</span> result = input;\n","        <span class=\"code-built_in\">Object</span>.entries(props).forEach(<span class=\"code-function\">(<span class=\"code-params\">[key, value]</span>) =&gt;</span> {\n","          result = replaceAll(result, <span class=\"code-string\">`{<span class=\"code-subst\">${key}</span>}`</span>, value);\n","        });\n","        <span class=\"code-keyword\">return</span> result;\n","      };\n","\n","      <span class=\"code-comment\">// Update markup</span>\n","      <span class=\"code-keyword\">if</span> (update) {\n","        <span class=\"code-keyword\">if</span> (is.string(<span class=\"code-keyword\">this</span>.config.controls)) {\n","          container = replace(container);\n","        }\n","      }\n","\n","      <span class=\"code-comment\">// Controls container</span>\n","      <span class=\"code-keyword\">let</span> target;\n","\n","      <span class=\"code-comment\">// Inject to custom location</span>\n","      <span class=\"code-keyword\">if</span> (is.string(<span class=\"code-keyword\">this</span>.config.selectors.controls.container)) {\n","        target = <span class=\"code-built_in\">document</span>.querySelector(<span class=\"code-keyword\">this</span>.config.selectors.controls.container);\n","      }\n","\n","      <span class=\"code-comment\">// Inject into the container by default</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(target)) {\n","        target = <span class=\"code-keyword\">this</span>.elements.container;\n","      }\n","\n","      <span class=\"code-comment\">// Inject controls HTML (needs to be before captions, hence \"afterbegin\")</span>\n","      <span class=\"code-keyword\">const</span> insertMethod = is.element(container) ? <span class=\"code-string\">'insertAdjacentElement'</span> : <span class=\"code-string\">'insertAdjacentHTML'</span>;\n","      target[insertMethod](<span class=\"code-string\">'afterbegin'</span>, container);\n","\n","      <span class=\"code-comment\">// Find the elements if need be</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.controls)) {\n","        controls.findElements.call(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Add pressed property to buttons</span>\n","      <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.elements.buttons)) {\n","        <span class=\"code-keyword\">const</span> addProperty = <span class=\"code-function\"><span class=\"code-params\">button</span> =&gt;</span> {\n","          <span class=\"code-keyword\">const</span> className = <span class=\"code-keyword\">this</span>.config.classNames.controlPressed;\n","          button.setAttribute(<span class=\"code-string\">'aria-pressed'</span>, <span class=\"code-string\">'false'</span>);\n","          <span class=\"code-built_in\">Object</span>.defineProperty(button, <span class=\"code-string\">'pressed'</span>, {\n","            configurable: <span class=\"code-literal\">true</span>,\n","            enumerable: <span class=\"code-literal\">true</span>,\n","            <span class=\"code-keyword\">get</span>() {\n","              <span class=\"code-keyword\">return</span> hasClass(button, className);\n","            },\n","            <span class=\"code-keyword\">set</span>(pressed = false) {\n","              toggleClass(button, className, pressed);\n","              button.setAttribute(<span class=\"code-string\">'aria-pressed'</span>, pressed ? <span class=\"code-string\">'true'</span> : <span class=\"code-string\">'false'</span>);\n","            }\n","          });\n","        };\n","\n","        <span class=\"code-comment\">// Toggle classname when pressed property is set</span>\n","        <span class=\"code-built_in\">Object</span>.values(<span class=\"code-keyword\">this</span>.elements.buttons).filter(<span class=\"code-built_in\">Boolean</span>).forEach(<span class=\"code-function\"><span class=\"code-params\">button</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (is.array(button) || is.nodeList(button)) {\n","            <span class=\"code-built_in\">Array</span>.from(button).filter(<span class=\"code-built_in\">Boolean</span>).forEach(addProperty);\n","          } <span class=\"code-keyword\">else</span> {\n","            addProperty(button);\n","          }\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Edge sometimes doesn't finish the paint so force a repaint</span>\n","      <span class=\"code-keyword\">if</span> (browser.isEdge) {\n","        repaint(target);\n","      }\n","\n","      <span class=\"code-comment\">// Setup tooltips</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.tooltips.controls) {\n","        <span class=\"code-keyword\">const</span> {\n","          classNames,\n","          selectors\n","        } = <span class=\"code-keyword\">this</span>.config;\n","        <span class=\"code-keyword\">const</span> selector = <span class=\"code-string\">`<span class=\"code-subst\">${selectors.controls.wrapper}</span> <span class=\"code-subst\">${selectors.labels}</span> .<span class=\"code-subst\">${classNames.hidden}</span>`</span>;\n","        <span class=\"code-keyword\">const</span> labels = getElements.call(<span class=\"code-keyword\">this</span>, selector);\n","        <span class=\"code-built_in\">Array</span>.from(labels).forEach(<span class=\"code-function\"><span class=\"code-params\">label</span> =&gt;</span> {\n","          toggleClass(label, <span class=\"code-keyword\">this</span>.config.classNames.hidden, <span class=\"code-literal\">false</span>);\n","          toggleClass(label, <span class=\"code-keyword\">this</span>.config.classNames.tooltip, <span class=\"code-literal\">true</span>);\n","        });\n","      }\n","    },\n","    <span class=\"code-comment\">// Set media metadata</span>\n","    setMediaMetadata() {\n","      <span class=\"code-keyword\">try</span> {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-string\">'mediaSession'</span> <span class=\"code-keyword\">in</span> navigator) {\n","          navigator.mediaSession.metadata = <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">window</span>.MediaMetadata({\n","            title: <span class=\"code-keyword\">this</span>.config.mediaMetadata.title,\n","            artist: <span class=\"code-keyword\">this</span>.config.mediaMetadata.artist,\n","            album: <span class=\"code-keyword\">this</span>.config.mediaMetadata.album,\n","            artwork: <span class=\"code-keyword\">this</span>.config.mediaMetadata.artwork\n","          });\n","        }\n","      } <span class=\"code-keyword\">catch</span> (_) {\n","        <span class=\"code-comment\">// Do nothing</span>\n","      }\n","    },\n","    <span class=\"code-comment\">// Add markers</span>\n","    setMarkers() {\n","      <span class=\"code-keyword\">var</span> _this$config$markers2, _this$config$markers3;\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.duration || <span class=\"code-keyword\">this</span>.elements.markers) <span class=\"code-keyword\">return</span>;\n","\n","      <span class=\"code-comment\">// Get valid points</span>\n","      <span class=\"code-keyword\">const</span> points = (_this$config$markers2 = <span class=\"code-keyword\">this</span>.config.markers) === <span class=\"code-literal\">null</span> || _this$config$markers2 === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : (_this$config$markers3 = _this$config$markers2.points) === <span class=\"code-literal\">null</span> || _this$config$markers3 === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : _this$config$markers3.filter(({\n","        time\n","      }) =&gt; time &gt; <span class=\"code-number\">0</span> &amp;&amp; time &lt; <span class=\"code-keyword\">this</span>.duration);\n","      <span class=\"code-keyword\">if</span> (!(points !== <span class=\"code-literal\">null</span> &amp;&amp; points !== <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> &amp;&amp; points.length)) <span class=\"code-keyword\">return</span>;\n","      <span class=\"code-keyword\">const</span> containerFragment = <span class=\"code-built_in\">document</span>.createDocumentFragment();\n","      <span class=\"code-keyword\">const</span> pointsFragment = <span class=\"code-built_in\">document</span>.createDocumentFragment();\n","      <span class=\"code-keyword\">let</span> tipElement = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">const</span> tipVisible = <span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.classNames.tooltip}</span>--visible`</span>;\n","      <span class=\"code-keyword\">const</span> toggleTip = <span class=\"code-function\"><span class=\"code-params\">show</span> =&gt;</span> toggleClass(tipElement, tipVisible, show);\n","\n","      <span class=\"code-comment\">// Inject markers to progress container</span>\n","      points.forEach(<span class=\"code-function\"><span class=\"code-params\">point</span> =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> markerElement = createElement(<span class=\"code-string\">'span'</span>, {\n","          class: this.config.classNames.marker\n","        }, <span class=\"code-string\">''</span>);\n","        const left = `${point.time / this.duration * 100}%`;\n","        <span class=\"code-keyword\">if</span> (tipElement) {\n","          <span class=\"code-comment\">// Show on hover</span>\n","          markerElement.addEventListener(<span class=\"code-string\">'mouseenter'</span>, () =&gt; {\n","            <span class=\"code-keyword\">if</span> (point.label) <span class=\"code-keyword\">return</span>;\n","            tipElement.style.left = left;\n","            tipElement.innerHTML = point.label;\n","            toggleTip(<span class=\"code-literal\">true</span>);\n","          });\n","\n","          <span class=\"code-comment\">// Hide on leave</span>\n","          markerElement.addEventListener(<span class=\"code-string\">'mouseleave'</span>, () =&gt; {\n","            toggleTip(<span class=\"code-literal\">false</span>);\n","          });\n","        }\n","        markerElement.addEventListener(<span class=\"code-string\">'click'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.currentTime = point.time;\n","        });\n","        markerElement.style.left = left;\n","        pointsFragment.appendChild(markerElement);\n","      });\n","      containerFragment.appendChild(pointsFragment);\n","\n","      <span class=\"code-comment\">// Inject a tooltip if needed</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.config.tooltips.seek) {\n","        tipElement = createElement(<span class=\"code-string\">'span'</span>, {\n","          class: this.config.classNames.tooltip\n","        }, <span class=\"code-string\">''</span>);\n","        containerFragment.appendChild(tipElement);\n","      }\n","      <span class=\"code-keyword\">this</span>.elements.markers = {\n","        points: pointsFragment,\n","        tip: tipElement\n","      };\n","      <span class=\"code-keyword\">this</span>.elements.progress.appendChild(containerFragment);\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">   * Parse a string to a URL object\n</span>","<span class=\"code-comment\">   * @param {String} input - the URL to be parsed\n</span>","<span class=\"code-comment\">   * @param {Boolean} safe - failsafe parsing\n</span>","<span class=\"code-comment\">   */</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">parseUrl</span>(<span class=\"code-params\">input, safe = true</span>) </span>{\n","    <span class=\"code-keyword\">let</span> url = input;\n","    <span class=\"code-keyword\">if</span> (safe) {\n","      <span class=\"code-keyword\">const</span> parser = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'a'</span>);\n","      parser.href = url;\n","      url = parser.href;\n","    }\n","    <span class=\"code-keyword\">try</span> {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> URL(url);\n","    } <span class=\"code-keyword\">catch</span> (_) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// Convert object to URLSearchParams</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">buildUrlParams</span>(<span class=\"code-params\">input</span>) </span>{\n","    <span class=\"code-keyword\">const</span> params = <span class=\"code-keyword\">new</span> URLSearchParams();\n","    <span class=\"code-keyword\">if</span> (is.object(input)) {\n","      <span class=\"code-built_in\">Object</span>.entries(input).forEach(<span class=\"code-function\">(<span class=\"code-params\">[key, value]</span>) =&gt;</span> {\n","        params.set(key, value);\n","      });\n","    }\n","    <span class=\"code-keyword\">return</span> params;\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-keyword\">const</span> captions = {\n","    <span class=\"code-comment\">// Setup captions</span>\n","    setup() {\n","      <span class=\"code-comment\">// Requires UI support</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Only Vimeo and HTML5 video supported at this point</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo || <span class=\"code-keyword\">this</span>.isYouTube || <span class=\"code-keyword\">this</span>.isHTML5 &amp;&amp; !support.textTracks) {\n","        <span class=\"code-comment\">// Clear menu and hide</span>\n","        <span class=\"code-keyword\">if</span> (is.array(<span class=\"code-keyword\">this</span>.config.controls) &amp;&amp; <span class=\"code-keyword\">this</span>.config.controls.includes(<span class=\"code-string\">'settings'</span>) &amp;&amp; <span class=\"code-keyword\">this</span>.config.settings.includes(<span class=\"code-string\">'captions'</span>)) {\n","          controls.setCaptionsMenu.call(<span class=\"code-keyword\">this</span>);\n","        }\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Inject the container</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.captions)) {\n","        <span class=\"code-keyword\">this</span>.elements.captions = createElement(<span class=\"code-string\">'div'</span>, getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.captions));\n","        <span class=\"code-keyword\">this</span>.elements.captions.setAttribute(<span class=\"code-string\">'dir'</span>, <span class=\"code-string\">'auto'</span>);\n","        insertAfter(<span class=\"code-keyword\">this</span>.elements.captions, <span class=\"code-keyword\">this</span>.elements.wrapper);\n","      }\n","\n","      <span class=\"code-comment\">// Fix IE captions if CORS is used</span>\n","      <span class=\"code-comment\">// Fetch captions and inject as blobs instead (data URIs not supported!)</span>\n","      <span class=\"code-keyword\">if</span> (browser.isIE &amp;&amp; <span class=\"code-built_in\">window</span>.URL) {\n","        <span class=\"code-keyword\">const</span> elements = <span class=\"code-keyword\">this</span>.media.querySelectorAll(<span class=\"code-string\">'track'</span>);\n","        <span class=\"code-built_in\">Array</span>.from(elements).forEach(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> {\n","          <span class=\"code-keyword\">const</span> src = track.getAttribute(<span class=\"code-string\">'src'</span>);\n","          <span class=\"code-keyword\">const</span> url = parseUrl(src);\n","          <span class=\"code-keyword\">if</span> (url !== <span class=\"code-literal\">null</span> &amp;&amp; url.hostname !== <span class=\"code-built_in\">window</span>.location.href.hostname &amp;&amp; [<span class=\"code-string\">'http:'</span>, <span class=\"code-string\">'https:'</span>].includes(url.protocol)) {\n","            fetch(src, <span class=\"code-string\">'blob'</span>).then(<span class=\"code-function\"><span class=\"code-params\">blob</span> =&gt;</span> {\n","              track.setAttribute(<span class=\"code-string\">'src'</span>, <span class=\"code-built_in\">window</span>.URL.createObjectURL(blob));\n","            }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              removeElement(track);\n","            });\n","          }\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Get and set initial data</span>\n","      <span class=\"code-comment\">// The \"preferred\" options are not realized unless / until the wanted language has a match</span>\n","      <span class=\"code-comment\">// * languages: Array of user's browser languages.</span>\n","      <span class=\"code-comment\">// * language:  The language preferred by user settings or config</span>\n","      <span class=\"code-comment\">// * active:    The state preferred by user settings or config</span>\n","      <span class=\"code-comment\">// * toggled:   The real captions state</span>\n","\n","      <span class=\"code-keyword\">const</span> browserLanguages = navigator.languages || [navigator.language || navigator.userLanguage || <span class=\"code-string\">'en'</span>];\n","      <span class=\"code-keyword\">const</span> languages = dedupe(browserLanguages.map(<span class=\"code-function\"><span class=\"code-params\">language</span> =&gt;</span> language.split(<span class=\"code-string\">'-'</span>)[<span class=\"code-number\">0</span>]));\n","      <span class=\"code-keyword\">let</span> language = (<span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'language'</span>) || <span class=\"code-keyword\">this</span>.config.captions.language || <span class=\"code-string\">'auto'</span>).toLowerCase();\n","\n","      <span class=\"code-comment\">// Use first browser language when language is 'auto'</span>\n","      <span class=\"code-keyword\">if</span> (language === <span class=\"code-string\">'auto'</span>) {\n","        [language] = languages;\n","      }\n","      <span class=\"code-keyword\">let</span> active = <span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'captions'</span>);\n","      <span class=\"code-keyword\">if</span> (!is.boolean(active)) {\n","        ({\n","          active\n","        } = <span class=\"code-keyword\">this</span>.config.captions);\n","      }\n","      <span class=\"code-built_in\">Object</span>.assign(<span class=\"code-keyword\">this</span>.captions, {\n","        toggled: <span class=\"code-literal\">false</span>,\n","        active,\n","        language,\n","        languages\n","      });\n","\n","      <span class=\"code-comment\">// Watch changes to textTracks and update captions menu</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">const</span> trackEvents = <span class=\"code-keyword\">this</span>.config.captions.update ? <span class=\"code-string\">'addtrack removetrack'</span> : <span class=\"code-string\">'removetrack'</span>;\n","        on.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media.textTracks, trackEvents, captions.update.bind(<span class=\"code-keyword\">this</span>));\n","      }\n","\n","      <span class=\"code-comment\">// Update available languages in list next tick (the event must not be triggered before the listeners)</span>\n","      setTimeout(captions.update.bind(<span class=\"code-keyword\">this</span>), <span class=\"code-number\">0</span>);\n","    },\n","    <span class=\"code-comment\">// Update available language options in settings based on tracks</span>\n","    update() {\n","      <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">true</span>);\n","      <span class=\"code-comment\">// Get the wanted language</span>\n","      <span class=\"code-keyword\">const</span> {\n","        active,\n","        language,\n","        meta,\n","        currentTrackNode\n","      } = <span class=\"code-keyword\">this</span>.captions;\n","      <span class=\"code-keyword\">const</span> languageExists = <span class=\"code-built_in\">Boolean</span>(tracks.find(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> track.language === language));\n","\n","      <span class=\"code-comment\">// Handle tracks (add event listener and \"pseudo\"-default)</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.isVideo) {\n","        tracks.filter(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> !meta.get(track)).forEach(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> {\n","          <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">'Track added'</span>, track);\n","\n","          <span class=\"code-comment\">// Attempt to store if the original dom element was \"default\"</span>\n","          meta.set(track, {\n","            <span class=\"code-keyword\">default</span>: track.mode === <span class=\"code-string\">'showing'</span>\n","          });\n","\n","          <span class=\"code-comment\">// Turn off native caption rendering to avoid double captions</span>\n","          <span class=\"code-comment\">// Note: mode='hidden' forces a track to download. To ensure every track</span>\n","          <span class=\"code-comment\">// isn't downloaded at once, only 'showing' tracks should be reassigned</span>\n","          <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","          <span class=\"code-keyword\">if</span> (track.mode === <span class=\"code-string\">'showing'</span>) {\n","            <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","            track.mode = <span class=\"code-string\">'hidden'</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Add event listener for cue changes</span>\n","          on.call(<span class=\"code-keyword\">this</span>, track, <span class=\"code-string\">'cuechange'</span>, () =&gt; captions.updateCues.call(<span class=\"code-keyword\">this</span>));\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Update language first time it matches, or if the previous matching track was removed</span>\n","      <span class=\"code-keyword\">if</span> (languageExists &amp;&amp; <span class=\"code-keyword\">this</span>.language !== language || !tracks.includes(currentTrackNode)) {\n","        captions.setLanguage.call(<span class=\"code-keyword\">this</span>, language);\n","        captions.toggle.call(<span class=\"code-keyword\">this</span>, active &amp;&amp; languageExists);\n","      }\n","\n","      <span class=\"code-comment\">// Enable or disable captions based on track length</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements) {\n","        toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.captions.enabled, !is.empty(tracks));\n","      }\n","\n","      <span class=\"code-comment\">// Update available languages in list</span>\n","      <span class=\"code-keyword\">if</span> (is.array(<span class=\"code-keyword\">this</span>.config.controls) &amp;&amp; <span class=\"code-keyword\">this</span>.config.controls.includes(<span class=\"code-string\">'settings'</span>) &amp;&amp; <span class=\"code-keyword\">this</span>.config.settings.includes(<span class=\"code-string\">'captions'</span>)) {\n","        controls.setCaptionsMenu.call(<span class=\"code-keyword\">this</span>);\n","      }\n","    },\n","    <span class=\"code-comment\">// Toggle captions display</span>\n","    <span class=\"code-comment\">// Used internally for the toggleCaptions method, with the passive option forced to false</span>\n","    toggle(input, passive = <span class=\"code-literal\">true</span>) {\n","      <span class=\"code-comment\">// If there's no full support</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> {\n","        toggled\n","      } = <span class=\"code-keyword\">this</span>.captions; <span class=\"code-comment\">// Current state</span>\n","      <span class=\"code-keyword\">const</span> activeClass = <span class=\"code-keyword\">this</span>.config.classNames.captions.active;\n","      <span class=\"code-comment\">// Get the next state</span>\n","      <span class=\"code-comment\">// If the method is called without parameter, toggle based on current value</span>\n","      <span class=\"code-keyword\">const</span> active = is.nullOrUndefined(input) ? !toggled : input;\n","\n","      <span class=\"code-comment\">// Update state and trigger event</span>\n","      <span class=\"code-keyword\">if</span> (active !== toggled) {\n","        <span class=\"code-comment\">// When passive, don't override user preferences</span>\n","        <span class=\"code-keyword\">if</span> (!passive) {\n","          <span class=\"code-keyword\">this</span>.captions.active = active;\n","          <span class=\"code-keyword\">this</span>.storage.set({\n","            captions: active\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Force language if the call isn't passive and there is no matching language to toggle to</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.language &amp;&amp; active &amp;&amp; !passive) {\n","          <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>);\n","          <span class=\"code-keyword\">const</span> track = captions.findTrack.call(<span class=\"code-keyword\">this</span>, [<span class=\"code-keyword\">this</span>.captions.language, ...this.captions.languages], <span class=\"code-literal\">true</span>);\n","\n","          <span class=\"code-comment\">// Override user preferences to avoid switching languages if a matching track is added</span>\n","          <span class=\"code-keyword\">this</span>.captions.language = track.language;\n","\n","          <span class=\"code-comment\">// Set caption, but don't store in localStorage as user preference</span>\n","          captions.set.call(<span class=\"code-keyword\">this</span>, tracks.indexOf(track));\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Toggle button if it's enabled</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements.buttons.captions) {\n","          <span class=\"code-keyword\">this</span>.elements.buttons.captions.pressed = active;\n","        }\n","\n","        <span class=\"code-comment\">// Add class hook</span>\n","        toggleClass(<span class=\"code-keyword\">this</span>.elements.container, activeClass, active);\n","        <span class=\"code-keyword\">this</span>.captions.toggled = active;\n","\n","        <span class=\"code-comment\">// Update settings menu</span>\n","        controls.updateSetting.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'captions'</span>);\n","\n","        <span class=\"code-comment\">// Trigger event (not used internally)</span>\n","        triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, active ? <span class=\"code-string\">'captionsenabled'</span> : <span class=\"code-string\">'captionsdisabled'</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Wait for the call stack to clear before setting mode='hidden'</span>\n","      <span class=\"code-comment\">// on the active track - forcing the browser to download it</span>\n","      setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (active &amp;&amp; <span class=\"code-keyword\">this</span>.captions.toggled) {\n","          <span class=\"code-keyword\">this</span>.captions.currentTrackNode.mode = <span class=\"code-string\">'hidden'</span>;\n","        }\n","      });\n","    },\n","    <span class=\"code-comment\">// Set captions by track index</span>\n","    <span class=\"code-comment\">// Used internally for the currentTrack setter with the passive option forced to false</span>\n","    <span class=\"code-keyword\">set</span>(index, passive = true) {\n","      <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Disable captions if setting to -1</span>\n","      <span class=\"code-keyword\">if</span> (index === <span class=\"code-number\">-1</span>) {\n","        captions.toggle.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">false</span>, passive);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (!is.number(index)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Invalid caption argument'</span>, index);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (!(index <span class=\"code-keyword\">in</span> tracks)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Track not found'</span>, index);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.captions.currentTrack !== index) {\n","        <span class=\"code-keyword\">this</span>.captions.currentTrack = index;\n","        <span class=\"code-keyword\">const</span> track = tracks[index];\n","        <span class=\"code-keyword\">const</span> {\n","          language\n","        } = track || {};\n","\n","        <span class=\"code-comment\">// Store reference to node for invalidation on remove</span>\n","        <span class=\"code-keyword\">this</span>.captions.currentTrackNode = track;\n","\n","        <span class=\"code-comment\">// Update settings menu</span>\n","        controls.updateSetting.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'captions'</span>);\n","\n","        <span class=\"code-comment\">// When passive, don't override user preferences</span>\n","        <span class=\"code-keyword\">if</span> (!passive) {\n","          <span class=\"code-keyword\">this</span>.captions.language = language;\n","          <span class=\"code-keyword\">this</span>.storage.set({\n","            language\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Handle Vimeo captions</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo) {\n","          <span class=\"code-keyword\">this</span>.embed.enableTextTrack(language);\n","        }\n","\n","        <span class=\"code-comment\">// Trigger event</span>\n","        triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, <span class=\"code-string\">'languagechange'</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Show captions</span>\n","      captions.toggle.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">true</span>, passive);\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-comment\">// If we change the active track while a cue is already displayed we need to update it</span>\n","        captions.updateCues.call(<span class=\"code-keyword\">this</span>);\n","      }\n","    },\n","    <span class=\"code-comment\">// Set captions by language</span>\n","    <span class=\"code-comment\">// Used internally for the language setter with the passive option forced to false</span>\n","    setLanguage(input, passive = <span class=\"code-literal\">true</span>) {\n","      <span class=\"code-keyword\">if</span> (!is.string(input)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Invalid language argument'</span>, input);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-comment\">// Normalize</span>\n","      <span class=\"code-keyword\">const</span> language = input.toLowerCase();\n","      <span class=\"code-keyword\">this</span>.captions.language = language;\n","\n","      <span class=\"code-comment\">// Set currentTrack</span>\n","      <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">const</span> track = captions.findTrack.call(<span class=\"code-keyword\">this</span>, [language]);\n","      captions.set.call(<span class=\"code-keyword\">this</span>, tracks.indexOf(track), passive);\n","    },\n","    <span class=\"code-comment\">// Get current valid caption tracks</span>\n","    <span class=\"code-comment\">// If update is false it will also ignore tracks without metadata</span>\n","    <span class=\"code-comment\">// This is used to \"freeze\" the language options when captions.update is false</span>\n","    getTracks(update = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-comment\">// Handle media or textTracks missing or null</span>\n","      <span class=\"code-keyword\">const</span> tracks = <span class=\"code-built_in\">Array</span>.from((<span class=\"code-keyword\">this</span>.media || {}).textTracks || []);\n","      <span class=\"code-comment\">// For HTML5, use cache instead of current tracks when it exists (if captions.update is false)</span>\n","      <span class=\"code-comment\">// Filter out removed tracks and tracks that aren't captions/subtitles (for example metadata)</span>\n","      <span class=\"code-keyword\">return</span> tracks.filter(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> !<span class=\"code-keyword\">this</span>.isHTML5 || update || <span class=\"code-keyword\">this</span>.captions.meta.has(track)).filter(<span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> [<span class=\"code-string\">'captions'</span>, <span class=\"code-string\">'subtitles'</span>].includes(track.kind));\n","    },\n","    <span class=\"code-comment\">// Match tracks based on languages and get the first</span>\n","    findTrack(languages, force = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-keyword\">const</span> tracks = captions.getTracks.call(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">const</span> sortIsDefault = <span class=\"code-function\"><span class=\"code-params\">track</span> =&gt;</span> <span class=\"code-built_in\">Number</span>((<span class=\"code-keyword\">this</span>.captions.meta.get(track) || {}).default);\n","      <span class=\"code-keyword\">const</span> sorted = <span class=\"code-built_in\">Array</span>.from(tracks).sort(<span class=\"code-function\">(<span class=\"code-params\">a, b</span>) =&gt;</span> sortIsDefault(b) - sortIsDefault(a));\n","      <span class=\"code-keyword\">let</span> track;\n","      languages.every(<span class=\"code-function\"><span class=\"code-params\">language</span> =&gt;</span> {\n","        track = sorted.find(<span class=\"code-function\"><span class=\"code-params\">t</span> =&gt;</span> t.language === language);\n","        <span class=\"code-keyword\">return</span> !track; <span class=\"code-comment\">// Break iteration if there is a match</span>\n","      });\n","\n","      <span class=\"code-comment\">// If no match is found but is required, get first</span>\n","      <span class=\"code-keyword\">return</span> track || (force ? sorted[<span class=\"code-number\">0</span>] : <span class=\"code-literal\">undefined</span>);\n","    },\n","    <span class=\"code-comment\">// Get the current track</span>\n","    getCurrentTrack() {\n","      <span class=\"code-keyword\">return</span> captions.getTracks.call(<span class=\"code-keyword\">this</span>)[<span class=\"code-keyword\">this</span>.currentTrack];\n","    },\n","    <span class=\"code-comment\">// Get UI label for track</span>\n","    getLabel(track) {\n","      <span class=\"code-keyword\">let</span> currentTrack = track;\n","      <span class=\"code-keyword\">if</span> (!is.track(currentTrack) &amp;&amp; support.textTracks &amp;&amp; <span class=\"code-keyword\">this</span>.captions.toggled) {\n","        currentTrack = captions.getCurrentTrack.call(<span class=\"code-keyword\">this</span>);\n","      }\n","      <span class=\"code-keyword\">if</span> (is.track(currentTrack)) {\n","        <span class=\"code-keyword\">if</span> (!is.empty(currentTrack.label)) {\n","          <span class=\"code-keyword\">return</span> currentTrack.label;\n","        }\n","        <span class=\"code-keyword\">if</span> (!is.empty(currentTrack.language)) {\n","          <span class=\"code-keyword\">return</span> track.language.toUpperCase();\n","        }\n","        <span class=\"code-keyword\">return</span> i18n.get(<span class=\"code-string\">'enabled'</span>, <span class=\"code-keyword\">this</span>.config);\n","      }\n","      <span class=\"code-keyword\">return</span> i18n.get(<span class=\"code-string\">'disabled'</span>, <span class=\"code-keyword\">this</span>.config);\n","    },\n","    <span class=\"code-comment\">// Update captions using current track's active cues</span>\n","    <span class=\"code-comment\">// Also optional array argument in case there isn't any track (ex: vimeo)</span>\n","    updateCues(input) {\n","      <span class=\"code-comment\">// Requires UI</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.captions)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'No captions element to render to'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Only accept array or empty input</span>\n","      <span class=\"code-keyword\">if</span> (!is.nullOrUndefined(input) &amp;&amp; !<span class=\"code-built_in\">Array</span>.isArray(input)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'updateCues: Invalid input'</span>, input);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">let</span> cues = input;\n","\n","      <span class=\"code-comment\">// Get cues from track</span>\n","      <span class=\"code-keyword\">if</span> (!cues) {\n","        <span class=\"code-keyword\">const</span> track = captions.getCurrentTrack.call(<span class=\"code-keyword\">this</span>);\n","        cues = <span class=\"code-built_in\">Array</span>.from((track || {}).activeCues || []).map(<span class=\"code-function\"><span class=\"code-params\">cue</span> =&gt;</span> cue.getCueAsHTML()).map(getHTML);\n","      }\n","\n","      <span class=\"code-comment\">// Set new caption text</span>\n","      <span class=\"code-keyword\">const</span> content = cues.map(<span class=\"code-function\"><span class=\"code-params\">cueText</span> =&gt;</span> cueText.trim()).join(<span class=\"code-string\">'\\n'</span>);\n","      <span class=\"code-keyword\">const</span> changed = content !== <span class=\"code-keyword\">this</span>.elements.captions.innerHTML;\n","      <span class=\"code-keyword\">if</span> (changed) {\n","        <span class=\"code-comment\">// Empty the container and create a new child element</span>\n","        emptyElement(<span class=\"code-keyword\">this</span>.elements.captions);\n","        <span class=\"code-keyword\">const</span> caption = createElement(<span class=\"code-string\">'span'</span>, getAttributesFromSelector(<span class=\"code-keyword\">this</span>.config.selectors.caption));\n","        caption.innerHTML = content;\n","        <span class=\"code-keyword\">this</span>.elements.captions.appendChild(caption);\n","\n","        <span class=\"code-comment\">// Trigger event</span>\n","        triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, <span class=\"code-string\">'cuechange'</span>);\n","      }\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Plyr default config</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> defaults = {\n","    <span class=\"code-comment\">// Disable</span>\n","    enabled: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Custom media title</span>\n","    title: <span class=\"code-string\">''</span>,\n","    <span class=\"code-comment\">// Logging to console</span>\n","    debug: <span class=\"code-literal\">false</span>,\n","    <span class=\"code-comment\">// Auto play (if supported)</span>\n","    autoplay: <span class=\"code-literal\">false</span>,\n","    <span class=\"code-comment\">// Only allow one media playing at once (vimeo only)</span>\n","    autopause: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Allow inline playback on iOS</span>\n","    playsinline: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Default time to skip when rewind/fast forward</span>\n","    seekTime: <span class=\"code-number\">10</span>,\n","    <span class=\"code-comment\">// Default volume</span>\n","    volume: <span class=\"code-number\">1</span>,\n","    muted: <span class=\"code-literal\">false</span>,\n","    <span class=\"code-comment\">// Pass a custom duration</span>\n","    duration: <span class=\"code-literal\">null</span>,\n","    <span class=\"code-comment\">// Display the media duration on load in the current time position</span>\n","    <span class=\"code-comment\">// If you have opted to display both duration and currentTime, this is ignored</span>\n","    displayDuration: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Invert the current time to be a countdown</span>\n","    invertTime: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Clicking the currentTime inverts it's value to show time left rather than elapsed</span>\n","    toggleInvert: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Force an aspect ratio</span>\n","    <span class=\"code-comment\">// The format must be `'w:h'` (e.g. `'16:9'`)</span>\n","    ratio: <span class=\"code-literal\">null</span>,\n","    <span class=\"code-comment\">// Click video container to play/pause</span>\n","    clickToPlay: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Auto hide the controls</span>\n","    hideControls: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Reset to start when playback ended</span>\n","    resetOnEnd: <span class=\"code-literal\">false</span>,\n","    <span class=\"code-comment\">// Disable the standard context menu</span>\n","    disableContextMenu: <span class=\"code-literal\">true</span>,\n","    <span class=\"code-comment\">// Sprite (for icons)</span>\n","    loadSprite: <span class=\"code-literal\">true</span>,\n","    iconPrefix: <span class=\"code-string\">'plyr'</span>,\n","    iconUrl: <span class=\"code-string\">'https://cdn.plyr.io/3.7.8/plyr.svg'</span>,\n","    <span class=\"code-comment\">// Blank video (used to prevent errors on source change)</span>\n","    blankVideo: <span class=\"code-string\">'https://cdn.plyr.io/static/blank.mp4'</span>,\n","    <span class=\"code-comment\">// Quality default</span>\n","    quality: {\n","      <span class=\"code-keyword\">default</span>: <span class=\"code-number\">576</span>,\n","      <span class=\"code-comment\">// The options to display in the UI, if available for the source media</span>\n","      options: [<span class=\"code-number\">4320</span>, <span class=\"code-number\">2880</span>, <span class=\"code-number\">2160</span>, <span class=\"code-number\">1440</span>, <span class=\"code-number\">1080</span>, <span class=\"code-number\">720</span>, <span class=\"code-number\">576</span>, <span class=\"code-number\">480</span>, <span class=\"code-number\">360</span>, <span class=\"code-number\">240</span>],\n","      forced: <span class=\"code-literal\">false</span>,\n","      onChange: <span class=\"code-literal\">null</span>\n","    },\n","    <span class=\"code-comment\">// Set loops</span>\n","    loop: {\n","      active: <span class=\"code-literal\">false</span>\n","      <span class=\"code-comment\">// start: null,</span>\n","      <span class=\"code-comment\">// end: null,</span>\n","    },\n","\n","    <span class=\"code-comment\">// Speed default and options to display</span>\n","    speed: {\n","      selected: <span class=\"code-number\">1</span>,\n","      <span class=\"code-comment\">// The options to display in the UI, if available for the source media (e.g. Vimeo and YouTube only support 0.5x-4x)</span>\n","      options: [<span class=\"code-number\">0.5</span>, <span class=\"code-number\">0.75</span>, <span class=\"code-number\">1</span>, <span class=\"code-number\">1.25</span>, <span class=\"code-number\">1.5</span>, <span class=\"code-number\">1.75</span>, <span class=\"code-number\">2</span>, <span class=\"code-number\">4</span>]\n","    },\n","    <span class=\"code-comment\">// Keyboard shortcut settings</span>\n","    keyboard: {\n","      focused: <span class=\"code-literal\">true</span>,\n","      global: <span class=\"code-literal\">false</span>\n","    },\n","    <span class=\"code-comment\">// Display tooltips</span>\n","    tooltips: {\n","      controls: <span class=\"code-literal\">false</span>,\n","      seek: <span class=\"code-literal\">true</span>\n","    },\n","    <span class=\"code-comment\">// Captions settings</span>\n","    captions: {\n","      active: <span class=\"code-literal\">false</span>,\n","      language: <span class=\"code-string\">'auto'</span>,\n","      <span class=\"code-comment\">// Listen to new tracks added after Plyr is initialized.</span>\n","      <span class=\"code-comment\">// This is needed for streaming captions, but may result in unselectable options</span>\n","      update: <span class=\"code-literal\">false</span>\n","    },\n","    <span class=\"code-comment\">// Fullscreen settings</span>\n","    fullscreen: {\n","      enabled: <span class=\"code-literal\">true</span>,\n","      <span class=\"code-comment\">// Allow fullscreen?</span>\n","      fallback: <span class=\"code-literal\">true</span>,\n","      <span class=\"code-comment\">// Fallback using full viewport/window</span>\n","      iosNative: <span class=\"code-literal\">false</span> <span class=\"code-comment\">// Use the native fullscreen in iOS (disables custom controls)</span>\n","      <span class=\"code-comment\">// Selector for the fullscreen container so contextual / non-player content can remain visible in fullscreen mode</span>\n","      <span class=\"code-comment\">// Non-ancestors of the player element will be ignored</span>\n","      <span class=\"code-comment\">// container: null, // defaults to the player element</span>\n","    },\n","\n","    <span class=\"code-comment\">// Local storage</span>\n","    storage: {\n","      enabled: <span class=\"code-literal\">true</span>,\n","      key: <span class=\"code-string\">'plyr'</span>\n","    },\n","    <span class=\"code-comment\">// Default controls</span>\n","    controls: [<span class=\"code-string\">'play-large'</span>,\n","    <span class=\"code-comment\">// 'restart',</span>\n","    <span class=\"code-comment\">// 'rewind',</span>\n","    <span class=\"code-string\">'play'</span>,\n","    <span class=\"code-comment\">// 'fast-forward',</span>\n","    <span class=\"code-string\">'progress'</span>, <span class=\"code-string\">'current-time'</span>,\n","    <span class=\"code-comment\">// 'duration',</span>\n","    <span class=\"code-string\">'mute'</span>, <span class=\"code-string\">'volume'</span>, <span class=\"code-string\">'captions'</span>, <span class=\"code-string\">'settings'</span>, <span class=\"code-string\">'pip'</span>, <span class=\"code-string\">'airplay'</span>,\n","    <span class=\"code-comment\">// 'download',</span>\n","    <span class=\"code-string\">'fullscreen'</span>],\n","    settings: [<span class=\"code-string\">'captions'</span>, <span class=\"code-string\">'quality'</span>, <span class=\"code-string\">'speed'</span>],\n","    <span class=\"code-comment\">// Localisation</span>\n","    i18n: {\n","      restart: <span class=\"code-string\">'Restart'</span>,\n","      rewind: <span class=\"code-string\">'Rewind {seektime}s'</span>,\n","      play: <span class=\"code-string\">'Play'</span>,\n","      pause: <span class=\"code-string\">'Pause'</span>,\n","      fastForward: <span class=\"code-string\">'Forward {seektime}s'</span>,\n","      seek: <span class=\"code-string\">'Seek'</span>,\n","      seekLabel: <span class=\"code-string\">'{currentTime} of {duration}'</span>,\n","      played: <span class=\"code-string\">'Played'</span>,\n","      buffered: <span class=\"code-string\">'Buffered'</span>,\n","      currentTime: <span class=\"code-string\">'Current time'</span>,\n","      duration: <span class=\"code-string\">'Duration'</span>,\n","      volume: <span class=\"code-string\">'Volume'</span>,\n","      mute: <span class=\"code-string\">'Mute'</span>,\n","      unmute: <span class=\"code-string\">'Unmute'</span>,\n","      enableCaptions: <span class=\"code-string\">'Enable captions'</span>,\n","      disableCaptions: <span class=\"code-string\">'Disable captions'</span>,\n","      download: <span class=\"code-string\">'Download'</span>,\n","      enterFullscreen: <span class=\"code-string\">'Enter fullscreen'</span>,\n","      exitFullscreen: <span class=\"code-string\">'Exit fullscreen'</span>,\n","      frameTitle: <span class=\"code-string\">'Player for {title}'</span>,\n","      captions: <span class=\"code-string\">'Captions'</span>,\n","      settings: <span class=\"code-string\">'Settings'</span>,\n","      pip: <span class=\"code-string\">'PIP'</span>,\n","      menuBack: <span class=\"code-string\">'Go back to previous menu'</span>,\n","      speed: <span class=\"code-string\">'Speed'</span>,\n","      normal: <span class=\"code-string\">'Normal'</span>,\n","      quality: <span class=\"code-string\">'Quality'</span>,\n","      loop: <span class=\"code-string\">'Loop'</span>,\n","      start: <span class=\"code-string\">'Start'</span>,\n","      end: <span class=\"code-string\">'End'</span>,\n","      all: <span class=\"code-string\">'All'</span>,\n","      reset: <span class=\"code-string\">'Reset'</span>,\n","      disabled: <span class=\"code-string\">'Disabled'</span>,\n","      enabled: <span class=\"code-string\">'Enabled'</span>,\n","      advertisement: <span class=\"code-string\">'Ad'</span>,\n","      qualityBadge: {\n","        <span class=\"code-number\">2160</span>: <span class=\"code-string\">'4K'</span>,\n","        <span class=\"code-number\">1440</span>: <span class=\"code-string\">'HD'</span>,\n","        <span class=\"code-number\">1080</span>: <span class=\"code-string\">'HD'</span>,\n","        <span class=\"code-number\">720</span>: <span class=\"code-string\">'HD'</span>,\n","        <span class=\"code-number\">576</span>: <span class=\"code-string\">'SD'</span>,\n","        <span class=\"code-number\">480</span>: <span class=\"code-string\">'SD'</span>\n","      }\n","    },\n","    <span class=\"code-comment\">// URLs</span>\n","    urls: {\n","      download: <span class=\"code-literal\">null</span>,\n","      vimeo: {\n","        sdk: <span class=\"code-string\">'https://player.vimeo.com/api/player.js'</span>,\n","        iframe: <span class=\"code-string\">'https://player.vimeo.com/video/{0}?{1}'</span>,\n","        api: <span class=\"code-string\">'https://vimeo.com/api/oembed.json?url={0}'</span>\n","      },\n","      youtube: {\n","        sdk: <span class=\"code-string\">'https://www.youtube.com/iframe_api'</span>,\n","        api: <span class=\"code-string\">'https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}'</span>\n","      },\n","      googleIMA: {\n","        sdk: <span class=\"code-string\">'https://imasdk.googleapis.com/js/sdkloader/ima3.js'</span>\n","      }\n","    },\n","    <span class=\"code-comment\">// Custom control listeners</span>\n","    listeners: {\n","      seek: <span class=\"code-literal\">null</span>,\n","      play: <span class=\"code-literal\">null</span>,\n","      pause: <span class=\"code-literal\">null</span>,\n","      restart: <span class=\"code-literal\">null</span>,\n","      rewind: <span class=\"code-literal\">null</span>,\n","      fastForward: <span class=\"code-literal\">null</span>,\n","      mute: <span class=\"code-literal\">null</span>,\n","      volume: <span class=\"code-literal\">null</span>,\n","      captions: <span class=\"code-literal\">null</span>,\n","      download: <span class=\"code-literal\">null</span>,\n","      fullscreen: <span class=\"code-literal\">null</span>,\n","      pip: <span class=\"code-literal\">null</span>,\n","      airplay: <span class=\"code-literal\">null</span>,\n","      speed: <span class=\"code-literal\">null</span>,\n","      quality: <span class=\"code-literal\">null</span>,\n","      loop: <span class=\"code-literal\">null</span>,\n","      language: <span class=\"code-literal\">null</span>\n","    },\n","    <span class=\"code-comment\">// Events to watch and bubble</span>\n","    events: [\n","    <span class=\"code-comment\">// Events to watch on HTML5 media elements and bubble</span>\n","    <span class=\"code-comment\">// https://developer.mozilla.org/en/docs/Web/Guide/Events/Media_events</span>\n","    <span class=\"code-string\">'ended'</span>, <span class=\"code-string\">'progress'</span>, <span class=\"code-string\">'stalled'</span>, <span class=\"code-string\">'playing'</span>, <span class=\"code-string\">'waiting'</span>, <span class=\"code-string\">'canplay'</span>, <span class=\"code-string\">'canplaythrough'</span>, <span class=\"code-string\">'loadstart'</span>, <span class=\"code-string\">'loadeddata'</span>, <span class=\"code-string\">'loadedmetadata'</span>, <span class=\"code-string\">'timeupdate'</span>, <span class=\"code-string\">'volumechange'</span>, <span class=\"code-string\">'play'</span>, <span class=\"code-string\">'pause'</span>, <span class=\"code-string\">'error'</span>, <span class=\"code-string\">'seeking'</span>, <span class=\"code-string\">'seeked'</span>, <span class=\"code-string\">'emptied'</span>, <span class=\"code-string\">'ratechange'</span>, <span class=\"code-string\">'cuechange'</span>,\n","    <span class=\"code-comment\">// Custom events</span>\n","    <span class=\"code-string\">'download'</span>, <span class=\"code-string\">'enterfullscreen'</span>, <span class=\"code-string\">'exitfullscreen'</span>, <span class=\"code-string\">'captionsenabled'</span>, <span class=\"code-string\">'captionsdisabled'</span>, <span class=\"code-string\">'languagechange'</span>, <span class=\"code-string\">'controlshidden'</span>, <span class=\"code-string\">'controlsshown'</span>, <span class=\"code-string\">'ready'</span>,\n","    <span class=\"code-comment\">// YouTube</span>\n","    <span class=\"code-string\">'statechange'</span>,\n","    <span class=\"code-comment\">// Quality</span>\n","    <span class=\"code-string\">'qualitychange'</span>,\n","    <span class=\"code-comment\">// Ads</span>\n","    <span class=\"code-string\">'adsloaded'</span>, <span class=\"code-string\">'adscontentpause'</span>, <span class=\"code-string\">'adscontentresume'</span>, <span class=\"code-string\">'adstarted'</span>, <span class=\"code-string\">'adsmidpoint'</span>, <span class=\"code-string\">'adscomplete'</span>, <span class=\"code-string\">'adsallcomplete'</span>, <span class=\"code-string\">'adsimpression'</span>, <span class=\"code-string\">'adsclick'</span>],\n","    <span class=\"code-comment\">// Selectors</span>\n","    <span class=\"code-comment\">// Change these to match your template if using custom HTML</span>\n","    selectors: {\n","      editable: <span class=\"code-string\">'input, textarea, select, [contenteditable]'</span>,\n","      container: <span class=\"code-string\">'.plyr'</span>,\n","      controls: {\n","        container: <span class=\"code-literal\">null</span>,\n","        wrapper: <span class=\"code-string\">'.plyr__controls'</span>\n","      },\n","      labels: <span class=\"code-string\">'[data-plyr]'</span>,\n","      buttons: {\n","        play: <span class=\"code-string\">'[data-plyr=\"play\"]'</span>,\n","        pause: <span class=\"code-string\">'[data-plyr=\"pause\"]'</span>,\n","        restart: <span class=\"code-string\">'[data-plyr=\"restart\"]'</span>,\n","        rewind: <span class=\"code-string\">'[data-plyr=\"rewind\"]'</span>,\n","        fastForward: <span class=\"code-string\">'[data-plyr=\"fast-forward\"]'</span>,\n","        mute: <span class=\"code-string\">'[data-plyr=\"mute\"]'</span>,\n","        captions: <span class=\"code-string\">'[data-plyr=\"captions\"]'</span>,\n","        download: <span class=\"code-string\">'[data-plyr=\"download\"]'</span>,\n","        fullscreen: <span class=\"code-string\">'[data-plyr=\"fullscreen\"]'</span>,\n","        pip: <span class=\"code-string\">'[data-plyr=\"pip\"]'</span>,\n","        airplay: <span class=\"code-string\">'[data-plyr=\"airplay\"]'</span>,\n","        settings: <span class=\"code-string\">'[data-plyr=\"settings\"]'</span>,\n","        loop: <span class=\"code-string\">'[data-plyr=\"loop\"]'</span>\n","      },\n","      inputs: {\n","        seek: <span class=\"code-string\">'[data-plyr=\"seek\"]'</span>,\n","        volume: <span class=\"code-string\">'[data-plyr=\"volume\"]'</span>,\n","        speed: <span class=\"code-string\">'[data-plyr=\"speed\"]'</span>,\n","        language: <span class=\"code-string\">'[data-plyr=\"language\"]'</span>,\n","        quality: <span class=\"code-string\">'[data-plyr=\"quality\"]'</span>\n","      },\n","      display: {\n","        currentTime: <span class=\"code-string\">'.plyr__time--current'</span>,\n","        duration: <span class=\"code-string\">'.plyr__time--duration'</span>,\n","        buffer: <span class=\"code-string\">'.plyr__progress__buffer'</span>,\n","        loop: <span class=\"code-string\">'.plyr__progress__loop'</span>,\n","        <span class=\"code-comment\">// Used later</span>\n","        volume: <span class=\"code-string\">'.plyr__volume--display'</span>\n","      },\n","      progress: <span class=\"code-string\">'.plyr__progress'</span>,\n","      captions: <span class=\"code-string\">'.plyr__captions'</span>,\n","      caption: <span class=\"code-string\">'.plyr__caption'</span>\n","    },\n","    <span class=\"code-comment\">// Class hooks added to the player in different states</span>\n","    classNames: {\n","      type: <span class=\"code-string\">'plyr--{0}'</span>,\n","      provider: <span class=\"code-string\">'plyr--{0}'</span>,\n","      video: <span class=\"code-string\">'plyr__video-wrapper'</span>,\n","      embed: <span class=\"code-string\">'plyr__video-embed'</span>,\n","      videoFixedRatio: <span class=\"code-string\">'plyr__video-wrapper--fixed-ratio'</span>,\n","      embedContainer: <span class=\"code-string\">'plyr__video-embed__container'</span>,\n","      poster: <span class=\"code-string\">'plyr__poster'</span>,\n","      posterEnabled: <span class=\"code-string\">'plyr__poster-enabled'</span>,\n","      ads: <span class=\"code-string\">'plyr__ads'</span>,\n","      control: <span class=\"code-string\">'plyr__control'</span>,\n","      controlPressed: <span class=\"code-string\">'plyr__control--pressed'</span>,\n","      playing: <span class=\"code-string\">'plyr--playing'</span>,\n","      paused: <span class=\"code-string\">'plyr--paused'</span>,\n","      stopped: <span class=\"code-string\">'plyr--stopped'</span>,\n","      loading: <span class=\"code-string\">'plyr--loading'</span>,\n","      hover: <span class=\"code-string\">'plyr--hover'</span>,\n","      tooltip: <span class=\"code-string\">'plyr__tooltip'</span>,\n","      cues: <span class=\"code-string\">'plyr__cues'</span>,\n","      marker: <span class=\"code-string\">'plyr__progress__marker'</span>,\n","      hidden: <span class=\"code-string\">'plyr__sr-only'</span>,\n","      hideControls: <span class=\"code-string\">'plyr--hide-controls'</span>,\n","      isTouch: <span class=\"code-string\">'plyr--is-touch'</span>,\n","      uiSupported: <span class=\"code-string\">'plyr--full-ui'</span>,\n","      noTransition: <span class=\"code-string\">'plyr--no-transition'</span>,\n","      display: {\n","        time: <span class=\"code-string\">'plyr__time'</span>\n","      },\n","      menu: {\n","        value: <span class=\"code-string\">'plyr__menu__value'</span>,\n","        badge: <span class=\"code-string\">'plyr__badge'</span>,\n","        open: <span class=\"code-string\">'plyr--menu-open'</span>\n","      },\n","      captions: {\n","        enabled: <span class=\"code-string\">'plyr--captions-enabled'</span>,\n","        active: <span class=\"code-string\">'plyr--captions-active'</span>\n","      },\n","      fullscreen: {\n","        enabled: <span class=\"code-string\">'plyr--fullscreen-enabled'</span>,\n","        fallback: <span class=\"code-string\">'plyr--fullscreen-fallback'</span>\n","      },\n","      pip: {\n","        supported: <span class=\"code-string\">'plyr--pip-supported'</span>,\n","        active: <span class=\"code-string\">'plyr--pip-active'</span>\n","      },\n","      airplay: {\n","        supported: <span class=\"code-string\">'plyr--airplay-supported'</span>,\n","        active: <span class=\"code-string\">'plyr--airplay-active'</span>\n","      },\n","      previewThumbnails: {\n","        <span class=\"code-comment\">// Tooltip thumbs</span>\n","        thumbContainer: <span class=\"code-string\">'plyr__preview-thumb'</span>,\n","        thumbContainerShown: <span class=\"code-string\">'plyr__preview-thumb--is-shown'</span>,\n","        imageContainer: <span class=\"code-string\">'plyr__preview-thumb__image-container'</span>,\n","        timeContainer: <span class=\"code-string\">'plyr__preview-thumb__time-container'</span>,\n","        <span class=\"code-comment\">// Scrubbing</span>\n","        scrubbingContainer: <span class=\"code-string\">'plyr__preview-scrubbing'</span>,\n","        scrubbingContainerShown: <span class=\"code-string\">'plyr__preview-scrubbing--is-shown'</span>\n","      }\n","    },\n","    <span class=\"code-comment\">// Embed attributes</span>\n","    attributes: {\n","      embed: {\n","        provider: <span class=\"code-string\">'data-plyr-provider'</span>,\n","        id: <span class=\"code-string\">'data-plyr-embed-id'</span>,\n","        hash: <span class=\"code-string\">'data-plyr-embed-hash'</span>\n","      }\n","    },\n","    <span class=\"code-comment\">// Advertisements plugin</span>\n","    <span class=\"code-comment\">// Register for an account here: http://vi.ai/publisher-video-monetization/?aid=plyrio</span>\n","    ads: {\n","      enabled: <span class=\"code-literal\">false</span>,\n","      publisherId: <span class=\"code-string\">''</span>,\n","      tagUrl: <span class=\"code-string\">''</span>\n","    },\n","    <span class=\"code-comment\">// Preview Thumbnails plugin</span>\n","    previewThumbnails: {\n","      enabled: <span class=\"code-literal\">false</span>,\n","      src: <span class=\"code-string\">''</span>\n","    },\n","    <span class=\"code-comment\">// Vimeo plugin</span>\n","    vimeo: {\n","      byline: <span class=\"code-literal\">false</span>,\n","      portrait: <span class=\"code-literal\">false</span>,\n","      title: <span class=\"code-literal\">false</span>,\n","      speed: <span class=\"code-literal\">true</span>,\n","      transparent: <span class=\"code-literal\">false</span>,\n","      <span class=\"code-comment\">// Custom settings from Plyr</span>\n","      customControls: <span class=\"code-literal\">true</span>,\n","      referrerPolicy: <span class=\"code-literal\">null</span>,\n","      <span class=\"code-comment\">// https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy</span>\n","      <span class=\"code-comment\">// Whether the owner of the video has a Pro or Business account</span>\n","      <span class=\"code-comment\">// (which allows us to properly hide controls without CSS hacks, etc)</span>\n","      premium: <span class=\"code-literal\">false</span>\n","    },\n","    <span class=\"code-comment\">// YouTube plugin</span>\n","    youtube: {\n","      rel: <span class=\"code-number\">0</span>,\n","      <span class=\"code-comment\">// No related vids</span>\n","      showinfo: <span class=\"code-number\">0</span>,\n","      <span class=\"code-comment\">// Hide info</span>\n","      iv_load_policy: <span class=\"code-number\">3</span>,\n","      <span class=\"code-comment\">// Hide annotations</span>\n","      modestbranding: <span class=\"code-number\">1</span>,\n","      <span class=\"code-comment\">// Hide logos as much as possible (they still show one in the corner when paused)</span>\n","      <span class=\"code-comment\">// Custom settings from Plyr</span>\n","      customControls: <span class=\"code-literal\">true</span>,\n","      noCookie: <span class=\"code-literal\">false</span> <span class=\"code-comment\">// Whether to use an alternative version of YouTube without cookies</span>\n","    },\n","\n","    <span class=\"code-comment\">// Media Metadata</span>\n","    mediaMetadata: {\n","      title: <span class=\"code-string\">''</span>,\n","      artist: <span class=\"code-string\">''</span>,\n","      album: <span class=\"code-string\">''</span>,\n","      artwork: []\n","    },\n","    <span class=\"code-comment\">// Markers</span>\n","    markers: {\n","      enabled: <span class=\"code-literal\">false</span>,\n","      points: []\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Plyr states</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> pip = {\n","    active: <span class=\"code-string\">'picture-in-picture'</span>,\n","    inactive: <span class=\"code-string\">'inline'</span>\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Plyr supported types and providers</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> providers = {\n","    html5: <span class=\"code-string\">'html5'</span>,\n","    youtube: <span class=\"code-string\">'youtube'</span>,\n","    vimeo: <span class=\"code-string\">'vimeo'</span>\n","  };\n","  <span class=\"code-keyword\">const</span> types = {\n","    audio: <span class=\"code-string\">'audio'</span>,\n","    video: <span class=\"code-string\">'video'</span>\n","  };\n","\n","  <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">   * Get provider by URL\n</span>","<span class=\"code-comment\">   * @param {String} url\n</span>","<span class=\"code-comment\">   */</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getProviderByUrl</span>(<span class=\"code-params\">url</span>) </span>{\n","    <span class=\"code-comment\">// YouTube</span>\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-regexp\">/^(https?:\\/\\/)?(www\\.)?(youtube\\.com|youtube-nocookie\\.com|youtu\\.?be)\\/.+$/</span>.test(url)) {\n","      <span class=\"code-keyword\">return</span> providers.youtube;\n","    }\n","\n","    <span class=\"code-comment\">// Vimeo</span>\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-regexp\">/^https?:\\/\\/player.vimeo.com\\/video\\/\\d{0,9}(?=\\b|\\/)/</span>.test(url)) {\n","      <span class=\"code-keyword\">return</span> providers.vimeo;\n","    }\n","    <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Console wrapper</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-keyword\">const</span> noop = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {};\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Console</span> </span>{\n","    <span class=\"code-keyword\">constructor</span>(enabled = false) {\n","      <span class=\"code-keyword\">this</span>.enabled = <span class=\"code-built_in\">window</span>.console &amp;&amp; enabled;\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.enabled) {\n","        <span class=\"code-keyword\">this</span>.log(<span class=\"code-string\">'Debugging enabled'</span>);\n","      }\n","    }\n","    <span class=\"code-keyword\">get</span> log() {\n","      <span class=\"code-comment\">// eslint-disable-next-line no-console</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.enabled ? <span class=\"code-built_in\">Function</span>.prototype.bind.call(<span class=\"code-built_in\">console</span>.log, <span class=\"code-built_in\">console</span>) : noop;\n","    }\n","    <span class=\"code-keyword\">get</span> warn() {\n","      <span class=\"code-comment\">// eslint-disable-next-line no-console</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.enabled ? <span class=\"code-built_in\">Function</span>.prototype.bind.call(<span class=\"code-built_in\">console</span>.warn, <span class=\"code-built_in\">console</span>) : noop;\n","    }\n","    <span class=\"code-keyword\">get</span> error() {\n","      <span class=\"code-comment\">// eslint-disable-next-line no-console</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.enabled ? <span class=\"code-built_in\">Function</span>.prototype.bind.call(<span class=\"code-built_in\">console</span>.error, <span class=\"code-built_in\">console</span>) : noop;\n","    }\n","  }\n","\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Fullscreen</span> </span>{\n","    <span class=\"code-keyword\">constructor</span>(player) {\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"onChange\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// Update toggle button</span>\n","        <span class=\"code-keyword\">const</span> button = <span class=\"code-keyword\">this</span>.player.elements.buttons.fullscreen;\n","        <span class=\"code-keyword\">if</span> (is.element(button)) {\n","          button.pressed = <span class=\"code-keyword\">this</span>.active;\n","        }\n","\n","        <span class=\"code-comment\">// Always trigger events on the plyr / media element (not a fullscreen container) and let them bubble up</span>\n","        <span class=\"code-keyword\">const</span> target = <span class=\"code-keyword\">this</span>.target === <span class=\"code-keyword\">this</span>.player.media ? <span class=\"code-keyword\">this</span>.target : <span class=\"code-keyword\">this</span>.player.elements.container;\n","        <span class=\"code-comment\">// Trigger an event</span>\n","        triggerEvent.call(<span class=\"code-keyword\">this</span>.player, target, <span class=\"code-keyword\">this</span>.active ? <span class=\"code-string\">'enterfullscreen'</span> : <span class=\"code-string\">'exitfullscreen'</span>, <span class=\"code-literal\">true</span>);\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"toggleFallback\"</span>, (toggle = <span class=\"code-literal\">false</span>) =&gt; {\n","        <span class=\"code-comment\">// Store or restore scroll position</span>\n","        <span class=\"code-keyword\">if</span> (toggle) {\n","          <span class=\"code-keyword\">this</span>.scrollPosition = {\n","            x: <span class=\"code-built_in\">window</span>.scrollX ?? <span class=\"code-number\">0</span>,\n","            y: <span class=\"code-built_in\">window</span>.scrollY ?? <span class=\"code-number\">0</span>\n","          };\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-built_in\">window</span>.scrollTo(<span class=\"code-keyword\">this</span>.scrollPosition.x, <span class=\"code-keyword\">this</span>.scrollPosition.y);\n","        }\n","\n","        <span class=\"code-comment\">// Toggle scroll</span>\n","        <span class=\"code-built_in\">document</span>.body.style.overflow = toggle ? <span class=\"code-string\">'hidden'</span> : <span class=\"code-string\">''</span>;\n","\n","        <span class=\"code-comment\">// Toggle class hook</span>\n","        toggleClass(<span class=\"code-keyword\">this</span>.target, <span class=\"code-keyword\">this</span>.player.config.classNames.fullscreen.fallback, toggle);\n","\n","        <span class=\"code-comment\">// Force full viewport on iPhone X+</span>\n","        <span class=\"code-keyword\">if</span> (browser.isIos) {\n","          <span class=\"code-keyword\">let</span> viewport = <span class=\"code-built_in\">document</span>.head.querySelector(<span class=\"code-string\">'meta[name=\"viewport\"]'</span>);\n","          <span class=\"code-keyword\">const</span> property = <span class=\"code-string\">'viewport-fit=cover'</span>;\n","\n","          <span class=\"code-comment\">// Inject the viewport meta if required</span>\n","          <span class=\"code-keyword\">if</span> (!viewport) {\n","            viewport = <span class=\"code-built_in\">document</span>.createElement(<span class=\"code-string\">'meta'</span>);\n","            viewport.setAttribute(<span class=\"code-string\">'name'</span>, <span class=\"code-string\">'viewport'</span>);\n","          }\n","\n","          <span class=\"code-comment\">// Check if the property already exists</span>\n","          <span class=\"code-keyword\">const</span> hasProperty = is.string(viewport.content) &amp;&amp; viewport.content.includes(property);\n","          <span class=\"code-keyword\">if</span> (toggle) {\n","            <span class=\"code-keyword\">this</span>.cleanupViewport = !hasProperty;\n","            <span class=\"code-keyword\">if</span> (!hasProperty) viewport.content += <span class=\"code-string\">`,<span class=\"code-subst\">${property}</span>`</span>;\n","          } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.cleanupViewport) {\n","            viewport.content = viewport.content.split(<span class=\"code-string\">','</span>).filter(<span class=\"code-function\"><span class=\"code-params\">part</span> =&gt;</span> part.trim() !== property).join(<span class=\"code-string\">','</span>);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Toggle button and fire events</span>\n","        <span class=\"code-keyword\">this</span>.onChange();\n","      });\n","      <span class=\"code-comment\">// Trap focus inside container</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"trapFocus\"</span>, event =&gt; {\n","        <span class=\"code-comment\">// Bail if iOS/iPadOS, not active, not the tab key</span>\n","        <span class=\"code-keyword\">if</span> (browser.isIos || browser.isIPadOS || !<span class=\"code-keyword\">this</span>.active || event.key !== <span class=\"code-string\">'Tab'</span>) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// Get the current focused element</span>\n","        <span class=\"code-keyword\">const</span> focused = <span class=\"code-built_in\">document</span>.activeElement;\n","        <span class=\"code-keyword\">const</span> focusable = getElements.call(<span class=\"code-keyword\">this</span>.player, <span class=\"code-string\">'a[href], button:not(:disabled), input:not(:disabled), [tabindex]'</span>);\n","        <span class=\"code-keyword\">const</span> [first] = focusable;\n","        <span class=\"code-keyword\">const</span> last = focusable[focusable.length - <span class=\"code-number\">1</span>];\n","        <span class=\"code-keyword\">if</span> (focused === last &amp;&amp; !event.shiftKey) {\n","          <span class=\"code-comment\">// Move focus to first element that can be tabbed if Shift isn't used</span>\n","          first.focus();\n","          event.preventDefault();\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (focused === first &amp;&amp; event.shiftKey) {\n","          <span class=\"code-comment\">// Move focus to last element that can be tabbed if Shift is used</span>\n","          last.focus();\n","          event.preventDefault();\n","        }\n","      });\n","      <span class=\"code-comment\">// Update UI</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"update\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.supported) {\n","          <span class=\"code-keyword\">let</span> mode;\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.forceFallback) mode = <span class=\"code-string\">'Fallback (forced)'</span>;<span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (Fullscreen.nativeSupported) mode = <span class=\"code-string\">'Native'</span>;<span class=\"code-keyword\">else</span> mode = <span class=\"code-string\">'Fallback'</span>;\n","          <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`<span class=\"code-subst\">${mode}</span> fullscreen enabled`</span>);\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">'Fullscreen not supported and fallback disabled'</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Add styling hook to show button</span>\n","        toggleClass(<span class=\"code-keyword\">this</span>.player.elements.container, <span class=\"code-keyword\">this</span>.player.config.classNames.fullscreen.enabled, <span class=\"code-keyword\">this</span>.supported);\n","      });\n","      <span class=\"code-comment\">// Make an element fullscreen</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"enter\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// iOS native fullscreen doesn't need the request step</span>\n","        <span class=\"code-keyword\">if</span> (browser.isIos &amp;&amp; <span class=\"code-keyword\">this</span>.player.config.fullscreen.iosNative) {\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.player.isVimeo) {\n","            <span class=\"code-keyword\">this</span>.player.embed.requestFullscreen();\n","          } <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-keyword\">this</span>.target.webkitEnterFullscreen();\n","          }\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!Fullscreen.nativeSupported || <span class=\"code-keyword\">this</span>.forceFallback) {\n","          <span class=\"code-keyword\">this</span>.toggleFallback(<span class=\"code-literal\">true</span>);\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.prefix) {\n","          <span class=\"code-keyword\">this</span>.target.requestFullscreen({\n","            navigationUI: <span class=\"code-string\">'hide'</span>\n","          });\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.prefix)) {\n","          <span class=\"code-keyword\">this</span>.target[<span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.prefix}</span>Request<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.property}</span>`</span>]();\n","        }\n","      });\n","      <span class=\"code-comment\">// Bail from fullscreen</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"exit\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// iOS native fullscreen</span>\n","        <span class=\"code-keyword\">if</span> (browser.isIos &amp;&amp; <span class=\"code-keyword\">this</span>.player.config.fullscreen.iosNative) {\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.player.isVimeo) {\n","            <span class=\"code-keyword\">this</span>.player.embed.exitFullscreen();\n","          } <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-keyword\">this</span>.target.webkitEnterFullscreen();\n","          }\n","          silencePromise(<span class=\"code-keyword\">this</span>.player.play());\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!Fullscreen.nativeSupported || <span class=\"code-keyword\">this</span>.forceFallback) {\n","          <span class=\"code-keyword\">this</span>.toggleFallback(<span class=\"code-literal\">false</span>);\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.prefix) {\n","          (<span class=\"code-built_in\">document</span>.cancelFullScreen || <span class=\"code-built_in\">document</span>.exitFullscreen).call(<span class=\"code-built_in\">document</span>);\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.prefix)) {\n","          <span class=\"code-keyword\">const</span> action = <span class=\"code-keyword\">this</span>.prefix === <span class=\"code-string\">'moz'</span> ? <span class=\"code-string\">'Cancel'</span> : <span class=\"code-string\">'Exit'</span>;\n","          <span class=\"code-built_in\">document</span>[<span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.prefix}</span><span class=\"code-subst\">${action}</span><span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.property}</span>`</span>]();\n","        }\n","      });\n","      <span class=\"code-comment\">// Toggle state</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"toggle\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.active) <span class=\"code-keyword\">this</span>.enter();<span class=\"code-keyword\">else</span> <span class=\"code-keyword\">this</span>.exit();\n","      });\n","      <span class=\"code-comment\">// Keep reference to parent</span>\n","      <span class=\"code-keyword\">this</span>.player = player;\n","\n","      <span class=\"code-comment\">// Get prefix</span>\n","      <span class=\"code-keyword\">this</span>.prefix = Fullscreen.prefix;\n","      <span class=\"code-keyword\">this</span>.property = Fullscreen.property;\n","\n","      <span class=\"code-comment\">// Scroll position</span>\n","      <span class=\"code-keyword\">this</span>.scrollPosition = {\n","        x: <span class=\"code-number\">0</span>,\n","        y: <span class=\"code-number\">0</span>\n","      };\n","\n","      <span class=\"code-comment\">// Force the use of 'full window/browser' rather than fullscreen</span>\n","      <span class=\"code-keyword\">this</span>.forceFallback = player.config.fullscreen.fallback === <span class=\"code-string\">'force'</span>;\n","\n","      <span class=\"code-comment\">// Get the fullscreen element</span>\n","      <span class=\"code-comment\">// Checks container is an ancestor, defaults to null</span>\n","      <span class=\"code-keyword\">this</span>.player.elements.fullscreen = player.config.fullscreen.container &amp;&amp; closest$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>.player.elements.container, player.config.fullscreen.container);\n","\n","      <span class=\"code-comment\">// Register event listeners</span>\n","      <span class=\"code-comment\">// Handle event (incase user presses escape etc)</span>\n","      on.call(<span class=\"code-keyword\">this</span>.player, <span class=\"code-built_in\">document</span>, <span class=\"code-keyword\">this</span>.prefix === <span class=\"code-string\">'ms'</span> ? <span class=\"code-string\">'MSFullscreenChange'</span> : <span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.prefix}</span>fullscreenchange`</span>, () =&gt; {\n","        <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Filter for target??</span>\n","        <span class=\"code-keyword\">this</span>.onChange();\n","      });\n","\n","      <span class=\"code-comment\">// Fullscreen toggle on double click</span>\n","      on.call(<span class=\"code-keyword\">this</span>.player, <span class=\"code-keyword\">this</span>.player.elements.container, <span class=\"code-string\">'dblclick'</span>, event =&gt; {\n","        <span class=\"code-comment\">// Ignore double click in controls</span>\n","        <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.player.elements.controls) &amp;&amp; <span class=\"code-keyword\">this</span>.player.elements.controls.contains(event.target)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        <span class=\"code-keyword\">this</span>.player.listeners.proxy(event, <span class=\"code-keyword\">this</span>.toggle, <span class=\"code-string\">'fullscreen'</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Tap focus when in fullscreen</span>\n","      on.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.player.elements.container, <span class=\"code-string\">'keydown'</span>, event =&gt; <span class=\"code-keyword\">this</span>.trapFocus(event));\n","\n","      <span class=\"code-comment\">// Update the UI</span>\n","      <span class=\"code-keyword\">this</span>.update();\n","    }\n","\n","    <span class=\"code-comment\">// Determine if native supported</span>\n","    <span class=\"code-keyword\">static</span> <span class=\"code-keyword\">get</span> nativeSupported() {\n","      <span class=\"code-keyword\">return</span> !!(<span class=\"code-built_in\">document</span>.fullscreenEnabled || <span class=\"code-built_in\">document</span>.webkitFullscreenEnabled || <span class=\"code-built_in\">document</span>.mozFullScreenEnabled || <span class=\"code-built_in\">document</span>.msFullscreenEnabled);\n","    }\n","\n","    <span class=\"code-comment\">// If we're actually using native</span>\n","    <span class=\"code-keyword\">get</span> useNative() {\n","      <span class=\"code-keyword\">return</span> Fullscreen.nativeSupported &amp;&amp; !<span class=\"code-keyword\">this</span>.forceFallback;\n","    }\n","\n","    <span class=\"code-comment\">// Get the prefix for handlers</span>\n","    <span class=\"code-keyword\">static</span> <span class=\"code-keyword\">get</span> prefix() {\n","      <span class=\"code-comment\">// No prefix</span>\n","      <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-built_in\">document</span>.exitFullscreen)) <span class=\"code-keyword\">return</span> <span class=\"code-string\">''</span>;\n","\n","      <span class=\"code-comment\">// Check for fullscreen support by vendor prefix</span>\n","      <span class=\"code-keyword\">let</span> value = <span class=\"code-string\">''</span>;\n","      <span class=\"code-keyword\">const</span> prefixes = [<span class=\"code-string\">'webkit'</span>, <span class=\"code-string\">'moz'</span>, <span class=\"code-string\">'ms'</span>];\n","      prefixes.some(<span class=\"code-function\"><span class=\"code-params\">pre</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-built_in\">document</span>[<span class=\"code-string\">`<span class=\"code-subst\">${pre}</span>ExitFullscreen`</span>]) || is.function(<span class=\"code-built_in\">document</span>[<span class=\"code-string\">`<span class=\"code-subst\">${pre}</span>CancelFullScreen`</span>])) {\n","          value = pre;\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      });\n","      <span class=\"code-keyword\">return</span> value;\n","    }\n","    <span class=\"code-keyword\">static</span> <span class=\"code-keyword\">get</span> property() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.prefix === <span class=\"code-string\">'moz'</span> ? <span class=\"code-string\">'FullScreen'</span> : <span class=\"code-string\">'Fullscreen'</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Determine if fullscreen is supported</span>\n","    <span class=\"code-keyword\">get</span> supported() {\n","      <span class=\"code-keyword\">return</span> [\n","      <span class=\"code-comment\">// Fullscreen is enabled in config</span>\n","      <span class=\"code-keyword\">this</span>.player.config.fullscreen.enabled,\n","      <span class=\"code-comment\">// Must be a video</span>\n","      <span class=\"code-keyword\">this</span>.player.isVideo,\n","      <span class=\"code-comment\">// Either native is supported or fallback enabled</span>\n","      Fullscreen.nativeSupported || <span class=\"code-keyword\">this</span>.player.config.fullscreen.fallback,\n","      <span class=\"code-comment\">// YouTube has no way to trigger fullscreen, so on devices with no native support, playsinline</span>\n","      <span class=\"code-comment\">// must be enabled and iosNative fullscreen must be disabled to offer the fullscreen fallback</span>\n","      !<span class=\"code-keyword\">this</span>.player.isYouTube || Fullscreen.nativeSupported || !browser.isIos || <span class=\"code-keyword\">this</span>.player.config.playsinline &amp;&amp; !<span class=\"code-keyword\">this</span>.player.config.fullscreen.iosNative].every(<span class=\"code-built_in\">Boolean</span>);\n","    }\n","\n","    <span class=\"code-comment\">// Get active state</span>\n","    <span class=\"code-keyword\">get</span> active() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported) <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","\n","      <span class=\"code-comment\">// Fallback using classname</span>\n","      <span class=\"code-keyword\">if</span> (!Fullscreen.nativeSupported || <span class=\"code-keyword\">this</span>.forceFallback) {\n","        <span class=\"code-keyword\">return</span> hasClass(<span class=\"code-keyword\">this</span>.target, <span class=\"code-keyword\">this</span>.player.config.classNames.fullscreen.fallback);\n","      }\n","      <span class=\"code-keyword\">const</span> element = !<span class=\"code-keyword\">this</span>.prefix ? <span class=\"code-keyword\">this</span>.target.getRootNode().fullscreenElement : <span class=\"code-keyword\">this</span>.target.getRootNode()[<span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.prefix}</span><span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.property}</span>Element`</span>];\n","      <span class=\"code-keyword\">return</span> element &amp;&amp; element.shadowRoot ? element === <span class=\"code-keyword\">this</span>.target.getRootNode().host : element === <span class=\"code-keyword\">this</span>.target;\n","    }\n","\n","    <span class=\"code-comment\">// Get target element</span>\n","    <span class=\"code-keyword\">get</span> target() {\n","      <span class=\"code-keyword\">return</span> browser.isIos &amp;&amp; <span class=\"code-keyword\">this</span>.player.config.fullscreen.iosNative ? <span class=\"code-keyword\">this</span>.player.media : <span class=\"code-keyword\">this</span>.player.elements.fullscreen ?? <span class=\"code-keyword\">this</span>.player.elements.container;\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-comment\">// Load image avoiding xhr/fetch CORS issues</span>\n","  <span class=\"code-comment\">// Server status can't be obtained this way unfortunately, so this uses \"naturalWidth\" to determine if the image has loaded</span>\n","  <span class=\"code-comment\">// By default it checks if it is at least 1px, but you can add a second argument to change this</span>\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadImage</span>(<span class=\"code-params\">src, minWidth = <span class=\"code-number\">1</span></span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\">(<span class=\"code-params\">resolve, reject</span>) =&gt;</span> {\n","      <span class=\"code-keyword\">const</span> image = <span class=\"code-keyword\">new</span> Image();\n","      <span class=\"code-keyword\">const</span> handler = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-keyword\">delete</span> image.onload;\n","        <span class=\"code-keyword\">delete</span> image.onerror;\n","        (image.naturalWidth &gt;= minWidth ? resolve : reject)(image);\n","      };\n","      <span class=\"code-built_in\">Object</span>.assign(image, {\n","        onload: handler,\n","        onerror: handler,\n","        src\n","      });\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-keyword\">const</span> ui = {\n","    addStyleHook() {\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.selectors.container.replace(<span class=\"code-string\">'.'</span>, <span class=\"code-string\">''</span>), <span class=\"code-literal\">true</span>);\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.uiSupported, <span class=\"code-keyword\">this</span>.supported.ui);\n","    },\n","    <span class=\"code-comment\">// Toggle native HTML5 media controls</span>\n","    toggleNativeControls(toggle = <span class=\"code-literal\">false</span>) {\n","      <span class=\"code-keyword\">if</span> (toggle &amp;&amp; <span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'controls'</span>, <span class=\"code-string\">''</span>);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">this</span>.media.removeAttribute(<span class=\"code-string\">'controls'</span>);\n","      }\n","    },\n","    <span class=\"code-comment\">// Setup the UI</span>\n","    build() {\n","      <span class=\"code-comment\">// Re-attach media element listeners</span>\n","      <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Use event bubbling?</span>\n","      <span class=\"code-keyword\">this</span>.listeners.media();\n","\n","      <span class=\"code-comment\">// Don't setup interface if no support</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.ui) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">`Basic support only for <span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.provider}</span> <span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.type}</span>`</span>);\n","\n","        <span class=\"code-comment\">// Restore native controls</span>\n","        ui.toggleNativeControls.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">true</span>);\n","\n","        <span class=\"code-comment\">// Bail</span>\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Inject custom controls if not present</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.controls)) {\n","        <span class=\"code-comment\">// Inject custom controls</span>\n","        controls.inject.call(<span class=\"code-keyword\">this</span>);\n","\n","        <span class=\"code-comment\">// Re-attach control listeners</span>\n","        <span class=\"code-keyword\">this</span>.listeners.controls();\n","      }\n","\n","      <span class=\"code-comment\">// Remove native controls</span>\n","      ui.toggleNativeControls.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Setup captions for HTML5</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","        captions.setup.call(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Reset volume</span>\n","      <span class=\"code-keyword\">this</span>.volume = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Reset mute state</span>\n","      <span class=\"code-keyword\">this</span>.muted = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Reset loop state</span>\n","      <span class=\"code-keyword\">this</span>.loop = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Reset quality setting</span>\n","      <span class=\"code-keyword\">this</span>.quality = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Reset speed</span>\n","      <span class=\"code-keyword\">this</span>.speed = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Reset volume display</span>\n","      controls.updateVolume.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Reset time display</span>\n","      controls.timeUpdate.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Reset duration display</span>\n","      controls.durationUpdate.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Update the UI</span>\n","      ui.checkPlaying.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Check for picture-in-picture support</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.pip.supported, support.pip &amp;&amp; <span class=\"code-keyword\">this</span>.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.isVideo);\n","\n","      <span class=\"code-comment\">// Check for airplay support</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.airplay.supported, support.airplay &amp;&amp; <span class=\"code-keyword\">this</span>.isHTML5);\n","\n","      <span class=\"code-comment\">// Add touch class</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.isTouch, <span class=\"code-keyword\">this</span>.touch);\n","\n","      <span class=\"code-comment\">// Ready for API calls</span>\n","      <span class=\"code-keyword\">this</span>.ready = <span class=\"code-literal\">true</span>;\n","\n","      <span class=\"code-comment\">// Ready event at end of execution stack</span>\n","      setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, <span class=\"code-string\">'ready'</span>);\n","      }, <span class=\"code-number\">0</span>);\n","\n","      <span class=\"code-comment\">// Set the title</span>\n","      ui.setTitle.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Assure the poster image is set, if the property was added before the element was created</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.poster) {\n","        ui.setPoster.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.poster, <span class=\"code-literal\">false</span>).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","      }\n","\n","      <span class=\"code-comment\">// Manually set the duration if user has overridden it.</span>\n","      <span class=\"code-comment\">// The event listeners for it doesn't get called if preload is disabled (#701)</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.duration) {\n","        controls.durationUpdate.call(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Media metadata</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.mediaMetadata) {\n","        controls.setMediaMetadata.call(<span class=\"code-keyword\">this</span>);\n","      }\n","    },\n","    <span class=\"code-comment\">// Setup aria attribute for play and iframe title</span>\n","    setTitle() {\n","      <span class=\"code-comment\">// Find the current text</span>\n","      <span class=\"code-keyword\">let</span> label = i18n.get(<span class=\"code-string\">'play'</span>, <span class=\"code-keyword\">this</span>.config);\n","\n","      <span class=\"code-comment\">// If there's a media title set, use that for the label</span>\n","      <span class=\"code-keyword\">if</span> (is.string(<span class=\"code-keyword\">this</span>.config.title) &amp;&amp; !is.empty(<span class=\"code-keyword\">this</span>.config.title)) {\n","        label += <span class=\"code-string\">`, <span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.config.title}</span>`</span>;\n","      }\n","\n","      <span class=\"code-comment\">// If there's a play button, set label</span>\n","      <span class=\"code-built_in\">Array</span>.from(<span class=\"code-keyword\">this</span>.elements.buttons.play || []).forEach(<span class=\"code-function\"><span class=\"code-params\">button</span> =&gt;</span> {\n","        button.setAttribute(<span class=\"code-string\">'aria-label'</span>, label);\n","      });\n","\n","      <span class=\"code-comment\">// Set iframe title</span>\n","      <span class=\"code-comment\">// https://github.com/sampotts/plyr/issues/124</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isEmbed) {\n","        <span class=\"code-keyword\">const</span> iframe = getElement.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'iframe'</span>);\n","        <span class=\"code-keyword\">if</span> (!is.element(iframe)) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Default to media type</span>\n","        <span class=\"code-keyword\">const</span> title = !is.empty(<span class=\"code-keyword\">this</span>.config.title) ? <span class=\"code-keyword\">this</span>.config.title : <span class=\"code-string\">'video'</span>;\n","        <span class=\"code-keyword\">const</span> format = i18n.get(<span class=\"code-string\">'frameTitle'</span>, <span class=\"code-keyword\">this</span>.config);\n","        iframe.setAttribute(<span class=\"code-string\">'title'</span>, format.replace(<span class=\"code-string\">'{title}'</span>, title));\n","      }\n","    },\n","    <span class=\"code-comment\">// Toggle poster</span>\n","    togglePoster(enable) {\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.posterEnabled, enable);\n","    },\n","    <span class=\"code-comment\">// Set the poster image (async)</span>\n","    <span class=\"code-comment\">// Used internally for the poster setter, with the passive option forced to false</span>\n","    setPoster(poster, passive = <span class=\"code-literal\">true</span>) {\n","      <span class=\"code-comment\">// Don't override if call is passive</span>\n","      <span class=\"code-keyword\">if</span> (passive &amp;&amp; <span class=\"code-keyword\">this</span>.poster) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Promise</span>.reject(<span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Error</span>(<span class=\"code-string\">'Poster already set'</span>));\n","      }\n","\n","      <span class=\"code-comment\">// Set property synchronously to respect the call order</span>\n","      <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'data-poster'</span>, poster);\n","\n","      <span class=\"code-comment\">// Show the poster</span>\n","      <span class=\"code-keyword\">this</span>.elements.poster.removeAttribute(<span class=\"code-string\">'hidden'</span>);\n","\n","      <span class=\"code-comment\">// Wait until ui is ready</span>\n","      <span class=\"code-keyword\">return</span> ready.call(<span class=\"code-keyword\">this</span>)\n","      <span class=\"code-comment\">// Load image</span>\n","      .then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> loadImage(poster)).catch(<span class=\"code-function\"><span class=\"code-params\">error</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Hide poster on error unless it's been set by another call</span>\n","        <span class=\"code-keyword\">if</span> (poster === <span class=\"code-keyword\">this</span>.poster) {\n","          ui.togglePoster.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">false</span>);\n","        }\n","        <span class=\"code-comment\">// Rethrow</span>\n","        <span class=\"code-keyword\">throw</span> error;\n","      }).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Prevent race conditions</span>\n","        <span class=\"code-keyword\">if</span> (poster !== <span class=\"code-keyword\">this</span>.poster) {\n","          <span class=\"code-keyword\">throw</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Error</span>(<span class=\"code-string\">'setPoster cancelled by later call to setPoster'</span>);\n","        }\n","      }).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-built_in\">Object</span>.assign(<span class=\"code-keyword\">this</span>.elements.poster.style, {\n","          backgroundImage: <span class=\"code-string\">`url('<span class=\"code-subst\">${poster}</span>')`</span>,\n","          <span class=\"code-comment\">// Reset backgroundSize as well (since it can be set to \"cover\" for padded thumbnails for youtube)</span>\n","          backgroundSize: <span class=\"code-string\">''</span>\n","        });\n","        ui.togglePoster.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">true</span>);\n","        <span class=\"code-keyword\">return</span> poster;\n","      });\n","    },\n","    <span class=\"code-comment\">// Check playing state</span>\n","    checkPlaying(event) {\n","      <span class=\"code-comment\">// Class hooks</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.playing, <span class=\"code-keyword\">this</span>.playing);\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.paused, <span class=\"code-keyword\">this</span>.paused);\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.stopped, <span class=\"code-keyword\">this</span>.stopped);\n","\n","      <span class=\"code-comment\">// Set state</span>\n","      <span class=\"code-built_in\">Array</span>.from(<span class=\"code-keyword\">this</span>.elements.buttons.play || []).forEach(<span class=\"code-function\"><span class=\"code-params\">target</span> =&gt;</span> {\n","        <span class=\"code-built_in\">Object</span>.assign(target, {\n","          pressed: <span class=\"code-keyword\">this</span>.playing\n","        });\n","        target.setAttribute(<span class=\"code-string\">'aria-label'</span>, i18n.get(<span class=\"code-keyword\">this</span>.playing ? <span class=\"code-string\">'pause'</span> : <span class=\"code-string\">'play'</span>, <span class=\"code-keyword\">this</span>.config));\n","      });\n","\n","      <span class=\"code-comment\">// Only update controls on non timeupdate events</span>\n","      <span class=\"code-keyword\">if</span> (is.event(event) &amp;&amp; event.type === <span class=\"code-string\">'timeupdate'</span>) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Toggle controls</span>\n","      ui.toggleControls.call(<span class=\"code-keyword\">this</span>);\n","    },\n","    <span class=\"code-comment\">// Check if media is loading</span>\n","    checkLoading(event) {\n","      <span class=\"code-keyword\">this</span>.loading = [<span class=\"code-string\">'stalled'</span>, <span class=\"code-string\">'waiting'</span>].includes(event.type);\n","\n","      <span class=\"code-comment\">// Clear timer</span>\n","      clearTimeout(<span class=\"code-keyword\">this</span>.timers.loading);\n","\n","      <span class=\"code-comment\">// Timer to prevent flicker when seeking</span>\n","      <span class=\"code-keyword\">this</span>.timers.loading = setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Update progress bar loading class state</span>\n","        toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.loading, <span class=\"code-keyword\">this</span>.loading);\n","\n","        <span class=\"code-comment\">// Update controls visibility</span>\n","        ui.toggleControls.call(<span class=\"code-keyword\">this</span>);\n","      }, <span class=\"code-keyword\">this</span>.loading ? <span class=\"code-number\">250</span> : <span class=\"code-number\">0</span>);\n","    },\n","    <span class=\"code-comment\">// Toggle controls based on state and `force` argument</span>\n","    toggleControls(force) {\n","      <span class=\"code-keyword\">const</span> {\n","        controls: controlsElement\n","      } = <span class=\"code-keyword\">this</span>.elements;\n","      <span class=\"code-keyword\">if</span> (controlsElement &amp;&amp; <span class=\"code-keyword\">this</span>.config.hideControls) {\n","        <span class=\"code-comment\">// Don't hide controls if a touch-device user recently seeked. (Must be limited to touch devices, or it occasionally prevents desktop controls from hiding.)</span>\n","        <span class=\"code-keyword\">const</span> recentTouchSeek = <span class=\"code-keyword\">this</span>.touch &amp;&amp; <span class=\"code-keyword\">this</span>.lastSeekTime + <span class=\"code-number\">2000</span> &gt; <span class=\"code-built_in\">Date</span>.now();\n","\n","        <span class=\"code-comment\">// Show controls if force, loading, paused, button interaction, or recent seek, otherwise hide</span>\n","        <span class=\"code-keyword\">this</span>.toggleControls(<span class=\"code-built_in\">Boolean</span>(force || <span class=\"code-keyword\">this</span>.loading || <span class=\"code-keyword\">this</span>.paused || controlsElement.pressed || controlsElement.hover || recentTouchSeek));\n","      }\n","    },\n","    <span class=\"code-comment\">// Migrate any custom properties from the media to the parent</span>\n","    migrateStyles() {\n","      <span class=\"code-comment\">// Loop through values (as they are the keys when the object is spread \uD83E\uDD14)</span>\n","      <span class=\"code-built_in\">Object</span>.values({\n","        ...this.media.style\n","      })\n","      <span class=\"code-comment\">// We're only fussed about Plyr specific properties</span>\n","      .filter(<span class=\"code-function\"><span class=\"code-params\">key</span> =&gt;</span> !is.empty(key) &amp;&amp; is.string(key) &amp;&amp; key.startsWith(<span class=\"code-string\">'--plyr'</span>)).forEach(<span class=\"code-function\"><span class=\"code-params\">key</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Set on the container</span>\n","        <span class=\"code-keyword\">this</span>.elements.container.style.setProperty(key, <span class=\"code-keyword\">this</span>.media.style.getPropertyValue(key));\n","\n","        <span class=\"code-comment\">// Clean up from media element</span>\n","        <span class=\"code-keyword\">this</span>.media.style.removeProperty(key);\n","      });\n","\n","      <span class=\"code-comment\">// Remove attribute if empty</span>\n","      <span class=\"code-keyword\">if</span> (is.empty(<span class=\"code-keyword\">this</span>.media.style)) {\n","        <span class=\"code-keyword\">this</span>.media.removeAttribute(<span class=\"code-string\">'style'</span>);\n","      }\n","    }\n","  };\n","\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Listeners</span> </span>{\n","    <span class=\"code-keyword\">constructor</span>(_player) {\n","      <span class=\"code-comment\">// Device is touch enabled</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"firstTouch\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> {\n","          elements\n","        } = player;\n","        player.touch = <span class=\"code-literal\">true</span>;\n","\n","        <span class=\"code-comment\">// Add touch class</span>\n","        toggleClass(elements.container, player.config.classNames.isTouch, <span class=\"code-literal\">true</span>);\n","      });\n","      <span class=\"code-comment\">// Global window &amp; document listeners</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"global\"</span>, (toggle = <span class=\"code-literal\">true</span>) =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","\n","        <span class=\"code-comment\">// Keyboard shortcuts</span>\n","        <span class=\"code-keyword\">if</span> (player.config.keyboard.global) {\n","          toggleListener.call(player, <span class=\"code-built_in\">window</span>, <span class=\"code-string\">'keydown keyup'</span>, <span class=\"code-keyword\">this</span>.handleKey, toggle, <span class=\"code-literal\">false</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Click anywhere closes menu</span>\n","        toggleListener.call(player, <span class=\"code-built_in\">document</span>.body, <span class=\"code-string\">'click'</span>, <span class=\"code-keyword\">this</span>.toggleMenu, toggle);\n","\n","        <span class=\"code-comment\">// Detect touch by events</span>\n","        once.call(player, <span class=\"code-built_in\">document</span>.body, <span class=\"code-string\">'touchstart'</span>, <span class=\"code-keyword\">this</span>.firstTouch);\n","      });\n","      <span class=\"code-comment\">// Container listeners</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"container\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> {\n","          config,\n","          elements,\n","          timers\n","        } = player;\n","\n","        <span class=\"code-comment\">// Keyboard shortcuts</span>\n","        <span class=\"code-keyword\">if</span> (!config.keyboard.global &amp;&amp; config.keyboard.focused) {\n","          on.call(player, elements.container, <span class=\"code-string\">'keydown keyup'</span>, <span class=\"code-keyword\">this</span>.handleKey, <span class=\"code-literal\">false</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Toggle controls on mouse events and entering fullscreen</span>\n","        on.call(player, elements.container, <span class=\"code-string\">'mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            controls: controlsElement\n","          } = elements;\n","\n","          <span class=\"code-comment\">// Remove button states for fullscreen</span>\n","          <span class=\"code-keyword\">if</span> (controlsElement &amp;&amp; event.type === <span class=\"code-string\">'enterfullscreen'</span>) {\n","            controlsElement.pressed = <span class=\"code-literal\">false</span>;\n","            controlsElement.hover = <span class=\"code-literal\">false</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Show, then hide after a timeout unless another control event occurs</span>\n","          <span class=\"code-keyword\">const</span> show = [<span class=\"code-string\">'touchstart'</span>, <span class=\"code-string\">'touchmove'</span>, <span class=\"code-string\">'mousemove'</span>].includes(event.type);\n","          <span class=\"code-keyword\">let</span> delay = <span class=\"code-number\">0</span>;\n","          <span class=\"code-keyword\">if</span> (show) {\n","            ui.toggleControls.call(player, <span class=\"code-literal\">true</span>);\n","            <span class=\"code-comment\">// Use longer timeout for touch devices</span>\n","            delay = player.touch ? <span class=\"code-number\">3000</span> : <span class=\"code-number\">2000</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Clear timer</span>\n","          clearTimeout(timers.controls);\n","\n","          <span class=\"code-comment\">// Set new timer to prevent flicker when seeking</span>\n","          timers.controls = setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> ui.toggleControls.call(player, <span class=\"code-literal\">false</span>), delay);\n","        });\n","\n","        <span class=\"code-comment\">// Set a gutter for Vimeo</span>\n","        <span class=\"code-keyword\">const</span> setGutter = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (!player.isVimeo || player.config.vimeo.premium) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","          <span class=\"code-keyword\">const</span> target = elements.wrapper;\n","          <span class=\"code-keyword\">const</span> {\n","            active\n","          } = player.fullscreen;\n","          <span class=\"code-keyword\">const</span> [videoWidth, videoHeight] = getAspectRatio.call(player);\n","          <span class=\"code-keyword\">const</span> useNativeAspectRatio = supportsCSS(<span class=\"code-string\">`aspect-ratio: <span class=\"code-subst\">${videoWidth}</span> / <span class=\"code-subst\">${videoHeight}</span>`</span>);\n","\n","          <span class=\"code-comment\">// If not active, remove styles</span>\n","          <span class=\"code-keyword\">if</span> (!active) {\n","            <span class=\"code-keyword\">if</span> (useNativeAspectRatio) {\n","              target.style.width = <span class=\"code-literal\">null</span>;\n","              target.style.height = <span class=\"code-literal\">null</span>;\n","            } <span class=\"code-keyword\">else</span> {\n","              target.style.maxWidth = <span class=\"code-literal\">null</span>;\n","              target.style.margin = <span class=\"code-literal\">null</span>;\n","            }\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Determine which dimension will overflow and constrain view</span>\n","          <span class=\"code-keyword\">const</span> [viewportWidth, viewportHeight] = getViewportSize();\n","          <span class=\"code-keyword\">const</span> overflow = viewportWidth / viewportHeight &gt; videoWidth / videoHeight;\n","          <span class=\"code-keyword\">if</span> (useNativeAspectRatio) {\n","            target.style.width = overflow ? <span class=\"code-string\">'auto'</span> : <span class=\"code-string\">'100%'</span>;\n","            target.style.height = overflow ? <span class=\"code-string\">'100%'</span> : <span class=\"code-string\">'auto'</span>;\n","          } <span class=\"code-keyword\">else</span> {\n","            target.style.maxWidth = overflow ? `${viewportHeight / videoHeight * videoWidth}px` : null;\n","            target.style.margin = overflow ? <span class=\"code-string\">'0 auto'</span> : <span class=\"code-literal\">null</span>;\n","          }\n","        };\n","\n","        <span class=\"code-comment\">// Handle resizing</span>\n","        <span class=\"code-keyword\">const</span> resized = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          clearTimeout(timers.resized);\n","          timers.resized = setTimeout(setGutter, <span class=\"code-number\">50</span>);\n","        };\n","        on.call(player, elements.container, <span class=\"code-string\">'enterfullscreen exitfullscreen'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            target\n","          } = player.fullscreen;\n","\n","          <span class=\"code-comment\">// Ignore events not from target</span>\n","          <span class=\"code-keyword\">if</span> (target !== elements.container) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// If it's not an embed and no ratio specified</span>\n","          <span class=\"code-keyword\">if</span> (!player.isEmbed &amp;&amp; is.empty(player.config.ratio)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Set Vimeo gutter</span>\n","          setGutter();\n","\n","          <span class=\"code-comment\">// Watch for resizes</span>\n","          <span class=\"code-keyword\">const</span> method = event.type === <span class=\"code-string\">'enterfullscreen'</span> ? on : off;\n","          method.call(player, <span class=\"code-built_in\">window</span>, <span class=\"code-string\">'resize'</span>, resized);\n","        });\n","      });\n","      <span class=\"code-comment\">// Listen for media events</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"media\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> {\n","          elements\n","        } = player;\n","\n","        <span class=\"code-comment\">// Time change on media</span>\n","        on.call(player, player.media, <span class=\"code-string\">'timeupdate seeking seeked'</span>, event =&gt; controls.timeUpdate.call(player, event));\n","\n","        <span class=\"code-comment\">// Display duration</span>\n","        on.call(player, player.media, <span class=\"code-string\">'durationchange loadeddata loadedmetadata'</span>, event =&gt; controls.durationUpdate.call(player, event));\n","\n","        <span class=\"code-comment\">// Handle the media finishing</span>\n","        on.call(player, player.media, <span class=\"code-string\">'ended'</span>, () =&gt; {\n","          <span class=\"code-comment\">// Show poster on end</span>\n","          <span class=\"code-keyword\">if</span> (player.isHTML5 &amp;&amp; player.isVideo &amp;&amp; player.config.resetOnEnd) {\n","            <span class=\"code-comment\">// Restart</span>\n","            player.restart();\n","\n","            <span class=\"code-comment\">// Call pause otherwise IE11 will start playing the video again</span>\n","            player.pause();\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Check for buffer progress</span>\n","        on.call(player, player.media, <span class=\"code-string\">'progress playing seeking seeked'</span>, event =&gt; controls.updateProgress.call(player, event));\n","\n","        <span class=\"code-comment\">// Handle volume changes</span>\n","        on.call(player, player.media, <span class=\"code-string\">'volumechange'</span>, event =&gt; controls.updateVolume.call(player, event));\n","\n","        <span class=\"code-comment\">// Handle play/pause</span>\n","        on.call(player, player.media, <span class=\"code-string\">'playing play pause ended emptied timeupdate'</span>, event =&gt; ui.checkPlaying.call(player, event));\n","\n","        <span class=\"code-comment\">// Loading state</span>\n","        on.call(player, player.media, <span class=\"code-string\">'waiting canplay seeked playing'</span>, event =&gt; ui.checkLoading.call(player, event));\n","\n","        <span class=\"code-comment\">// Click video</span>\n","        <span class=\"code-keyword\">if</span> (player.supported.ui &amp;&amp; player.config.clickToPlay &amp;&amp; !player.isAudio) {\n","          <span class=\"code-comment\">// Re-fetch the wrapper</span>\n","          <span class=\"code-keyword\">const</span> wrapper = getElement.call(player, <span class=\"code-string\">`.<span class=\"code-subst\">${player.config.classNames.video}</span>`</span>);\n","\n","          <span class=\"code-comment\">// Bail if there's no wrapper (this should never happen)</span>\n","          <span class=\"code-keyword\">if</span> (!is.element(wrapper)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// On click play, pause or restart</span>\n","          on.call(player, elements.container, <span class=\"code-string\">'click'</span>, event =&gt; {\n","            <span class=\"code-keyword\">const</span> targets = [elements.container, wrapper];\n","\n","            <span class=\"code-comment\">// Ignore if click if not container or in video wrapper</span>\n","            <span class=\"code-keyword\">if</span> (!targets.includes(event.target) &amp;&amp; !wrapper.contains(event.target)) {\n","              <span class=\"code-keyword\">return</span>;\n","            }\n","\n","            <span class=\"code-comment\">// Touch devices will just show controls (if hidden)</span>\n","            <span class=\"code-keyword\">if</span> (player.touch &amp;&amp; player.config.hideControls) {\n","              <span class=\"code-keyword\">return</span>;\n","            }\n","            <span class=\"code-keyword\">if</span> (player.ended) {\n","              <span class=\"code-keyword\">this</span>.proxy(event, player.restart, <span class=\"code-string\">'restart'</span>);\n","              <span class=\"code-keyword\">this</span>.proxy(event, () =&gt; {\n","                silencePromise(player.play());\n","              }, <span class=\"code-string\">'play'</span>);\n","            } <span class=\"code-keyword\">else</span> {\n","              <span class=\"code-keyword\">this</span>.proxy(event, () =&gt; {\n","                silencePromise(player.togglePlay());\n","              }, <span class=\"code-string\">'play'</span>);\n","            }\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Disable right click</span>\n","        <span class=\"code-keyword\">if</span> (player.supported.ui &amp;&amp; player.config.disableContextMenu) {\n","          on.call(player, elements.wrapper, <span class=\"code-string\">'contextmenu'</span>, event =&gt; {\n","            event.preventDefault();\n","          }, <span class=\"code-literal\">false</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Volume change</span>\n","        on.call(player, player.media, <span class=\"code-string\">'volumechange'</span>, () =&gt; {\n","          <span class=\"code-comment\">// Save to storage</span>\n","          player.storage.set({\n","            volume: player.volume,\n","            muted: player.muted\n","          });\n","        });\n","\n","        <span class=\"code-comment\">// Speed change</span>\n","        on.call(player, player.media, <span class=\"code-string\">'ratechange'</span>, () =&gt; {\n","          <span class=\"code-comment\">// Update UI</span>\n","          controls.updateSetting.call(player, <span class=\"code-string\">'speed'</span>);\n","\n","          <span class=\"code-comment\">// Save to storage</span>\n","          player.storage.set({\n","            speed: player.speed\n","          });\n","        });\n","\n","        <span class=\"code-comment\">// Quality change</span>\n","        on.call(player, player.media, <span class=\"code-string\">'qualitychange'</span>, event =&gt; {\n","          <span class=\"code-comment\">// Update UI</span>\n","          controls.updateSetting.call(player, <span class=\"code-string\">'quality'</span>, <span class=\"code-literal\">null</span>, event.detail.quality);\n","        });\n","\n","        <span class=\"code-comment\">// Update download link when ready and if quality changes</span>\n","        on.call(player, player.media, <span class=\"code-string\">'ready qualitychange'</span>, () =&gt; {\n","          controls.setDownloadUrl.call(player);\n","        });\n","\n","        <span class=\"code-comment\">// Proxy events to container</span>\n","        <span class=\"code-comment\">// Bubble up key events for Edge</span>\n","        <span class=\"code-keyword\">const</span> proxyEvents = player.config.events.concat([<span class=\"code-string\">'keyup'</span>, <span class=\"code-string\">'keydown'</span>]).join(<span class=\"code-string\">' '</span>);\n","        on.call(player, player.media, proxyEvents, event =&gt; {\n","          <span class=\"code-keyword\">let</span> {\n","            detail = {}\n","          } = event;\n","\n","          <span class=\"code-comment\">// Get error details from media</span>\n","          <span class=\"code-keyword\">if</span> (event.type === <span class=\"code-string\">'error'</span>) {\n","            detail = player.media.error;\n","          }\n","          triggerEvent.call(player, elements.container, event.type, <span class=\"code-literal\">true</span>, detail);\n","        });\n","      });\n","      <span class=\"code-comment\">// Run default and custom handlers</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"proxy\"</span>, (event, defaultHandler, customHandlerKey) =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> customHandler = player.config.listeners[customHandlerKey];\n","        <span class=\"code-keyword\">const</span> hasCustomHandler = is.function(customHandler);\n","        <span class=\"code-keyword\">let</span> returned = <span class=\"code-literal\">true</span>;\n","\n","        <span class=\"code-comment\">// Execute custom handler</span>\n","        <span class=\"code-keyword\">if</span> (hasCustomHandler) {\n","          returned = customHandler.call(player, event);\n","        }\n","\n","        <span class=\"code-comment\">// Only call default handler if not prevented in custom handler</span>\n","        <span class=\"code-keyword\">if</span> (returned !== <span class=\"code-literal\">false</span> &amp;&amp; is.function(defaultHandler)) {\n","          defaultHandler.call(player, event);\n","        }\n","      });\n","      <span class=\"code-comment\">// Trigger custom and default handlers</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"bind\"</span>, (element, type, defaultHandler, customHandlerKey, passive = <span class=\"code-literal\">true</span>) =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> customHandler = player.config.listeners[customHandlerKey];\n","        <span class=\"code-keyword\">const</span> hasCustomHandler = is.function(customHandler);\n","        on.call(player, element, type, event =&gt; <span class=\"code-keyword\">this</span>.proxy(event, defaultHandler, customHandlerKey), passive &amp;&amp; !hasCustomHandler);\n","      });\n","      <span class=\"code-comment\">// Listen for control events</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"controls\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          player\n","        } = <span class=\"code-keyword\">this</span>;\n","        <span class=\"code-keyword\">const</span> {\n","          elements\n","        } = player;\n","        <span class=\"code-comment\">// IE doesn't support input event, so we fallback to change</span>\n","        <span class=\"code-keyword\">const</span> inputEvent = browser.isIE ? <span class=\"code-string\">'change'</span> : <span class=\"code-string\">'input'</span>;\n","\n","        <span class=\"code-comment\">// Play/pause toggle</span>\n","        <span class=\"code-keyword\">if</span> (elements.buttons.play) {\n","          <span class=\"code-built_in\">Array</span>.from(elements.buttons.play).forEach(<span class=\"code-function\"><span class=\"code-params\">button</span> =&gt;</span> {\n","            <span class=\"code-keyword\">this</span>.bind(button, <span class=\"code-string\">'click'</span>, () =&gt; {\n","              silencePromise(player.togglePlay());\n","            }, <span class=\"code-string\">'play'</span>);\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Pause</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.restart, <span class=\"code-string\">'click'</span>, player.restart, <span class=\"code-string\">'restart'</span>);\n","\n","        <span class=\"code-comment\">// Rewind</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.rewind, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          <span class=\"code-comment\">// Record seek time so we can prevent hiding controls for a few seconds after rewind</span>\n","          player.lastSeekTime = <span class=\"code-built_in\">Date</span>.now();\n","          player.rewind();\n","        }, <span class=\"code-string\">'rewind'</span>);\n","\n","        <span class=\"code-comment\">// Rewind</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.fastForward, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          <span class=\"code-comment\">// Record seek time so we can prevent hiding controls for a few seconds after fast forward</span>\n","          player.lastSeekTime = <span class=\"code-built_in\">Date</span>.now();\n","          player.forward();\n","        }, <span class=\"code-string\">'fastForward'</span>);\n","\n","        <span class=\"code-comment\">// Mute toggle</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.mute, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          player.muted = !player.muted;\n","        }, <span class=\"code-string\">'mute'</span>);\n","\n","        <span class=\"code-comment\">// Captions toggle</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.captions, <span class=\"code-string\">'click'</span>, () =&gt; player.toggleCaptions());\n","\n","        <span class=\"code-comment\">// Download</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.download, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          triggerEvent.call(player, player.media, <span class=\"code-string\">'download'</span>);\n","        }, <span class=\"code-string\">'download'</span>);\n","\n","        <span class=\"code-comment\">// Fullscreen toggle</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.fullscreen, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          player.fullscreen.toggle();\n","        }, <span class=\"code-string\">'fullscreen'</span>);\n","\n","        <span class=\"code-comment\">// Picture-in-Picture</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.pip, <span class=\"code-string\">'click'</span>, () =&gt; {\n","          player.pip = <span class=\"code-string\">'toggle'</span>;\n","        }, <span class=\"code-string\">'pip'</span>);\n","\n","        <span class=\"code-comment\">// Airplay</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.airplay, <span class=\"code-string\">'click'</span>, player.airplay, <span class=\"code-string\">'airplay'</span>);\n","\n","        <span class=\"code-comment\">// Settings menu - click toggle</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.settings, <span class=\"code-string\">'click'</span>, event =&gt; {\n","          <span class=\"code-comment\">// Prevent the document click listener closing the menu</span>\n","          event.stopPropagation();\n","          event.preventDefault();\n","          controls.toggleMenu.call(player, event);\n","        }, <span class=\"code-literal\">null</span>, <span class=\"code-literal\">false</span>); <span class=\"code-comment\">// Can't be passive as we're preventing default</span>\n","\n","        <span class=\"code-comment\">// Settings menu - keyboard toggle</span>\n","        <span class=\"code-comment\">// We have to bind to keyup otherwise Firefox triggers a click when a keydown event handler shifts focus</span>\n","        <span class=\"code-comment\">// https://bugzilla.mozilla.org/show_bug.cgi?id=1220143</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.buttons.settings, <span class=\"code-string\">'keyup'</span>, event =&gt; {\n","          <span class=\"code-keyword\">if</span> (![<span class=\"code-string\">' '</span>, <span class=\"code-string\">'Enter'</span>].includes(event.key)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Because return triggers a click anyway, all we need to do is set focus</span>\n","          <span class=\"code-keyword\">if</span> (event.key === <span class=\"code-string\">'Enter'</span>) {\n","            controls.focusFirstMenuItem.call(player, <span class=\"code-literal\">null</span>, <span class=\"code-literal\">true</span>);\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Prevent scroll</span>\n","          event.preventDefault();\n","\n","          <span class=\"code-comment\">// Prevent playing video (Firefox)</span>\n","          event.stopPropagation();\n","\n","          <span class=\"code-comment\">// Toggle menu</span>\n","          controls.toggleMenu.call(player, event);\n","        }, <span class=\"code-literal\">null</span>, <span class=\"code-literal\">false</span> <span class=\"code-comment\">// Can't be passive as we're preventing default</span>\n","        );\n","\n","        <span class=\"code-comment\">// Escape closes menu</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.settings.menu, <span class=\"code-string\">'keydown'</span>, event =&gt; {\n","          <span class=\"code-keyword\">if</span> (event.key === <span class=\"code-string\">'Escape'</span>) {\n","            controls.toggleMenu.call(player, event);\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Set range input alternative \"value\", which matches the tooltip time (#954)</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.inputs.seek, <span class=\"code-string\">'mousedown mousemove'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> rect = elements.progress.getBoundingClientRect();\n","          <span class=\"code-keyword\">const</span> percent = <span class=\"code-number\">100</span> / rect.width * (event.pageX - rect.left);\n","          event.currentTarget.setAttribute(<span class=\"code-string\">'seek-value'</span>, percent);\n","        });\n","\n","        <span class=\"code-comment\">// Pause while seeking</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.inputs.seek, <span class=\"code-string\">'mousedown mouseup keydown keyup touchstart touchend'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> seek = event.currentTarget;\n","          <span class=\"code-keyword\">const</span> attribute = <span class=\"code-string\">'play-on-seeked'</span>;\n","          <span class=\"code-keyword\">if</span> (is.keyboardEvent(event) &amp;&amp; ![<span class=\"code-string\">'ArrowLeft'</span>, <span class=\"code-string\">'ArrowRight'</span>].includes(event.key)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Record seek time so we can prevent hiding controls for a few seconds after seek</span>\n","          player.lastSeekTime = <span class=\"code-built_in\">Date</span>.now();\n","\n","          <span class=\"code-comment\">// Was playing before?</span>\n","          <span class=\"code-keyword\">const</span> play = seek.hasAttribute(attribute);\n","          <span class=\"code-comment\">// Done seeking</span>\n","          <span class=\"code-keyword\">const</span> done = [<span class=\"code-string\">'mouseup'</span>, <span class=\"code-string\">'touchend'</span>, <span class=\"code-string\">'keyup'</span>].includes(event.type);\n","\n","          <span class=\"code-comment\">// If we're done seeking and it was playing, resume playback</span>\n","          <span class=\"code-keyword\">if</span> (play &amp;&amp; done) {\n","            seek.removeAttribute(attribute);\n","            silencePromise(player.play());\n","          } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!done &amp;&amp; player.playing) {\n","            seek.setAttribute(attribute, <span class=\"code-string\">''</span>);\n","            player.pause();\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Fix range inputs on iOS</span>\n","        <span class=\"code-comment\">// Super weird iOS bug where after you interact with an &lt;input type=\"range\"&gt;,</span>\n","        <span class=\"code-comment\">// it takes over further interactions on the page. This is a hack</span>\n","        <span class=\"code-keyword\">if</span> (browser.isIos) {\n","          <span class=\"code-keyword\">const</span> inputs = getElements.call(player, <span class=\"code-string\">'input[type=\"range\"]'</span>);\n","          <span class=\"code-built_in\">Array</span>.from(inputs).forEach(<span class=\"code-function\"><span class=\"code-params\">input</span> =&gt;</span> <span class=\"code-keyword\">this</span>.bind(input, inputEvent, event =&gt; repaint(event.target)));\n","        }\n","\n","        <span class=\"code-comment\">// Seek</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.inputs.seek, inputEvent, event =&gt; {\n","          <span class=\"code-keyword\">const</span> seek = event.currentTarget;\n","          <span class=\"code-comment\">// If it exists, use seek-value instead of \"value\" for consistency with tooltip time (#954)</span>\n","          <span class=\"code-keyword\">let</span> seekTo = seek.getAttribute(<span class=\"code-string\">'seek-value'</span>);\n","          <span class=\"code-keyword\">if</span> (is.empty(seekTo)) {\n","            seekTo = seek.value;\n","          }\n","          seek.removeAttribute(<span class=\"code-string\">'seek-value'</span>);\n","          player.currentTime = seekTo / seek.max * player.duration;\n","        }, <span class=\"code-string\">'seek'</span>);\n","\n","        <span class=\"code-comment\">// Seek tooltip</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.progress, <span class=\"code-string\">'mouseenter mouseleave mousemove'</span>, event =&gt; controls.updateSeekTooltip.call(player, event));\n","\n","        <span class=\"code-comment\">// Preview thumbnails plugin</span>\n","        <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Really need to work on some sort of plug-in wide event bus or pub-sub for this</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.progress, <span class=\"code-string\">'mousemove touchmove'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            previewThumbnails\n","          } = player;\n","          <span class=\"code-keyword\">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {\n","            previewThumbnails.startMove(event);\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Hide thumbnail preview - on mouse click, mouse leave, and video play/seek. All four are required, e.g., for buffering</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.progress, <span class=\"code-string\">'mouseleave touchend click'</span>, () =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            previewThumbnails\n","          } = player;\n","          <span class=\"code-keyword\">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {\n","            previewThumbnails.endMove(<span class=\"code-literal\">false</span>, <span class=\"code-literal\">true</span>);\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Show scrubbing preview</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.progress, <span class=\"code-string\">'mousedown touchstart'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            previewThumbnails\n","          } = player;\n","          <span class=\"code-keyword\">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {\n","            previewThumbnails.startScrubbing(event);\n","          }\n","        });\n","        <span class=\"code-keyword\">this</span>.bind(elements.progress, <span class=\"code-string\">'mouseup touchend'</span>, event =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            previewThumbnails\n","          } = player;\n","          <span class=\"code-keyword\">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {\n","            previewThumbnails.endScrubbing(event);\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Polyfill for lower fill in &lt;input type=\"range\"&gt; for webkit</span>\n","        <span class=\"code-keyword\">if</span> (browser.isWebKit) {\n","          <span class=\"code-built_in\">Array</span>.from(getElements.call(player, <span class=\"code-string\">'input[type=\"range\"]'</span>)).forEach(<span class=\"code-function\"><span class=\"code-params\">element</span> =&gt;</span> {\n","            <span class=\"code-keyword\">this</span>.bind(element, <span class=\"code-string\">'input'</span>, event =&gt; controls.updateRangeFill.call(player, event.target));\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Current time invert</span>\n","        <span class=\"code-comment\">// Only if one time element is used for both currentTime and duration</span>\n","        <span class=\"code-keyword\">if</span> (player.config.toggleInvert &amp;&amp; !is.element(elements.display.duration)) {\n","          <span class=\"code-keyword\">this</span>.bind(elements.display.currentTime, <span class=\"code-string\">'click'</span>, () =&gt; {\n","            <span class=\"code-comment\">// Do nothing if we're at the start</span>\n","            <span class=\"code-keyword\">if</span> (player.currentTime === <span class=\"code-number\">0</span>) {\n","              <span class=\"code-keyword\">return</span>;\n","            }\n","            player.config.invertTime = !player.config.invertTime;\n","            controls.timeUpdate.call(player);\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Volume</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.inputs.volume, inputEvent, event =&gt; {\n","          player.volume = event.target.value;\n","        }, <span class=\"code-string\">'volume'</span>);\n","\n","        <span class=\"code-comment\">// Update controls.hover state (used for ui.toggleControls to avoid hiding when interacting)</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.controls, <span class=\"code-string\">'mouseenter mouseleave'</span>, event =&gt; {\n","          elements.controls.hover = !player.touch &amp;&amp; event.type === <span class=\"code-string\">'mouseenter'</span>;\n","        });\n","\n","        <span class=\"code-comment\">// Also update controls.hover state for any non-player children of fullscreen element (as above)</span>\n","        <span class=\"code-keyword\">if</span> (elements.fullscreen) {\n","          <span class=\"code-built_in\">Array</span>.from(elements.fullscreen.children).filter(<span class=\"code-function\"><span class=\"code-params\">c</span> =&gt;</span> !c.contains(elements.container)).forEach(<span class=\"code-function\"><span class=\"code-params\">child</span> =&gt;</span> {\n","            <span class=\"code-keyword\">this</span>.bind(child, <span class=\"code-string\">'mouseenter mouseleave'</span>, event =&gt; {\n","              <span class=\"code-keyword\">if</span> (elements.controls) {\n","                elements.controls.hover = !player.touch &amp;&amp; event.type === <span class=\"code-string\">'mouseenter'</span>;\n","              }\n","            });\n","          });\n","        }\n","\n","        <span class=\"code-comment\">// Update controls.pressed state (used for ui.toggleControls to avoid hiding when interacting)</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.controls, <span class=\"code-string\">'mousedown mouseup touchstart touchend touchcancel'</span>, event =&gt; {\n","          elements.controls.pressed = [<span class=\"code-string\">'mousedown'</span>, <span class=\"code-string\">'touchstart'</span>].includes(event.type);\n","        });\n","\n","        <span class=\"code-comment\">// Show controls when they receive focus (e.g., when using keyboard tab key)</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.controls, <span class=\"code-string\">'focusin'</span>, () =&gt; {\n","          <span class=\"code-keyword\">const</span> {\n","            config,\n","            timers\n","          } = player;\n","\n","          <span class=\"code-comment\">// Skip transition to prevent focus from scrolling the parent element</span>\n","          toggleClass(elements.controls, config.classNames.noTransition, <span class=\"code-literal\">true</span>);\n","\n","          <span class=\"code-comment\">// Toggle</span>\n","          ui.toggleControls.call(player, <span class=\"code-literal\">true</span>);\n","\n","          <span class=\"code-comment\">// Restore transition</span>\n","          setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            toggleClass(elements.controls, config.classNames.noTransition, <span class=\"code-literal\">false</span>);\n","          }, <span class=\"code-number\">0</span>);\n","\n","          <span class=\"code-comment\">// Delay a little more for mouse users</span>\n","          <span class=\"code-keyword\">const</span> delay = <span class=\"code-keyword\">this</span>.touch ? <span class=\"code-number\">3000</span> : <span class=\"code-number\">4000</span>;\n","\n","          <span class=\"code-comment\">// Clear timer</span>\n","          clearTimeout(timers.controls);\n","\n","          <span class=\"code-comment\">// Hide again after delay</span>\n","          timers.controls = setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> ui.toggleControls.call(player, <span class=\"code-literal\">false</span>), delay);\n","        });\n","\n","        <span class=\"code-comment\">// Mouse wheel for volume</span>\n","        <span class=\"code-keyword\">this</span>.bind(elements.inputs.volume, <span class=\"code-string\">'wheel'</span>, event =&gt; {\n","          <span class=\"code-comment\">// Detect \"natural\" scroll - supported on OS X Safari only</span>\n","          <span class=\"code-comment\">// Other browsers on OS X will be inverted until support improves</span>\n","          <span class=\"code-keyword\">const</span> inverted = event.webkitDirectionInvertedFromDevice;\n","          <span class=\"code-comment\">// Get delta from event. Invert if `inverted` is true</span>\n","          <span class=\"code-keyword\">const</span> [x, y] = [event.deltaX, -event.deltaY].map(<span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> inverted ? -value : value);\n","          <span class=\"code-comment\">// Using the biggest delta, normalize to 1 or -1 (or 0 if no delta)</span>\n","          <span class=\"code-keyword\">const</span> direction = <span class=\"code-built_in\">Math</span>.sign(<span class=\"code-built_in\">Math</span>.abs(x) &gt; <span class=\"code-built_in\">Math</span>.abs(y) ? x : y);\n","\n","          <span class=\"code-comment\">// Change the volume by 2%</span>\n","          player.increaseVolume(direction / <span class=\"code-number\">50</span>);\n","\n","          <span class=\"code-comment\">// Don't break page scrolling at max and min</span>\n","          <span class=\"code-keyword\">const</span> {\n","            volume\n","          } = player.media;\n","          <span class=\"code-keyword\">if</span> (direction === <span class=\"code-number\">1</span> &amp;&amp; volume &lt; <span class=\"code-number\">1</span> || direction === <span class=\"code-number\">-1</span> &amp;&amp; volume &gt; <span class=\"code-number\">0</span>) {\n","            event.preventDefault();\n","          }\n","        }, <span class=\"code-string\">'volume'</span>, <span class=\"code-literal\">false</span>);\n","      });\n","      <span class=\"code-keyword\">this</span>.player = _player;\n","      <span class=\"code-keyword\">this</span>.lastKey = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.focusTimer = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.lastKeyDown = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.handleKey = <span class=\"code-keyword\">this</span>.handleKey.bind(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">this</span>.toggleMenu = <span class=\"code-keyword\">this</span>.toggleMenu.bind(<span class=\"code-keyword\">this</span>);\n","      <span class=\"code-keyword\">this</span>.firstTouch = <span class=\"code-keyword\">this</span>.firstTouch.bind(<span class=\"code-keyword\">this</span>);\n","    }\n","\n","    <span class=\"code-comment\">// Handle key presses</span>\n","    handleKey(event) {\n","      <span class=\"code-keyword\">const</span> {\n","        player\n","      } = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">const</span> {\n","        elements\n","      } = player;\n","      <span class=\"code-keyword\">const</span> {\n","        key,\n","        type,\n","        altKey,\n","        ctrlKey,\n","        metaKey,\n","        shiftKey\n","      } = event;\n","      <span class=\"code-keyword\">const</span> pressed = type === <span class=\"code-string\">'keydown'</span>;\n","      <span class=\"code-keyword\">const</span> repeat = pressed &amp;&amp; key === <span class=\"code-keyword\">this</span>.lastKey;\n","\n","      <span class=\"code-comment\">// Bail if a modifier key is set</span>\n","      <span class=\"code-keyword\">if</span> (altKey || ctrlKey || metaKey || shiftKey) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// If the event is bubbled from the media element</span>\n","      <span class=\"code-comment\">// Firefox doesn't get the key for whatever reason</span>\n","      <span class=\"code-keyword\">if</span> (!key) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Seek by increment</span>\n","      <span class=\"code-keyword\">const</span> seekByIncrement = <span class=\"code-function\"><span class=\"code-params\">increment</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Divide the max duration into 10th's and times by the number value</span>\n","        player.currentTime = player.duration / <span class=\"code-number\">10</span> * increment;\n","      };\n","\n","      <span class=\"code-comment\">// Handle the key on keydown</span>\n","      <span class=\"code-comment\">// Reset on keyup</span>\n","      <span class=\"code-keyword\">if</span> (pressed) {\n","        <span class=\"code-comment\">// Check focused element</span>\n","        <span class=\"code-comment\">// and if the focused element is not editable (e.g. text input)</span>\n","        <span class=\"code-comment\">// and any that accept key input http://webaim.org/techniques/keyboard/</span>\n","        <span class=\"code-keyword\">const</span> focused = <span class=\"code-built_in\">document</span>.activeElement;\n","        <span class=\"code-keyword\">if</span> (is.element(focused)) {\n","          <span class=\"code-keyword\">const</span> {\n","            editable\n","          } = player.config.selectors;\n","          <span class=\"code-keyword\">const</span> {\n","            seek\n","          } = elements.inputs;\n","          <span class=\"code-keyword\">if</span> (focused !== seek &amp;&amp; matches(focused, editable)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (event.key === <span class=\"code-string\">' '</span> &amp;&amp; matches(focused, <span class=\"code-string\">'button, [role^=\"menuitem\"]'</span>)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Which keys should we prevent default</span>\n","        <span class=\"code-keyword\">const</span> preventDefault = [<span class=\"code-string\">' '</span>, <span class=\"code-string\">'ArrowLeft'</span>, <span class=\"code-string\">'ArrowUp'</span>, <span class=\"code-string\">'ArrowRight'</span>, <span class=\"code-string\">'ArrowDown'</span>, <span class=\"code-string\">'0'</span>, <span class=\"code-string\">'1'</span>, <span class=\"code-string\">'2'</span>, <span class=\"code-string\">'3'</span>, <span class=\"code-string\">'4'</span>, <span class=\"code-string\">'5'</span>, <span class=\"code-string\">'6'</span>, <span class=\"code-string\">'7'</span>, <span class=\"code-string\">'8'</span>, <span class=\"code-string\">'9'</span>, <span class=\"code-string\">'c'</span>, <span class=\"code-string\">'f'</span>, <span class=\"code-string\">'k'</span>, <span class=\"code-string\">'l'</span>, <span class=\"code-string\">'m'</span>];\n","\n","        <span class=\"code-comment\">// If the key is found prevent default (e.g. prevent scrolling for arrows)</span>\n","        <span class=\"code-keyword\">if</span> (preventDefault.includes(key)) {\n","          event.preventDefault();\n","          event.stopPropagation();\n","        }\n","        <span class=\"code-keyword\">switch</span> (key) {\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'0'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'1'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'2'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'3'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'4'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'5'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'6'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'7'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'8'</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'9'</span>:\n","            <span class=\"code-keyword\">if</span> (!repeat) {\n","              seekByIncrement(<span class=\"code-built_in\">parseInt</span>(key, <span class=\"code-number\">10</span>));\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">' '</span>:\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'k'</span>:\n","            <span class=\"code-keyword\">if</span> (!repeat) {\n","              silencePromise(player.togglePlay());\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'ArrowUp'</span>:\n","            player.increaseVolume(<span class=\"code-number\">0.1</span>);\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'ArrowDown'</span>:\n","            player.decreaseVolume(<span class=\"code-number\">0.1</span>);\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'m'</span>:\n","            <span class=\"code-keyword\">if</span> (!repeat) {\n","              player.muted = !player.muted;\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'ArrowRight'</span>:\n","            player.forward();\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'ArrowLeft'</span>:\n","            player.rewind();\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'f'</span>:\n","            player.fullscreen.toggle();\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'c'</span>:\n","            <span class=\"code-keyword\">if</span> (!repeat) {\n","              player.toggleCaptions();\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> <span class=\"code-string\">'l'</span>:\n","            player.loop = !player.loop;\n","            <span class=\"code-keyword\">break</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Escape is handle natively when in full screen</span>\n","        <span class=\"code-comment\">// So we only need to worry about non native</span>\n","        <span class=\"code-keyword\">if</span> (key === <span class=\"code-string\">'Escape'</span> &amp;&amp; !player.fullscreen.usingNative &amp;&amp; player.fullscreen.active) {\n","          player.fullscreen.toggle();\n","        }\n","\n","        <span class=\"code-comment\">// Store last key for next cycle</span>\n","        <span class=\"code-keyword\">this</span>.lastKey = key;\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">this</span>.lastKey = <span class=\"code-literal\">null</span>;\n","      }\n","    }\n","\n","    <span class=\"code-comment\">// Toggle menu</span>\n","    toggleMenu(event) {\n","      controls.toggleMenu.call(<span class=\"code-keyword\">this</span>.player, event);\n","    }\n","  }\n","\n","  <span class=\"code-keyword\">var</span> commonjsGlobal = <span class=\"code-keyword\">typeof</span> globalThis !== <span class=\"code-string\">'undefined'</span> ? globalThis : <span class=\"code-keyword\">typeof</span> <span class=\"code-built_in\">window</span> !== <span class=\"code-string\">'undefined'</span> ? <span class=\"code-built_in\">window</span> : <span class=\"code-keyword\">typeof</span> global !== <span class=\"code-string\">'undefined'</span> ? global : <span class=\"code-keyword\">typeof</span> self !== <span class=\"code-string\">'undefined'</span> ? self : {};\n","\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">createCommonjsModule</span>(<span class=\"code-params\">fn, module</span>) </span>{\n","  \t<span class=\"code-keyword\">return</span> <span class=\"code-built_in\">module</span> = { <span class=\"code-attr\">exports</span>: {} }, fn(<span class=\"code-built_in\">module</span>, <span class=\"code-built_in\">module</span>.exports), <span class=\"code-built_in\">module</span>.exports;\n","  }\n","\n","  <span class=\"code-keyword\">var</span> loadjs_umd = createCommonjsModule(<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">module, exports</span>) </span>{\n","    (<span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">root, factory</span>) </span>{\n","      {\n","        <span class=\"code-built_in\">module</span>.exports = factory();\n","      }\n","    })(commonjsGlobal, <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Global dependencies.\n</span>","<span class=\"code-comment\">       * @global {Object} document - DOM\n</span>","<span class=\"code-comment\">       */</span>\n","\n","      <span class=\"code-keyword\">var</span> devnull = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\"></span>) </span>{},\n","        bundleIdCache = {},\n","        bundleResultCache = {},\n","        bundleCallbackQueue = {};\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Subscribe to bundle load event.\n</span>","<span class=\"code-comment\">       * @param {string[]} bundleIds - Bundle ids\n</span>","<span class=\"code-comment\">       * @param {Function} callbackFn - The callback function\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">subscribe</span>(<span class=\"code-params\">bundleIds, callbackFn</span>) </span>{\n","        <span class=\"code-comment\">// listify</span>\n","        bundleIds = bundleIds.push ? bundleIds : [bundleIds];\n","        <span class=\"code-keyword\">var</span> depsNotFound = [],\n","          i = bundleIds.length,\n","          numWaiting = i,\n","          fn,\n","          bundleId,\n","          r,\n","          q;\n","\n","        <span class=\"code-comment\">// define callback function</span>\n","        fn = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">bundleId, pathsNotFound</span>) </span>{\n","          <span class=\"code-keyword\">if</span> (pathsNotFound.length) depsNotFound.push(bundleId);\n","          numWaiting--;\n","          <span class=\"code-keyword\">if</span> (!numWaiting) callbackFn(depsNotFound);\n","        };\n","\n","        <span class=\"code-comment\">// register callback</span>\n","        <span class=\"code-keyword\">while</span> (i--) {\n","          bundleId = bundleIds[i];\n","\n","          <span class=\"code-comment\">// execute callback if in result cache</span>\n","          r = bundleResultCache[bundleId];\n","          <span class=\"code-keyword\">if</span> (r) {\n","            fn(bundleId, r);\n","            <span class=\"code-keyword\">continue</span>;\n","          }\n","\n","          <span class=\"code-comment\">// add to callback queue</span>\n","          q = bundleCallbackQueue[bundleId] = bundleCallbackQueue[bundleId] || [];\n","          q.push(fn);\n","        }\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Publish bundle load event.\n</span>","<span class=\"code-comment\">       * @param {string} bundleId - Bundle id\n</span>","<span class=\"code-comment\">       * @param {string[]} pathsNotFound - List of files not found\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">publish</span>(<span class=\"code-params\">bundleId, pathsNotFound</span>) </span>{\n","        <span class=\"code-comment\">// exit if id isn't defined</span>\n","        <span class=\"code-keyword\">if</span> (!bundleId) <span class=\"code-keyword\">return</span>;\n","        <span class=\"code-keyword\">var</span> q = bundleCallbackQueue[bundleId];\n","\n","        <span class=\"code-comment\">// cache result</span>\n","        bundleResultCache[bundleId] = pathsNotFound;\n","\n","        <span class=\"code-comment\">// exit if queue is empty</span>\n","        <span class=\"code-keyword\">if</span> (!q) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// empty callback queue</span>\n","        <span class=\"code-keyword\">while</span> (q.length) {\n","          q[<span class=\"code-number\">0</span>](bundleId, pathsNotFound);\n","          q.splice(<span class=\"code-number\">0</span>, <span class=\"code-number\">1</span>);\n","        }\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Execute callbacks.\n</span>","<span class=\"code-comment\">       * @param {Object or Function} args - The callback args\n</span>","<span class=\"code-comment\">       * @param {string[]} depsNotFound - List of dependencies not found\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">executeCallbacks</span>(<span class=\"code-params\">args, depsNotFound</span>) </span>{\n","        <span class=\"code-comment\">// accept function as argument</span>\n","        <span class=\"code-keyword\">if</span> (args.call) args = {\n","          success: args\n","        };\n","\n","        <span class=\"code-comment\">// success and error callbacks</span>\n","        <span class=\"code-keyword\">if</span> (depsNotFound.length) (args.error || devnull)(depsNotFound);<span class=\"code-keyword\">else</span> (args.success || devnull)(args);\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Load individual file.\n</span>","<span class=\"code-comment\">       * @param {string} path - The file path\n</span>","<span class=\"code-comment\">       * @param {Function} callbackFn - The callback function\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadFile</span>(<span class=\"code-params\">path, callbackFn, args, numTries</span>) </span>{\n","        <span class=\"code-keyword\">var</span> doc = <span class=\"code-built_in\">document</span>,\n","          <span class=\"code-keyword\">async</span> = args.async,\n","          maxTries = (args.numRetries || <span class=\"code-number\">0</span>) + <span class=\"code-number\">1</span>,\n","          beforeCallbackFn = args.before || devnull,\n","          pathname = path.replace(<span class=\"code-regexp\">/[\\?|#].*$/</span>, <span class=\"code-string\">''</span>),\n","          pathStripped = path.replace(<span class=\"code-regexp\">/^(css|img)!/</span>, <span class=\"code-string\">''</span>),\n","          isLegacyIECss,\n","          e;\n","        numTries = numTries || <span class=\"code-number\">0</span>;\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-regexp\">/(^css!|\\.css$)/</span>.test(pathname)) {\n","          <span class=\"code-comment\">// css</span>\n","          e = doc.createElement(<span class=\"code-string\">'link'</span>);\n","          e.rel = <span class=\"code-string\">'stylesheet'</span>;\n","          e.href = pathStripped;\n","\n","          <span class=\"code-comment\">// tag IE9+</span>\n","          isLegacyIECss = <span class=\"code-string\">'hideFocus'</span> <span class=\"code-keyword\">in</span> e;\n","\n","          <span class=\"code-comment\">// use preload in IE Edge (to detect load errors)</span>\n","          <span class=\"code-keyword\">if</span> (isLegacyIECss &amp;&amp; e.relList) {\n","            isLegacyIECss = <span class=\"code-number\">0</span>;\n","            e.rel = <span class=\"code-string\">'preload'</span>;\n","            e.as = <span class=\"code-string\">'style'</span>;\n","          }\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-regexp\">/(^img!|\\.(png|gif|jpg|svg|webp)$)/</span>.test(pathname)) {\n","          <span class=\"code-comment\">// image</span>\n","          e = doc.createElement(<span class=\"code-string\">'img'</span>);\n","          e.src = pathStripped;\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-comment\">// javascript</span>\n","          e = doc.createElement(<span class=\"code-string\">'script'</span>);\n","          e.src = path;\n","          e.async = <span class=\"code-keyword\">async</span> === <span class=\"code-literal\">undefined</span> ? <span class=\"code-literal\">true</span> : <span class=\"code-keyword\">async</span>;\n","        }\n","        e.onload = e.onerror = e.onbeforeload = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">ev</span>) </span>{\n","          <span class=\"code-keyword\">var</span> result = ev.type[<span class=\"code-number\">0</span>];\n","\n","          <span class=\"code-comment\">// treat empty stylesheets as failures to get around lack of onerror</span>\n","          <span class=\"code-comment\">// support in IE9-11</span>\n","          <span class=\"code-keyword\">if</span> (isLegacyIECss) {\n","            <span class=\"code-keyword\">try</span> {\n","              <span class=\"code-keyword\">if</span> (!e.sheet.cssText.length) result = <span class=\"code-string\">'e'</span>;\n","            } <span class=\"code-keyword\">catch</span> (x) {\n","              <span class=\"code-comment\">// sheets objects created from load errors don't allow access to</span>\n","              <span class=\"code-comment\">// `cssText` (unless error is Code:18 SecurityError)</span>\n","              <span class=\"code-keyword\">if</span> (x.code != <span class=\"code-number\">18</span>) result = <span class=\"code-string\">'e'</span>;\n","            }\n","          }\n","\n","          <span class=\"code-comment\">// handle retries in case of load failure</span>\n","          <span class=\"code-keyword\">if</span> (result == <span class=\"code-string\">'e'</span>) {\n","            <span class=\"code-comment\">// increment counter</span>\n","            numTries += <span class=\"code-number\">1</span>;\n","\n","            <span class=\"code-comment\">// exit function and try again</span>\n","            <span class=\"code-keyword\">if</span> (numTries &lt; maxTries) {\n","              <span class=\"code-keyword\">return</span> loadFile(path, callbackFn, args, numTries);\n","            }\n","          } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (e.rel == <span class=\"code-string\">'preload'</span> &amp;&amp; e.as == <span class=\"code-string\">'style'</span>) {\n","            <span class=\"code-comment\">// activate preloaded stylesheets</span>\n","            <span class=\"code-keyword\">return</span> e.rel = <span class=\"code-string\">'stylesheet'</span>; <span class=\"code-comment\">// jshint ignore:line</span>\n","          }\n","\n","          <span class=\"code-comment\">// execute callback</span>\n","          callbackFn(path, result, ev.defaultPrevented);\n","        };\n","\n","        <span class=\"code-comment\">// add to document (unless callback returns `false`)</span>\n","        <span class=\"code-keyword\">if</span> (beforeCallbackFn(path, e) !== <span class=\"code-literal\">false</span>) doc.head.appendChild(e);\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Load multiple files.\n</span>","<span class=\"code-comment\">       * @param {string[]} paths - The file paths\n</span>","<span class=\"code-comment\">       * @param {Function} callbackFn - The callback function\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadFiles</span>(<span class=\"code-params\">paths, callbackFn, args</span>) </span>{\n","        <span class=\"code-comment\">// listify paths</span>\n","        paths = paths.push ? paths : [paths];\n","        <span class=\"code-keyword\">var</span> numWaiting = paths.length,\n","          x = numWaiting,\n","          pathsNotFound = [],\n","          fn,\n","          i;\n","\n","        <span class=\"code-comment\">// define callback function</span>\n","        fn = <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">path, result, defaultPrevented</span>) </span>{\n","          <span class=\"code-comment\">// handle error</span>\n","          <span class=\"code-keyword\">if</span> (result == <span class=\"code-string\">'e'</span>) pathsNotFound.push(path);\n","\n","          <span class=\"code-comment\">// handle beforeload event. If defaultPrevented then that means the load</span>\n","          <span class=\"code-comment\">// will be blocked (ex. Ghostery/ABP on Safari)</span>\n","          <span class=\"code-keyword\">if</span> (result == <span class=\"code-string\">'b'</span>) {\n","            <span class=\"code-keyword\">if</span> (defaultPrevented) pathsNotFound.push(path);<span class=\"code-keyword\">else</span> <span class=\"code-keyword\">return</span>;\n","          }\n","          numWaiting--;\n","          <span class=\"code-keyword\">if</span> (!numWaiting) callbackFn(pathsNotFound);\n","        };\n","\n","        <span class=\"code-comment\">// load scripts</span>\n","        <span class=\"code-keyword\">for</span> (i = <span class=\"code-number\">0</span>; i &lt; x; i++) loadFile(paths[i], fn, args);\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Initiate script load and register bundle.\n</span>","<span class=\"code-comment\">       * @param {(string|string[])} paths - The file paths\n</span>","<span class=\"code-comment\">       * @param {(string|Function|Object)} [arg1] - The (1) bundleId or (2) success\n</span>","<span class=\"code-comment\">       *   callback or (3) object literal with success/error arguments, numRetries,\n</span>","<span class=\"code-comment\">       *   etc.\n</span>","<span class=\"code-comment\">       * @param {(Function|Object)} [arg2] - The (1) success callback or (2) object\n</span>","<span class=\"code-comment\">       *   literal with success/error arguments, numRetries, etc.\n</span>","<span class=\"code-comment\">       */</span>\n","      <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadjs</span>(<span class=\"code-params\">paths, arg1, arg2</span>) </span>{\n","        <span class=\"code-keyword\">var</span> bundleId, args;\n","\n","        <span class=\"code-comment\">// bundleId (if string)</span>\n","        <span class=\"code-keyword\">if</span> (arg1 &amp;&amp; arg1.trim) bundleId = arg1;\n","\n","        <span class=\"code-comment\">// args (default is {})</span>\n","        args = (bundleId ? arg2 : arg1) || {};\n","\n","        <span class=\"code-comment\">// throw error if bundle is already defined</span>\n","        <span class=\"code-keyword\">if</span> (bundleId) {\n","          <span class=\"code-keyword\">if</span> (bundleId <span class=\"code-keyword\">in</span> bundleIdCache) {\n","            <span class=\"code-keyword\">throw</span> <span class=\"code-string\">\"LoadJS\"</span>;\n","          } <span class=\"code-keyword\">else</span> {\n","            bundleIdCache[bundleId] = <span class=\"code-literal\">true</span>;\n","          }\n","        }\n","        <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadFn</span>(<span class=\"code-params\">resolve, reject</span>) </span>{\n","          loadFiles(paths, <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">pathsNotFound</span>) </span>{\n","            <span class=\"code-comment\">// execute callbacks</span>\n","            executeCallbacks(args, pathsNotFound);\n","\n","            <span class=\"code-comment\">// resolve Promise</span>\n","            <span class=\"code-keyword\">if</span> (resolve) {\n","              executeCallbacks({\n","                success: resolve,\n","                error: reject\n","              }, pathsNotFound);\n","            }\n","\n","            <span class=\"code-comment\">// publish bundle load event</span>\n","            publish(bundleId, pathsNotFound);\n","          }, args);\n","        }\n","        <span class=\"code-keyword\">if</span> (args.returnPromise) <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(loadFn);<span class=\"code-keyword\">else</span> loadFn();\n","      }\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Execute callbacks when dependencies have been satisfied.\n</span>","<span class=\"code-comment\">       * @param {(string|string[])} deps - List of bundle ids\n</span>","<span class=\"code-comment\">       * @param {Object} args - success/error arguments\n</span>","<span class=\"code-comment\">       */</span>\n","      loadjs.ready = <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">ready</span>(<span class=\"code-params\">deps, args</span>) </span>{\n","        <span class=\"code-comment\">// subscribe to bundle load event</span>\n","        subscribe(deps, <span class=\"code-function\"><span class=\"code-keyword\">function</span> (<span class=\"code-params\">depsNotFound</span>) </span>{\n","          <span class=\"code-comment\">// execute callbacks</span>\n","          executeCallbacks(args, depsNotFound);\n","        });\n","        <span class=\"code-keyword\">return</span> loadjs;\n","      };\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Manually satisfy bundle dependencies.\n</span>","<span class=\"code-comment\">       * @param {string} bundleId - The bundle id\n</span>","<span class=\"code-comment\">       */</span>\n","      loadjs.done = <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">done</span>(<span class=\"code-params\">bundleId</span>) </span>{\n","        publish(bundleId, []);\n","      };\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Reset loadjs dependencies statuses\n</span>","<span class=\"code-comment\">       */</span>\n","      loadjs.reset = <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">reset</span>(<span class=\"code-params\"></span>) </span>{\n","        bundleIdCache = {};\n","        bundleResultCache = {};\n","        bundleCallbackQueue = {};\n","      };\n","\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Determine if bundle has already been defined\n</span>","<span class=\"code-comment\">       * @param String} bundleId - The bundle id\n</span>","<span class=\"code-comment\">       */</span>\n","      loadjs.isDefined = <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">isDefined</span>(<span class=\"code-params\">bundleId</span>) </span>{\n","        <span class=\"code-keyword\">return</span> bundleId <span class=\"code-keyword\">in</span> bundleIdCache;\n","      };\n","\n","      <span class=\"code-comment\">// export</span>\n","      <span class=\"code-keyword\">return</span> loadjs;\n","    });\n","  });\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">loadScript</span>(<span class=\"code-params\">url</span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\">(<span class=\"code-params\">resolve, reject</span>) =&gt;</span> {\n","      loadjs_umd(url, {\n","        success: resolve,\n","        error: reject\n","      });\n","    });\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Parse Vimeo ID from URL</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">parseId$1</span>(<span class=\"code-params\">url</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.empty(url)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","    <span class=\"code-keyword\">if</span> (is.number(<span class=\"code-built_in\">Number</span>(url))) {\n","      <span class=\"code-keyword\">return</span> url;\n","    }\n","    <span class=\"code-keyword\">const</span> regex = <span class=\"code-regexp\">/^.*(vimeo.com\\/|video\\/)(\\d+).*/</span>;\n","    <span class=\"code-keyword\">return</span> url.match(regex) ? <span class=\"code-built_in\">RegExp</span>.$<span class=\"code-number\">2</span> : url;\n","  }\n","\n","  <span class=\"code-comment\">// Try to extract a hash for private videos from the URL</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">parseHash</span>(<span class=\"code-params\">url</span>) </span>{\n","    <span class=\"code-comment\">/* This regex matches a hexadecimal hash if given in any of these forms:\n</span>","<span class=\"code-comment\">     *  - [https://player.]vimeo.com/video/{id}/{hash}[?params]\n</span>","<span class=\"code-comment\">     *  - [https://player.]vimeo.com/video/{id}?h={hash}[&amp;params]\n</span>","<span class=\"code-comment\">     *  - [https://player.]vimeo.com/video/{id}?[params]&amp;h={hash}\n</span>","<span class=\"code-comment\">     *  - video/{id}/{hash}\n</span>","<span class=\"code-comment\">     * If matched, the hash is available in capture group 4\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">const</span> regex = <span class=\"code-regexp\">/^.*(vimeo.com\\/|video\\/)(\\d+)(\\?.*&amp;*h=|\\/)+([\\d,a-f]+)/</span>;\n","    <span class=\"code-keyword\">const</span> found = url.match(regex);\n","    <span class=\"code-keyword\">return</span> found &amp;&amp; found.length === <span class=\"code-number\">5</span> ? found[<span class=\"code-number\">4</span>] : <span class=\"code-literal\">null</span>;\n","  }\n","\n","  <span class=\"code-comment\">// Set playback state and trigger change (only on actual change)</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">assurePlaybackState$1</span>(<span class=\"code-params\">play</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (play &amp;&amp; !<span class=\"code-keyword\">this</span>.embed.hasPlayed) {\n","      <span class=\"code-keyword\">this</span>.embed.hasPlayed = <span class=\"code-literal\">true</span>;\n","    }\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.paused === play) {\n","      <span class=\"code-keyword\">this</span>.media.paused = !play;\n","      triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, play ? <span class=\"code-string\">'play'</span> : <span class=\"code-string\">'pause'</span>);\n","    }\n","  }\n","  <span class=\"code-keyword\">const</span> vimeo = {\n","    setup() {\n","      <span class=\"code-keyword\">const</span> player = <span class=\"code-keyword\">this</span>;\n","\n","      <span class=\"code-comment\">// Add embed class for responsive</span>\n","      toggleClass(player.elements.wrapper, player.config.classNames.embed, <span class=\"code-literal\">true</span>);\n","\n","      <span class=\"code-comment\">// Set speed options from config</span>\n","      player.options.speed = player.config.speed.options;\n","\n","      <span class=\"code-comment\">// Set intial ratio</span>\n","      setAspectRatio.call(player);\n","\n","      <span class=\"code-comment\">// Load the SDK if not already</span>\n","      <span class=\"code-keyword\">if</span> (!is.object(<span class=\"code-built_in\">window</span>.Vimeo)) {\n","        loadScript(player.config.urls.vimeo.sdk).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          vimeo.ready.call(player);\n","        }).catch(<span class=\"code-function\"><span class=\"code-params\">error</span> =&gt;</span> {\n","          player.debug.warn(<span class=\"code-string\">'Vimeo SDK (player.js) failed to load'</span>, error);\n","        });\n","      } <span class=\"code-keyword\">else</span> {\n","        vimeo.ready.call(player);\n","      }\n","    },\n","    <span class=\"code-comment\">// API Ready</span>\n","    ready() {\n","      <span class=\"code-keyword\">const</span> player = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">const</span> config = player.config.vimeo;\n","      <span class=\"code-keyword\">const</span> {\n","        premium,\n","        referrerPolicy,\n","        ...frameParams\n","      } = config;\n","      <span class=\"code-comment\">// Get the source URL or ID</span>\n","      <span class=\"code-keyword\">let</span> source = player.media.getAttribute(<span class=\"code-string\">'src'</span>);\n","      <span class=\"code-keyword\">let</span> hash = <span class=\"code-string\">''</span>;\n","      <span class=\"code-comment\">// Get from &lt;div&gt; if needed</span>\n","      <span class=\"code-keyword\">if</span> (is.empty(source)) {\n","        source = player.media.getAttribute(player.config.attributes.embed.id);\n","        <span class=\"code-comment\">// hash can also be set as attribute on the &lt;div&gt;</span>\n","        hash = player.media.getAttribute(player.config.attributes.embed.hash);\n","      } <span class=\"code-keyword\">else</span> {\n","        hash = parseHash(source);\n","      }\n","      <span class=\"code-keyword\">const</span> hashParam = hash ? {\n","        h: hash\n","      } : {};\n","\n","      <span class=\"code-comment\">// If the owner has a pro or premium account then we can hide controls etc</span>\n","      <span class=\"code-keyword\">if</span> (premium) {\n","        <span class=\"code-built_in\">Object</span>.assign(frameParams, {\n","          controls: <span class=\"code-literal\">false</span>,\n","          sidedock: <span class=\"code-literal\">false</span>\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Get Vimeo params for the iframe</span>\n","      <span class=\"code-keyword\">const</span> params = buildUrlParams({\n","        loop: player.config.loop.active,\n","        autoplay: player.autoplay,\n","        muted: player.muted,\n","        gesture: <span class=\"code-string\">'media'</span>,\n","        playsinline: player.config.playsinline,\n","        <span class=\"code-comment\">// hash has to be added to iframe-URL</span>\n","        ...hashParam,\n","        ...frameParams\n","      });\n","      <span class=\"code-keyword\">const</span> id = parseId$<span class=\"code-number\">1</span>(source);\n","      <span class=\"code-comment\">// Build an iframe</span>\n","      <span class=\"code-keyword\">const</span> iframe = createElement(<span class=\"code-string\">'iframe'</span>);\n","      <span class=\"code-keyword\">const</span> src = format(player.config.urls.vimeo.iframe, id, params);\n","      iframe.setAttribute(<span class=\"code-string\">'src'</span>, src);\n","      iframe.setAttribute(<span class=\"code-string\">'allowfullscreen'</span>, <span class=\"code-string\">''</span>);\n","      iframe.setAttribute(<span class=\"code-string\">'allow'</span>, [<span class=\"code-string\">'autoplay'</span>, <span class=\"code-string\">'fullscreen'</span>, <span class=\"code-string\">'picture-in-picture'</span>, <span class=\"code-string\">'encrypted-media'</span>, <span class=\"code-string\">'accelerometer'</span>, <span class=\"code-string\">'gyroscope'</span>].join(<span class=\"code-string\">'; '</span>));\n","\n","      <span class=\"code-comment\">// Set the referrer policy if required</span>\n","      <span class=\"code-keyword\">if</span> (!is.empty(referrerPolicy)) {\n","        iframe.setAttribute(<span class=\"code-string\">'referrerPolicy'</span>, referrerPolicy);\n","      }\n","\n","      <span class=\"code-comment\">// Inject the package</span>\n","      <span class=\"code-keyword\">if</span> (premium || !config.customControls) {\n","        iframe.setAttribute(<span class=\"code-string\">'data-poster'</span>, player.poster);\n","        player.media = replaceElement(iframe, player.media);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">const</span> wrapper = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: player.config.classNames.embedContainer,\n","          <span class=\"code-string\">'data-poster'</span>: player.poster\n","        });\n","        wrapper.appendChild(iframe);\n","        player.media = replaceElement(wrapper, player.media);\n","      }\n","\n","      <span class=\"code-comment\">// Get poster image</span>\n","      <span class=\"code-keyword\">if</span> (!config.customControls) {\n","        fetch(format(player.config.urls.vimeo.api, src)).then(<span class=\"code-function\"><span class=\"code-params\">response</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (is.empty(response) || !response.thumbnail_url) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Set and show poster</span>\n","          ui.setPoster.call(player, response.thumbnail_url).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Setup instance</span>\n","      <span class=\"code-comment\">// https://github.com/vimeo/player.js</span>\n","      player.embed = <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">window</span>.Vimeo.Player(iframe, {\n","        autopause: player.config.autopause,\n","        muted: player.muted\n","      });\n","      player.media.paused = <span class=\"code-literal\">true</span>;\n","      player.media.currentTime = <span class=\"code-number\">0</span>;\n","\n","      <span class=\"code-comment\">// Disable native text track rendering</span>\n","      <span class=\"code-keyword\">if</span> (player.supported.ui) {\n","        player.embed.disableTextTrack();\n","      }\n","\n","      <span class=\"code-comment\">// Create a faux HTML5 API using the Vimeo API</span>\n","      player.media.play = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        assurePlaybackState$<span class=\"code-number\">1.</span>call(player, <span class=\"code-literal\">true</span>);\n","        <span class=\"code-keyword\">return</span> player.embed.play();\n","      };\n","      player.media.pause = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        assurePlaybackState$<span class=\"code-number\">1.</span>call(player, <span class=\"code-literal\">false</span>);\n","        <span class=\"code-keyword\">return</span> player.embed.pause();\n","      };\n","      player.media.stop = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        player.pause();\n","        player.currentTime = <span class=\"code-number\">0</span>;\n","      };\n","\n","      <span class=\"code-comment\">// Seeking</span>\n","      <span class=\"code-keyword\">let</span> {\n","        currentTime\n","      } = player.media;\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'currentTime'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> currentTime;\n","        },\n","        <span class=\"code-keyword\">set</span>(time) {\n","          <span class=\"code-comment\">// Vimeo will automatically play on seek if the video hasn't been played before</span>\n","\n","          <span class=\"code-comment\">// Get current paused state and volume etc</span>\n","          <span class=\"code-keyword\">const</span> {\n","            embed,\n","            media,\n","            paused,\n","            volume\n","          } = player;\n","          <span class=\"code-keyword\">const</span> restorePause = paused &amp;&amp; !embed.hasPlayed;\n","\n","          <span class=\"code-comment\">// Set seeking state and trigger event</span>\n","          media.seeking = <span class=\"code-literal\">true</span>;\n","          triggerEvent.call(player, media, <span class=\"code-string\">'seeking'</span>);\n","\n","          <span class=\"code-comment\">// If paused, mute until seek is complete</span>\n","          <span class=\"code-built_in\">Promise</span>.resolve(restorePause &amp;&amp; embed.setVolume(<span class=\"code-number\">0</span>))\n","          <span class=\"code-comment\">// Seek</span>\n","          .then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> embed.setCurrentTime(time))\n","          <span class=\"code-comment\">// Restore paused</span>\n","          .then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> restorePause &amp;&amp; embed.pause())\n","          <span class=\"code-comment\">// Restore volume</span>\n","          .then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> restorePause &amp;&amp; embed.setVolume(volume)).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-comment\">// Do nothing</span>\n","          });\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Playback speed</span>\n","      <span class=\"code-keyword\">let</span> speed = player.config.speed.selected;\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'playbackRate'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> speed;\n","        },\n","        <span class=\"code-keyword\">set</span>(input) {\n","          player.embed.setPlaybackRate(input).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            speed = input;\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'ratechange'</span>);\n","          }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-comment\">// Cannot set Playback Rate, Video is probably not on Pro account</span>\n","            player.options.speed = [<span class=\"code-number\">1</span>];\n","          });\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Volume</span>\n","      <span class=\"code-keyword\">let</span> {\n","        volume\n","      } = player.config;\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'volume'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> volume;\n","        },\n","        <span class=\"code-keyword\">set</span>(input) {\n","          player.embed.setVolume(input).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            volume = input;\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'volumechange'</span>);\n","          });\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Muted</span>\n","      <span class=\"code-keyword\">let</span> {\n","        muted\n","      } = player.config;\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'muted'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> muted;\n","        },\n","        <span class=\"code-keyword\">set</span>(input) {\n","          <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : <span class=\"code-literal\">false</span>;\n","          player.embed.setMuted(toggle ? <span class=\"code-literal\">true</span> : player.config.muted).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            muted = toggle;\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'volumechange'</span>);\n","          });\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Loop</span>\n","      <span class=\"code-keyword\">let</span> {\n","        loop\n","      } = player.config;\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'loop'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> loop;\n","        },\n","        <span class=\"code-keyword\">set</span>(input) {\n","          <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : player.config.loop.active;\n","          player.embed.setLoop(toggle).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            loop = toggle;\n","          });\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Source</span>\n","      <span class=\"code-keyword\">let</span> currentSrc;\n","      player.embed.getVideoUrl().then(<span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> {\n","        currentSrc = value;\n","        controls.setDownloadUrl.call(player);\n","      }).catch(<span class=\"code-function\"><span class=\"code-params\">error</span> =&gt;</span> {\n","        <span class=\"code-keyword\">this</span>.debug.warn(error);\n","      });\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'currentSrc'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> currentSrc;\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Ended</span>\n","      <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'ended'</span>, {\n","        <span class=\"code-keyword\">get</span>() {\n","          <span class=\"code-keyword\">return</span> player.currentTime === player.duration;\n","        }\n","      });\n","\n","      <span class=\"code-comment\">// Set aspect ratio based on video size</span>\n","      <span class=\"code-built_in\">Promise</span>.all([player.embed.getVideoWidth(), player.embed.getVideoHeight()]).then(<span class=\"code-function\"><span class=\"code-params\">dimensions</span> =&gt;</span> {\n","        <span class=\"code-keyword\">const</span> [width, height] = dimensions;\n","        player.embed.ratio = roundAspectRatio(width, height);\n","        setAspectRatio.call(<span class=\"code-keyword\">this</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Set autopause</span>\n","      player.embed.setAutopause(player.config.autopause).then(<span class=\"code-function\"><span class=\"code-params\">state</span> =&gt;</span> {\n","        player.config.autopause = state;\n","      });\n","\n","      <span class=\"code-comment\">// Get title</span>\n","      player.embed.getVideoTitle().then(<span class=\"code-function\"><span class=\"code-params\">title</span> =&gt;</span> {\n","        player.config.title = title;\n","        ui.setTitle.call(<span class=\"code-keyword\">this</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Get current time</span>\n","      player.embed.getCurrentTime().then(<span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> {\n","        currentTime = value;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'timeupdate'</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Get duration</span>\n","      player.embed.getDuration().then(<span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> {\n","        player.media.duration = value;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'durationchange'</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Get captions</span>\n","      player.embed.getTextTracks().then(<span class=\"code-function\"><span class=\"code-params\">tracks</span> =&gt;</span> {\n","        player.media.textTracks = tracks;\n","        captions.setup.call(player);\n","      });\n","      player.embed.on(<span class=\"code-string\">'cuechange'</span>, ({\n","        cues = []\n","      }) =&gt; {\n","        <span class=\"code-keyword\">const</span> strippedCues = cues.map(<span class=\"code-function\"><span class=\"code-params\">cue</span> =&gt;</span> stripHTML(cue.text));\n","        captions.updateCues.call(player, strippedCues);\n","      });\n","      player.embed.on(<span class=\"code-string\">'loaded'</span>, () =&gt; {\n","        <span class=\"code-comment\">// Assure state and events are updated on autoplay</span>\n","        player.embed.getPaused().then(<span class=\"code-function\"><span class=\"code-params\">paused</span> =&gt;</span> {\n","          assurePlaybackState$<span class=\"code-number\">1.</span>call(player, !paused);\n","          <span class=\"code-keyword\">if</span> (!paused) {\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'playing'</span>);\n","          }\n","        });\n","        <span class=\"code-keyword\">if</span> (is.element(player.embed.element) &amp;&amp; player.supported.ui) {\n","          <span class=\"code-keyword\">const</span> frame = player.embed.element;\n","\n","          <span class=\"code-comment\">// Fix keyboard focus issues</span>\n","          <span class=\"code-comment\">// https://github.com/sampotts/plyr/issues/317</span>\n","          frame.setAttribute(<span class=\"code-string\">'tabindex'</span>, <span class=\"code-number\">-1</span>);\n","        }\n","      });\n","      player.embed.on(<span class=\"code-string\">'bufferstart'</span>, () =&gt; {\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'waiting'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'bufferend'</span>, () =&gt; {\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'playing'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'play'</span>, () =&gt; {\n","        assurePlaybackState$<span class=\"code-number\">1.</span>call(player, <span class=\"code-literal\">true</span>);\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'playing'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'pause'</span>, () =&gt; {\n","        assurePlaybackState$<span class=\"code-number\">1.</span>call(player, <span class=\"code-literal\">false</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'timeupdate'</span>, data =&gt; {\n","        player.media.seeking = <span class=\"code-literal\">false</span>;\n","        currentTime = data.seconds;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'timeupdate'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'progress'</span>, data =&gt; {\n","        player.media.buffered = data.percent;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'progress'</span>);\n","\n","        <span class=\"code-comment\">// Check all loaded</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">parseInt</span>(data.percent, <span class=\"code-number\">10</span>) === <span class=\"code-number\">1</span>) {\n","          triggerEvent.call(player, player.media, <span class=\"code-string\">'canplaythrough'</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Get duration as if we do it before load, it gives an incorrect value</span>\n","        <span class=\"code-comment\">// https://github.com/sampotts/plyr/issues/891</span>\n","        player.embed.getDuration().then(<span class=\"code-function\"><span class=\"code-params\">value</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (value !== player.media.duration) {\n","            player.media.duration = value;\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'durationchange'</span>);\n","          }\n","        });\n","      });\n","      player.embed.on(<span class=\"code-string\">'seeked'</span>, () =&gt; {\n","        player.media.seeking = <span class=\"code-literal\">false</span>;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'seeked'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'ended'</span>, () =&gt; {\n","        player.media.paused = <span class=\"code-literal\">true</span>;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'ended'</span>);\n","      });\n","      player.embed.on(<span class=\"code-string\">'error'</span>, detail =&gt; {\n","        player.media.error = detail;\n","        triggerEvent.call(player, player.media, <span class=\"code-string\">'error'</span>);\n","      });\n","\n","      <span class=\"code-comment\">// Rebuild UI</span>\n","      <span class=\"code-keyword\">if</span> (config.customControls) {\n","        setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> ui.build.call(player), <span class=\"code-number\">0</span>);\n","      }\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","\n","  <span class=\"code-comment\">// Parse YouTube ID from URL</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">parseId</span>(<span class=\"code-params\">url</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (is.empty(url)) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","    }\n","    <span class=\"code-keyword\">const</span> regex = <span class=\"code-regexp\">/^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&amp;v=)([^#&amp;?]*).*/</span>;\n","    <span class=\"code-keyword\">return</span> url.match(regex) ? <span class=\"code-built_in\">RegExp</span>.$<span class=\"code-number\">2</span> : url;\n","  }\n","\n","  <span class=\"code-comment\">// Set playback state and trigger change (only on actual change)</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">assurePlaybackState</span>(<span class=\"code-params\">play</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (play &amp;&amp; !<span class=\"code-keyword\">this</span>.embed.hasPlayed) {\n","      <span class=\"code-keyword\">this</span>.embed.hasPlayed = <span class=\"code-literal\">true</span>;\n","    }\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.paused === play) {\n","      <span class=\"code-keyword\">this</span>.media.paused = !play;\n","      triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, play ? <span class=\"code-string\">'play'</span> : <span class=\"code-string\">'pause'</span>);\n","    }\n","  }\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">getHost</span>(<span class=\"code-params\">config</span>) </span>{\n","    <span class=\"code-keyword\">if</span> (config.noCookie) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-string\">'https://www.youtube-nocookie.com'</span>;\n","    }\n","    <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">window</span>.location.protocol === <span class=\"code-string\">'http:'</span>) {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-string\">'http://www.youtube.com'</span>;\n","    }\n","\n","    <span class=\"code-comment\">// Use YouTube's default</span>\n","    <span class=\"code-keyword\">return</span> <span class=\"code-literal\">undefined</span>;\n","  }\n","  <span class=\"code-keyword\">const</span> youtube = {\n","    setup() {\n","      <span class=\"code-comment\">// Add embed class for responsive</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.wrapper, <span class=\"code-keyword\">this</span>.config.classNames.embed, <span class=\"code-literal\">true</span>);\n","\n","      <span class=\"code-comment\">// Setup API</span>\n","      <span class=\"code-keyword\">if</span> (is.object(<span class=\"code-built_in\">window</span>.YT) &amp;&amp; is.function(<span class=\"code-built_in\">window</span>.YT.Player)) {\n","        youtube.ready.call(<span class=\"code-keyword\">this</span>);\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-comment\">// Reference current global callback</span>\n","        <span class=\"code-keyword\">const</span> callback = <span class=\"code-built_in\">window</span>.onYouTubeIframeAPIReady;\n","\n","        <span class=\"code-comment\">// Set callback to process queue</span>\n","        <span class=\"code-built_in\">window</span>.onYouTubeIframeAPIReady = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-comment\">// Call global callback if set</span>\n","          <span class=\"code-keyword\">if</span> (is.function(callback)) {\n","            callback();\n","          }\n","          youtube.ready.call(<span class=\"code-keyword\">this</span>);\n","        };\n","\n","        <span class=\"code-comment\">// Load the SDK</span>\n","        loadScript(<span class=\"code-keyword\">this</span>.config.urls.youtube.sdk).catch(<span class=\"code-function\"><span class=\"code-params\">error</span> =&gt;</span> {\n","          <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'YouTube API failed to load'</span>, error);\n","        });\n","      }\n","    },\n","    <span class=\"code-comment\">// Get the media title</span>\n","    getTitle(videoId) {\n","      <span class=\"code-keyword\">const</span> url = format(<span class=\"code-keyword\">this</span>.config.urls.youtube.api, videoId);\n","      fetch(url).then(<span class=\"code-function\"><span class=\"code-params\">data</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (is.object(data)) {\n","          <span class=\"code-keyword\">const</span> {\n","            title,\n","            height,\n","            width\n","          } = data;\n","\n","          <span class=\"code-comment\">// Set title</span>\n","          <span class=\"code-keyword\">this</span>.config.title = title;\n","          ui.setTitle.call(<span class=\"code-keyword\">this</span>);\n","\n","          <span class=\"code-comment\">// Set aspect ratio</span>\n","          <span class=\"code-keyword\">this</span>.embed.ratio = roundAspectRatio(width, height);\n","        }\n","        setAspectRatio.call(<span class=\"code-keyword\">this</span>);\n","      }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-comment\">// Set aspect ratio</span>\n","        setAspectRatio.call(<span class=\"code-keyword\">this</span>);\n","      });\n","    },\n","    <span class=\"code-comment\">// API ready</span>\n","    ready() {\n","      <span class=\"code-keyword\">const</span> player = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">const</span> config = player.config.youtube;\n","      <span class=\"code-comment\">// Ignore already setup (race condition)</span>\n","      <span class=\"code-keyword\">const</span> currentId = player.media &amp;&amp; player.media.getAttribute(<span class=\"code-string\">'id'</span>);\n","      <span class=\"code-keyword\">if</span> (!is.empty(currentId) &amp;&amp; currentId.startsWith(<span class=\"code-string\">'youtube-'</span>)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Get the source URL or ID</span>\n","      <span class=\"code-keyword\">let</span> source = player.media.getAttribute(<span class=\"code-string\">'src'</span>);\n","\n","      <span class=\"code-comment\">// Get from &lt;div&gt; if needed</span>\n","      <span class=\"code-keyword\">if</span> (is.empty(source)) {\n","        source = player.media.getAttribute(<span class=\"code-keyword\">this</span>.config.attributes.embed.id);\n","      }\n","\n","      <span class=\"code-comment\">// Replace the &lt;iframe&gt; with a &lt;div&gt; due to YouTube API issues</span>\n","      <span class=\"code-keyword\">const</span> videoId = parseId(source);\n","      <span class=\"code-keyword\">const</span> id = generateId(player.provider);\n","      <span class=\"code-comment\">// Replace media element</span>\n","      <span class=\"code-keyword\">const</span> container = createElement(<span class=\"code-string\">'div'</span>, {\n","        id,\n","        <span class=\"code-string\">'data-poster'</span>: config.customControls ? player.poster : <span class=\"code-literal\">undefined</span>\n","      });\n","      player.media = replaceElement(container, player.media);\n","\n","      <span class=\"code-comment\">// Only load the poster when using custom controls</span>\n","      <span class=\"code-keyword\">if</span> (config.customControls) {\n","        <span class=\"code-keyword\">const</span> posterSrc = <span class=\"code-function\"><span class=\"code-params\">s</span> =&gt;</span> <span class=\"code-string\">`https://i.ytimg.com/vi/<span class=\"code-subst\">${videoId}</span>/<span class=\"code-subst\">${s}</span>default.jpg`</span>;\n","\n","        <span class=\"code-comment\">// Check thumbnail images in order of quality, but reject fallback thumbnails (120px wide)</span>\n","        loadImage(posterSrc(<span class=\"code-string\">'maxres'</span>), <span class=\"code-number\">121</span>) <span class=\"code-comment\">// Highest quality and un-padded</span>\n","        .catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> loadImage(posterSrc(<span class=\"code-string\">'sd'</span>), <span class=\"code-number\">121</span>)) <span class=\"code-comment\">// 480p padded 4:3</span>\n","        .catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> loadImage(posterSrc(<span class=\"code-string\">'hq'</span>))) <span class=\"code-comment\">// 360p padded 4:3. Always exists</span>\n","        .then(<span class=\"code-function\"><span class=\"code-params\">image</span> =&gt;</span> ui.setPoster.call(player, image.src)).then(<span class=\"code-function\"><span class=\"code-params\">src</span> =&gt;</span> {\n","          <span class=\"code-comment\">// If the image is padded, use background-size \"cover\" instead (like youtube does too with their posters)</span>\n","          <span class=\"code-keyword\">if</span> (!src.includes(<span class=\"code-string\">'maxres'</span>)) {\n","            player.elements.poster.style.backgroundSize = <span class=\"code-string\">'cover'</span>;\n","          }\n","        }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","      }\n","\n","      <span class=\"code-comment\">// Setup instance</span>\n","      <span class=\"code-comment\">// https://developers.google.com/youtube/iframe_api_reference</span>\n","      player.embed = <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">window</span>.YT.Player(player.media, {\n","        videoId,\n","        host: getHost(config),\n","        playerVars: extend({}, {\n","          <span class=\"code-comment\">// Autoplay</span>\n","          autoplay: player.config.autoplay ? <span class=\"code-number\">1</span> : <span class=\"code-number\">0</span>,\n","          <span class=\"code-comment\">// iframe interface language</span>\n","          hl: player.config.hl,\n","          <span class=\"code-comment\">// Only show controls if not fully supported or opted out</span>\n","          controls: player.supported.ui &amp;&amp; config.customControls ? <span class=\"code-number\">0</span> : <span class=\"code-number\">1</span>,\n","          <span class=\"code-comment\">// Disable keyboard as we handle it</span>\n","          disablekb: <span class=\"code-number\">1</span>,\n","          <span class=\"code-comment\">// Allow iOS inline playback</span>\n","          playsinline: player.config.playsinline &amp;&amp; !player.config.fullscreen.iosNative ? <span class=\"code-number\">1</span> : <span class=\"code-number\">0</span>,\n","          <span class=\"code-comment\">// Captions are flaky on YouTube</span>\n","          cc_load_policy: player.captions.active ? <span class=\"code-number\">1</span> : <span class=\"code-number\">0</span>,\n","          cc_lang_pref: player.config.captions.language,\n","          <span class=\"code-comment\">// Tracking for stats</span>\n","          widget_referrer: <span class=\"code-built_in\">window</span> ? <span class=\"code-built_in\">window</span>.location.href : <span class=\"code-literal\">null</span>\n","        }, config),\n","        events: {\n","          onError(event) {\n","            <span class=\"code-comment\">// YouTube may fire onError twice, so only handle it once</span>\n","            <span class=\"code-keyword\">if</span> (!player.media.error) {\n","              <span class=\"code-keyword\">const</span> code = event.data;\n","              <span class=\"code-comment\">// Messages copied from https://developers.google.com/youtube/iframe_api_reference#onError</span>\n","              <span class=\"code-keyword\">const</span> message = {\n","                <span class=\"code-number\">2</span>: <span class=\"code-string\">'The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.'</span>,\n","                <span class=\"code-number\">5</span>: <span class=\"code-string\">'The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.'</span>,\n","                <span class=\"code-number\">100</span>: <span class=\"code-string\">'The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.'</span>,\n","                <span class=\"code-number\">101</span>: <span class=\"code-string\">'The owner of the requested video does not allow it to be played in embedded players.'</span>,\n","                <span class=\"code-number\">150</span>: <span class=\"code-string\">'The owner of the requested video does not allow it to be played in embedded players.'</span>\n","              }[code] || <span class=\"code-string\">'An unknown error occurred'</span>;\n","              player.media.error = {\n","                code,\n","                message\n","              };\n","              triggerEvent.call(player, player.media, <span class=\"code-string\">'error'</span>);\n","            }\n","          },\n","          onPlaybackRateChange(event) {\n","            <span class=\"code-comment\">// Get the instance</span>\n","            <span class=\"code-keyword\">const</span> instance = event.target;\n","\n","            <span class=\"code-comment\">// Get current speed</span>\n","            player.media.playbackRate = instance.getPlaybackRate();\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'ratechange'</span>);\n","          },\n","          onReady(event) {\n","            <span class=\"code-comment\">// Bail if onReady has already been called. See issue #1108</span>\n","            <span class=\"code-keyword\">if</span> (is.function(player.media.play)) {\n","              <span class=\"code-keyword\">return</span>;\n","            }\n","            <span class=\"code-comment\">// Get the instance</span>\n","            <span class=\"code-keyword\">const</span> instance = event.target;\n","\n","            <span class=\"code-comment\">// Get the title</span>\n","            youtube.getTitle.call(player, videoId);\n","\n","            <span class=\"code-comment\">// Create a faux HTML5 API using the YouTube API</span>\n","            player.media.play = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              assurePlaybackState.call(player, <span class=\"code-literal\">true</span>);\n","              instance.playVideo();\n","            };\n","            player.media.pause = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              assurePlaybackState.call(player, <span class=\"code-literal\">false</span>);\n","              instance.pauseVideo();\n","            };\n","            player.media.stop = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              instance.stopVideo();\n","            };\n","            player.media.duration = instance.getDuration();\n","            player.media.paused = <span class=\"code-literal\">true</span>;\n","\n","            <span class=\"code-comment\">// Seeking</span>\n","            player.media.currentTime = <span class=\"code-number\">0</span>;\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'currentTime'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Number</span>(instance.getCurrentTime());\n","              },\n","              <span class=\"code-keyword\">set</span>(time) {\n","                <span class=\"code-comment\">// If paused and never played, mute audio preventively (YouTube starts playing on seek if the video hasn't been played yet).</span>\n","                <span class=\"code-keyword\">if</span> (player.paused &amp;&amp; !player.embed.hasPlayed) {\n","                  player.embed.mute();\n","                }\n","\n","                <span class=\"code-comment\">// Set seeking state and trigger event</span>\n","                player.media.seeking = <span class=\"code-literal\">true</span>;\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'seeking'</span>);\n","\n","                <span class=\"code-comment\">// Seek after events sent</span>\n","                instance.seekTo(time);\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Playback speed</span>\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'playbackRate'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> instance.getPlaybackRate();\n","              },\n","              <span class=\"code-keyword\">set</span>(input) {\n","                instance.setPlaybackRate(input);\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Volume</span>\n","            <span class=\"code-keyword\">let</span> {\n","              volume\n","            } = player.config;\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'volume'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> volume;\n","              },\n","              <span class=\"code-keyword\">set</span>(input) {\n","                volume = input;\n","                instance.setVolume(volume * <span class=\"code-number\">100</span>);\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'volumechange'</span>);\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Muted</span>\n","            <span class=\"code-keyword\">let</span> {\n","              muted\n","            } = player.config;\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'muted'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> muted;\n","              },\n","              <span class=\"code-keyword\">set</span>(input) {\n","                <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : muted;\n","                muted = toggle;\n","                instance[toggle ? <span class=\"code-string\">'mute'</span> : <span class=\"code-string\">'unMute'</span>]();\n","                instance.setVolume(volume * <span class=\"code-number\">100</span>);\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'volumechange'</span>);\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Source</span>\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'currentSrc'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> instance.getVideoUrl();\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Ended</span>\n","            <span class=\"code-built_in\">Object</span>.defineProperty(player.media, <span class=\"code-string\">'ended'</span>, {\n","              <span class=\"code-keyword\">get</span>() {\n","                <span class=\"code-keyword\">return</span> player.currentTime === player.duration;\n","              }\n","            });\n","\n","            <span class=\"code-comment\">// Get available speeds</span>\n","            <span class=\"code-keyword\">const</span> speeds = instance.getAvailablePlaybackRates();\n","            <span class=\"code-comment\">// Filter based on config</span>\n","            player.options.speed = speeds.filter(<span class=\"code-function\"><span class=\"code-params\">s</span> =&gt;</span> player.config.speed.options.includes(s));\n","\n","            <span class=\"code-comment\">// Set the tabindex to avoid focus entering iframe</span>\n","            <span class=\"code-keyword\">if</span> (player.supported.ui &amp;&amp; config.customControls) {\n","              player.media.setAttribute(<span class=\"code-string\">'tabindex'</span>, <span class=\"code-number\">-1</span>);\n","            }\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'timeupdate'</span>);\n","            triggerEvent.call(player, player.media, <span class=\"code-string\">'durationchange'</span>);\n","\n","            <span class=\"code-comment\">// Reset timer</span>\n","            clearInterval(player.timers.buffering);\n","\n","            <span class=\"code-comment\">// Setup buffering</span>\n","            player.timers.buffering = setInterval(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              <span class=\"code-comment\">// Get loaded % from YouTube</span>\n","              player.media.buffered = instance.getVideoLoadedFraction();\n","\n","              <span class=\"code-comment\">// Trigger progress only when we actually buffer something</span>\n","              <span class=\"code-keyword\">if</span> (player.media.lastBuffered === <span class=\"code-literal\">null</span> || player.media.lastBuffered &lt; player.media.buffered) {\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'progress'</span>);\n","              }\n","\n","              <span class=\"code-comment\">// Set last buffer point</span>\n","              player.media.lastBuffered = player.media.buffered;\n","\n","              <span class=\"code-comment\">// Bail if we're at 100%</span>\n","              <span class=\"code-keyword\">if</span> (player.media.buffered === <span class=\"code-number\">1</span>) {\n","                clearInterval(player.timers.buffering);\n","\n","                <span class=\"code-comment\">// Trigger event</span>\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'canplaythrough'</span>);\n","              }\n","            }, <span class=\"code-number\">200</span>);\n","\n","            <span class=\"code-comment\">// Rebuild UI</span>\n","            <span class=\"code-keyword\">if</span> (config.customControls) {\n","              setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> ui.build.call(player), <span class=\"code-number\">50</span>);\n","            }\n","          },\n","          onStateChange(event) {\n","            <span class=\"code-comment\">// Get the instance</span>\n","            <span class=\"code-keyword\">const</span> instance = event.target;\n","\n","            <span class=\"code-comment\">// Reset timer</span>\n","            clearInterval(player.timers.playing);\n","            <span class=\"code-keyword\">const</span> seeked = player.media.seeking &amp;&amp; [<span class=\"code-number\">1</span>, <span class=\"code-number\">2</span>].includes(event.data);\n","            <span class=\"code-keyword\">if</span> (seeked) {\n","              <span class=\"code-comment\">// Unset seeking and fire seeked event</span>\n","              player.media.seeking = <span class=\"code-literal\">false</span>;\n","              triggerEvent.call(player, player.media, <span class=\"code-string\">'seeked'</span>);\n","            }\n","\n","            <span class=\"code-comment\">// Handle events</span>\n","            <span class=\"code-comment\">// -1   Unstarted</span>\n","            <span class=\"code-comment\">// 0    Ended</span>\n","            <span class=\"code-comment\">// 1    Playing</span>\n","            <span class=\"code-comment\">// 2    Paused</span>\n","            <span class=\"code-comment\">// 3    Buffering</span>\n","            <span class=\"code-comment\">// 5    Video cued</span>\n","            <span class=\"code-keyword\">switch</span> (event.data) {\n","              <span class=\"code-keyword\">case</span> <span class=\"code-number\">-1</span>:\n","                <span class=\"code-comment\">// Update scrubber</span>\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'timeupdate'</span>);\n","\n","                <span class=\"code-comment\">// Get loaded % from YouTube</span>\n","                player.media.buffered = instance.getVideoLoadedFraction();\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'progress'</span>);\n","                <span class=\"code-keyword\">break</span>;\n","              <span class=\"code-keyword\">case</span> <span class=\"code-number\">0</span>:\n","                assurePlaybackState.call(player, <span class=\"code-literal\">false</span>);\n","\n","                <span class=\"code-comment\">// YouTube doesn't support loop for a single video, so mimick it.</span>\n","                <span class=\"code-keyword\">if</span> (player.media.loop) {\n","                  <span class=\"code-comment\">// YouTube needs a call to `stopVideo` before playing again</span>\n","                  instance.stopVideo();\n","                  instance.playVideo();\n","                } <span class=\"code-keyword\">else</span> {\n","                  triggerEvent.call(player, player.media, <span class=\"code-string\">'ended'</span>);\n","                }\n","                <span class=\"code-keyword\">break</span>;\n","              <span class=\"code-keyword\">case</span> <span class=\"code-number\">1</span>:\n","                <span class=\"code-comment\">// Restore paused state (YouTube starts playing on seek if the video hasn't been played yet)</span>\n","                <span class=\"code-keyword\">if</span> (config.customControls &amp;&amp; !player.config.autoplay &amp;&amp; player.media.paused &amp;&amp; !player.embed.hasPlayed) {\n","                  player.media.pause();\n","                } <span class=\"code-keyword\">else</span> {\n","                  assurePlaybackState.call(player, <span class=\"code-literal\">true</span>);\n","                  triggerEvent.call(player, player.media, <span class=\"code-string\">'playing'</span>);\n","\n","                  <span class=\"code-comment\">// Poll to get playback progress</span>\n","                  player.timers.playing = setInterval(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","                    triggerEvent.call(player, player.media, <span class=\"code-string\">'timeupdate'</span>);\n","                  }, <span class=\"code-number\">50</span>);\n","\n","                  <span class=\"code-comment\">// Check duration again due to YouTube bug</span>\n","                  <span class=\"code-comment\">// https://github.com/sampotts/plyr/issues/374</span>\n","                  <span class=\"code-comment\">// https://code.google.com/p/gdata-issues/issues/detail?id=8690</span>\n","                  <span class=\"code-keyword\">if</span> (player.media.duration !== instance.getDuration()) {\n","                    player.media.duration = instance.getDuration();\n","                    triggerEvent.call(player, player.media, <span class=\"code-string\">'durationchange'</span>);\n","                  }\n","                }\n","                <span class=\"code-keyword\">break</span>;\n","              <span class=\"code-keyword\">case</span> <span class=\"code-number\">2</span>:\n","                <span class=\"code-comment\">// Restore audio (YouTube starts playing on seek if the video hasn't been played yet)</span>\n","                <span class=\"code-keyword\">if</span> (!player.muted) {\n","                  player.embed.unMute();\n","                }\n","                assurePlaybackState.call(player, <span class=\"code-literal\">false</span>);\n","                <span class=\"code-keyword\">break</span>;\n","              <span class=\"code-keyword\">case</span> <span class=\"code-number\">3</span>:\n","                <span class=\"code-comment\">// Trigger waiting event to add loading classes to container as the video buffers.</span>\n","                triggerEvent.call(player, player.media, <span class=\"code-string\">'waiting'</span>);\n","                <span class=\"code-keyword\">break</span>;\n","            }\n","            triggerEvent.call(player, player.elements.container, <span class=\"code-string\">'statechange'</span>, <span class=\"code-literal\">false</span>, {\n","              code: event.data\n","            });\n","          }\n","        }\n","      });\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-keyword\">const</span> media = {\n","    <span class=\"code-comment\">// Setup media</span>\n","    setup() {\n","      <span class=\"code-comment\">// If there's no media, bail</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.media) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'No media element found!'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Add type class</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.type.replace(<span class=\"code-string\">'{0}'</span>, <span class=\"code-keyword\">this</span>.type), <span class=\"code-literal\">true</span>);\n","\n","      <span class=\"code-comment\">// Add provider class</span>\n","      toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.provider.replace(<span class=\"code-string\">'{0}'</span>, <span class=\"code-keyword\">this</span>.provider), <span class=\"code-literal\">true</span>);\n","\n","      <span class=\"code-comment\">// Add video class for embeds</span>\n","      <span class=\"code-comment\">// This will require changes if audio embeds are added</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isEmbed) {\n","        toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.type.replace(<span class=\"code-string\">'{0}'</span>, <span class=\"code-string\">'video'</span>), <span class=\"code-literal\">true</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Inject the player wrapper</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-comment\">// Create the wrapper div</span>\n","        <span class=\"code-keyword\">this</span>.elements.wrapper = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.config.classNames.video\n","        });\n","\n","        <span class=\"code-comment\">// Wrap the video in a container</span>\n","        wrap(<span class=\"code-keyword\">this</span>.media, <span class=\"code-keyword\">this</span>.elements.wrapper);\n","\n","        <span class=\"code-comment\">// Poster image container</span>\n","        <span class=\"code-keyword\">this</span>.elements.poster = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.config.classNames.poster\n","        });\n","        <span class=\"code-keyword\">this</span>.elements.wrapper.appendChild(<span class=\"code-keyword\">this</span>.elements.poster);\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","        html5.setup.call(<span class=\"code-keyword\">this</span>);\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isYouTube) {\n","        youtube.setup.call(<span class=\"code-keyword\">this</span>);\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo) {\n","        vimeo.setup.call(<span class=\"code-keyword\">this</span>);\n","      }\n","    }\n","  };\n","\n","  <span class=\"code-keyword\">const</span> destroy = <span class=\"code-function\"><span class=\"code-params\">instance</span> =&gt;</span> {\n","    <span class=\"code-comment\">// Destroy our adsManager</span>\n","    <span class=\"code-keyword\">if</span> (instance.manager) {\n","      instance.manager.destroy();\n","    }\n","\n","    <span class=\"code-comment\">// Destroy our adsManager</span>\n","    <span class=\"code-keyword\">if</span> (instance.elements.displayContainer) {\n","      instance.elements.displayContainer.destroy();\n","    }\n","    instance.elements.container.remove();\n","  };\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Ads</span> </span>{\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Ads constructor.\n</span>","<span class=\"code-comment\">     * @param {Object} player\n</span>","<span class=\"code-comment\">     * @return {Ads}\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">constructor</span>(player) {\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Load the IMA SDK\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"load\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.enabled) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Check if the Google IMA3 SDK is loaded or load it ourselves</span>\n","        <span class=\"code-keyword\">if</span> (!is.object(<span class=\"code-built_in\">window</span>.google) || !is.object(<span class=\"code-built_in\">window</span>.google.ima)) {\n","          loadScript(<span class=\"code-keyword\">this</span>.player.config.urls.googleIMA.sdk).then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-keyword\">this</span>.ready();\n","          }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-comment\">// Script failed to load or is blocked</span>\n","            <span class=\"code-keyword\">this</span>.trigger(<span class=\"code-string\">'error'</span>, <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Error</span>(<span class=\"code-string\">'Google IMA SDK failed to load'</span>));\n","          });\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-keyword\">this</span>.ready();\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Get the ads instance ready\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"ready\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Double check we're enabled</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.enabled) {\n","          destroy(<span class=\"code-keyword\">this</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Start ticking our safety timer. If the whole advertisement</span>\n","        <span class=\"code-comment\">// thing doesn't resolve within our set time; we bail</span>\n","        <span class=\"code-keyword\">this</span>.startSafetyTimer(<span class=\"code-number\">12000</span>, <span class=\"code-string\">'ready()'</span>);\n","\n","        <span class=\"code-comment\">// Clear the safety timer</span>\n","        <span class=\"code-keyword\">this</span>.managerPromise.then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-keyword\">this</span>.clearSafetyTimer(<span class=\"code-string\">'onAdsManagerLoaded()'</span>);\n","        });\n","\n","        <span class=\"code-comment\">// Set listeners on the Plyr instance</span>\n","        <span class=\"code-keyword\">this</span>.listeners();\n","\n","        <span class=\"code-comment\">// Setup the IMA SDK</span>\n","        <span class=\"code-keyword\">this</span>.setupIMA();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * In order for the SDK to display ads for our video, we need to tell it where to put them,\n</span>","<span class=\"code-comment\">       * so here we define our ad container. This div is set up to render on top of the video player.\n</span>","<span class=\"code-comment\">       * Using the code below, we tell the SDK to render ads within that div. We also provide a\n</span>","<span class=\"code-comment\">       * handle to the content video player - the SDK will poll the current time of our player to\n</span>","<span class=\"code-comment\">       * properly place mid-rolls. After we create the ad display container, we initialize it. On\n</span>","<span class=\"code-comment\">       * mobile devices, this initialization is done as the result of a user action.\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"setupIMA\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Create the container for our advertisements</span>\n","        <span class=\"code-keyword\">this</span>.elements.container = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.player.config.classNames.ads\n","        });\n","        <span class=\"code-keyword\">this</span>.player.elements.container.appendChild(<span class=\"code-keyword\">this</span>.elements.container);\n","\n","        <span class=\"code-comment\">// So we can run VPAID2</span>\n","        google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);\n","\n","        <span class=\"code-comment\">// Set language</span>\n","        google.ima.settings.setLocale(<span class=\"code-keyword\">this</span>.player.config.ads.language);\n","\n","        <span class=\"code-comment\">// Set playback for iOS10+</span>\n","        google.ima.settings.setDisableCustomPlaybackForIOS10Plus(<span class=\"code-keyword\">this</span>.player.config.playsinline);\n","\n","        <span class=\"code-comment\">// We assume the adContainer is the video container of the plyr element that will house the ads</span>\n","        <span class=\"code-keyword\">this</span>.elements.displayContainer = <span class=\"code-keyword\">new</span> google.ima.AdDisplayContainer(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.player.media);\n","\n","        <span class=\"code-comment\">// Create ads loader</span>\n","        <span class=\"code-keyword\">this</span>.loader = <span class=\"code-keyword\">new</span> google.ima.AdsLoader(<span class=\"code-keyword\">this</span>.elements.displayContainer);\n","\n","        <span class=\"code-comment\">// Listen and respond to ads loaded and error events</span>\n","        <span class=\"code-keyword\">this</span>.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, event =&gt; <span class=\"code-keyword\">this</span>.onAdsManagerLoaded(event), <span class=\"code-literal\">false</span>);\n","        <span class=\"code-keyword\">this</span>.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, error =&gt; <span class=\"code-keyword\">this</span>.onAdError(error), <span class=\"code-literal\">false</span>);\n","\n","        <span class=\"code-comment\">// Request video ads to be pre-loaded</span>\n","        <span class=\"code-keyword\">this</span>.requestAds();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Request advertisements\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"requestAds\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          container\n","        } = <span class=\"code-keyword\">this</span>.player.elements;\n","        <span class=\"code-keyword\">try</span> {\n","          <span class=\"code-comment\">// Request video ads</span>\n","          <span class=\"code-keyword\">const</span> request = <span class=\"code-keyword\">new</span> google.ima.AdsRequest();\n","          request.adTagUrl = <span class=\"code-keyword\">this</span>.tagUrl;\n","\n","          <span class=\"code-comment\">// Specify the linear and nonlinear slot sizes. This helps the SDK</span>\n","          <span class=\"code-comment\">// to select the correct creative if multiple are returned</span>\n","          request.linearAdSlotWidth = container.offsetWidth;\n","          request.linearAdSlotHeight = container.offsetHeight;\n","          request.nonLinearAdSlotWidth = container.offsetWidth;\n","          request.nonLinearAdSlotHeight = container.offsetHeight;\n","\n","          <span class=\"code-comment\">// We only overlay ads as we only support video.</span>\n","          request.forceNonLinearFullSlot = <span class=\"code-literal\">false</span>;\n","\n","          <span class=\"code-comment\">// Mute based on current state</span>\n","          request.setAdWillPlayMuted(!<span class=\"code-keyword\">this</span>.player.muted);\n","          <span class=\"code-keyword\">this</span>.loader.requestAds(request);\n","        } <span class=\"code-keyword\">catch</span> (error) {\n","          <span class=\"code-keyword\">this</span>.onAdError(error);\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Update the ad countdown\n</span>","<span class=\"code-comment\">       * @param {Boolean} start\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"pollCountdown\"</span>, (start = <span class=\"code-literal\">false</span>) =&gt; {\n","        <span class=\"code-keyword\">if</span> (!start) {\n","          clearInterval(<span class=\"code-keyword\">this</span>.countdownTimer);\n","          <span class=\"code-keyword\">this</span>.elements.container.removeAttribute(<span class=\"code-string\">'data-badge-text'</span>);\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> update = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-keyword\">const</span> time = formatTime(<span class=\"code-built_in\">Math</span>.max(<span class=\"code-keyword\">this</span>.manager.getRemainingTime(), <span class=\"code-number\">0</span>));\n","          <span class=\"code-keyword\">const</span> label = <span class=\"code-string\">`<span class=\"code-subst\">${i18n.get(<span class=\"code-string\">'advertisement'</span>, <span class=\"code-keyword\">this</span>.player.config)}</span> - <span class=\"code-subst\">${time}</span>`</span>;\n","          <span class=\"code-keyword\">this</span>.elements.container.setAttribute(<span class=\"code-string\">'data-badge-text'</span>, label);\n","        };\n","        <span class=\"code-keyword\">this</span>.countdownTimer = setInterval(update, <span class=\"code-number\">100</span>);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * This method is called whenever the ads are ready inside the AdDisplayContainer\n</span>","<span class=\"code-comment\">       * @param {Event} event - adsManagerLoadedEvent\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"onAdsManagerLoaded\"</span>, event =&gt; {\n","        <span class=\"code-comment\">// Load could occur after a source change (race condition)</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.enabled) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Get the ads manager</span>\n","        <span class=\"code-keyword\">const</span> settings = <span class=\"code-keyword\">new</span> google.ima.AdsRenderingSettings();\n","\n","        <span class=\"code-comment\">// Tell the SDK to save and restore content video state on our behalf</span>\n","        settings.restoreCustomPlaybackStateOnAdBreakComplete = <span class=\"code-literal\">true</span>;\n","        settings.enablePreloading = <span class=\"code-literal\">true</span>;\n","\n","        <span class=\"code-comment\">// The SDK is polling currentTime on the contentPlayback. And needs a duration</span>\n","        <span class=\"code-comment\">// so it can determine when to start the mid- and post-roll</span>\n","        <span class=\"code-keyword\">this</span>.manager = event.getAdsManager(<span class=\"code-keyword\">this</span>.player, settings);\n","\n","        <span class=\"code-comment\">// Get the cue points for any mid-rolls by filtering out the pre- and post-roll</span>\n","        <span class=\"code-keyword\">this</span>.cuePoints = <span class=\"code-keyword\">this</span>.manager.getCuePoints();\n","\n","        <span class=\"code-comment\">// Add listeners to the required events</span>\n","        <span class=\"code-comment\">// Advertisement error events</span>\n","        <span class=\"code-keyword\">this</span>.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, error =&gt; <span class=\"code-keyword\">this</span>.onAdError(error));\n","\n","        <span class=\"code-comment\">// Advertisement regular events</span>\n","        <span class=\"code-built_in\">Object</span>.keys(google.ima.AdEvent.Type).forEach(<span class=\"code-function\"><span class=\"code-params\">type</span> =&gt;</span> {\n","          <span class=\"code-keyword\">this</span>.manager.addEventListener(google.ima.AdEvent.Type[type], e =&gt; <span class=\"code-keyword\">this</span>.onAdEvent(e));\n","        });\n","\n","        <span class=\"code-comment\">// Resolve our adsManager</span>\n","        <span class=\"code-keyword\">this</span>.trigger(<span class=\"code-string\">'loaded'</span>);\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"addCuePoints\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Add advertisement cue's within the time line if available</span>\n","        <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.cuePoints)) {\n","          <span class=\"code-keyword\">this</span>.cuePoints.forEach(<span class=\"code-function\"><span class=\"code-params\">cuePoint</span> =&gt;</span> {\n","            <span class=\"code-keyword\">if</span> (cuePoint !== <span class=\"code-number\">0</span> &amp;&amp; cuePoint !== <span class=\"code-number\">-1</span> &amp;&amp; cuePoint &lt; <span class=\"code-keyword\">this</span>.player.duration) {\n","              <span class=\"code-keyword\">const</span> seekElement = <span class=\"code-keyword\">this</span>.player.elements.progress;\n","              <span class=\"code-keyword\">if</span> (is.element(seekElement)) {\n","                <span class=\"code-keyword\">const</span> cuePercentage = <span class=\"code-number\">100</span> / <span class=\"code-keyword\">this</span>.player.duration * cuePoint;\n","                <span class=\"code-keyword\">const</span> cue = createElement(<span class=\"code-string\">'span'</span>, {\n","                  class: this.player.config.classNames.cues\n","                });\n","                cue.style.left = <span class=\"code-string\">`<span class=\"code-subst\">${cuePercentage.toString()}</span>%`</span>;\n","                seekElement.appendChild(cue);\n","              }\n","            }\n","          });\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * This is where all the event handling takes place. Retrieve the ad from the event. Some\n</span>","<span class=\"code-comment\">       * events (e.g. ALL_ADS_COMPLETED) don't have the ad object associated\n</span>","<span class=\"code-comment\">       * https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdEvent.Type\n</span>","<span class=\"code-comment\">       * @param {Event} event\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"onAdEvent\"</span>, event =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          container\n","        } = <span class=\"code-keyword\">this</span>.player.elements;\n","        <span class=\"code-comment\">// Retrieve the ad from the event. Some events (e.g. ALL_ADS_COMPLETED)</span>\n","        <span class=\"code-comment\">// don't have ad object associated</span>\n","        <span class=\"code-keyword\">const</span> ad = event.getAd();\n","        <span class=\"code-keyword\">const</span> adData = event.getAdData();\n","\n","        <span class=\"code-comment\">// Proxy event</span>\n","        <span class=\"code-keyword\">const</span> dispatchEvent = <span class=\"code-function\"><span class=\"code-params\">type</span> =&gt;</span> {\n","          triggerEvent.call(<span class=\"code-keyword\">this</span>.player, <span class=\"code-keyword\">this</span>.player.media, <span class=\"code-string\">`ads<span class=\"code-subst\">${type.replace(<span class=\"code-regexp\">/_/g</span>, <span class=\"code-string\">''</span>).toLowerCase()}</span>`</span>);\n","        };\n","\n","        <span class=\"code-comment\">// Bubble the event</span>\n","        dispatchEvent(event.type);\n","        <span class=\"code-keyword\">switch</span> (event.type) {\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.LOADED:\n","            <span class=\"code-comment\">// This is the first event sent for an ad - it is possible to determine whether the</span>\n","            <span class=\"code-comment\">// ad is a video ad or an overlay</span>\n","            <span class=\"code-keyword\">this</span>.trigger(<span class=\"code-string\">'loaded'</span>);\n","\n","            <span class=\"code-comment\">// Start countdown</span>\n","            <span class=\"code-keyword\">this</span>.pollCountdown(<span class=\"code-literal\">true</span>);\n","            <span class=\"code-keyword\">if</span> (!ad.isLinear()) {\n","              <span class=\"code-comment\">// Position AdDisplayContainer correctly for overlay</span>\n","              ad.width = container.offsetWidth;\n","              ad.height = container.offsetHeight;\n","            }\n","\n","            <span class=\"code-comment\">// console.info('Ad type: ' + event.getAd().getAdPodInfo().getPodIndex());</span>\n","            <span class=\"code-comment\">// console.info('Ad time: ' + event.getAd().getAdPodInfo().getTimeOffset());</span>\n","\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.STARTED:\n","            <span class=\"code-comment\">// Set volume to match player</span>\n","            <span class=\"code-keyword\">this</span>.manager.setVolume(<span class=\"code-keyword\">this</span>.player.volume);\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.ALL_ADS_COMPLETED:\n","            <span class=\"code-comment\">// All ads for the current videos are done. We can now request new advertisements</span>\n","            <span class=\"code-comment\">// in case the video is re-played</span>\n","\n","            <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Example for what happens when a next video in a playlist would be loaded.</span>\n","            <span class=\"code-comment\">// So here we load a new video when all ads are done.</span>\n","            <span class=\"code-comment\">// Then we load new ads within a new adsManager. When the video</span>\n","            <span class=\"code-comment\">// Is started - after - the ads are loaded, then we get ads.</span>\n","            <span class=\"code-comment\">// You can also easily test cancelling and reloading by running</span>\n","            <span class=\"code-comment\">// player.ads.cancel() and player.ads.play from the console I guess.</span>\n","            <span class=\"code-comment\">// this.player.source = {</span>\n","            <span class=\"code-comment\">//     type: 'video',</span>\n","            <span class=\"code-comment\">//     title: 'View From A Blue Moon',</span>\n","            <span class=\"code-comment\">//     sources: [{</span>\n","            <span class=\"code-comment\">//         src:</span>\n","            <span class=\"code-comment\">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.mp4', type:</span>\n","            <span class=\"code-comment\">// 'video/mp4', }], poster:</span>\n","            <span class=\"code-comment\">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.jpg', tracks:</span>\n","            <span class=\"code-comment\">// [ { kind: 'captions', label: 'English', srclang: 'en', src:</span>\n","            <span class=\"code-comment\">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.en.vtt',</span>\n","            <span class=\"code-comment\">// default: true, }, { kind: 'captions', label: 'French', srclang: 'fr', src:</span>\n","            <span class=\"code-comment\">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.fr.vtt', }, ],</span>\n","            <span class=\"code-comment\">// };</span>\n","\n","            <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> So there is still this thing where a video should only be allowed to start</span>\n","            <span class=\"code-comment\">// playing when the IMA SDK is ready or has failed</span>\n","\n","            <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.player.ended) {\n","              <span class=\"code-keyword\">this</span>.loadAds();\n","            } <span class=\"code-keyword\">else</span> {\n","              <span class=\"code-comment\">// The SDK won't allow new ads to be called without receiving a contentComplete()</span>\n","              <span class=\"code-keyword\">this</span>.loader.contentComplete();\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:\n","            <span class=\"code-comment\">// This event indicates the ad has started - the video player can adjust the UI,</span>\n","            <span class=\"code-comment\">// for example display a pause button and remaining time. Fired when content should</span>\n","            <span class=\"code-comment\">// be paused. This usually happens right before an ad is about to cover the content</span>\n","\n","            <span class=\"code-keyword\">this</span>.pauseContent();\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:\n","            <span class=\"code-comment\">// This event indicates the ad has finished - the video player can perform</span>\n","            <span class=\"code-comment\">// appropriate UI actions, such as removing the timer for remaining time detection.</span>\n","            <span class=\"code-comment\">// Fired when content should be resumed. This usually happens when an ad finishes</span>\n","            <span class=\"code-comment\">// or collapses</span>\n","\n","            <span class=\"code-keyword\">this</span>.pollCountdown();\n","            <span class=\"code-keyword\">this</span>.resumeContent();\n","            <span class=\"code-keyword\">break</span>;\n","          <span class=\"code-keyword\">case</span> google.ima.AdEvent.Type.LOG:\n","            <span class=\"code-keyword\">if</span> (adData.adError) {\n","              <span class=\"code-keyword\">this</span>.player.debug.warn(<span class=\"code-string\">`Non-fatal ad error: <span class=\"code-subst\">${adData.adError.getMessage()}</span>`</span>);\n","            }\n","            <span class=\"code-keyword\">break</span>;\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Any ad error handling comes through here\n</span>","<span class=\"code-comment\">       * @param {Event} event\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"onAdError\"</span>, event =&gt; {\n","        <span class=\"code-keyword\">this</span>.cancel();\n","        <span class=\"code-keyword\">this</span>.player.debug.warn(<span class=\"code-string\">'Ads error'</span>, event);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Setup hooks for Plyr and window events. This ensures\n</span>","<span class=\"code-comment\">       * the mid- and post-roll launch at the correct time. And\n</span>","<span class=\"code-comment\">       * resize the advertisement when the player resizes\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"listeners\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          container\n","        } = <span class=\"code-keyword\">this</span>.player.elements;\n","        <span class=\"code-keyword\">let</span> time;\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'canplay'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.addCuePoints();\n","        });\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'ended'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.loader.contentComplete();\n","        });\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'timeupdate'</span>, () =&gt; {\n","          time = <span class=\"code-keyword\">this</span>.player.currentTime;\n","        });\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'seeked'</span>, () =&gt; {\n","          <span class=\"code-keyword\">const</span> seekedTime = <span class=\"code-keyword\">this</span>.player.currentTime;\n","          <span class=\"code-keyword\">if</span> (is.empty(<span class=\"code-keyword\">this</span>.cuePoints)) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","          <span class=\"code-keyword\">this</span>.cuePoints.forEach(<span class=\"code-function\">(<span class=\"code-params\">cuePoint, index</span>) =&gt;</span> {\n","            <span class=\"code-keyword\">if</span> (time &lt; cuePoint &amp;&amp; cuePoint &lt; seekedTime) {\n","              <span class=\"code-keyword\">this</span>.manager.discardAdBreak();\n","              <span class=\"code-keyword\">this</span>.cuePoints.splice(index, <span class=\"code-number\">1</span>);\n","            }\n","          });\n","        });\n","\n","        <span class=\"code-comment\">// Listen to the resizing of the window. And resize ad accordingly</span>\n","        <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> eventually implement ResizeObserver</span>\n","        <span class=\"code-built_in\">window</span>.addEventListener(<span class=\"code-string\">'resize'</span>, () =&gt; {\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.manager) {\n","            <span class=\"code-keyword\">this</span>.manager.resize(container.offsetWidth, container.offsetHeight, google.ima.ViewMode.NORMAL);\n","          }\n","        });\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Initialize the adsManager and start playing advertisements\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"play\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          container\n","        } = <span class=\"code-keyword\">this</span>.player.elements;\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.managerPromise) {\n","          <span class=\"code-keyword\">this</span>.resumeContent();\n","        }\n","\n","        <span class=\"code-comment\">// Play the requested advertisement whenever the adsManager is ready</span>\n","        <span class=\"code-keyword\">this</span>.managerPromise.then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-comment\">// Set volume to match player</span>\n","          <span class=\"code-keyword\">this</span>.manager.setVolume(<span class=\"code-keyword\">this</span>.player.volume);\n","\n","          <span class=\"code-comment\">// Initialize the container. Must be done via a user action on mobile devices</span>\n","          <span class=\"code-keyword\">this</span>.elements.displayContainer.initialize();\n","          <span class=\"code-keyword\">try</span> {\n","            <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.initialized) {\n","              <span class=\"code-comment\">// Initialize the ads manager. Ad rules playlist will start at this time</span>\n","              <span class=\"code-keyword\">this</span>.manager.init(container.offsetWidth, container.offsetHeight, google.ima.ViewMode.NORMAL);\n","\n","              <span class=\"code-comment\">// Call play to start showing the ad. Single video and overlay ads will</span>\n","              <span class=\"code-comment\">// start at this time; the call will be ignored for ad rules</span>\n","              <span class=\"code-keyword\">this</span>.manager.start();\n","            }\n","            <span class=\"code-keyword\">this</span>.initialized = <span class=\"code-literal\">true</span>;\n","          } <span class=\"code-keyword\">catch</span> (adError) {\n","            <span class=\"code-comment\">// An error may be thrown if there was a problem with the</span>\n","            <span class=\"code-comment\">// VAST response</span>\n","            <span class=\"code-keyword\">this</span>.onAdError(adError);\n","          }\n","        }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Resume our video\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"resumeContent\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Hide the advertisement container</span>\n","        <span class=\"code-keyword\">this</span>.elements.container.style.zIndex = <span class=\"code-string\">''</span>;\n","\n","        <span class=\"code-comment\">// Ad is stopped</span>\n","        <span class=\"code-keyword\">this</span>.playing = <span class=\"code-literal\">false</span>;\n","\n","        <span class=\"code-comment\">// Play video</span>\n","        silencePromise(<span class=\"code-keyword\">this</span>.player.media.play());\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Pause our video\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"pauseContent\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Show the advertisement container</span>\n","        <span class=\"code-keyword\">this</span>.elements.container.style.zIndex = <span class=\"code-number\">3</span>;\n","\n","        <span class=\"code-comment\">// Ad is playing</span>\n","        <span class=\"code-keyword\">this</span>.playing = <span class=\"code-literal\">true</span>;\n","\n","        <span class=\"code-comment\">// Pause our video.</span>\n","        <span class=\"code-keyword\">this</span>.player.media.pause();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Destroy the adsManager so we can grab new ads after this. If we don't then we're not\n</span>","<span class=\"code-comment\">       * allowed to call new ads based on google policies, as they interpret this as an accidental\n</span>","<span class=\"code-comment\">       * video requests. https://developers.google.com/interactive-\n</span>","<span class=\"code-comment\">       * media-ads/docs/sdks/android/faq#8\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"cancel\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Pause our video</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.initialized) {\n","          <span class=\"code-keyword\">this</span>.resumeContent();\n","        }\n","\n","        <span class=\"code-comment\">// Tell our instance that we're done for now</span>\n","        <span class=\"code-keyword\">this</span>.trigger(<span class=\"code-string\">'error'</span>);\n","\n","        <span class=\"code-comment\">// Re-create our adsManager</span>\n","        <span class=\"code-keyword\">this</span>.loadAds();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Re-create our adsManager\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"loadAds\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Tell our adsManager to go bye bye</span>\n","        <span class=\"code-keyword\">this</span>.managerPromise.then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-comment\">// Destroy our adsManager</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.manager) {\n","            <span class=\"code-keyword\">this</span>.manager.destroy();\n","          }\n","\n","          <span class=\"code-comment\">// Re-set our adsManager promises</span>\n","          <span class=\"code-keyword\">this</span>.managerPromise = <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\"><span class=\"code-params\">resolve</span> =&gt;</span> {\n","            <span class=\"code-keyword\">this</span>.on(<span class=\"code-string\">'loaded'</span>, resolve);\n","            <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-keyword\">this</span>.manager);\n","          });\n","          <span class=\"code-comment\">// Now that the manager has been destroyed set it to also be un-initialized</span>\n","          <span class=\"code-keyword\">this</span>.initialized = <span class=\"code-literal\">false</span>;\n","\n","          <span class=\"code-comment\">// Now request some new advertisements</span>\n","          <span class=\"code-keyword\">this</span>.requestAds();\n","        }).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Handles callbacks after an ad event was invoked\n</span>","<span class=\"code-comment\">       * @param {String} event - Event type\n</span>","<span class=\"code-comment\">       * @param args\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"trigger\"</span>, (event, ...args) =&gt; {\n","        <span class=\"code-keyword\">const</span> handlers = <span class=\"code-keyword\">this</span>.events[event];\n","        <span class=\"code-keyword\">if</span> (is.array(handlers)) {\n","          handlers.forEach(<span class=\"code-function\"><span class=\"code-params\">handler</span> =&gt;</span> {\n","            <span class=\"code-keyword\">if</span> (is.function(handler)) {\n","              handler.apply(<span class=\"code-keyword\">this</span>, args);\n","            }\n","          });\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Add event listeners\n</span>","<span class=\"code-comment\">       * @param {String} event - Event type\n</span>","<span class=\"code-comment\">       * @param {Function} callback - Callback for when event occurs\n</span>","<span class=\"code-comment\">       * @return {Ads}\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"on\"</span>, (event, callback) =&gt; {\n","        <span class=\"code-keyword\">if</span> (!is.array(<span class=\"code-keyword\">this</span>.events[event])) {\n","          <span class=\"code-keyword\">this</span>.events[event] = [];\n","        }\n","        <span class=\"code-keyword\">this</span>.events[event].push(callback);\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>;\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Setup a safety timer for when the ad network doesn't respond for whatever reason.\n</span>","<span class=\"code-comment\">       * The advertisement has 12 seconds to get its things together. We stop this timer when the\n</span>","<span class=\"code-comment\">       * advertisement is playing, or when a user action is required to start, then we clear the\n</span>","<span class=\"code-comment\">       * timer on ad ready\n</span>","<span class=\"code-comment\">       * @param {Number} time\n</span>","<span class=\"code-comment\">       * @param {String} from\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"startSafetyTimer\"</span>, (time, <span class=\"code-keyword\">from</span>) =&gt; {\n","        <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Safety timer invoked from: <span class=\"code-subst\">${<span class=\"code-keyword\">from</span>}</span>`</span>);\n","        <span class=\"code-keyword\">this</span>.safetyTimer = setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-keyword\">this</span>.cancel();\n","          <span class=\"code-keyword\">this</span>.clearSafetyTimer(<span class=\"code-string\">'startSafetyTimer()'</span>);\n","        }, time);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Clear our safety timer(s)\n</span>","<span class=\"code-comment\">       * @param {String} from\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"clearSafetyTimer\"</span>, <span class=\"code-keyword\">from</span> =&gt; {\n","        <span class=\"code-keyword\">if</span> (!is.nullOrUndefined(<span class=\"code-keyword\">this</span>.safetyTimer)) {\n","          <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Safety timer cleared from: <span class=\"code-subst\">${<span class=\"code-keyword\">from</span>}</span>`</span>);\n","          clearTimeout(<span class=\"code-keyword\">this</span>.safetyTimer);\n","          <span class=\"code-keyword\">this</span>.safetyTimer = <span class=\"code-literal\">null</span>;\n","        }\n","      });\n","      <span class=\"code-keyword\">this</span>.player = player;\n","      <span class=\"code-keyword\">this</span>.config = player.config.ads;\n","      <span class=\"code-keyword\">this</span>.playing = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.initialized = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.elements = {\n","        container: <span class=\"code-literal\">null</span>,\n","        displayContainer: <span class=\"code-literal\">null</span>\n","      };\n","      <span class=\"code-keyword\">this</span>.manager = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.loader = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.cuePoints = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.events = {};\n","      <span class=\"code-keyword\">this</span>.safetyTimer = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">this</span>.countdownTimer = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Setup a promise to resolve when the IMA manager is ready</span>\n","      <span class=\"code-keyword\">this</span>.managerPromise = <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\">(<span class=\"code-params\">resolve, reject</span>) =&gt;</span> {\n","        <span class=\"code-comment\">// The ad is loaded and ready</span>\n","        <span class=\"code-keyword\">this</span>.on(<span class=\"code-string\">'loaded'</span>, resolve);\n","\n","        <span class=\"code-comment\">// Ads failed</span>\n","        <span class=\"code-keyword\">this</span>.on(<span class=\"code-string\">'error'</span>, reject);\n","      });\n","      <span class=\"code-keyword\">this</span>.load();\n","    }\n","    <span class=\"code-keyword\">get</span> enabled() {\n","      <span class=\"code-keyword\">const</span> {\n","        config\n","      } = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.player.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.player.isVideo &amp;&amp; config.enabled &amp;&amp; (!is.empty(config.publisherId) || is.url(config.tagUrl));\n","    }\n","    <span class=\"code-comment\">// Build the tag URL</span>\n","    <span class=\"code-keyword\">get</span> tagUrl() {\n","      <span class=\"code-keyword\">const</span> {\n","        config\n","      } = <span class=\"code-keyword\">this</span>;\n","      <span class=\"code-keyword\">if</span> (is.url(config.tagUrl)) {\n","        <span class=\"code-keyword\">return</span> config.tagUrl;\n","      }\n","      <span class=\"code-keyword\">const</span> params = {\n","        AV_PUBLISHERID: <span class=\"code-string\">'58c25bb0073ef448b1087ad6'</span>,\n","        AV_CHANNELID: <span class=\"code-string\">'5a0458dc28a06145e4519d21'</span>,\n","        AV_URL: <span class=\"code-built_in\">window</span>.location.hostname,\n","        cb: <span class=\"code-built_in\">Date</span>.now(),\n","        AV_WIDTH: <span class=\"code-number\">640</span>,\n","        AV_HEIGHT: <span class=\"code-number\">480</span>,\n","        AV_CDIM2: config.publisherId\n","      };\n","      <span class=\"code-keyword\">const</span> base = <span class=\"code-string\">'https://go.aniview.com/api/adserver6/vast/'</span>;\n","      <span class=\"code-keyword\">return</span> <span class=\"code-string\">`<span class=\"code-subst\">${base}</span>?<span class=\"code-subst\">${buildUrlParams(params)}</span>`</span>;\n","    }\n","  }\n","\n","  <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">   * Returns a number whose value is limited to the given range.\n</span>","<span class=\"code-comment\">   *\n</span>","<span class=\"code-comment\">   * Example: limit the output of this computation to between 0 and 255\n</span>","<span class=\"code-comment\">   * (x * 255).clamp(0, 255)\n</span>","<span class=\"code-comment\">   *\n</span>","<span class=\"code-comment\">   * @param {Number} input\n</span>","<span class=\"code-comment\">   * @param {Number} min The lower boundary of the output range\n</span>","<span class=\"code-comment\">   * @param {Number} max The upper boundary of the output range\n</span>","<span class=\"code-comment\">   * @returns A number within the bounds of min and max\n</span>","<span class=\"code-comment\">   * @type Number\n</span>","<span class=\"code-comment\">   */</span>\n","  <span class=\"code-function\"><span class=\"code-keyword\">function</span> <span class=\"code-title\">clamp</span>(<span class=\"code-params\">input = <span class=\"code-number\">0</span>, min = <span class=\"code-number\">0</span>, max = <span class=\"code-number\">255</span></span>) </span>{\n","    <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Math</span>.min(<span class=\"code-built_in\">Math</span>.max(input, min), max);\n","  }\n","\n","  <span class=\"code-comment\">// Arg: vttDataString example: \"WEBVTT\\n\\n1\\n00:00:05.000 --&gt; 00:00:10.000\\n1080p-00001.jpg\"</span>\n","  <span class=\"code-keyword\">const</span> parseVtt = <span class=\"code-function\"><span class=\"code-params\">vttDataString</span> =&gt;</span> {\n","    <span class=\"code-keyword\">const</span> processedList = [];\n","    <span class=\"code-keyword\">const</span> frames = vttDataString.split(<span class=\"code-regexp\">/\\r\\n\\r\\n|\\n\\n|\\r\\r/</span>);\n","    frames.forEach(<span class=\"code-function\"><span class=\"code-params\">frame</span> =&gt;</span> {\n","      <span class=\"code-keyword\">const</span> result = {};\n","      <span class=\"code-keyword\">const</span> lines = frame.split(<span class=\"code-regexp\">/\\r\\n|\\n|\\r/</span>);\n","      lines.forEach(<span class=\"code-function\"><span class=\"code-params\">line</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (!is.number(result.startTime)) {\n","          <span class=\"code-comment\">// The line with start and end times on it is the first line of interest</span>\n","          <span class=\"code-keyword\">const</span> matchTimes = line.match(<span class=\"code-regexp\">/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--&gt; ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/</span>); <span class=\"code-comment\">// Note that this currently ignores caption formatting directives that are optionally on the end of this line - fine for non-captions VTT</span>\n","\n","          <span class=\"code-keyword\">if</span> (matchTimes) {\n","            result.startTime = <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">1</span>] || <span class=\"code-number\">0</span>) * <span class=\"code-number\">60</span> * <span class=\"code-number\">60</span> + <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">2</span>]) * <span class=\"code-number\">60</span> + <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">3</span>]) + <span class=\"code-built_in\">Number</span>(<span class=\"code-string\">`0.<span class=\"code-subst\">${matchTimes[<span class=\"code-number\">4</span>]}</span>`</span>);\n","            result.endTime = <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">6</span>] || <span class=\"code-number\">0</span>) * <span class=\"code-number\">60</span> * <span class=\"code-number\">60</span> + <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">7</span>]) * <span class=\"code-number\">60</span> + <span class=\"code-built_in\">Number</span>(matchTimes[<span class=\"code-number\">8</span>]) + <span class=\"code-built_in\">Number</span>(<span class=\"code-string\">`0.<span class=\"code-subst\">${matchTimes[<span class=\"code-number\">9</span>]}</span>`</span>);\n","          }\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (!is.empty(line.trim()) &amp;&amp; is.empty(result.text)) {\n","          <span class=\"code-comment\">// If we already have the startTime, then we're definitely up to the text line(s)</span>\n","          <span class=\"code-keyword\">const</span> lineSplit = line.trim().split(<span class=\"code-string\">'#xywh='</span>);\n","          [result.text] = lineSplit;\n","\n","          <span class=\"code-comment\">// If there's content in lineSplit[1], then we have sprites. If not, then it's just one frame per image</span>\n","          <span class=\"code-keyword\">if</span> (lineSplit[<span class=\"code-number\">1</span>]) {\n","            [result.x, result.y, result.w, result.h] = lineSplit[<span class=\"code-number\">1</span>].split(<span class=\"code-string\">','</span>);\n","          }\n","        }\n","      });\n","      <span class=\"code-keyword\">if</span> (result.text) {\n","        processedList.push(result);\n","      }\n","    });\n","    <span class=\"code-keyword\">return</span> processedList;\n","  };\n","\n","  <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">   * Preview thumbnails for seek hover and scrubbing\n</span>","<span class=\"code-comment\">   * Seeking: Hover over the seek bar (desktop only): shows a small preview container above the seek bar\n</span>","<span class=\"code-comment\">   * Scrubbing: Click and drag the seek bar (desktop and mobile): shows the preview image over the entire video, as if the video is scrubbing at very high speed\n</span>","<span class=\"code-comment\">   *\n</span>","<span class=\"code-comment\">   * Notes:\n</span>","<span class=\"code-comment\">   * - Thumbs are set via JS settings on Plyr init, not HTML5 'track' property. Using the track property would be a bit gross, because it doesn't support custom 'kinds'. kind=metadata might be used for something else, and we want to allow multiple thumbnails tracks. Tracks must have a unique combination of 'kind' and 'label'. We would have to do something like kind=metadata,label=thumbnails1 / kind=metadata,label=thumbnails2. Square peg, round hole\n</span>","<span class=\"code-comment\">   * - VTT info: the image URL is relative to the VTT, not the current document. But if the url starts with a slash, it will naturally be relative to the current domain. https://support.jwplayer.com/articles/how-to-add-preview-thumbnails\n</span>","<span class=\"code-comment\">   * - This implementation uses multiple separate img elements. Other implementations use background-image on one element. This would be nice and simple, but Firefox and Safari have flickering issues with replacing backgrounds of larger images. It seems that YouTube perhaps only avoids this because they don't have the option for high-res previews (even the fullscreen ones, when mousedown/seeking). Images appear over the top of each other, and previous ones are discarded once the new ones have been rendered\n</span>","<span class=\"code-comment\">   */</span>\n","\n","  <span class=\"code-keyword\">const</span> fitRatio = <span class=\"code-function\">(<span class=\"code-params\">ratio, outer</span>) =&gt;</span> {\n","    <span class=\"code-keyword\">const</span> targetRatio = outer.width / outer.height;\n","    <span class=\"code-keyword\">const</span> result = {};\n","    <span class=\"code-keyword\">if</span> (ratio &gt; targetRatio) {\n","      result.width = outer.width;\n","      result.height = <span class=\"code-number\">1</span> / ratio * outer.width;\n","    } <span class=\"code-keyword\">else</span> {\n","      result.height = outer.height;\n","      result.width = ratio * outer.height;\n","    }\n","    <span class=\"code-keyword\">return</span> result;\n","  };\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">PreviewThumbnails</span> </span>{\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * PreviewThumbnails constructor.\n</span>","<span class=\"code-comment\">     * @param {Plyr} player\n</span>","<span class=\"code-comment\">     * @return {PreviewThumbnails}\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">constructor</span>(player) {\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"load\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Toggle the regular seek tooltip</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.player.elements.display.seekTooltip) {\n","          <span class=\"code-keyword\">this</span>.player.elements.display.seekTooltip.hidden = <span class=\"code-keyword\">this</span>.enabled;\n","        }\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.enabled) <span class=\"code-keyword\">return</span>;\n","        <span class=\"code-keyword\">this</span>.getThumbnails().then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.enabled) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Render DOM elements</span>\n","          <span class=\"code-keyword\">this</span>.render();\n","\n","          <span class=\"code-comment\">// Check to see if thumb container size was specified manually in CSS</span>\n","          <span class=\"code-keyword\">this</span>.determineContainerAutoSizing();\n","\n","          <span class=\"code-comment\">// Set up listeners</span>\n","          <span class=\"code-keyword\">this</span>.listeners();\n","          <span class=\"code-keyword\">this</span>.loaded = <span class=\"code-literal\">true</span>;\n","        });\n","      });\n","      <span class=\"code-comment\">// Download VTT files and parse them</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"getThumbnails\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\"><span class=\"code-params\">resolve</span> =&gt;</span> {\n","          <span class=\"code-keyword\">const</span> {\n","            src\n","          } = <span class=\"code-keyword\">this</span>.player.config.previewThumbnails;\n","          <span class=\"code-keyword\">if</span> (is.empty(src)) {\n","            <span class=\"code-keyword\">throw</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Error</span>(<span class=\"code-string\">'Missing previewThumbnails.src config attribute'</span>);\n","          }\n","\n","          <span class=\"code-comment\">// Resolve promise</span>\n","          <span class=\"code-keyword\">const</span> sortAndResolve = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-comment\">// Sort smallest to biggest (e.g., [120p, 480p, 1080p])</span>\n","            <span class=\"code-keyword\">this</span>.thumbnails.sort(<span class=\"code-function\">(<span class=\"code-params\">x, y</span>) =&gt;</span> x.height - y.height);\n","            <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">'Preview thumbnails'</span>, <span class=\"code-keyword\">this</span>.thumbnails);\n","            resolve();\n","          };\n","\n","          <span class=\"code-comment\">// Via callback()</span>\n","          <span class=\"code-keyword\">if</span> (is.function(src)) {\n","            src(<span class=\"code-function\"><span class=\"code-params\">thumbnails</span> =&gt;</span> {\n","              <span class=\"code-keyword\">this</span>.thumbnails = thumbnails;\n","              sortAndResolve();\n","            });\n","          }\n","          <span class=\"code-comment\">// VTT urls</span>\n","          <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-comment\">// If string, convert into single-element list</span>\n","            <span class=\"code-keyword\">const</span> urls = is.string(src) ? [src] : src;\n","            <span class=\"code-comment\">// Loop through each src URL. Download and process the VTT file, storing the resulting data in this.thumbnails</span>\n","            <span class=\"code-keyword\">const</span> promises = urls.map(<span class=\"code-function\"><span class=\"code-params\">u</span> =&gt;</span> <span class=\"code-keyword\">this</span>.getThumbnail(u));\n","            <span class=\"code-comment\">// Resolve</span>\n","            <span class=\"code-built_in\">Promise</span>.all(promises).then(sortAndResolve);\n","          }\n","        });\n","      });\n","      <span class=\"code-comment\">// Process individual VTT file</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"getThumbnail\"</span>, url =&gt; {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\"><span class=\"code-params\">resolve</span> =&gt;</span> {\n","          fetch(url).then(<span class=\"code-function\"><span class=\"code-params\">response</span> =&gt;</span> {\n","            <span class=\"code-keyword\">const</span> thumbnail = {\n","              frames: parseVtt(response),\n","              height: <span class=\"code-literal\">null</span>,\n","              urlPrefix: <span class=\"code-string\">''</span>\n","            };\n","\n","            <span class=\"code-comment\">// If the URLs don't start with '/', then we need to set their relative path to be the location of the VTT file</span>\n","            <span class=\"code-comment\">// If the URLs do start with '/', then they obviously don't need a prefix, so it will remain blank</span>\n","            <span class=\"code-comment\">// If the thumbnail URLs start with with none of '/', 'http://' or 'https://', then we need to set their relative path to be the location of the VTT file</span>\n","            <span class=\"code-keyword\">if</span> (!thumbnail.frames[<span class=\"code-number\">0</span>].text.startsWith(<span class=\"code-string\">'/'</span>) &amp;&amp; !thumbnail.frames[<span class=\"code-number\">0</span>].text.startsWith(<span class=\"code-string\">'http://'</span>) &amp;&amp; !thumbnail.frames[<span class=\"code-number\">0</span>].text.startsWith(<span class=\"code-string\">'https://'</span>)) {\n","              thumbnail.urlPrefix = url.substring(<span class=\"code-number\">0</span>, url.lastIndexOf(<span class=\"code-string\">'/'</span>) + <span class=\"code-number\">1</span>);\n","            }\n","\n","            <span class=\"code-comment\">// Download the first frame, so that we can determine/set the height of this thumbnailsDef</span>\n","            <span class=\"code-keyword\">const</span> tempImage = <span class=\"code-keyword\">new</span> Image();\n","            tempImage.onload = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              thumbnail.height = tempImage.naturalHeight;\n","              thumbnail.width = tempImage.naturalWidth;\n","              <span class=\"code-keyword\">this</span>.thumbnails.push(thumbnail);\n","              resolve();\n","            };\n","            tempImage.src = thumbnail.urlPrefix + thumbnail.frames[<span class=\"code-number\">0</span>].text;\n","          });\n","        });\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"startMove\"</span>, event =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.loaded) <span class=\"code-keyword\">return</span>;\n","        <span class=\"code-keyword\">if</span> (!is.event(event) || ![<span class=\"code-string\">'touchmove'</span>, <span class=\"code-string\">'mousemove'</span>].includes(event.type)) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// Wait until media has a duration</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.player.media.duration) <span class=\"code-keyword\">return</span>;\n","        <span class=\"code-keyword\">if</span> (event.type === <span class=\"code-string\">'touchmove'</span>) {\n","          <span class=\"code-comment\">// Calculate seek hover position as approx video seconds</span>\n","          <span class=\"code-keyword\">this</span>.seekTime = <span class=\"code-keyword\">this</span>.player.media.duration * (<span class=\"code-keyword\">this</span>.player.elements.inputs.seek.value / <span class=\"code-number\">100</span>);\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-keyword\">var</span> _this$player$config$m, _this$player$config$m2;\n","          <span class=\"code-comment\">// Calculate seek hover position as approx video seconds</span>\n","          <span class=\"code-keyword\">const</span> clientRect = <span class=\"code-keyword\">this</span>.player.elements.progress.getBoundingClientRect();\n","          <span class=\"code-keyword\">const</span> percentage = <span class=\"code-number\">100</span> / clientRect.width * (event.pageX - clientRect.left);\n","          <span class=\"code-keyword\">this</span>.seekTime = <span class=\"code-keyword\">this</span>.player.media.duration * (percentage / <span class=\"code-number\">100</span>);\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.seekTime &lt; <span class=\"code-number\">0</span>) {\n","            <span class=\"code-comment\">// The mousemove fires for 10+px out to the left</span>\n","            <span class=\"code-keyword\">this</span>.seekTime = <span class=\"code-number\">0</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.seekTime &gt; <span class=\"code-keyword\">this</span>.player.media.duration - <span class=\"code-number\">1</span>) {\n","            <span class=\"code-comment\">// Took 1 second off the duration for safety, because different players can disagree on the real duration of a video</span>\n","            <span class=\"code-keyword\">this</span>.seekTime = <span class=\"code-keyword\">this</span>.player.media.duration - <span class=\"code-number\">1</span>;\n","          }\n","          <span class=\"code-keyword\">this</span>.mousePosX = event.pageX;\n","\n","          <span class=\"code-comment\">// Set time text inside image container</span>\n","          <span class=\"code-keyword\">this</span>.elements.thumb.time.innerText = formatTime(<span class=\"code-keyword\">this</span>.seekTime);\n","\n","          <span class=\"code-comment\">// Get marker point for time</span>\n","          <span class=\"code-keyword\">const</span> point = (_this$player$config$m = <span class=\"code-keyword\">this</span>.player.config.markers) === <span class=\"code-literal\">null</span> || _this$player$config$m === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : (_this$player$config$m2 = _this$player$config$m.points) === <span class=\"code-literal\">null</span> || _this$player$config$m2 === <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> ? <span class=\"code-keyword\">void</span> <span class=\"code-number\">0</span> : _this$player$config$m2.find(({\n","            time: t\n","          }) =&gt; t === <span class=\"code-built_in\">Math</span>.round(<span class=\"code-keyword\">this</span>.seekTime));\n","\n","          <span class=\"code-comment\">// Append the point label to the tooltip</span>\n","          <span class=\"code-keyword\">if</span> (point) {\n","            <span class=\"code-comment\">// this.elements.thumb.time.innerText.concat('\\n');</span>\n","            <span class=\"code-keyword\">this</span>.elements.thumb.time.insertAdjacentHTML(<span class=\"code-string\">'afterbegin'</span>, <span class=\"code-string\">`<span class=\"code-subst\">${point.label}</span>&lt;br&gt;`</span>);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Download and show image</span>\n","        <span class=\"code-keyword\">this</span>.showImageAtCurrentTime();\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"endMove\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">this</span>.toggleThumbContainer(<span class=\"code-literal\">false</span>, <span class=\"code-literal\">true</span>);\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"startScrubbing\"</span>, event =&gt; {\n","        <span class=\"code-comment\">// Only act on left mouse button (0), or touch device (event.button does not exist or is false)</span>\n","        <span class=\"code-keyword\">if</span> (is.nullOrUndefined(event.button) || event.button === <span class=\"code-literal\">false</span> || event.button === <span class=\"code-number\">0</span>) {\n","          <span class=\"code-keyword\">this</span>.mouseDown = <span class=\"code-literal\">true</span>;\n","\n","          <span class=\"code-comment\">// Wait until media has a duration</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.player.media.duration) {\n","            <span class=\"code-keyword\">this</span>.toggleScrubbingContainer(<span class=\"code-literal\">true</span>);\n","            <span class=\"code-keyword\">this</span>.toggleThumbContainer(<span class=\"code-literal\">false</span>, <span class=\"code-literal\">true</span>);\n","\n","            <span class=\"code-comment\">// Download and show image</span>\n","            <span class=\"code-keyword\">this</span>.showImageAtCurrentTime();\n","          }\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"endScrubbing\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">this</span>.mouseDown = <span class=\"code-literal\">false</span>;\n","\n","        <span class=\"code-comment\">// Hide scrubbing preview. But wait until the video has successfully seeked before hiding the scrubbing preview</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Math</span>.ceil(<span class=\"code-keyword\">this</span>.lastTime) === <span class=\"code-built_in\">Math</span>.ceil(<span class=\"code-keyword\">this</span>.player.media.currentTime)) {\n","          <span class=\"code-comment\">// The video was already seeked/loaded at the chosen time - hide immediately</span>\n","          <span class=\"code-keyword\">this</span>.toggleScrubbingContainer(<span class=\"code-literal\">false</span>);\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-comment\">// The video hasn't seeked yet. Wait for that</span>\n","          once.call(<span class=\"code-keyword\">this</span>.player, <span class=\"code-keyword\">this</span>.player.media, <span class=\"code-string\">'timeupdate'</span>, () =&gt; {\n","            <span class=\"code-comment\">// Re-check mousedown - we might have already started scrubbing again</span>\n","            <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.mouseDown) {\n","              <span class=\"code-keyword\">this</span>.toggleScrubbingContainer(<span class=\"code-literal\">false</span>);\n","            }\n","          });\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Setup hooks for Plyr and window events\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"listeners\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Hide thumbnail preview - on mouse click, mouse leave (in listeners.js for now), and video play/seek. All four are required, e.g., for buffering</span>\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'play'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.toggleThumbContainer(<span class=\"code-literal\">false</span>, <span class=\"code-literal\">true</span>);\n","        });\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'seeked'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.toggleThumbContainer(<span class=\"code-literal\">false</span>);\n","        });\n","        <span class=\"code-keyword\">this</span>.player.on(<span class=\"code-string\">'timeupdate'</span>, () =&gt; {\n","          <span class=\"code-keyword\">this</span>.lastTime = <span class=\"code-keyword\">this</span>.player.media.currentTime;\n","        });\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Create HTML elements for image containers\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"render\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Create HTML element: plyr__preview-thumbnail-container</span>\n","        <span class=\"code-keyword\">this</span>.elements.thumb.container = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.player.config.classNames.previewThumbnails.thumbContainer\n","        });\n","\n","        <span class=\"code-comment\">// Wrapper for the image for styling</span>\n","        <span class=\"code-keyword\">this</span>.elements.thumb.imageContainer = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.player.config.classNames.previewThumbnails.imageContainer\n","        });\n","        <span class=\"code-keyword\">this</span>.elements.thumb.container.appendChild(<span class=\"code-keyword\">this</span>.elements.thumb.imageContainer);\n","\n","        <span class=\"code-comment\">// Create HTML element, parent+span: time text (e.g., 01:32:00)</span>\n","        <span class=\"code-keyword\">const</span> timeContainer = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.player.config.classNames.previewThumbnails.timeContainer\n","        });\n","        <span class=\"code-keyword\">this</span>.elements.thumb.time = createElement(<span class=\"code-string\">'span'</span>, {}, <span class=\"code-string\">'00:00'</span>);\n","        timeContainer.appendChild(<span class=\"code-keyword\">this</span>.elements.thumb.time);\n","        <span class=\"code-keyword\">this</span>.elements.thumb.imageContainer.appendChild(timeContainer);\n","\n","        <span class=\"code-comment\">// Inject the whole thumb</span>\n","        <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.player.elements.progress)) {\n","          <span class=\"code-keyword\">this</span>.player.elements.progress.appendChild(<span class=\"code-keyword\">this</span>.elements.thumb.container);\n","        }\n","\n","        <span class=\"code-comment\">// Create HTML element: plyr__preview-scrubbing-container</span>\n","        <span class=\"code-keyword\">this</span>.elements.scrubbing.container = createElement(<span class=\"code-string\">'div'</span>, {\n","          class: this.player.config.classNames.previewThumbnails.scrubbingContainer\n","        });\n","        <span class=\"code-keyword\">this</span>.player.elements.wrapper.appendChild(<span class=\"code-keyword\">this</span>.elements.scrubbing.container);\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"destroy\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements.thumb.container) {\n","          <span class=\"code-keyword\">this</span>.elements.thumb.container.remove();\n","        }\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements.scrubbing.container) {\n","          <span class=\"code-keyword\">this</span>.elements.scrubbing.container.remove();\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"showImageAtCurrentTime\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.mouseDown) {\n","          <span class=\"code-keyword\">this</span>.setScrubbingContainerSize();\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-keyword\">this</span>.setThumbContainerSizeAndPos();\n","        }\n","\n","        <span class=\"code-comment\">// Find the desired thumbnail index</span>\n","        <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Handle a video longer than the thumbs where thumbNum is null</span>\n","        <span class=\"code-keyword\">const</span> thumbNum = <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames.findIndex(<span class=\"code-function\"><span class=\"code-params\">frame</span> =&gt;</span> <span class=\"code-keyword\">this</span>.seekTime &gt;= frame.startTime &amp;&amp; <span class=\"code-keyword\">this</span>.seekTime &lt;= frame.endTime);\n","        <span class=\"code-keyword\">const</span> hasThumb = thumbNum &gt;= <span class=\"code-number\">0</span>;\n","        <span class=\"code-keyword\">let</span> qualityIndex = <span class=\"code-number\">0</span>;\n","\n","        <span class=\"code-comment\">// Show the thumb container if we're not scrubbing</span>\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.mouseDown) {\n","          <span class=\"code-keyword\">this</span>.toggleThumbContainer(hasThumb);\n","        }\n","\n","        <span class=\"code-comment\">// No matching thumb found</span>\n","        <span class=\"code-keyword\">if</span> (!hasThumb) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Check to see if we've already downloaded higher quality versions of this image</span>\n","        <span class=\"code-keyword\">this</span>.thumbnails.forEach(<span class=\"code-function\">(<span class=\"code-params\">thumbnail, index</span>) =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.loadedImages.includes(thumbnail.frames[thumbNum].text)) {\n","            qualityIndex = index;\n","          }\n","        });\n","\n","        <span class=\"code-comment\">// Only proceed if either thumb num or thumbfilename has changed</span>\n","        <span class=\"code-keyword\">if</span> (thumbNum !== <span class=\"code-keyword\">this</span>.showingThumb) {\n","          <span class=\"code-keyword\">this</span>.showingThumb = thumbNum;\n","          <span class=\"code-keyword\">this</span>.loadImage(qualityIndex);\n","        }\n","      });\n","      <span class=\"code-comment\">// Show the image that's currently specified in this.showingThumb</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"loadImage\"</span>, (qualityIndex = <span class=\"code-number\">0</span>) =&gt; {\n","        <span class=\"code-keyword\">const</span> thumbNum = <span class=\"code-keyword\">this</span>.showingThumb;\n","        <span class=\"code-keyword\">const</span> thumbnail = <span class=\"code-keyword\">this</span>.thumbnails[qualityIndex];\n","        <span class=\"code-keyword\">const</span> {\n","          urlPrefix\n","        } = thumbnail;\n","        <span class=\"code-keyword\">const</span> frame = thumbnail.frames[thumbNum];\n","        <span class=\"code-keyword\">const</span> thumbFilename = thumbnail.frames[thumbNum].text;\n","        <span class=\"code-keyword\">const</span> thumbUrl = urlPrefix + thumbFilename;\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.currentImageElement || <span class=\"code-keyword\">this</span>.currentImageElement.dataset.filename !== thumbFilename) {\n","          <span class=\"code-comment\">// If we're already loading a previous image, remove its onload handler - we don't want it to load after this one</span>\n","          <span class=\"code-comment\">// Only do this if not using sprites. Without sprites we really want to show as many images as possible, as a best-effort</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.loadingImage &amp;&amp; <span class=\"code-keyword\">this</span>.usingSprites) {\n","            <span class=\"code-keyword\">this</span>.loadingImage.onload = <span class=\"code-literal\">null</span>;\n","          }\n","\n","          <span class=\"code-comment\">// We're building and adding a new image. In other implementations of similar functionality (YouTube), background image</span>\n","          <span class=\"code-comment\">// is instead used. But this causes issues with larger images in Firefox and Safari - switching between background</span>\n","          <span class=\"code-comment\">// images causes a flicker. Putting a new image over the top does not</span>\n","          <span class=\"code-keyword\">const</span> previewImage = <span class=\"code-keyword\">new</span> Image();\n","          previewImage.src = thumbUrl;\n","          previewImage.dataset.index = thumbNum;\n","          previewImage.dataset.filename = thumbFilename;\n","          <span class=\"code-keyword\">this</span>.showingThumbFilename = thumbFilename;\n","          <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Loading image: <span class=\"code-subst\">${thumbUrl}</span>`</span>);\n","\n","          <span class=\"code-comment\">// For some reason, passing the named function directly causes it to execute immediately. So I've wrapped it in an anonymous function...</span>\n","          previewImage.onload = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> <span class=\"code-keyword\">this</span>.showImage(previewImage, frame, qualityIndex, thumbNum, thumbFilename, <span class=\"code-literal\">true</span>);\n","          <span class=\"code-keyword\">this</span>.loadingImage = previewImage;\n","          <span class=\"code-keyword\">this</span>.removeOldImages(previewImage);\n","        } <span class=\"code-keyword\">else</span> {\n","          <span class=\"code-comment\">// Update the existing image</span>\n","          <span class=\"code-keyword\">this</span>.showImage(<span class=\"code-keyword\">this</span>.currentImageElement, frame, qualityIndex, thumbNum, thumbFilename, <span class=\"code-literal\">false</span>);\n","          <span class=\"code-keyword\">this</span>.currentImageElement.dataset.index = thumbNum;\n","          <span class=\"code-keyword\">this</span>.removeOldImages(<span class=\"code-keyword\">this</span>.currentImageElement);\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"showImage\"</span>, (previewImage, frame, qualityIndex, thumbNum, thumbFilename, newImage = <span class=\"code-literal\">true</span>) =&gt; {\n","        <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Showing thumb: <span class=\"code-subst\">${thumbFilename}</span>. num: <span class=\"code-subst\">${thumbNum}</span>. qual: <span class=\"code-subst\">${qualityIndex}</span>. newimg: <span class=\"code-subst\">${newImage}</span>`</span>);\n","        <span class=\"code-keyword\">this</span>.setImageSizeAndOffset(previewImage, frame);\n","        <span class=\"code-keyword\">if</span> (newImage) {\n","          <span class=\"code-keyword\">this</span>.currentImageContainer.appendChild(previewImage);\n","          <span class=\"code-keyword\">this</span>.currentImageElement = previewImage;\n","          <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.loadedImages.includes(thumbFilename)) {\n","            <span class=\"code-keyword\">this</span>.loadedImages.push(thumbFilename);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Preload images before and after the current one</span>\n","        <span class=\"code-comment\">// Show higher quality of the same frame</span>\n","        <span class=\"code-comment\">// Each step here has a short time delay, and only continues if still hovering/seeking the same spot. This is to protect slow connections from overloading</span>\n","        <span class=\"code-keyword\">this</span>.preloadNearby(thumbNum, <span class=\"code-literal\">true</span>).then(<span class=\"code-keyword\">this</span>.preloadNearby(thumbNum, <span class=\"code-literal\">false</span>)).then(<span class=\"code-keyword\">this</span>.getHigherQuality(qualityIndex, previewImage, frame, thumbFilename));\n","      });\n","      <span class=\"code-comment\">// Remove all preview images that aren't the designated current image</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"removeOldImages\"</span>, currentImage =&gt; {\n","        <span class=\"code-comment\">// Get a list of all images, convert it from a DOM list to an array</span>\n","        <span class=\"code-built_in\">Array</span>.from(<span class=\"code-keyword\">this</span>.currentImageContainer.children).forEach(<span class=\"code-function\"><span class=\"code-params\">image</span> =&gt;</span> {\n","          <span class=\"code-keyword\">if</span> (image.tagName.toLowerCase() !== <span class=\"code-string\">'img'</span>) {\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","          <span class=\"code-keyword\">const</span> removeDelay = <span class=\"code-keyword\">this</span>.usingSprites ? <span class=\"code-number\">500</span> : <span class=\"code-number\">1000</span>;\n","          <span class=\"code-keyword\">if</span> (image.dataset.index !== currentImage.dataset.index &amp;&amp; !image.dataset.deleting) {\n","            <span class=\"code-comment\">// Wait 200ms, as the new image can take some time to show on certain browsers (even though it was downloaded before showing). This will prevent flicker, and show some generosity towards slower clients</span>\n","            <span class=\"code-comment\">// First set attribute 'deleting' to prevent multi-handling of this on repeat firing of this function</span>\n","            <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","            image.dataset.deleting = <span class=\"code-literal\">true</span>;\n","\n","            <span class=\"code-comment\">// This has to be set before the timeout - to prevent issues switching between hover and scrub</span>\n","            <span class=\"code-keyword\">const</span> {\n","              currentImageContainer\n","            } = <span class=\"code-keyword\">this</span>;\n","            setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              currentImageContainer.removeChild(image);\n","              <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Removing thumb: <span class=\"code-subst\">${image.dataset.filename}</span>`</span>);\n","            }, removeDelay);\n","          }\n","        });\n","      });\n","      <span class=\"code-comment\">// Preload images before and after the current one. Only if the user is still hovering/seeking the same frame</span>\n","      <span class=\"code-comment\">// This will only preload the lowest quality</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"preloadNearby\"</span>, (thumbNum, forward = <span class=\"code-literal\">true</span>) =&gt; {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">Promise</span>(<span class=\"code-function\"><span class=\"code-params\">resolve</span> =&gt;</span> {\n","          setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","            <span class=\"code-keyword\">const</span> oldThumbFilename = <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames[thumbNum].text;\n","            <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.showingThumbFilename === oldThumbFilename) {\n","              <span class=\"code-comment\">// Find the nearest thumbs with different filenames. Sometimes it'll be the next index, but in the case of sprites, it might be 100+ away</span>\n","              <span class=\"code-keyword\">let</span> thumbnailsClone;\n","              <span class=\"code-keyword\">if</span> (forward) {\n","                thumbnailsClone = <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames.slice(thumbNum);\n","              } <span class=\"code-keyword\">else</span> {\n","                thumbnailsClone = <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames.slice(<span class=\"code-number\">0</span>, thumbNum).reverse();\n","              }\n","              <span class=\"code-keyword\">let</span> foundOne = <span class=\"code-literal\">false</span>;\n","              thumbnailsClone.forEach(<span class=\"code-function\"><span class=\"code-params\">frame</span> =&gt;</span> {\n","                <span class=\"code-keyword\">const</span> newThumbFilename = frame.text;\n","                <span class=\"code-keyword\">if</span> (newThumbFilename !== oldThumbFilename) {\n","                  <span class=\"code-comment\">// Found one with a different filename. Make sure it hasn't already been loaded on this page visit</span>\n","                  <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.loadedImages.includes(newThumbFilename)) {\n","                    foundOne = <span class=\"code-literal\">true</span>;\n","                    <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Preloading thumb filename: <span class=\"code-subst\">${newThumbFilename}</span>`</span>);\n","                    <span class=\"code-keyword\">const</span> {\n","                      urlPrefix\n","                    } = <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>];\n","                    <span class=\"code-keyword\">const</span> thumbURL = urlPrefix + newThumbFilename;\n","                    <span class=\"code-keyword\">const</span> previewImage = <span class=\"code-keyword\">new</span> Image();\n","                    previewImage.src = thumbURL;\n","                    previewImage.onload = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","                      <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Preloaded thumb filename: <span class=\"code-subst\">${newThumbFilename}</span>`</span>);\n","                      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.loadedImages.includes(newThumbFilename)) <span class=\"code-keyword\">this</span>.loadedImages.push(newThumbFilename);\n","\n","                      <span class=\"code-comment\">// We don't resolve until the thumb is loaded</span>\n","                      resolve();\n","                    };\n","                  }\n","                }\n","              });\n","\n","              <span class=\"code-comment\">// If there are none to preload then we want to resolve immediately</span>\n","              <span class=\"code-keyword\">if</span> (!foundOne) {\n","                resolve();\n","              }\n","            }\n","          }, <span class=\"code-number\">300</span>);\n","        });\n","      });\n","      <span class=\"code-comment\">// If user has been hovering current image for half a second, look for a higher quality one</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"getHigherQuality\"</span>, (currentQualityIndex, previewImage, frame, thumbFilename) =&gt; {\n","        <span class=\"code-keyword\">if</span> (currentQualityIndex &lt; <span class=\"code-keyword\">this</span>.thumbnails.length - <span class=\"code-number\">1</span>) {\n","          <span class=\"code-comment\">// Only use the higher quality version if it's going to look any better - if the current thumb is of a lower pixel density than the thumbnail container</span>\n","          <span class=\"code-keyword\">let</span> previewImageHeight = previewImage.naturalHeight;\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.usingSprites) {\n","            previewImageHeight = frame.h;\n","          }\n","          <span class=\"code-keyword\">if</span> (previewImageHeight &lt; <span class=\"code-keyword\">this</span>.thumbContainerHeight) {\n","            <span class=\"code-comment\">// Recurse back to the loadImage function - show a higher quality one, but only if the viewer is on this frame for a while</span>\n","            setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              <span class=\"code-comment\">// Make sure the mouse hasn't already moved on and started hovering at another image</span>\n","              <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.showingThumbFilename === thumbFilename) {\n","                <span class=\"code-keyword\">this</span>.player.debug.log(<span class=\"code-string\">`Showing higher quality thumb for: <span class=\"code-subst\">${thumbFilename}</span>`</span>);\n","                <span class=\"code-keyword\">this</span>.loadImage(currentQualityIndex + <span class=\"code-number\">1</span>);\n","              }\n","            }, <span class=\"code-number\">300</span>);\n","          }\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"toggleThumbContainer\"</span>, (toggle = <span class=\"code-literal\">false</span>, clearShowing = <span class=\"code-literal\">false</span>) =&gt; {\n","        <span class=\"code-keyword\">const</span> className = <span class=\"code-keyword\">this</span>.player.config.classNames.previewThumbnails.thumbContainerShown;\n","        <span class=\"code-keyword\">this</span>.elements.thumb.container.classList.toggle(className, toggle);\n","        <span class=\"code-keyword\">if</span> (!toggle &amp;&amp; clearShowing) {\n","          <span class=\"code-keyword\">this</span>.showingThumb = <span class=\"code-literal\">null</span>;\n","          <span class=\"code-keyword\">this</span>.showingThumbFilename = <span class=\"code-literal\">null</span>;\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"toggleScrubbingContainer\"</span>, (toggle = <span class=\"code-literal\">false</span>) =&gt; {\n","        <span class=\"code-keyword\">const</span> className = <span class=\"code-keyword\">this</span>.player.config.classNames.previewThumbnails.scrubbingContainerShown;\n","        <span class=\"code-keyword\">this</span>.elements.scrubbing.container.classList.toggle(className, toggle);\n","        <span class=\"code-keyword\">if</span> (!toggle) {\n","          <span class=\"code-keyword\">this</span>.showingThumb = <span class=\"code-literal\">null</span>;\n","          <span class=\"code-keyword\">this</span>.showingThumbFilename = <span class=\"code-literal\">null</span>;\n","        }\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"determineContainerAutoSizing\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.elements.thumb.imageContainer.clientHeight &gt; <span class=\"code-number\">20</span> || <span class=\"code-keyword\">this</span>.elements.thumb.imageContainer.clientWidth &gt; <span class=\"code-number\">20</span>) {\n","          <span class=\"code-comment\">// This will prevent auto sizing in this.setThumbContainerSizeAndPos()</span>\n","          <span class=\"code-keyword\">this</span>.sizeSpecifiedInCSS = <span class=\"code-literal\">true</span>;\n","        }\n","      });\n","      <span class=\"code-comment\">// Set the size to be about a quarter of the size of video. Unless option dynamicSize === false, in which case it needs to be set in CSS</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"setThumbContainerSizeAndPos\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          imageContainer\n","        } = <span class=\"code-keyword\">this</span>.elements.thumb;\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.sizeSpecifiedInCSS) {\n","          <span class=\"code-keyword\">const</span> thumbWidth = <span class=\"code-built_in\">Math</span>.floor(<span class=\"code-keyword\">this</span>.thumbContainerHeight * <span class=\"code-keyword\">this</span>.thumbAspectRatio);\n","          imageContainer.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.thumbContainerHeight}</span>px`</span>;\n","          imageContainer.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${thumbWidth}</span>px`</span>;\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (imageContainer.clientHeight &gt; <span class=\"code-number\">20</span> &amp;&amp; imageContainer.clientWidth &lt; <span class=\"code-number\">20</span>) {\n","          <span class=\"code-keyword\">const</span> thumbWidth = <span class=\"code-built_in\">Math</span>.floor(imageContainer.clientHeight * <span class=\"code-keyword\">this</span>.thumbAspectRatio);\n","          imageContainer.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${thumbWidth}</span>px`</span>;\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (imageContainer.clientHeight &lt; <span class=\"code-number\">20</span> &amp;&amp; imageContainer.clientWidth &gt; <span class=\"code-number\">20</span>) {\n","          <span class=\"code-keyword\">const</span> thumbHeight = <span class=\"code-built_in\">Math</span>.floor(imageContainer.clientWidth / <span class=\"code-keyword\">this</span>.thumbAspectRatio);\n","          imageContainer.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${thumbHeight}</span>px`</span>;\n","        }\n","        <span class=\"code-keyword\">this</span>.setThumbContainerPos();\n","      });\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"setThumbContainerPos\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> scrubberRect = <span class=\"code-keyword\">this</span>.player.elements.progress.getBoundingClientRect();\n","        <span class=\"code-keyword\">const</span> containerRect = <span class=\"code-keyword\">this</span>.player.elements.container.getBoundingClientRect();\n","        <span class=\"code-keyword\">const</span> {\n","          container\n","        } = <span class=\"code-keyword\">this</span>.elements.thumb;\n","        <span class=\"code-comment\">// Find the lowest and highest desired left-position, so we don't slide out the side of the video container</span>\n","        <span class=\"code-keyword\">const</span> min = containerRect.left - scrubberRect.left + <span class=\"code-number\">10</span>;\n","        <span class=\"code-keyword\">const</span> max = containerRect.right - scrubberRect.left - container.clientWidth - <span class=\"code-number\">10</span>;\n","        <span class=\"code-comment\">// Set preview container position to: mousepos, minus seekbar.left, minus half of previewContainer.clientWidth</span>\n","        <span class=\"code-keyword\">const</span> position = <span class=\"code-keyword\">this</span>.mousePosX - scrubberRect.left - container.clientWidth / <span class=\"code-number\">2</span>;\n","        <span class=\"code-keyword\">const</span> clamped = clamp(position, min, max);\n","\n","        <span class=\"code-comment\">// Move the popover position</span>\n","        container.style.left = <span class=\"code-string\">`<span class=\"code-subst\">${clamped}</span>px`</span>;\n","\n","        <span class=\"code-comment\">// The arrow can follow the cursor</span>\n","        container.style.setProperty(<span class=\"code-string\">'--preview-arrow-offset'</span>, <span class=\"code-string\">`<span class=\"code-subst\">${position - clamped}</span>px`</span>);\n","      });\n","      <span class=\"code-comment\">// Can't use 100% width, in case the video is a different aspect ratio to the video container</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"setScrubbingContainerSize\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">const</span> {\n","          width,\n","          height\n","        } = fitRatio(<span class=\"code-keyword\">this</span>.thumbAspectRatio, {\n","          width: <span class=\"code-keyword\">this</span>.player.media.clientWidth,\n","          height: <span class=\"code-keyword\">this</span>.player.media.clientHeight\n","        });\n","        <span class=\"code-keyword\">this</span>.elements.scrubbing.container.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${width}</span>px`</span>;\n","        <span class=\"code-keyword\">this</span>.elements.scrubbing.container.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${height}</span>px`</span>;\n","      });\n","      <span class=\"code-comment\">// Sprites need to be offset to the correct location</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"setImageSizeAndOffset\"</span>, (previewImage, frame) =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.usingSprites) <span class=\"code-keyword\">return</span>;\n","\n","        <span class=\"code-comment\">// Find difference between height and preview container height</span>\n","        <span class=\"code-keyword\">const</span> multiplier = <span class=\"code-keyword\">this</span>.thumbContainerHeight / frame.h;\n","\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        previewImage.style.height = <span class=\"code-string\">`<span class=\"code-subst\">${previewImage.naturalHeight * multiplier}</span>px`</span>;\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        previewImage.style.width = <span class=\"code-string\">`<span class=\"code-subst\">${previewImage.naturalWidth * multiplier}</span>px`</span>;\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        previewImage.style.left = <span class=\"code-string\">`-<span class=\"code-subst\">${frame.x * multiplier}</span>px`</span>;\n","        <span class=\"code-comment\">// eslint-disable-next-line no-param-reassign</span>\n","        previewImage.style.top = <span class=\"code-string\">`-<span class=\"code-subst\">${frame.y * multiplier}</span>px`</span>;\n","      });\n","      <span class=\"code-keyword\">this</span>.player = player;\n","      <span class=\"code-keyword\">this</span>.thumbnails = [];\n","      <span class=\"code-keyword\">this</span>.loaded = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.lastMouseMoveTime = <span class=\"code-built_in\">Date</span>.now();\n","      <span class=\"code-keyword\">this</span>.mouseDown = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.loadedImages = [];\n","      <span class=\"code-keyword\">this</span>.elements = {\n","        thumb: {},\n","        scrubbing: {}\n","      };\n","      <span class=\"code-keyword\">this</span>.load();\n","    }\n","    <span class=\"code-keyword\">get</span> enabled() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.player.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.player.isVideo &amp;&amp; <span class=\"code-keyword\">this</span>.player.config.previewThumbnails.enabled;\n","    }\n","    <span class=\"code-keyword\">get</span> currentImageContainer() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.mouseDown ? <span class=\"code-keyword\">this</span>.elements.scrubbing.container : <span class=\"code-keyword\">this</span>.elements.thumb.imageContainer;\n","    }\n","    <span class=\"code-keyword\">get</span> usingSprites() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Object</span>.keys(<span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames[<span class=\"code-number\">0</span>]).includes(<span class=\"code-string\">'w'</span>);\n","    }\n","    <span class=\"code-keyword\">get</span> thumbAspectRatio() {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.usingSprites) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames[<span class=\"code-number\">0</span>].w / <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].frames[<span class=\"code-number\">0</span>].h;\n","      }\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].width / <span class=\"code-keyword\">this</span>.thumbnails[<span class=\"code-number\">0</span>].height;\n","    }\n","    <span class=\"code-keyword\">get</span> thumbContainerHeight() {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.mouseDown) {\n","        <span class=\"code-keyword\">const</span> {\n","          height\n","        } = fitRatio(<span class=\"code-keyword\">this</span>.thumbAspectRatio, {\n","          width: <span class=\"code-keyword\">this</span>.player.media.clientWidth,\n","          height: <span class=\"code-keyword\">this</span>.player.media.clientHeight\n","        });\n","        <span class=\"code-keyword\">return</span> height;\n","      }\n","\n","      <span class=\"code-comment\">// If css is used this needs to return the css height for sprites to work (see setImageSizeAndOffset)</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.sizeSpecifiedInCSS) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.elements.thumb.imageContainer.clientHeight;\n","      }\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Math</span>.floor(<span class=\"code-keyword\">this</span>.player.media.clientWidth / <span class=\"code-keyword\">this</span>.thumbAspectRatio / <span class=\"code-number\">4</span>);\n","    }\n","    <span class=\"code-keyword\">get</span> currentImageElement() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.mouseDown ? <span class=\"code-keyword\">this</span>.currentScrubbingImageElement : <span class=\"code-keyword\">this</span>.currentThumbnailImageElement;\n","    }\n","    <span class=\"code-keyword\">set</span> currentImageElement(element) {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.mouseDown) {\n","        <span class=\"code-keyword\">this</span>.currentScrubbingImageElement = element;\n","      } <span class=\"code-keyword\">else</span> {\n","        <span class=\"code-keyword\">this</span>.currentThumbnailImageElement = element;\n","      }\n","    }\n","  }\n","\n","  <span class=\"code-comment\">// ==========================================================================</span>\n","  <span class=\"code-keyword\">const</span> source = {\n","    <span class=\"code-comment\">// Add elements to HTML5 media (source, tracks, etc)</span>\n","    insertElements(type, attributes) {\n","      <span class=\"code-keyword\">if</span> (is.string(attributes)) {\n","        insertElement(type, <span class=\"code-keyword\">this</span>.media, {\n","          src: attributes\n","        });\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.array(attributes)) {\n","        attributes.forEach(<span class=\"code-function\"><span class=\"code-params\">attribute</span> =&gt;</span> {\n","          insertElement(type, <span class=\"code-keyword\">this</span>.media, attribute);\n","        });\n","      }\n","    },\n","    <span class=\"code-comment\">// Update source</span>\n","    <span class=\"code-comment\">// Sources are not checked for support so be careful</span>\n","    change(input) {\n","      <span class=\"code-keyword\">if</span> (!getDeep(input, <span class=\"code-string\">'sources.length'</span>)) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Invalid source format'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Cancel current network requests</span>\n","      html5.cancelRequests.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Destroy instance and re-setup</span>\n","      <span class=\"code-keyword\">this</span>.destroy.call(<span class=\"code-keyword\">this</span>, () =&gt; {\n","        <span class=\"code-comment\">// Reset quality options</span>\n","        <span class=\"code-keyword\">this</span>.options.quality = [];\n","\n","        <span class=\"code-comment\">// Remove elements</span>\n","        removeElement(<span class=\"code-keyword\">this</span>.media);\n","        <span class=\"code-keyword\">this</span>.media = <span class=\"code-literal\">null</span>;\n","\n","        <span class=\"code-comment\">// Reset class name</span>\n","        <span class=\"code-keyword\">if</span> (is.element(<span class=\"code-keyword\">this</span>.elements.container)) {\n","          <span class=\"code-keyword\">this</span>.elements.container.removeAttribute(<span class=\"code-string\">'class'</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Set the type and provider</span>\n","        <span class=\"code-keyword\">const</span> {\n","          sources,\n","          type\n","        } = input;\n","        <span class=\"code-keyword\">const</span> [{\n","          provider = providers.html5,\n","          src\n","        }] = sources;\n","        <span class=\"code-keyword\">const</span> tagName = provider === <span class=\"code-string\">'html5'</span> ? type : <span class=\"code-string\">'div'</span>;\n","        <span class=\"code-keyword\">const</span> attributes = provider === <span class=\"code-string\">'html5'</span> ? {} : {\n","          src\n","        };\n","        <span class=\"code-built_in\">Object</span>.assign(<span class=\"code-keyword\">this</span>, {\n","          provider,\n","          type,\n","          <span class=\"code-comment\">// Check for support</span>\n","          supported: support.check(type, provider, <span class=\"code-keyword\">this</span>.config.playsinline),\n","          <span class=\"code-comment\">// Create new element</span>\n","          media: createElement(tagName, attributes)\n","        });\n","\n","        <span class=\"code-comment\">// Inject the new element</span>\n","        <span class=\"code-keyword\">this</span>.elements.container.appendChild(<span class=\"code-keyword\">this</span>.media);\n","\n","        <span class=\"code-comment\">// Autoplay the new source?</span>\n","        <span class=\"code-keyword\">if</span> (is.boolean(input.autoplay)) {\n","          <span class=\"code-keyword\">this</span>.config.autoplay = input.autoplay;\n","        }\n","\n","        <span class=\"code-comment\">// Set attributes for audio and video</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.crossorigin) {\n","            <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'crossorigin'</span>, <span class=\"code-string\">''</span>);\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.autoplay) {\n","            <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'autoplay'</span>, <span class=\"code-string\">''</span>);\n","          }\n","          <span class=\"code-keyword\">if</span> (!is.empty(input.poster)) {\n","            <span class=\"code-keyword\">this</span>.poster = input.poster;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.loop.active) {\n","            <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'loop'</span>, <span class=\"code-string\">''</span>);\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.muted) {\n","            <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'muted'</span>, <span class=\"code-string\">''</span>);\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.playsinline) {\n","            <span class=\"code-keyword\">this</span>.media.setAttribute(<span class=\"code-string\">'playsinline'</span>, <span class=\"code-string\">''</span>);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Restore class hook</span>\n","        ui.addStyleHook.call(<span class=\"code-keyword\">this</span>);\n","\n","        <span class=\"code-comment\">// Set new sources for html5</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          source.insertElements.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'source'</span>, sources);\n","        }\n","\n","        <span class=\"code-comment\">// Set video title</span>\n","        <span class=\"code-keyword\">this</span>.config.title = input.title;\n","\n","        <span class=\"code-comment\">// Set up from scratch</span>\n","        media.setup.call(<span class=\"code-keyword\">this</span>);\n","\n","        <span class=\"code-comment\">// HTML5 stuff</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          <span class=\"code-comment\">// Setup captions</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(input).includes(<span class=\"code-string\">'tracks'</span>)) {\n","            source.insertElements.call(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">'track'</span>, input.tracks);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// If HTML5 or embed but not fully supported, setupInterface and call ready now</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5 || <span class=\"code-keyword\">this</span>.isEmbed &amp;&amp; !<span class=\"code-keyword\">this</span>.supported.ui) {\n","          <span class=\"code-comment\">// Setup interface</span>\n","          ui.build.call(<span class=\"code-keyword\">this</span>);\n","        }\n","\n","        <span class=\"code-comment\">// Load HTML5 sources</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          <span class=\"code-keyword\">this</span>.media.load();\n","        }\n","\n","        <span class=\"code-comment\">// Update previewThumbnails config &amp; reload plugin</span>\n","        <span class=\"code-keyword\">if</span> (!is.empty(input.previewThumbnails)) {\n","          <span class=\"code-built_in\">Object</span>.assign(<span class=\"code-keyword\">this</span>.config.previewThumbnails, input.previewThumbnails);\n","\n","          <span class=\"code-comment\">// Cleanup previewThumbnails plugin if it was loaded</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.previewThumbnails &amp;&amp; <span class=\"code-keyword\">this</span>.previewThumbnails.loaded) {\n","            <span class=\"code-keyword\">this</span>.previewThumbnails.destroy();\n","            <span class=\"code-keyword\">this</span>.previewThumbnails = <span class=\"code-literal\">null</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Create new instance if it is still enabled</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.previewThumbnails.enabled) {\n","            <span class=\"code-keyword\">this</span>.previewThumbnails = <span class=\"code-keyword\">new</span> PreviewThumbnails(<span class=\"code-keyword\">this</span>);\n","          }\n","        }\n","\n","        <span class=\"code-comment\">// Update the fullscreen support</span>\n","        <span class=\"code-keyword\">this</span>.fullscreen.update();\n","      }, <span class=\"code-literal\">true</span>);\n","    }\n","  };\n","\n","  <span class=\"code-comment\">// Private properties</span>\n","  <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Use a WeakMap for private globals</span>\n","  <span class=\"code-comment\">// const globals = new WeakMap();</span>\n","\n","  <span class=\"code-comment\">// Plyr instance</span>\n","  <span class=\"code-class\"><span class=\"code-keyword\">class</span> <span class=\"code-title\">Plyr</span> </span>{\n","    <span class=\"code-keyword\">constructor</span>(target, options) {\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Play the media, or play the advertisement (if they are not blocked)\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"play\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!is.function(<span class=\"code-keyword\">this</span>.media.play)) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","\n","        <span class=\"code-comment\">// Intecept play with ads</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.ads &amp;&amp; <span class=\"code-keyword\">this</span>.ads.enabled) {\n","          <span class=\"code-keyword\">this</span>.ads.managerPromise.then(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> <span class=\"code-keyword\">this</span>.ads.play()).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> silencePromise(<span class=\"code-keyword\">this</span>.media.play()));\n","        }\n","\n","        <span class=\"code-comment\">// Return the promise (for HTML5)</span>\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.play();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Pause the media\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"pause\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.playing || !is.function(<span class=\"code-keyword\">this</span>.media.pause)) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.pause();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Toggle playback based on current status\n</span>","<span class=\"code-comment\">       * @param {Boolean} input\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"togglePlay\"</span>, input =&gt; {\n","        <span class=\"code-comment\">// Toggle based on current state if nothing passed</span>\n","        <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : !<span class=\"code-keyword\">this</span>.playing;\n","        <span class=\"code-keyword\">if</span> (toggle) {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.play();\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.pause();\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Stop playback\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"stop\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          <span class=\"code-keyword\">this</span>.pause();\n","          <span class=\"code-keyword\">this</span>.restart();\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-keyword\">this</span>.media.stop)) {\n","          <span class=\"code-keyword\">this</span>.media.stop();\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Restart playback\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"restart\"</span>, () =&gt; {\n","        <span class=\"code-keyword\">this</span>.currentTime = <span class=\"code-number\">0</span>;\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Rewind\n</span>","<span class=\"code-comment\">       * @param {Number} seekTime - how far to rewind in seconds. Defaults to the config.seekTime\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"rewind\"</span>, seekTime =&gt; {\n","        <span class=\"code-keyword\">this</span>.currentTime -= is.number(seekTime) ? seekTime : <span class=\"code-keyword\">this</span>.config.seekTime;\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Fast forward\n</span>","<span class=\"code-comment\">       * @param {Number} seekTime - how far to fast forward in seconds. Defaults to the config.seekTime\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"forward\"</span>, seekTime =&gt; {\n","        <span class=\"code-keyword\">this</span>.currentTime += is.number(seekTime) ? seekTime : <span class=\"code-keyword\">this</span>.config.seekTime;\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Increase volume\n</span>","<span class=\"code-comment\">       * @param {Boolean} step - How much to decrease by (between 0 and 1)\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"increaseVolume\"</span>, step =&gt; {\n","        <span class=\"code-keyword\">const</span> volume = <span class=\"code-keyword\">this</span>.media.muted ? <span class=\"code-number\">0</span> : <span class=\"code-keyword\">this</span>.volume;\n","        <span class=\"code-keyword\">this</span>.volume = volume + (is.number(step) ? step : <span class=\"code-number\">0</span>);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Decrease volume\n</span>","<span class=\"code-comment\">       * @param {Boolean} step - How much to decrease by (between 0 and 1)\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"decreaseVolume\"</span>, step =&gt; {\n","        <span class=\"code-keyword\">this</span>.increaseVolume(-step);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Trigger the airplay dialog\n</span>","<span class=\"code-comment\">       * <span class=\"code-doctag\">TODO:</span> update player with state, support, enabled\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"airplay\"</span>, () =&gt; {\n","        <span class=\"code-comment\">// Show dialog if supported</span>\n","        <span class=\"code-keyword\">if</span> (support.airplay) {\n","          <span class=\"code-keyword\">this</span>.media.webkitShowPlaybackTargetPicker();\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Toggle the player controls\n</span>","<span class=\"code-comment\">       * @param {Boolean} [toggle] - Whether to show the controls\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"toggleControls\"</span>, toggle =&gt; {\n","        <span class=\"code-comment\">// Don't toggle if missing UI support or if it's audio</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.supported.ui &amp;&amp; !<span class=\"code-keyword\">this</span>.isAudio) {\n","          <span class=\"code-comment\">// Get state before change</span>\n","          <span class=\"code-keyword\">const</span> isHidden = hasClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.hideControls);\n","          <span class=\"code-comment\">// Negate the argument if not undefined since adding the class to hides the controls</span>\n","          <span class=\"code-keyword\">const</span> force = <span class=\"code-keyword\">typeof</span> toggle === <span class=\"code-string\">'undefined'</span> ? <span class=\"code-literal\">undefined</span> : !toggle;\n","          <span class=\"code-comment\">// Apply and get updated state</span>\n","          <span class=\"code-keyword\">const</span> hiding = toggleClass(<span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.classNames.hideControls, force);\n","\n","          <span class=\"code-comment\">// Close menu</span>\n","          <span class=\"code-keyword\">if</span> (hiding &amp;&amp; is.array(<span class=\"code-keyword\">this</span>.config.controls) &amp;&amp; <span class=\"code-keyword\">this</span>.config.controls.includes(<span class=\"code-string\">'settings'</span>) &amp;&amp; !is.empty(<span class=\"code-keyword\">this</span>.config.settings)) {\n","            controls.toggleMenu.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">false</span>);\n","          }\n","\n","          <span class=\"code-comment\">// Trigger event on change</span>\n","          <span class=\"code-keyword\">if</span> (hiding !== isHidden) {\n","            <span class=\"code-keyword\">const</span> eventName = hiding ? <span class=\"code-string\">'controlshidden'</span> : <span class=\"code-string\">'controlsshown'</span>;\n","            triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.media, eventName);\n","          }\n","          <span class=\"code-keyword\">return</span> !hiding;\n","        }\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">false</span>;\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Add event listeners\n</span>","<span class=\"code-comment\">       * @param {String} event - Event type\n</span>","<span class=\"code-comment\">       * @param {Function} callback - Callback for when event occurs\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"on\"</span>, (event, callback) =&gt; {\n","        on.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.container, event, callback);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Add event listeners once\n</span>","<span class=\"code-comment\">       * @param {String} event - Event type\n</span>","<span class=\"code-comment\">       * @param {Function} callback - Callback for when event occurs\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"once\"</span>, (event, callback) =&gt; {\n","        once.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.container, event, callback);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Remove event listeners\n</span>","<span class=\"code-comment\">       * @param {String} event - Event type\n</span>","<span class=\"code-comment\">       * @param {Function} callback - Callback for when event occurs\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"off\"</span>, (event, callback) =&gt; {\n","        off(<span class=\"code-keyword\">this</span>.elements.container, event, callback);\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Destroy an instance\n</span>","<span class=\"code-comment\">       * Event listeners are removed when elements are removed\n</span>","<span class=\"code-comment\">       * http://stackoverflow.com/questions/12528049/if-a-dom-element-is-removed-are-its-listeners-also-removed-from-memory\n</span>","<span class=\"code-comment\">       * @param {Function} callback - Callback for when destroy is complete\n</span>","<span class=\"code-comment\">       * @param {Boolean} soft - Whether it's a soft destroy (for source changes etc)\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"destroy\"</span>, (callback, soft = <span class=\"code-literal\">false</span>) =&gt; {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.ready) {\n","          <span class=\"code-keyword\">return</span>;\n","        }\n","        <span class=\"code-keyword\">const</span> done = <span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","          <span class=\"code-comment\">// Reset overflow (incase destroyed while in fullscreen)</span>\n","          <span class=\"code-built_in\">document</span>.body.style.overflow = <span class=\"code-string\">''</span>;\n","\n","          <span class=\"code-comment\">// GC for embed</span>\n","          <span class=\"code-keyword\">this</span>.embed = <span class=\"code-literal\">null</span>;\n","\n","          <span class=\"code-comment\">// If it's a soft destroy, make minimal changes</span>\n","          <span class=\"code-keyword\">if</span> (soft) {\n","            <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">Object</span>.keys(<span class=\"code-keyword\">this</span>.elements).length) {\n","              <span class=\"code-comment\">// Remove elements</span>\n","              removeElement(<span class=\"code-keyword\">this</span>.elements.buttons.play);\n","              removeElement(<span class=\"code-keyword\">this</span>.elements.captions);\n","              removeElement(<span class=\"code-keyword\">this</span>.elements.controls);\n","              removeElement(<span class=\"code-keyword\">this</span>.elements.wrapper);\n","\n","              <span class=\"code-comment\">// Clear for GC</span>\n","              <span class=\"code-keyword\">this</span>.elements.buttons.play = <span class=\"code-literal\">null</span>;\n","              <span class=\"code-keyword\">this</span>.elements.captions = <span class=\"code-literal\">null</span>;\n","              <span class=\"code-keyword\">this</span>.elements.controls = <span class=\"code-literal\">null</span>;\n","              <span class=\"code-keyword\">this</span>.elements.wrapper = <span class=\"code-literal\">null</span>;\n","            }\n","\n","            <span class=\"code-comment\">// Callback</span>\n","            <span class=\"code-keyword\">if</span> (is.function(callback)) {\n","              callback();\n","            }\n","          } <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-comment\">// Unbind listeners</span>\n","            unbindListeners.call(<span class=\"code-keyword\">this</span>);\n","\n","            <span class=\"code-comment\">// Cancel current network requests</span>\n","            html5.cancelRequests.call(<span class=\"code-keyword\">this</span>);\n","\n","            <span class=\"code-comment\">// Replace the container with the original element provided</span>\n","            replaceElement(<span class=\"code-keyword\">this</span>.elements.original, <span class=\"code-keyword\">this</span>.elements.container);\n","\n","            <span class=\"code-comment\">// Event</span>\n","            triggerEvent.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.original, <span class=\"code-string\">'destroyed'</span>, <span class=\"code-literal\">true</span>);\n","\n","            <span class=\"code-comment\">// Callback</span>\n","            <span class=\"code-keyword\">if</span> (is.function(callback)) {\n","              callback.call(<span class=\"code-keyword\">this</span>.elements.original);\n","            }\n","\n","            <span class=\"code-comment\">// Reset state</span>\n","            <span class=\"code-keyword\">this</span>.ready = <span class=\"code-literal\">false</span>;\n","\n","            <span class=\"code-comment\">// Clear for garbage collection</span>\n","            setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","              <span class=\"code-keyword\">this</span>.elements = <span class=\"code-literal\">null</span>;\n","              <span class=\"code-keyword\">this</span>.media = <span class=\"code-literal\">null</span>;\n","            }, <span class=\"code-number\">200</span>);\n","          }\n","        };\n","\n","        <span class=\"code-comment\">// Stop playback</span>\n","        <span class=\"code-keyword\">this</span>.stop();\n","\n","        <span class=\"code-comment\">// Clear timeouts</span>\n","        clearTimeout(<span class=\"code-keyword\">this</span>.timers.loading);\n","        clearTimeout(<span class=\"code-keyword\">this</span>.timers.controls);\n","        clearTimeout(<span class=\"code-keyword\">this</span>.timers.resized);\n","\n","        <span class=\"code-comment\">// Provider specific stuff</span>\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5) {\n","          <span class=\"code-comment\">// Restore native video controls</span>\n","          ui.toggleNativeControls.call(<span class=\"code-keyword\">this</span>, <span class=\"code-literal\">true</span>);\n","\n","          <span class=\"code-comment\">// Clean up</span>\n","          done();\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isYouTube) {\n","          <span class=\"code-comment\">// Clear timers</span>\n","          clearInterval(<span class=\"code-keyword\">this</span>.timers.buffering);\n","          clearInterval(<span class=\"code-keyword\">this</span>.timers.playing);\n","\n","          <span class=\"code-comment\">// Destroy YouTube API</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.embed !== <span class=\"code-literal\">null</span> &amp;&amp; is.function(<span class=\"code-keyword\">this</span>.embed.destroy)) {\n","            <span class=\"code-keyword\">this</span>.embed.destroy();\n","          }\n","\n","          <span class=\"code-comment\">// Clean up</span>\n","          done();\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo) {\n","          <span class=\"code-comment\">// Destroy Vimeo API</span>\n","          <span class=\"code-comment\">// then clean up (wait, to prevent postmessage errors)</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.embed !== <span class=\"code-literal\">null</span>) {\n","            <span class=\"code-keyword\">this</span>.embed.unload().then(done);\n","          }\n","\n","          <span class=\"code-comment\">// Vimeo does not always return</span>\n","          setTimeout(done, <span class=\"code-number\">200</span>);\n","        }\n","      });\n","      <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">       * Check for support for a mime type (HTML5 only)\n</span>","<span class=\"code-comment\">       * @param {String} type - Mime type\n</span>","<span class=\"code-comment\">       */</span>\n","      _defineProperty$<span class=\"code-number\">1</span>(<span class=\"code-keyword\">this</span>, <span class=\"code-string\">\"supports\"</span>, type =&gt; support.mime.call(<span class=\"code-keyword\">this</span>, type));\n","      <span class=\"code-keyword\">this</span>.timers = {};\n","\n","      <span class=\"code-comment\">// State</span>\n","      <span class=\"code-keyword\">this</span>.ready = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.loading = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.failed = <span class=\"code-literal\">false</span>;\n","\n","      <span class=\"code-comment\">// Touch device</span>\n","      <span class=\"code-keyword\">this</span>.touch = support.touch;\n","\n","      <span class=\"code-comment\">// Set the media element</span>\n","      <span class=\"code-keyword\">this</span>.media = target;\n","\n","      <span class=\"code-comment\">// String selector passed</span>\n","      <span class=\"code-keyword\">if</span> (is.string(<span class=\"code-keyword\">this</span>.media)) {\n","        <span class=\"code-keyword\">this</span>.media = <span class=\"code-built_in\">document</span>.querySelectorAll(<span class=\"code-keyword\">this</span>.media);\n","      }\n","\n","      <span class=\"code-comment\">// jQuery, NodeList or Array passed, use first element</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-built_in\">window</span>.jQuery &amp;&amp; <span class=\"code-keyword\">this</span>.media <span class=\"code-keyword\">instanceof</span> jQuery || is.nodeList(<span class=\"code-keyword\">this</span>.media) || is.array(<span class=\"code-keyword\">this</span>.media)) {\n","        <span class=\"code-comment\">// eslint-disable-next-line</span>\n","        <span class=\"code-keyword\">this</span>.media = <span class=\"code-keyword\">this</span>.media[<span class=\"code-number\">0</span>];\n","      }\n","\n","      <span class=\"code-comment\">// Set config</span>\n","      <span class=\"code-keyword\">this</span>.config = extend({}, defaults, Plyr.defaults, options || {}, (<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-keyword\">try</span> {\n","          <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">JSON</span>.parse(<span class=\"code-keyword\">this</span>.media.getAttribute(<span class=\"code-string\">'data-plyr-config'</span>));\n","        } <span class=\"code-keyword\">catch</span> (_) {\n","          <span class=\"code-keyword\">return</span> {};\n","        }\n","      })());\n","\n","      <span class=\"code-comment\">// Elements cache</span>\n","      <span class=\"code-keyword\">this</span>.elements = {\n","        container: <span class=\"code-literal\">null</span>,\n","        fullscreen: <span class=\"code-literal\">null</span>,\n","        captions: <span class=\"code-literal\">null</span>,\n","        buttons: {},\n","        display: {},\n","        progress: {},\n","        inputs: {},\n","        settings: {\n","          popup: <span class=\"code-literal\">null</span>,\n","          menu: <span class=\"code-literal\">null</span>,\n","          panels: {},\n","          buttons: {}\n","        }\n","      };\n","\n","      <span class=\"code-comment\">// Captions</span>\n","      <span class=\"code-keyword\">this</span>.captions = {\n","        active: <span class=\"code-literal\">null</span>,\n","        currentTrack: <span class=\"code-number\">-1</span>,\n","        meta: <span class=\"code-keyword\">new</span> <span class=\"code-built_in\">WeakMap</span>()\n","      };\n","\n","      <span class=\"code-comment\">// Fullscreen</span>\n","      <span class=\"code-keyword\">this</span>.fullscreen = {\n","        active: <span class=\"code-literal\">false</span>\n","      };\n","\n","      <span class=\"code-comment\">// Options</span>\n","      <span class=\"code-keyword\">this</span>.options = {\n","        speed: [],\n","        quality: []\n","      };\n","\n","      <span class=\"code-comment\">// Debugging</span>\n","      <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> move to globals</span>\n","      <span class=\"code-keyword\">this</span>.debug = <span class=\"code-keyword\">new</span> Console(<span class=\"code-keyword\">this</span>.config.debug);\n","\n","      <span class=\"code-comment\">// Log config options and support</span>\n","      <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">'Config'</span>, <span class=\"code-keyword\">this</span>.config);\n","      <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">'Support'</span>, support);\n","\n","      <span class=\"code-comment\">// We need an element to setup</span>\n","      <span class=\"code-keyword\">if</span> (is.nullOrUndefined(<span class=\"code-keyword\">this</span>.media) || !is.element(<span class=\"code-keyword\">this</span>.media)) {\n","        <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: no suitable element passed'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Bail if the element is initialized</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.plyr) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Target already setup'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Bail if not enabled</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.config.enabled) {\n","        <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: disabled by config'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Bail if disabled or no basic support</span>\n","      <span class=\"code-comment\">// You may want to disable certain UAs etc</span>\n","      <span class=\"code-keyword\">if</span> (!support.check().api) {\n","        <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: no support'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Cache original element state for .destroy()</span>\n","      <span class=\"code-keyword\">const</span> clone = <span class=\"code-keyword\">this</span>.media.cloneNode(<span class=\"code-literal\">true</span>);\n","      clone.autoplay = <span class=\"code-literal\">false</span>;\n","      <span class=\"code-keyword\">this</span>.elements.original = clone;\n","\n","      <span class=\"code-comment\">// Set media type based on tag or data attribute</span>\n","      <span class=\"code-comment\">// Supported: video, audio, vimeo, youtube</span>\n","      <span class=\"code-keyword\">const</span> _type = <span class=\"code-keyword\">this</span>.media.tagName.toLowerCase();\n","      <span class=\"code-comment\">// Embed properties</span>\n","      <span class=\"code-keyword\">let</span> iframe = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">let</span> url = <span class=\"code-literal\">null</span>;\n","\n","      <span class=\"code-comment\">// Different setup based on type</span>\n","      <span class=\"code-keyword\">switch</span> (_type) {\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'div'</span>:\n","          <span class=\"code-comment\">// Find the frame</span>\n","          iframe = <span class=\"code-keyword\">this</span>.media.querySelector(<span class=\"code-string\">'iframe'</span>);\n","\n","          <span class=\"code-comment\">// &lt;iframe&gt; type</span>\n","          <span class=\"code-keyword\">if</span> (is.element(iframe)) {\n","            <span class=\"code-comment\">// Detect provider</span>\n","            url = parseUrl(iframe.getAttribute(<span class=\"code-string\">'src'</span>));\n","            <span class=\"code-keyword\">this</span>.provider = getProviderByUrl(url.toString());\n","\n","            <span class=\"code-comment\">// Rework elements</span>\n","            <span class=\"code-keyword\">this</span>.elements.container = <span class=\"code-keyword\">this</span>.media;\n","            <span class=\"code-keyword\">this</span>.media = iframe;\n","\n","            <span class=\"code-comment\">// Reset classname</span>\n","            <span class=\"code-keyword\">this</span>.elements.container.className = <span class=\"code-string\">''</span>;\n","\n","            <span class=\"code-comment\">// Get attributes from URL and set config</span>\n","            <span class=\"code-keyword\">if</span> (url.search.length) {\n","              <span class=\"code-keyword\">const</span> truthy = [<span class=\"code-string\">'1'</span>, <span class=\"code-string\">'true'</span>];\n","              <span class=\"code-keyword\">if</span> (truthy.includes(url.searchParams.get(<span class=\"code-string\">'autoplay'</span>))) {\n","                <span class=\"code-keyword\">this</span>.config.autoplay = <span class=\"code-literal\">true</span>;\n","              }\n","              <span class=\"code-keyword\">if</span> (truthy.includes(url.searchParams.get(<span class=\"code-string\">'loop'</span>))) {\n","                <span class=\"code-keyword\">this</span>.config.loop.active = <span class=\"code-literal\">true</span>;\n","              }\n","\n","              <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> replace fullscreen.iosNative with this playsinline config option</span>\n","              <span class=\"code-comment\">// YouTube requires the playsinline in the URL</span>\n","              <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isYouTube) {\n","                <span class=\"code-keyword\">this</span>.config.playsinline = truthy.includes(url.searchParams.get(<span class=\"code-string\">'playsinline'</span>));\n","                <span class=\"code-keyword\">this</span>.config.youtube.hl = url.searchParams.get(<span class=\"code-string\">'hl'</span>); <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Should this be setting language?</span>\n","              } <span class=\"code-keyword\">else</span> {\n","                <span class=\"code-keyword\">this</span>.config.playsinline = <span class=\"code-literal\">true</span>;\n","              }\n","            }\n","          } <span class=\"code-keyword\">else</span> {\n","            <span class=\"code-comment\">// &lt;div&gt; with attributes</span>\n","            <span class=\"code-keyword\">this</span>.provider = <span class=\"code-keyword\">this</span>.media.getAttribute(<span class=\"code-keyword\">this</span>.config.attributes.embed.provider);\n","\n","            <span class=\"code-comment\">// Remove attribute</span>\n","            <span class=\"code-keyword\">this</span>.media.removeAttribute(<span class=\"code-keyword\">this</span>.config.attributes.embed.provider);\n","          }\n","\n","          <span class=\"code-comment\">// Unsupported or missing provider</span>\n","          <span class=\"code-keyword\">if</span> (is.empty(<span class=\"code-keyword\">this</span>.provider) || !<span class=\"code-built_in\">Object</span>.values(providers).includes(<span class=\"code-keyword\">this</span>.provider)) {\n","            <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: Invalid provider'</span>);\n","            <span class=\"code-keyword\">return</span>;\n","          }\n","\n","          <span class=\"code-comment\">// Audio will come later for external providers</span>\n","          <span class=\"code-keyword\">this</span>.type = types.video;\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'video'</span>:\n","        <span class=\"code-keyword\">case</span> <span class=\"code-string\">'audio'</span>:\n","          <span class=\"code-keyword\">this</span>.type = _type;\n","          <span class=\"code-keyword\">this</span>.provider = providers.html5;\n","\n","          <span class=\"code-comment\">// Get config from attributes</span>\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'crossorigin'</span>)) {\n","            <span class=\"code-keyword\">this</span>.config.crossorigin = <span class=\"code-literal\">true</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'autoplay'</span>)) {\n","            <span class=\"code-keyword\">this</span>.config.autoplay = <span class=\"code-literal\">true</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'playsinline'</span>) || <span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'webkit-playsinline'</span>)) {\n","            <span class=\"code-keyword\">this</span>.config.playsinline = <span class=\"code-literal\">true</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'muted'</span>)) {\n","            <span class=\"code-keyword\">this</span>.config.muted = <span class=\"code-literal\">true</span>;\n","          }\n","          <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media.hasAttribute(<span class=\"code-string\">'loop'</span>)) {\n","            <span class=\"code-keyword\">this</span>.config.loop.active = <span class=\"code-literal\">true</span>;\n","          }\n","          <span class=\"code-keyword\">break</span>;\n","        <span class=\"code-keyword\">default</span>:\n","          <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: unsupported type'</span>);\n","          <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Check for support again but with type</span>\n","      <span class=\"code-keyword\">this</span>.supported = support.check(<span class=\"code-keyword\">this</span>.type, <span class=\"code-keyword\">this</span>.provider);\n","\n","      <span class=\"code-comment\">// If no support for even API, bail</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.supported.api) {\n","        <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">'Setup failed: no support'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">this</span>.eventListeners = [];\n","\n","      <span class=\"code-comment\">// Create listeners</span>\n","      <span class=\"code-keyword\">this</span>.listeners = <span class=\"code-keyword\">new</span> Listeners(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Setup local storage for user settings</span>\n","      <span class=\"code-keyword\">this</span>.storage = <span class=\"code-keyword\">new</span> Storage(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Store reference</span>\n","      <span class=\"code-keyword\">this</span>.media.plyr = <span class=\"code-keyword\">this</span>;\n","\n","      <span class=\"code-comment\">// Wrap media</span>\n","      <span class=\"code-keyword\">if</span> (!is.element(<span class=\"code-keyword\">this</span>.elements.container)) {\n","        <span class=\"code-keyword\">this</span>.elements.container = createElement(<span class=\"code-string\">'div'</span>);\n","        wrap(<span class=\"code-keyword\">this</span>.media, <span class=\"code-keyword\">this</span>.elements.container);\n","      }\n","\n","      <span class=\"code-comment\">// Migrate custom properties from media to container (so they work \uD83D\uDE09)</span>\n","      ui.migrateStyles.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Add style hook</span>\n","      ui.addStyleHook.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Setup media</span>\n","      media.setup.call(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Listen for events if debugging</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.debug) {\n","        on.call(<span class=\"code-keyword\">this</span>, <span class=\"code-keyword\">this</span>.elements.container, <span class=\"code-keyword\">this</span>.config.events.join(<span class=\"code-string\">' '</span>), event =&gt; {\n","          <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">`event: <span class=\"code-subst\">${event.type}</span>`</span>);\n","        });\n","      }\n","\n","      <span class=\"code-comment\">// Setup fullscreen</span>\n","      <span class=\"code-keyword\">this</span>.fullscreen = <span class=\"code-keyword\">new</span> Fullscreen(<span class=\"code-keyword\">this</span>);\n","\n","      <span class=\"code-comment\">// Setup interface</span>\n","      <span class=\"code-comment\">// If embed but not fully supported, build interface now to avoid flash of controls</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5 || <span class=\"code-keyword\">this</span>.isEmbed &amp;&amp; !<span class=\"code-keyword\">this</span>.supported.ui) {\n","        ui.build.call(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Container listeners</span>\n","      <span class=\"code-keyword\">this</span>.listeners.container();\n","\n","      <span class=\"code-comment\">// Global listeners</span>\n","      <span class=\"code-keyword\">this</span>.listeners.global();\n","\n","      <span class=\"code-comment\">// Setup ads if provided</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.ads.enabled) {\n","        <span class=\"code-keyword\">this</span>.ads = <span class=\"code-keyword\">new</span> Ads(<span class=\"code-keyword\">this</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Autoplay if required</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isHTML5 &amp;&amp; <span class=\"code-keyword\">this</span>.config.autoplay) {\n","        <span class=\"code-keyword\">this</span>.once(<span class=\"code-string\">'canplay'</span>, () =&gt; silencePromise(<span class=\"code-keyword\">this</span>.play()));\n","      }\n","\n","      <span class=\"code-comment\">// Seek time will be recorded (in listeners.js) so we can prevent hiding controls for a few seconds after seek</span>\n","      <span class=\"code-keyword\">this</span>.lastSeekTime = <span class=\"code-number\">0</span>;\n","\n","      <span class=\"code-comment\">// Setup preview thumbnails if enabled</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.previewThumbnails.enabled) {\n","        <span class=\"code-keyword\">this</span>.previewThumbnails = <span class=\"code-keyword\">new</span> PreviewThumbnails(<span class=\"code-keyword\">this</span>);\n","      }\n","    }\n","\n","    <span class=\"code-comment\">// ---------------------------------------</span>\n","    <span class=\"code-comment\">// API</span>\n","    <span class=\"code-comment\">// ---------------------------------------</span>\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Types and provider helpers\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> isHTML5() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.provider === providers.html5;\n","    }\n","    <span class=\"code-keyword\">get</span> isEmbed() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.isYouTube || <span class=\"code-keyword\">this</span>.isVimeo;\n","    }\n","    <span class=\"code-keyword\">get</span> isYouTube() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.provider === providers.youtube;\n","    }\n","    <span class=\"code-keyword\">get</span> isVimeo() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.provider === providers.vimeo;\n","    }\n","    <span class=\"code-keyword\">get</span> isVideo() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.type === types.video;\n","    }\n","    <span class=\"code-keyword\">get</span> isAudio() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.type === types.audio;\n","    }\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get playing state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> playing() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.ready &amp;&amp; !<span class=\"code-keyword\">this</span>.paused &amp;&amp; !<span class=\"code-keyword\">this</span>.ended);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get paused state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> paused() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.paused);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get stopped state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> stopped() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.paused &amp;&amp; <span class=\"code-keyword\">this</span>.currentTime === <span class=\"code-number\">0</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get ended state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> ended() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.ended);\n","    }\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Seek to a time\n</span>","<span class=\"code-comment\">     * @param {Number} input - where to seek to in seconds. Defaults to 0 (the start)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> currentTime(input) {\n","      <span class=\"code-comment\">// Bail if media duration isn't available yet</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.duration) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Validate input</span>\n","      <span class=\"code-keyword\">const</span> inputIsValid = is.number(input) &amp;&amp; input &gt; <span class=\"code-number\">0</span>;\n","\n","      <span class=\"code-comment\">// Set</span>\n","      <span class=\"code-keyword\">this</span>.media.currentTime = inputIsValid ? <span class=\"code-built_in\">Math</span>.min(input, <span class=\"code-keyword\">this</span>.duration) : <span class=\"code-number\">0</span>;\n","\n","      <span class=\"code-comment\">// Logging</span>\n","      <span class=\"code-keyword\">this</span>.debug.log(<span class=\"code-string\">`Seeking to <span class=\"code-subst\">${<span class=\"code-keyword\">this</span>.currentTime}</span> seconds`</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current time\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> currentTime() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Number</span>(<span class=\"code-keyword\">this</span>.media.currentTime);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get buffered\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> buffered() {\n","      <span class=\"code-keyword\">const</span> {\n","        buffered\n","      } = <span class=\"code-keyword\">this</span>.media;\n","\n","      <span class=\"code-comment\">// YouTube / Vimeo return a float between 0-1</span>\n","      <span class=\"code-keyword\">if</span> (is.number(buffered)) {\n","        <span class=\"code-keyword\">return</span> buffered;\n","      }\n","\n","      <span class=\"code-comment\">// HTML5</span>\n","      <span class=\"code-comment\">// <span class=\"code-doctag\">TODO:</span> Handle buffered chunks of the media</span>\n","      <span class=\"code-comment\">// (i.e. seek to another section buffers only that section)</span>\n","      <span class=\"code-keyword\">if</span> (buffered &amp;&amp; buffered.length &amp;&amp; <span class=\"code-keyword\">this</span>.duration &gt; <span class=\"code-number\">0</span>) {\n","        <span class=\"code-keyword\">return</span> buffered.end(<span class=\"code-number\">0</span>) / <span class=\"code-keyword\">this</span>.duration;\n","      }\n","      <span class=\"code-keyword\">return</span> <span class=\"code-number\">0</span>;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get seeking status\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> seeking() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.seeking);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the duration of the current media\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> duration() {\n","      <span class=\"code-comment\">// Faux duration set via config</span>\n","      <span class=\"code-keyword\">const</span> fauxDuration = <span class=\"code-built_in\">parseFloat</span>(<span class=\"code-keyword\">this</span>.config.duration);\n","      <span class=\"code-comment\">// Media duration can be NaN or Infinity before the media has loaded</span>\n","      <span class=\"code-keyword\">const</span> realDuration = (<span class=\"code-keyword\">this</span>.media || {}).duration;\n","      <span class=\"code-keyword\">const</span> duration = !is.number(realDuration) || realDuration === <span class=\"code-literal\">Infinity</span> ? <span class=\"code-number\">0</span> : realDuration;\n","\n","      <span class=\"code-comment\">// If config duration is funky, use regular duration</span>\n","      <span class=\"code-keyword\">return</span> fauxDuration || duration;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the player volume\n</span>","<span class=\"code-comment\">     * @param {Number} value - must be between 0 and 1. Defaults to the value from local storage and config.volume if not set in storage\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> volume(value) {\n","      <span class=\"code-keyword\">let</span> volume = value;\n","      <span class=\"code-keyword\">const</span> max = <span class=\"code-number\">1</span>;\n","      <span class=\"code-keyword\">const</span> min = <span class=\"code-number\">0</span>;\n","      <span class=\"code-keyword\">if</span> (is.string(volume)) {\n","        volume = <span class=\"code-built_in\">Number</span>(volume);\n","      }\n","\n","      <span class=\"code-comment\">// Load volume from storage if no value specified</span>\n","      <span class=\"code-keyword\">if</span> (!is.number(volume)) {\n","        volume = <span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'volume'</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Use config if all else fails</span>\n","      <span class=\"code-keyword\">if</span> (!is.number(volume)) {\n","        ({\n","          volume\n","        } = <span class=\"code-keyword\">this</span>.config);\n","      }\n","\n","      <span class=\"code-comment\">// Maximum is volumeMax</span>\n","      <span class=\"code-keyword\">if</span> (volume &gt; max) {\n","        volume = max;\n","      }\n","      <span class=\"code-comment\">// Minimum is volumeMin</span>\n","      <span class=\"code-keyword\">if</span> (volume &lt; min) {\n","        volume = min;\n","      }\n","\n","      <span class=\"code-comment\">// Update config</span>\n","      <span class=\"code-keyword\">this</span>.config.volume = volume;\n","\n","      <span class=\"code-comment\">// Set the player volume</span>\n","      <span class=\"code-keyword\">this</span>.media.volume = volume;\n","\n","      <span class=\"code-comment\">// If muted, and we're increasing volume manually, reset muted state</span>\n","      <span class=\"code-keyword\">if</span> (!is.empty(value) &amp;&amp; <span class=\"code-keyword\">this</span>.muted &amp;&amp; volume &gt; <span class=\"code-number\">0</span>) {\n","        <span class=\"code-keyword\">this</span>.muted = <span class=\"code-literal\">false</span>;\n","      }\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current player volume\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> volume() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Number</span>(<span class=\"code-keyword\">this</span>.media.volume);\n","    }\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set muted state\n</span>","<span class=\"code-comment\">     * @param {Boolean} mute\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> muted(mute) {\n","      <span class=\"code-keyword\">let</span> toggle = mute;\n","\n","      <span class=\"code-comment\">// Load muted state from storage</span>\n","      <span class=\"code-keyword\">if</span> (!is.boolean(toggle)) {\n","        toggle = <span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'muted'</span>);\n","      }\n","\n","      <span class=\"code-comment\">// Use config if all else fails</span>\n","      <span class=\"code-keyword\">if</span> (!is.boolean(toggle)) {\n","        toggle = <span class=\"code-keyword\">this</span>.config.muted;\n","      }\n","\n","      <span class=\"code-comment\">// Update config</span>\n","      <span class=\"code-keyword\">this</span>.config.muted = toggle;\n","\n","      <span class=\"code-comment\">// Set mute on the player</span>\n","      <span class=\"code-keyword\">this</span>.media.muted = toggle;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current muted state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> muted() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.muted);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Check if the media has audio\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> hasAudio() {\n","      <span class=\"code-comment\">// Assume yes for all non HTML5 (as we can't tell...)</span>\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isHTML5) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isAudio) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">true</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Get audio tracks</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.mozHasAudio) || <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.webkitAudioDecodedByteCount) || <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.audioTracks &amp;&amp; <span class=\"code-keyword\">this</span>.media.audioTracks.length);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set playback speed\n</span>","<span class=\"code-comment\">     * @param {Number} input - the speed of playback (0.5-2.0)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> speed(input) {\n","      <span class=\"code-keyword\">let</span> speed = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">if</span> (is.number(input)) {\n","        speed = input;\n","      }\n","      <span class=\"code-keyword\">if</span> (!is.number(speed)) {\n","        speed = <span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'speed'</span>);\n","      }\n","      <span class=\"code-keyword\">if</span> (!is.number(speed)) {\n","        speed = <span class=\"code-keyword\">this</span>.config.speed.selected;\n","      }\n","\n","      <span class=\"code-comment\">// Clamp to min/max</span>\n","      <span class=\"code-keyword\">const</span> {\n","        minimumSpeed: min,\n","        maximumSpeed: max\n","      } = <span class=\"code-keyword\">this</span>;\n","      speed = clamp(speed, min, max);\n","\n","      <span class=\"code-comment\">// Update config</span>\n","      <span class=\"code-keyword\">this</span>.config.speed.selected = speed;\n","\n","      <span class=\"code-comment\">// Set media speed</span>\n","      setTimeout(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {\n","        <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.media) {\n","          <span class=\"code-keyword\">this</span>.media.playbackRate = speed;\n","        }\n","      }, <span class=\"code-number\">0</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current playback speed\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> speed() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Number</span>(<span class=\"code-keyword\">this</span>.media.playbackRate);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the minimum allowed speed\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> minimumSpeed() {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isYouTube) {\n","        <span class=\"code-comment\">// https://developers.google.com/youtube/iframe_api_reference#setPlaybackRate</span>\n","        <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Math</span>.min(...this.options.speed);\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo) {\n","        <span class=\"code-comment\">// https://github.com/vimeo/player.js/#setplaybackrateplaybackrate-number-promisenumber-rangeerrorerror</span>\n","        <span class=\"code-keyword\">return</span> <span class=\"code-number\">0.5</span>;\n","      }\n","\n","      <span class=\"code-comment\">// https://stackoverflow.com/a/32320020/1191319</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-number\">0.0625</span>;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the maximum allowed speed\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> maximumSpeed() {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isYouTube) {\n","        <span class=\"code-comment\">// https://developers.google.com/youtube/iframe_api_reference#setPlaybackRate</span>\n","        <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Math</span>.max(...this.options.speed);\n","      }\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.isVimeo) {\n","        <span class=\"code-comment\">// https://github.com/vimeo/player.js/#setplaybackrateplaybackrate-number-promisenumber-rangeerrorerror</span>\n","        <span class=\"code-keyword\">return</span> <span class=\"code-number\">2</span>;\n","      }\n","\n","      <span class=\"code-comment\">// https://stackoverflow.com/a/32320020/1191319</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-number\">16</span>;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set playback quality\n</span>","<span class=\"code-comment\">     * Currently HTML5 &amp; YouTube only\n</span>","<span class=\"code-comment\">     * @param {Number} input - Quality level\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> quality(input) {\n","      <span class=\"code-keyword\">const</span> config = <span class=\"code-keyword\">this</span>.config.quality;\n","      <span class=\"code-keyword\">const</span> options = <span class=\"code-keyword\">this</span>.options.quality;\n","      <span class=\"code-keyword\">if</span> (!options.length) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">let</span> quality = [!is.empty(input) &amp;&amp; <span class=\"code-built_in\">Number</span>(input), <span class=\"code-keyword\">this</span>.storage.get(<span class=\"code-string\">'quality'</span>), config.selected, config.default].find(is.number);\n","      <span class=\"code-keyword\">let</span> updateStorage = <span class=\"code-literal\">true</span>;\n","      <span class=\"code-keyword\">if</span> (!options.includes(quality)) {\n","        <span class=\"code-keyword\">const</span> value = closest(options, quality);\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">`Unsupported quality option: <span class=\"code-subst\">${quality}</span>, using <span class=\"code-subst\">${value}</span> instead`</span>);\n","        quality = value;\n","\n","        <span class=\"code-comment\">// Don't update storage if quality is not supported</span>\n","        updateStorage = <span class=\"code-literal\">false</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Update config</span>\n","      config.selected = quality;\n","\n","      <span class=\"code-comment\">// Set quality</span>\n","      <span class=\"code-keyword\">this</span>.media.quality = quality;\n","\n","      <span class=\"code-comment\">// Save to storage</span>\n","      <span class=\"code-keyword\">if</span> (updateStorage) {\n","        <span class=\"code-keyword\">this</span>.storage.set({\n","          quality\n","        });\n","      }\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current quality level\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> quality() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.quality;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Toggle loop\n</span>","<span class=\"code-comment\">     * <span class=\"code-doctag\">TODO:</span> Finish fancy new logic. Set the indicator on load as user may pass loop as config\n</span>","<span class=\"code-comment\">     * @param {Boolean} input - Whether to loop or not\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> loop(input) {\n","      <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : <span class=\"code-keyword\">this</span>.config.loop.active;\n","      <span class=\"code-keyword\">this</span>.config.loop.active = toggle;\n","      <span class=\"code-keyword\">this</span>.media.loop = toggle;\n","\n","      <span class=\"code-comment\">// Set default to be a true toggle</span>\n","      <span class=\"code-comment\">/* const type = ['start', 'end', 'all', 'none', 'toggle'].includes(input) ? input : 'toggle';\n</span>","<span class=\"code-comment\">           switch (type) {\n</span>","<span class=\"code-comment\">              case 'start':\n</span>","<span class=\"code-comment\">                  if (this.config.loop.end &amp;&amp; this.config.loop.end &lt;= this.currentTime) {\n</span>","<span class=\"code-comment\">                      this.config.loop.end = null;\n</span>","<span class=\"code-comment\">                  }\n</span>","<span class=\"code-comment\">                  this.config.loop.start = this.currentTime;\n</span>","<span class=\"code-comment\">                  // this.config.loop.indicator.start = this.elements.display.played.value;\n</span>","<span class=\"code-comment\">                  break;\n</span>","<span class=\"code-comment\">               case 'end':\n</span>","<span class=\"code-comment\">                  if (this.config.loop.start &gt;= this.currentTime) {\n</span>","<span class=\"code-comment\">                      return this;\n</span>","<span class=\"code-comment\">                  }\n</span>","<span class=\"code-comment\">                  this.config.loop.end = this.currentTime;\n</span>","<span class=\"code-comment\">                  // this.config.loop.indicator.end = this.elements.display.played.value;\n</span>","<span class=\"code-comment\">                  break;\n</span>","<span class=\"code-comment\">               case 'all':\n</span>","<span class=\"code-comment\">                  this.config.loop.start = 0;\n</span>","<span class=\"code-comment\">                  this.config.loop.end = this.duration - 2;\n</span>","<span class=\"code-comment\">                  this.config.loop.indicator.start = 0;\n</span>","<span class=\"code-comment\">                  this.config.loop.indicator.end = 100;\n</span>","<span class=\"code-comment\">                  break;\n</span>","<span class=\"code-comment\">               case 'toggle':\n</span>","<span class=\"code-comment\">                  if (this.config.loop.active) {\n</span>","<span class=\"code-comment\">                      this.config.loop.start = 0;\n</span>","<span class=\"code-comment\">                      this.config.loop.end = null;\n</span>","<span class=\"code-comment\">                  } else {\n</span>","<span class=\"code-comment\">                      this.config.loop.start = 0;\n</span>","<span class=\"code-comment\">                      this.config.loop.end = this.duration - 2;\n</span>","<span class=\"code-comment\">                  }\n</span>","<span class=\"code-comment\">                  break;\n</span>","<span class=\"code-comment\">               default:\n</span>","<span class=\"code-comment\">                  this.config.loop.start = 0;\n</span>","<span class=\"code-comment\">                  this.config.loop.end = null;\n</span>","<span class=\"code-comment\">                  break;\n</span>","<span class=\"code-comment\">          } */</span>\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current loop state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> loop() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.media.loop);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set new media source\n</span>","<span class=\"code-comment\">     * @param {Object} input - The new source object (see docs)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> source(input) {\n","      source.change.call(<span class=\"code-keyword\">this</span>, input);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get current source\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> source() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.currentSrc;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get a download URL (either source or custom)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> download() {\n","      <span class=\"code-keyword\">const</span> {\n","        download\n","      } = <span class=\"code-keyword\">this</span>.config.urls;\n","      <span class=\"code-keyword\">return</span> is.url(download) ? download : <span class=\"code-keyword\">this</span>.source;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the download URL\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> download(input) {\n","      <span class=\"code-keyword\">if</span> (!is.url(input)) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">this</span>.config.urls.download = input;\n","      controls.setDownloadUrl.call(<span class=\"code-keyword\">this</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the poster image for a video\n</span>","<span class=\"code-comment\">     * @param {String} input - the URL for the new poster image\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> poster(input) {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Poster can only be set for video'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      ui.setPoster.call(<span class=\"code-keyword\">this</span>, input, <span class=\"code-literal\">false</span>).catch(<span class=\"code-function\"><span class=\"code-params\">()</span> =&gt;</span> {});\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current poster image\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> poster() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.getAttribute(<span class=\"code-string\">'poster'</span>) || <span class=\"code-keyword\">this</span>.media.getAttribute(<span class=\"code-string\">'data-poster'</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current aspect ratio in use\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> ratio() {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","      <span class=\"code-keyword\">const</span> ratio = reduceAspectRatio(getAspectRatio.call(<span class=\"code-keyword\">this</span>));\n","      <span class=\"code-keyword\">return</span> is.array(ratio) ? ratio.join(<span class=\"code-string\">':'</span>) : ratio;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set video aspect ratio\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> ratio(input) {\n","      <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.isVideo) {\n","        <span class=\"code-keyword\">this</span>.debug.warn(<span class=\"code-string\">'Aspect ratio can only be set for video'</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">if</span> (!is.string(input) || !validateAspectRatio(input)) {\n","        <span class=\"code-keyword\">this</span>.debug.error(<span class=\"code-string\">`Invalid aspect ratio specified (<span class=\"code-subst\">${input}</span>)`</span>);\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","      <span class=\"code-keyword\">this</span>.config.ratio = reduceAspectRatio(input);\n","      setAspectRatio.call(<span class=\"code-keyword\">this</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the autoplay state\n</span>","<span class=\"code-comment\">     * @param {Boolean} input - Whether to autoplay or not\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> autoplay(input) {\n","      <span class=\"code-keyword\">this</span>.config.autoplay = is.boolean(input) ? input : <span class=\"code-keyword\">this</span>.config.autoplay;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current autoplay state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> autoplay() {\n","      <span class=\"code-keyword\">return</span> <span class=\"code-built_in\">Boolean</span>(<span class=\"code-keyword\">this</span>.config.autoplay);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Toggle captions\n</span>","<span class=\"code-comment\">     * @param {Boolean} input - Whether to enable captions\n</span>","<span class=\"code-comment\">     */</span>\n","    toggleCaptions(input) {\n","      captions.toggle.call(<span class=\"code-keyword\">this</span>, input, <span class=\"code-literal\">false</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the caption track by index\n</span>","<span class=\"code-comment\">     * @param {Number} input - Caption index\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> currentTrack(input) {\n","      captions.set.call(<span class=\"code-keyword\">this</span>, input, <span class=\"code-literal\">false</span>);\n","      captions.setup.call(<span class=\"code-keyword\">this</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current caption track index (-1 if disabled)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> currentTrack() {\n","      <span class=\"code-keyword\">const</span> {\n","        toggled,\n","        currentTrack\n","      } = <span class=\"code-keyword\">this</span>.captions;\n","      <span class=\"code-keyword\">return</span> toggled ? currentTrack : <span class=\"code-number\">-1</span>;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Set the wanted language for captions\n</span>","<span class=\"code-comment\">     * Since tracks can be added later it won't update the actual caption track until there is a matching track\n</span>","<span class=\"code-comment\">     * @param {String} input - Two character ISO language code (e.g. EN, FR, PT, etc)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> language(input) {\n","      captions.setLanguage.call(<span class=\"code-keyword\">this</span>, input, <span class=\"code-literal\">false</span>);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current track's language\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> language() {\n","      <span class=\"code-keyword\">return</span> (captions.getCurrentTrack.call(<span class=\"code-keyword\">this</span>) || {}).language;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Toggle picture-in-picture playback on WebKit/MacOS\n</span>","<span class=\"code-comment\">     * <span class=\"code-doctag\">TODO:</span> update player with state, support, enabled\n</span>","<span class=\"code-comment\">     * <span class=\"code-doctag\">TODO:</span> detect outside changes\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">set</span> pip(input) {\n","      <span class=\"code-comment\">// Bail if no support</span>\n","      <span class=\"code-keyword\">if</span> (!support.pip) {\n","        <span class=\"code-keyword\">return</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Toggle based on current state if not passed</span>\n","      <span class=\"code-keyword\">const</span> toggle = is.boolean(input) ? input : !<span class=\"code-keyword\">this</span>.pip;\n","\n","      <span class=\"code-comment\">// Toggle based on current state</span>\n","      <span class=\"code-comment\">// Safari</span>\n","      <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-keyword\">this</span>.media.webkitSetPresentationMode)) {\n","        <span class=\"code-keyword\">this</span>.media.webkitSetPresentationMode(toggle ? pip.active : pip.inactive);\n","      }\n","\n","      <span class=\"code-comment\">// Chrome</span>\n","      <span class=\"code-keyword\">if</span> (is.function(<span class=\"code-keyword\">this</span>.media.requestPictureInPicture)) {\n","        <span class=\"code-keyword\">if</span> (!<span class=\"code-keyword\">this</span>.pip &amp;&amp; toggle) {\n","          <span class=\"code-keyword\">this</span>.media.requestPictureInPicture();\n","        } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.pip &amp;&amp; !toggle) {\n","          <span class=\"code-built_in\">document</span>.exitPictureInPicture();\n","        }\n","      }\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Get the current picture-in-picture state\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">get</span> pip() {\n","      <span class=\"code-keyword\">if</span> (!support.pip) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","\n","      <span class=\"code-comment\">// Safari</span>\n","      <span class=\"code-keyword\">if</span> (!is.empty(<span class=\"code-keyword\">this</span>.media.webkitPresentationMode)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media.webkitPresentationMode === pip.active;\n","      }\n","\n","      <span class=\"code-comment\">// Chrome</span>\n","      <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.media === <span class=\"code-built_in\">document</span>.pictureInPictureElement;\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Sets the preview thumbnails for the current source\n</span>","<span class=\"code-comment\">     */</span>\n","    setPreviewThumbnails(thumbnailSource) {\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.previewThumbnails &amp;&amp; <span class=\"code-keyword\">this</span>.previewThumbnails.loaded) {\n","        <span class=\"code-keyword\">this</span>.previewThumbnails.destroy();\n","        <span class=\"code-keyword\">this</span>.previewThumbnails = <span class=\"code-literal\">null</span>;\n","      }\n","      <span class=\"code-built_in\">Object</span>.assign(<span class=\"code-keyword\">this</span>.config.previewThumbnails, thumbnailSource);\n","\n","      <span class=\"code-comment\">// Create new instance if it is still enabled</span>\n","      <span class=\"code-keyword\">if</span> (<span class=\"code-keyword\">this</span>.config.previewThumbnails.enabled) {\n","        <span class=\"code-keyword\">this</span>.previewThumbnails = <span class=\"code-keyword\">new</span> PreviewThumbnails(<span class=\"code-keyword\">this</span>);\n","      }\n","    }\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Check for support\n</span>","<span class=\"code-comment\">     * @param {String} type - Player type (audio/video)\n</span>","<span class=\"code-comment\">     * @param {String} provider - Provider (html5/youtube/vimeo)\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">static</span> supported(type, provider) {\n","      <span class=\"code-keyword\">return</span> support.check(type, provider);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Load an SVG sprite into the page\n</span>","<span class=\"code-comment\">     * @param {String} url - URL for the SVG sprite\n</span>","<span class=\"code-comment\">     * @param {String} [id] - Unique ID\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">static</span> loadSprite(url, id) {\n","      <span class=\"code-keyword\">return</span> loadSprite(url, id);\n","    }\n","\n","    <span class=\"code-comment\">/**\n</span>","<span class=\"code-comment\">     * Setup multiple instances\n</span>","<span class=\"code-comment\">     * @param {*} selector\n</span>","<span class=\"code-comment\">     * @param {Object} options\n</span>","<span class=\"code-comment\">     */</span>\n","    <span class=\"code-keyword\">static</span> setup(selector, options = {}) {\n","      <span class=\"code-keyword\">let</span> targets = <span class=\"code-literal\">null</span>;\n","      <span class=\"code-keyword\">if</span> (is.string(selector)) {\n","        targets = <span class=\"code-built_in\">Array</span>.from(<span class=\"code-built_in\">document</span>.querySelectorAll(selector));\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.nodeList(selector)) {\n","        targets = <span class=\"code-built_in\">Array</span>.from(selector);\n","      } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (is.array(selector)) {\n","        targets = selector.filter(is.element);\n","      }\n","      <span class=\"code-keyword\">if</span> (is.empty(targets)) {\n","        <span class=\"code-keyword\">return</span> <span class=\"code-literal\">null</span>;\n","      }\n","      <span class=\"code-keyword\">return</span> targets.map(<span class=\"code-function\"><span class=\"code-params\">t</span> =&gt;</span> <span class=\"code-keyword\">new</span> Plyr(t, options));\n","    }\n","  }\n","  Plyr.defaults = cloneDeep(defaults);\n","\n","  <span class=\"code-keyword\">return</span> Plyr;\n","\n","}));\n","<span class=\"code-comment\">//# sourceMappingURL=plyr.js.map</span>\n",""]}}}</script></head><body><div id="root"><style data-emotion-css="gtfibm">html{box-sizing:border-box;}*,*:before,*:after{box-sizing:inherit;}html,body,#root{height:100%;margin:0;}body{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;font-size:16px;line-height:1.5;overflow-wrap:break-word;background:white;color:black;}code{font-family:Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace;}th,td{padding:0;}select{font-size:inherit;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><style data-emotion-css="1r6h1r6">.code-listing{background:#fbfdff;color:#383a42;}.code-comment,.code-quote{color:#a0a1a7;font-style:italic;}.code-doctag,.code-keyword,.code-link,.code-formula{color:#a626a4;}.code-section,.code-name,.code-selector-tag,.code-deletion,.code-subst{color:#e45649;}.code-literal{color:#0184bb;}.code-string,.code-regexp,.code-addition,.code-attribute,.code-meta-string{color:#50a14f;}.code-built_in,.code-class .code-title{color:#c18401;}.code-attr,.code-variable,.code-template-variable,.code-type,.code-selector-class,.code-selector-attr,.code-selector-pseudo,.code-number{color:#986801;}.code-symbol,.code-bullet,.code-meta,.code-selector-id,.code-title{color:#4078f2;}.code-emphasis{font-style:italic;}.code-strong{font-weight:bold;}</style><style data-emotion-css="1c3h18e">.css-1c3h18e{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;}</style><div class="css-1c3h18e"><style data-emotion-css="1cfuj1t">.css-1cfuj1t{max-width:940px;padding:0 20px;margin:0 auto;}</style><div class="css-1cfuj1t"><style data-emotion-css="i51og3">.css-i51og3{margin-top:2rem;}</style><header class="css-i51og3"><style data-emotion-css="1y7u1xh">.css-1y7u1xh{text-align:center;font-size:3rem;-webkit-letter-spacing:0.05em;-moz-letter-spacing:0.05em;-ms-letter-spacing:0.05em;letter-spacing:0.05em;}</style><h1 class="css-1y7u1xh"><style data-emotion-css="1ydg16i">.css-1ydg16i{color:#000;-webkit-text-decoration:none;text-decoration:none;}</style><a href="/" class="css-1ydg16i">UNPKG</a></h1></header></div><div class="css-1cfuj1t"><style data-emotion-css="93o42g">.css-93o42g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (max-width:700px){.css-93o42g{-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}</style><header class="css-93o42g"><style data-emotion-css="1dlpvgi">.css-1dlpvgi{font-size:1.5rem;font-weight:normal;-webkit-flex:1;-ms-flex:1;flex:1;word-break:break-all;}</style><h1 class="css-1dlpvgi"><nav><style data-emotion-css="xt128v">.css-xt128v{color:#0076ff;-webkit-text-decoration:none;text-decoration:none;}.css-xt128v:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="/browse/plyr@3.7.8/" class="css-xt128v">plyr</a><style data-emotion-css="lllnmq">.css-lllnmq{padding-left:5px;padding-right:5px;}</style><span class="css-lllnmq">/</span><a href="/browse/plyr@3.7.8/dist/" class="css-xt128v">dist</a><span class="css-lllnmq">/</span><strong>plyr.js</strong></nav></h1><style data-emotion-css="1nr3dab">.css-1nr3dab{margin-left:20px;}@media (max-width:700px){.css-1nr3dab{margin-left:0;margin-bottom:0;}}</style><p class="css-1nr3dab"><label>Version:<!-- --> <style data-emotion-css="un3bt6">.css-un3bt6{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;padding:4px 24px 4px 8px;font-weight:600;font-size:0.9em;color:#24292e;border:1px solid rgba(27,31,35,.2);border-radius:3px;background-color:#eff3f6;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAKCAYAAAC9vt6cAAAAAXNSR0IArs4c6QAAARFJREFUKBVjZAACNS39RhBNKrh17WI9o4quoT3Dn78HSNUMUs/CzOTI/O7Vi4dCYpJ3/jP+92BkYGAlyiBGhm8MjIxJt65e3MQM0vDu9YvLYmISILYZELOBxHABRkaGr0yMzF23r12YDFIDNgDEePv65SEhEXENBkYGFSAXuyGMjF8Z/jOsvX3tYiFIDwgwQSgIaaijnvj/P8M5IO8HsjiY/f//D4b//88A1SQhywG9jQr09PS4v/1mPAeUUPzP8B8cJowMjL+Bqu6xMQmaXL164AuyDgwDQJLa2qYSP//9vARkCoMVMzK8YeVkNbh+9uxzMB+JwGoASF5Vx0jz/98/18BqmZi171w9D2EjaaYKEwAEK00XQLdJuwAAAABJRU5ErkJggg==);background-position:right 8px center;background-repeat:no-repeat;background-size:auto 25%;}.css-un3bt6:hover{background-color:#e6ebf1;border-color:rgba(27,31,35,.35);}.css-un3bt6:active{background-color:#e9ecef;border-color:rgba(27,31,35,.35);box-shadow:inset 0 0.15em 0.3em rgba(27,31,35,.15);}</style><select name="version" class="css-un3bt6"><option value="1.5.9">1.5.9</option><option value="1.5.10">1.5.10</option><option value="1.5.11">1.5.11</option><option value="1.5.12">1.5.12</option><option value="1.5.13">1.5.13</option><option value="1.5.14">1.5.14</option><option value="1.5.16">1.5.16</option><option value="1.5.17">1.5.17</option><option value="1.5.18">1.5.18</option><option value="1.5.19">1.5.19</option><option value="1.5.20">1.5.20</option><option value="1.6.0">1.6.0</option><option value="1.6.1">1.6.1</option><option value="1.6.4">1.6.4</option><option value="1.6.5">1.6.5</option><option value="1.6.6">1.6.6</option><option value="1.6.7">1.6.7</option><option value="1.6.8">1.6.8</option><option value="1.6.9">1.6.9</option><option value="1.6.10">1.6.10</option><option value="1.6.12">1.6.12</option><option value="1.6.14">1.6.14</option><option value="1.6.15">1.6.15</option><option value="1.6.16">1.6.16</option><option value="1.6.17">1.6.17</option><option value="1.6.18">1.6.18</option><option value="1.6.19">1.6.19</option><option value="1.6.20">1.6.20</option><option value="1.7.0">1.7.0</option><option value="1.8.0">1.8.0</option><option value="1.8.1">1.8.1</option><option value="1.8.2">1.8.2</option><option value="1.8.4">1.8.4</option><option value="1.8.5">1.8.5</option><option value="1.8.6">1.8.6</option><option value="1.8.7">1.8.7</option><option value="1.8.8">1.8.8</option><option value="1.8.9">1.8.9</option><option value="1.8.10">1.8.10</option><option value="1.8.11">1.8.11</option><option value="1.8.12">1.8.12</option><option value="1.9.0">1.9.0</option><option value="2.0.0">2.0.0</option><option value="2.0.1">2.0.1</option><option value="2.0.3">2.0.3</option><option value="2.0.4">2.0.4</option><option value="2.0.5">2.0.5</option><option value="2.0.6">2.0.6</option><option value="2.0.7">2.0.7</option><option value="2.0.8">2.0.8</option><option value="2.0.9">2.0.9</option><option value="2.0.10">2.0.10</option><option value="2.0.11">2.0.11</option><option value="2.0.12">2.0.12</option><option value="2.0.13">2.0.13</option><option value="2.0.14">2.0.14</option><option value="2.0.15">2.0.15</option><option value="2.0.16">2.0.16</option><option value="2.0.17">2.0.17</option><option value="2.0.18">2.0.18</option><option value="3.0.0-beta.6">3.0.0-beta.6</option><option value="3.0.0-beta.7">3.0.0-beta.7</option><option value="3.0.0-beta.8">3.0.0-beta.8</option><option value="3.0.0-beta.9">3.0.0-beta.9</option><option value="3.0.0-beta.10">3.0.0-beta.10</option><option value="3.0.0-beta.11">3.0.0-beta.11</option><option value="3.0.0-beta.12">3.0.0-beta.12</option><option value="3.0.0-beta.13">3.0.0-beta.13</option><option value="3.0.0-beta.14">3.0.0-beta.14</option><option value="3.0.0-beta.15">3.0.0-beta.15</option><option value="3.0.0-beta.16">3.0.0-beta.16</option><option value="3.0.0-beta.17">3.0.0-beta.17</option><option value="3.0.0-beta.18">3.0.0-beta.18</option><option value="3.0.0-beta.19">3.0.0-beta.19</option><option value="3.0.0-beta.20">3.0.0-beta.20</option><option value="3.0.0">3.0.0</option><option value="3.0.1">3.0.1</option><option value="3.0.2">3.0.2</option><option value="3.0.3">3.0.3</option><option value="3.0.4">3.0.4</option><option value="3.0.5">3.0.5</option><option value="3.0.6">3.0.6</option><option value="3.0.7">3.0.7</option><option value="3.0.8">3.0.8</option><option value="3.0.9">3.0.9</option><option value="3.0.10">3.0.10</option><option value="3.0.11">3.0.11</option><option value="3.1.0-beta.1">3.1.0-beta.1</option><option value="3.1.0-beta.2">3.1.0-beta.2</option><option value="3.1.0">3.1.0</option><option value="3.2.0">3.2.0</option><option value="3.2.1">3.2.1</option><option value="3.2.2">3.2.2</option><option value="3.2.3">3.2.3</option><option value="3.2.4">3.2.4</option><option value="3.3.3">3.3.3</option><option value="3.3.5">3.3.5</option><option value="3.3.6">3.3.6</option><option value="3.3.7">3.3.7</option><option value="3.3.8">3.3.8</option><option value="3.3.9">3.3.9</option><option value="3.3.10">3.3.10</option><option value="3.3.11">3.3.11</option><option value="3.3.12">3.3.12</option><option value="3.3.13">3.3.13</option><option value="3.3.14">3.3.14</option><option value="3.3.15">3.3.15</option><option value="3.3.16">3.3.16</option><option value="3.3.17">3.3.17</option><option value="3.3.18">3.3.18</option><option value="3.3.19">3.3.19</option><option value="3.3.20">3.3.20</option><option value="3.3.21">3.3.21</option><option value="3.3.22">3.3.22</option><option value="3.3.23">3.3.23</option><option value="3.4.0-beta.1">3.4.0-beta.1</option><option value="3.4.0-beta.2">3.4.0-beta.2</option><option value="3.4.0">3.4.0</option><option value="3.4.1">3.4.1</option><option value="3.4.2">3.4.2</option><option value="3.4.3">3.4.3</option><option value="3.4.4">3.4.4</option><option value="3.4.5">3.4.5</option><option value="3.4.6">3.4.6</option><option value="3.4.7">3.4.7</option><option value="3.4.8">3.4.8</option><option value="3.5.0">3.5.0</option><option value="3.5.1">3.5.1</option><option value="3.5.2">3.5.2</option><option value="3.5.3">3.5.3</option><option value="3.5.4">3.5.4</option><option value="3.5.5">3.5.5</option><option value="3.5.6">3.5.6</option><option value="3.5.7-beta.0">3.5.7-beta.0</option><option value="3.5.7">3.5.7</option><option value="3.5.8">3.5.8</option><option value="3.5.9">3.5.9</option><option value="3.5.10">3.5.10</option><option value="3.6.1">3.6.1</option><option value="3.6.2">3.6.2</option><option value="3.6.3">3.6.3</option><option value="3.6.4">3.6.4</option><option value="3.6.5">3.6.5</option><option value="3.6.6">3.6.6</option><option value="3.6.7">3.6.7</option><option value="3.6.8">3.6.8</option><option value="3.6.9">3.6.9</option><option value="3.6.10">3.6.10</option><option value="3.6.11">3.6.11</option><option value="3.6.12">3.6.12</option><option value="3.7.0">3.7.0</option><option value="3.7.1">3.7.1</option><option value="3.7.2">3.7.2</option><option value="3.7.3">3.7.3</option><option value="3.7.4">3.7.4</option><option value="3.7.5">3.7.5</option><option value="3.7.6">3.7.6</option><option value="3.7.7">3.7.7</option><option selected="" value="3.7.8">3.7.8</option></select></label></p></header></div><style data-emotion-css="107j3ms">.css-107j3ms{max-width:940px;padding:0 20px;margin:0 auto;}@media (max-width:700px){.css-107j3ms{padding:0;margin:0;}}</style><div class="css-107j3ms"><style data-emotion-css="q3frg4">.css-q3frg4{border:1px solid #dfe2e5;border-radius:3px;}@media (max-width:700px){.css-q3frg4{border-right-width:0;border-left-width:0;}}</style><div class="css-q3frg4"><style data-emotion-css="10o5omr">.css-10o5omr{padding:10px;background:#f6f8fa;color:#424242;border:1px solid #d1d5da;border-top-left-radius:3px;border-top-right-radius:3px;margin:-1px -1px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}@media (max-width:700px){.css-10o5omr{padding-right:20px;padding-left:20px;}}</style><div class="css-10o5omr"><span>299 kB</span><span>JavaScript</span><span><style data-emotion-css="18x593j">.css-18x593j{display:inline-block;margin-left:8px;padding:2px 8px;-webkit-text-decoration:none;text-decoration:none;font-weight:600;font-size:0.9rem;color:#24292e;background-color:#eff3f6;border:1px solid rgba(27,31,35,.2);border-radius:3px;}.css-18x593j:hover{background-color:#e6ebf1;border-color:rgba(27,31,35,.35);}.css-18x593j:active{background-color:#e9ecef;border-color:rgba(27,31,35,.35);box-shadow:inset 0 0.15em 0.3em rgba(27,31,35,.15);}</style><a href="/plyr@3.7.8/dist/plyr.js" class="css-18x593j">View Raw</a></span></div><style data-emotion-css="1i31ihw">.css-1i31ihw{overflow-x:auto;overflow-y:hidden;padding-top:5px;padding-bottom:5px;}</style><div class="code-listing css-1i31ihw"><style data-emotion-css="173nir8">.css-173nir8{border:none;border-collapse:collapse;border-spacing:0;}</style><table class="css-173nir8"><tbody><tr><style data-emotion-css="a4x74f">.css-a4x74f{padding-left:10px;padding-right:10px;color:rgba(27,31,35,.3);text-align:right;vertical-align:top;width:1%;min-width:50px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}</style><td id="L1" class="css-a4x74f"><span>1</span></td><style data-emotion-css="1dcdqdg">.css-1dcdqdg{padding-left:10px;padding-right:10px;color:#24292e;white-space:pre;}</style><td id="LC1" class="css-1dcdqdg"><code><span class="code-keyword">typeof</span> navigator === <span class="code-string">"object"</span> &amp;&amp; (<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">global, factory</span>) </span>{
</code></td></tr><tr><td id="L2" class="css-a4x74f"><span>2</span></td><td id="LC2" class="css-1dcdqdg"><code>  <span class="code-keyword">typeof</span> exports === <span class="code-string">'object'</span> &amp;&amp; <span class="code-keyword">typeof</span> <span class="code-built_in">module</span> !== <span class="code-string">'undefined'</span> ? <span class="code-built_in">module</span>.exports = factory() :
</code></td></tr><tr><td id="L3" class="css-a4x74f"><span>3</span></td><td id="LC3" class="css-1dcdqdg"><code>  <span class="code-keyword">typeof</span> define === <span class="code-string">'function'</span> &amp;&amp; define.amd ? define(<span class="code-string">'Plyr'</span>, factory) :
</code></td></tr><tr><td id="L4" class="css-a4x74f"><span>4</span></td><td id="LC4" class="css-1dcdqdg"><code>  (global = <span class="code-keyword">typeof</span> globalThis !== <span class="code-string">'undefined'</span> ? globalThis : global || self, global.Plyr = factory());
</code></td></tr><tr><td id="L5" class="css-a4x74f"><span>5</span></td><td id="LC5" class="css-1dcdqdg"><code>})(<span class="code-keyword">this</span>, (<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{ <span class="code-string">'use strict'</span>;
</code></td></tr><tr><td id="L6" class="css-a4x74f"><span>6</span></td><td id="LC6" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7" class="css-a4x74f"><span>7</span></td><td id="LC7" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_defineProperty$1</span>(<span class="code-params">obj, key, value</span>) </span>{
</code></td></tr><tr><td id="L8" class="css-a4x74f"><span>8</span></td><td id="LC8" class="css-1dcdqdg"><code>    key = _toPropertyKey(key);
</code></td></tr><tr><td id="L9" class="css-a4x74f"><span>9</span></td><td id="LC9" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (key <span class="code-keyword">in</span> obj) {
</code></td></tr><tr><td id="L10" class="css-a4x74f"><span>10</span></td><td id="LC10" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(obj, key, {
</code></td></tr><tr><td id="L11" class="css-a4x74f"><span>11</span></td><td id="LC11" class="css-1dcdqdg"><code>        value: value,
</code></td></tr><tr><td id="L12" class="css-a4x74f"><span>12</span></td><td id="LC12" class="css-1dcdqdg"><code>        enumerable: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L13" class="css-a4x74f"><span>13</span></td><td id="LC13" class="css-1dcdqdg"><code>        configurable: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L14" class="css-a4x74f"><span>14</span></td><td id="LC14" class="css-1dcdqdg"><code>        writable: <span class="code-literal">true</span>
</code></td></tr><tr><td id="L15" class="css-a4x74f"><span>15</span></td><td id="LC15" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L16" class="css-a4x74f"><span>16</span></td><td id="LC16" class="css-1dcdqdg"><code>    } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L17" class="css-a4x74f"><span>17</span></td><td id="LC17" class="css-1dcdqdg"><code>      obj[key] = value;
</code></td></tr><tr><td id="L18" class="css-a4x74f"><span>18</span></td><td id="LC18" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L19" class="css-a4x74f"><span>19</span></td><td id="LC19" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> obj;
</code></td></tr><tr><td id="L20" class="css-a4x74f"><span>20</span></td><td id="LC20" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L21" class="css-a4x74f"><span>21</span></td><td id="LC21" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_toPrimitive</span>(<span class="code-params">input, hint</span>) </span>{
</code></td></tr><tr><td id="L22" class="css-a4x74f"><span>22</span></td><td id="LC22" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-keyword">typeof</span> input !== <span class="code-string">"object"</span> || input === <span class="code-literal">null</span>) <span class="code-keyword">return</span> input;
</code></td></tr><tr><td id="L23" class="css-a4x74f"><span>23</span></td><td id="LC23" class="css-1dcdqdg"><code>    <span class="code-keyword">var</span> prim = input[<span class="code-built_in">Symbol</span>.toPrimitive];
</code></td></tr><tr><td id="L24" class="css-a4x74f"><span>24</span></td><td id="LC24" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (prim !== <span class="code-literal">undefined</span>) {
</code></td></tr><tr><td id="L25" class="css-a4x74f"><span>25</span></td><td id="LC25" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> res = prim.call(input, hint || <span class="code-string">"default"</span>);
</code></td></tr><tr><td id="L26" class="css-a4x74f"><span>26</span></td><td id="LC26" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">typeof</span> res !== <span class="code-string">"object"</span>) <span class="code-keyword">return</span> res;
</code></td></tr><tr><td id="L27" class="css-a4x74f"><span>27</span></td><td id="LC27" class="css-1dcdqdg"><code>      <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-built_in">TypeError</span>(<span class="code-string">"@@toPrimitive must return a primitive value."</span>);
</code></td></tr><tr><td id="L28" class="css-a4x74f"><span>28</span></td><td id="LC28" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L29" class="css-a4x74f"><span>29</span></td><td id="LC29" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> (hint === <span class="code-string">"string"</span> ? <span class="code-built_in">String</span> : <span class="code-built_in">Number</span>)(input);
</code></td></tr><tr><td id="L30" class="css-a4x74f"><span>30</span></td><td id="LC30" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L31" class="css-a4x74f"><span>31</span></td><td id="LC31" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_toPropertyKey</span>(<span class="code-params">arg</span>) </span>{
</code></td></tr><tr><td id="L32" class="css-a4x74f"><span>32</span></td><td id="LC32" class="css-1dcdqdg"><code>    <span class="code-keyword">var</span> key = _toPrimitive(arg, <span class="code-string">"string"</span>);
</code></td></tr><tr><td id="L33" class="css-a4x74f"><span>33</span></td><td id="LC33" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">typeof</span> key === <span class="code-string">"symbol"</span> ? key : <span class="code-built_in">String</span>(key);
</code></td></tr><tr><td id="L34" class="css-a4x74f"><span>34</span></td><td id="LC34" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L35" class="css-a4x74f"><span>35</span></td><td id="LC35" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L36" class="css-a4x74f"><span>36</span></td><td id="LC36" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_classCallCheck</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L37" class="css-a4x74f"><span>37</span></td><td id="LC37" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!(e <span class="code-keyword">instanceof</span> t)) <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-built_in">TypeError</span>(<span class="code-string">"Cannot call a class as a function"</span>);
</code></td></tr><tr><td id="L38" class="css-a4x74f"><span>38</span></td><td id="LC38" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L39" class="css-a4x74f"><span>39</span></td><td id="LC39" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_defineProperties</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L40" class="css-a4x74f"><span>40</span></td><td id="LC40" class="css-1dcdqdg"><code>    <span class="code-keyword">for</span> (<span class="code-keyword">var</span> n = <span class="code-number">0</span>; n &lt; t.length; n++) {
</code></td></tr><tr><td id="L41" class="css-a4x74f"><span>41</span></td><td id="LC41" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> r = t[n];
</code></td></tr><tr><td id="L42" class="css-a4x74f"><span>42</span></td><td id="LC42" class="css-1dcdqdg"><code>      r.enumerable = r.enumerable || !<span class="code-number">1</span>, r.configurable = !<span class="code-number">0</span>, <span class="code-string">"value"</span> <span class="code-keyword">in</span> r &amp;&amp; (r.writable = !<span class="code-number">0</span>), <span class="code-built_in">Object</span>.defineProperty(e, r.key, r);
</code></td></tr><tr><td id="L43" class="css-a4x74f"><span>43</span></td><td id="LC43" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L44" class="css-a4x74f"><span>44</span></td><td id="LC44" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L45" class="css-a4x74f"><span>45</span></td><td id="LC45" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_createClass</span>(<span class="code-params">e, t, n</span>) </span>{
</code></td></tr><tr><td id="L46" class="css-a4x74f"><span>46</span></td><td id="LC46" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> t &amp;&amp; _defineProperties(e.prototype, t), n &amp;&amp; _defineProperties(e, n), e;
</code></td></tr><tr><td id="L47" class="css-a4x74f"><span>47</span></td><td id="LC47" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L48" class="css-a4x74f"><span>48</span></td><td id="LC48" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_defineProperty</span>(<span class="code-params">e, t, n</span>) </span>{
</code></td></tr><tr><td id="L49" class="css-a4x74f"><span>49</span></td><td id="LC49" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> t <span class="code-keyword">in</span> e ? <span class="code-built_in">Object</span>.defineProperty(e, t, {
</code></td></tr><tr><td id="L50" class="css-a4x74f"><span>50</span></td><td id="LC50" class="css-1dcdqdg"><code>      value: n,
</code></td></tr><tr><td id="L51" class="css-a4x74f"><span>51</span></td><td id="LC51" class="css-1dcdqdg"><code>      enumerable: !<span class="code-number">0</span>,
</code></td></tr><tr><td id="L52" class="css-a4x74f"><span>52</span></td><td id="LC52" class="css-1dcdqdg"><code>      configurable: !<span class="code-number">0</span>,
</code></td></tr><tr><td id="L53" class="css-a4x74f"><span>53</span></td><td id="LC53" class="css-1dcdqdg"><code>      writable: !<span class="code-number">0</span>
</code></td></tr><tr><td id="L54" class="css-a4x74f"><span>54</span></td><td id="LC54" class="css-1dcdqdg"><code>    }) : e[t] = n, e;
</code></td></tr><tr><td id="L55" class="css-a4x74f"><span>55</span></td><td id="LC55" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L56" class="css-a4x74f"><span>56</span></td><td id="LC56" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">ownKeys</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L57" class="css-a4x74f"><span>57</span></td><td id="LC57" class="css-1dcdqdg"><code>    <span class="code-keyword">var</span> n = <span class="code-built_in">Object</span>.keys(e);
</code></td></tr><tr><td id="L58" class="css-a4x74f"><span>58</span></td><td id="LC58" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.getOwnPropertySymbols) {
</code></td></tr><tr><td id="L59" class="css-a4x74f"><span>59</span></td><td id="LC59" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> r = <span class="code-built_in">Object</span>.getOwnPropertySymbols(e);
</code></td></tr><tr><td id="L60" class="css-a4x74f"><span>60</span></td><td id="LC60" class="css-1dcdqdg"><code>      t &amp;&amp; (r = r.filter(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L61" class="css-a4x74f"><span>61</span></td><td id="LC61" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-built_in">Object</span>.getOwnPropertyDescriptor(e, t).enumerable;
</code></td></tr><tr><td id="L62" class="css-a4x74f"><span>62</span></td><td id="LC62" class="css-1dcdqdg"><code>      })), n.push.apply(n, r);
</code></td></tr><tr><td id="L63" class="css-a4x74f"><span>63</span></td><td id="LC63" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L64" class="css-a4x74f"><span>64</span></td><td id="LC64" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> n;
</code></td></tr><tr><td id="L65" class="css-a4x74f"><span>65</span></td><td id="LC65" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L66" class="css-a4x74f"><span>66</span></td><td id="LC66" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">_objectSpread2</span>(<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L67" class="css-a4x74f"><span>67</span></td><td id="LC67" class="css-1dcdqdg"><code>    <span class="code-keyword">for</span> (<span class="code-keyword">var</span> t = <span class="code-number">1</span>; t &lt; <span class="code-built_in">arguments</span>.length; t++) {
</code></td></tr><tr><td id="L68" class="css-a4x74f"><span>68</span></td><td id="LC68" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> n = <span class="code-literal">null</span> != <span class="code-built_in">arguments</span>[t] ? <span class="code-built_in">arguments</span>[t] : {};
</code></td></tr><tr><td id="L69" class="css-a4x74f"><span>69</span></td><td id="LC69" class="css-1dcdqdg"><code>      t % <span class="code-number">2</span> ? ownKeys(<span class="code-built_in">Object</span>(n), !<span class="code-number">0</span>).forEach(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L70" class="css-a4x74f"><span>70</span></td><td id="LC70" class="css-1dcdqdg"><code>        _defineProperty(e, t, n[t]);
</code></td></tr><tr><td id="L71" class="css-a4x74f"><span>71</span></td><td id="LC71" class="css-1dcdqdg"><code>      }) : <span class="code-built_in">Object</span>.getOwnPropertyDescriptors ? <span class="code-built_in">Object</span>.defineProperties(e, <span class="code-built_in">Object</span>.getOwnPropertyDescriptors(n)) : ownKeys(<span class="code-built_in">Object</span>(n)).forEach(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L72" class="css-a4x74f"><span>72</span></td><td id="LC72" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.defineProperty(e, t, <span class="code-built_in">Object</span>.getOwnPropertyDescriptor(n, t));
</code></td></tr><tr><td id="L73" class="css-a4x74f"><span>73</span></td><td id="LC73" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L74" class="css-a4x74f"><span>74</span></td><td id="LC74" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L75" class="css-a4x74f"><span>75</span></td><td id="LC75" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> e;
</code></td></tr><tr><td id="L76" class="css-a4x74f"><span>76</span></td><td id="LC76" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L77" class="css-a4x74f"><span>77</span></td><td id="LC77" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> defaults$<span class="code-number">1</span> = {
</code></td></tr><tr><td id="L78" class="css-a4x74f"><span>78</span></td><td id="LC78" class="css-1dcdqdg"><code>    addCSS: !<span class="code-number">0</span>,
</code></td></tr><tr><td id="L79" class="css-a4x74f"><span>79</span></td><td id="LC79" class="css-1dcdqdg"><code>    thumbWidth: <span class="code-number">15</span>,
</code></td></tr><tr><td id="L80" class="css-a4x74f"><span>80</span></td><td id="LC80" class="css-1dcdqdg"><code>    watch: !<span class="code-number">0</span>
</code></td></tr><tr><td id="L81" class="css-a4x74f"><span>81</span></td><td id="LC81" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L82" class="css-a4x74f"><span>82</span></td><td id="LC82" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">matches$1</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L83" class="css-a4x74f"><span>83</span></td><td id="LC83" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L84" class="css-a4x74f"><span>84</span></td><td id="LC84" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Array</span>.from(<span class="code-built_in">document</span>.querySelectorAll(t)).includes(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L85" class="css-a4x74f"><span>85</span></td><td id="LC85" class="css-1dcdqdg"><code>    }.call(e, t);
</code></td></tr><tr><td id="L86" class="css-a4x74f"><span>86</span></td><td id="LC86" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L87" class="css-a4x74f"><span>87</span></td><td id="LC87" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">trigger</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L88" class="css-a4x74f"><span>88</span></td><td id="LC88" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (e &amp;&amp; t) {
</code></td></tr><tr><td id="L89" class="css-a4x74f"><span>89</span></td><td id="LC89" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> n = <span class="code-keyword">new</span> Event(t, {
</code></td></tr><tr><td id="L90" class="css-a4x74f"><span>90</span></td><td id="LC90" class="css-1dcdqdg"><code>        bubbles: !<span class="code-number">0</span>
</code></td></tr><tr><td id="L91" class="css-a4x74f"><span>91</span></td><td id="LC91" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L92" class="css-a4x74f"><span>92</span></td><td id="LC92" class="css-1dcdqdg"><code>      e.dispatchEvent(n);
</code></td></tr><tr><td id="L93" class="css-a4x74f"><span>93</span></td><td id="LC93" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L94" class="css-a4x74f"><span>94</span></td><td id="LC94" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L95" class="css-a4x74f"><span>95</span></td><td id="LC95" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> getConstructor$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L96" class="css-a4x74f"><span>96</span></td><td id="LC96" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span> != e ? e.constructor : <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L97" class="css-a4x74f"><span>97</span></td><td id="LC97" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L98" class="css-a4x74f"><span>98</span></td><td id="LC98" class="css-1dcdqdg"><code>    instanceOf$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L99" class="css-a4x74f"><span>99</span></td><td id="LC99" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> !!(e &amp;&amp; t &amp;&amp; e <span class="code-keyword">instanceof</span> t);
</code></td></tr><tr><td id="L100" class="css-a4x74f"><span>100</span></td><td id="LC100" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L101" class="css-a4x74f"><span>101</span></td><td id="LC101" class="css-1dcdqdg"><code>    isNullOrUndefined$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L102" class="css-a4x74f"><span>102</span></td><td id="LC102" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span> == e;
</code></td></tr><tr><td id="L103" class="css-a4x74f"><span>103</span></td><td id="LC103" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L104" class="css-a4x74f"><span>104</span></td><td id="LC104" class="css-1dcdqdg"><code>    isObject$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L105" class="css-a4x74f"><span>105</span></td><td id="LC105" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> getConstructor$<span class="code-number">1</span>(e) === <span class="code-built_in">Object</span>;
</code></td></tr><tr><td id="L106" class="css-a4x74f"><span>106</span></td><td id="LC106" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L107" class="css-a4x74f"><span>107</span></td><td id="LC107" class="css-1dcdqdg"><code>    isNumber$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L108" class="css-a4x74f"><span>108</span></td><td id="LC108" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> getConstructor$<span class="code-number">1</span>(e) === <span class="code-built_in">Number</span> &amp;&amp; !<span class="code-built_in">Number</span>.isNaN(e);
</code></td></tr><tr><td id="L109" class="css-a4x74f"><span>109</span></td><td id="LC109" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L110" class="css-a4x74f"><span>110</span></td><td id="LC110" class="css-1dcdqdg"><code>    isString$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L111" class="css-a4x74f"><span>111</span></td><td id="LC111" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> getConstructor$<span class="code-number">1</span>(e) === <span class="code-built_in">String</span>;
</code></td></tr><tr><td id="L112" class="css-a4x74f"><span>112</span></td><td id="LC112" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L113" class="css-a4x74f"><span>113</span></td><td id="LC113" class="css-1dcdqdg"><code>    isBoolean$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L114" class="css-a4x74f"><span>114</span></td><td id="LC114" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> getConstructor$<span class="code-number">1</span>(e) === <span class="code-built_in">Boolean</span>;
</code></td></tr><tr><td id="L115" class="css-a4x74f"><span>115</span></td><td id="LC115" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L116" class="css-a4x74f"><span>116</span></td><td id="LC116" class="css-1dcdqdg"><code>    isFunction$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L117" class="css-a4x74f"><span>117</span></td><td id="LC117" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> getConstructor$<span class="code-number">1</span>(e) === <span class="code-built_in">Function</span>;
</code></td></tr><tr><td id="L118" class="css-a4x74f"><span>118</span></td><td id="LC118" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L119" class="css-a4x74f"><span>119</span></td><td id="LC119" class="css-1dcdqdg"><code>    isArray$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L120" class="css-a4x74f"><span>120</span></td><td id="LC120" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Array</span>.isArray(e);
</code></td></tr><tr><td id="L121" class="css-a4x74f"><span>121</span></td><td id="LC121" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L122" class="css-a4x74f"><span>122</span></td><td id="LC122" class="css-1dcdqdg"><code>    isNodeList$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L123" class="css-a4x74f"><span>123</span></td><td id="LC123" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> instanceOf$<span class="code-number">1</span>(e, NodeList);
</code></td></tr><tr><td id="L124" class="css-a4x74f"><span>124</span></td><td id="LC124" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L125" class="css-a4x74f"><span>125</span></td><td id="LC125" class="css-1dcdqdg"><code>    isElement$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L126" class="css-a4x74f"><span>126</span></td><td id="LC126" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> instanceOf$<span class="code-number">1</span>(e, Element);
</code></td></tr><tr><td id="L127" class="css-a4x74f"><span>127</span></td><td id="LC127" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L128" class="css-a4x74f"><span>128</span></td><td id="LC128" class="css-1dcdqdg"><code>    isEvent$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L129" class="css-a4x74f"><span>129</span></td><td id="LC129" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> instanceOf$<span class="code-number">1</span>(e, Event);
</code></td></tr><tr><td id="L130" class="css-a4x74f"><span>130</span></td><td id="LC130" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L131" class="css-a4x74f"><span>131</span></td><td id="LC131" class="css-1dcdqdg"><code>    isEmpty$<span class="code-number">1</span> = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L132" class="css-a4x74f"><span>132</span></td><td id="LC132" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> isNullOrUndefined$<span class="code-number">1</span>(e) || (isString$<span class="code-number">1</span>(e) || isArray$<span class="code-number">1</span>(e) || isNodeList$<span class="code-number">1</span>(e)) &amp;&amp; !e.length || isObject$<span class="code-number">1</span>(e) &amp;&amp; !<span class="code-built_in">Object</span>.keys(e).length;
</code></td></tr><tr><td id="L133" class="css-a4x74f"><span>133</span></td><td id="LC133" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L134" class="css-a4x74f"><span>134</span></td><td id="LC134" class="css-1dcdqdg"><code>    is$<span class="code-number">1</span> = {
</code></td></tr><tr><td id="L135" class="css-a4x74f"><span>135</span></td><td id="LC135" class="css-1dcdqdg"><code>      nullOrUndefined: isNullOrUndefined$<span class="code-number">1</span>,
</code></td></tr><tr><td id="L136" class="css-a4x74f"><span>136</span></td><td id="LC136" class="css-1dcdqdg"><code>      object: isObject$<span class="code-number">1</span>,
</code></td></tr><tr><td id="L137" class="css-a4x74f"><span>137</span></td><td id="LC137" class="css-1dcdqdg"><code>      number: isNumber$<span class="code-number">1</span>,
</code></td></tr><tr><td id="L138" class="css-a4x74f"><span>138</span></td><td id="LC138" class="css-1dcdqdg"><code>      string: isString$<span class="code-number">1</span>,
</code></td></tr><tr><td id="L139" class="css-a4x74f"><span>139</span></td><td id="LC139" class="css-1dcdqdg"><code>      boolean: isBoolean$<span class="code-number">1</span>,
</code></td></tr><tr><td id="L140" class="css-a4x74f"><span>140</span></td><td id="LC140" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span>: <span class="code-title">isFunction$1</span>,
</span></code></td></tr><tr><td id="L141" class="css-a4x74f"><span>141</span></td><td id="LC141" class="css-1dcdqdg"><code><span class="code-function">      <span class="code-title">array</span>: <span class="code-title">isArray$1</span>,
</span></code></td></tr><tr><td id="L142" class="css-a4x74f"><span>142</span></td><td id="LC142" class="css-1dcdqdg"><code><span class="code-function">      <span class="code-title">nodeList</span>: <span class="code-title">isNodeList$1</span>,
</span></code></td></tr><tr><td id="L143" class="css-a4x74f"><span>143</span></td><td id="LC143" class="css-1dcdqdg"><code><span class="code-function">      <span class="code-title">element</span>: <span class="code-title">isElement$1</span>,
</span></code></td></tr><tr><td id="L144" class="css-a4x74f"><span>144</span></td><td id="LC144" class="css-1dcdqdg"><code><span class="code-function">      <span class="code-title">event</span>: <span class="code-title">isEvent$1</span>,
</span></code></td></tr><tr><td id="L145" class="css-a4x74f"><span>145</span></td><td id="LC145" class="css-1dcdqdg"><code><span class="code-function">      <span class="code-title">empty</span>: <span class="code-title">isEmpty$1</span>
</span></code></td></tr><tr><td id="L146" class="css-a4x74f"><span>146</span></td><td id="LC146" class="css-1dcdqdg"><code><span class="code-function">    };
</span></code></td></tr><tr><td id="L147" class="css-a4x74f"><span>147</span></td><td id="LC147" class="css-1dcdqdg"><code><span class="code-function">  <span class="code-title">function</span> <span class="code-title">getDecimalPlaces</span>(<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L148" class="css-a4x74f"><span>148</span></td><td id="LC148" class="css-1dcdqdg"><code>    <span class="code-keyword">var</span> t = <span class="code-string">""</span>.concat(e).match(<span class="code-regexp">/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/</span>);
</code></td></tr><tr><td id="L149" class="css-a4x74f"><span>149</span></td><td id="LC149" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> t ? <span class="code-built_in">Math</span>.max(<span class="code-number">0</span>, (t[<span class="code-number">1</span>] ? t[<span class="code-number">1</span>].length : <span class="code-number">0</span>) - (t[<span class="code-number">2</span>] ? +t[<span class="code-number">2</span>] : <span class="code-number">0</span>)) : <span class="code-number">0</span>;
</code></td></tr><tr><td id="L150" class="css-a4x74f"><span>150</span></td><td id="LC150" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L151" class="css-a4x74f"><span>151</span></td><td id="LC151" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">round</span>(<span class="code-params">e, t</span>) </span>{
</code></td></tr><tr><td id="L152" class="css-a4x74f"><span>152</span></td><td id="LC152" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-number">1</span> &gt; t) {
</code></td></tr><tr><td id="L153" class="css-a4x74f"><span>153</span></td><td id="LC153" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> n = getDecimalPlaces(t);
</code></td></tr><tr><td id="L154" class="css-a4x74f"><span>154</span></td><td id="LC154" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">parseFloat</span>(e.toFixed(n));
</code></td></tr><tr><td id="L155" class="css-a4x74f"><span>155</span></td><td id="LC155" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L156" class="css-a4x74f"><span>156</span></td><td id="LC156" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-built_in">Math</span>.round(e / t) * t;
</code></td></tr><tr><td id="L157" class="css-a4x74f"><span>157</span></td><td id="LC157" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L158" class="css-a4x74f"><span>158</span></td><td id="LC158" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> RangeTouch = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L159" class="css-a4x74f"><span>159</span></td><td id="LC159" class="css-1dcdqdg"><code>    <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">e</span>(<span class="code-params">t, n</span>) </span>{
</code></td></tr><tr><td id="L160" class="css-a4x74f"><span>160</span></td><td id="LC160" class="css-1dcdqdg"><code>      _classCallCheck(<span class="code-keyword">this</span>, e), is$<span class="code-number">1.</span>element(t) ? <span class="code-keyword">this</span>.element = t : is$<span class="code-number">1.</span>string(t) &amp;&amp; (<span class="code-keyword">this</span>.element = <span class="code-built_in">document</span>.querySelector(t)), is$<span class="code-number">1.</span>element(<span class="code-keyword">this</span>.element) &amp;&amp; is$<span class="code-number">1.</span>empty(<span class="code-keyword">this</span>.element.rangeTouch) &amp;&amp; (<span class="code-keyword">this</span>.config = _objectSpread2({}, defaults$<span class="code-number">1</span>, {}, n), <span class="code-keyword">this</span>.init());
</code></td></tr><tr><td id="L161" class="css-a4x74f"><span>161</span></td><td id="LC161" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L162" class="css-a4x74f"><span>162</span></td><td id="LC162" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> _createClass(e, [{
</code></td></tr><tr><td id="L163" class="css-a4x74f"><span>163</span></td><td id="LC163" class="css-1dcdqdg"><code>      key: <span class="code-string">"init"</span>,
</code></td></tr><tr><td id="L164" class="css-a4x74f"><span>164</span></td><td id="LC164" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L165" class="css-a4x74f"><span>165</span></td><td id="LC165" class="css-1dcdqdg"><code>        e.enabled &amp;&amp; (<span class="code-keyword">this</span>.config.addCSS &amp;&amp; (<span class="code-keyword">this</span>.element.style.userSelect = <span class="code-string">"none"</span>, <span class="code-keyword">this</span>.element.style.webKitUserSelect = <span class="code-string">"none"</span>, <span class="code-keyword">this</span>.element.style.touchAction = <span class="code-string">"manipulation"</span>), <span class="code-keyword">this</span>.listeners(!<span class="code-number">0</span>), <span class="code-keyword">this</span>.element.rangeTouch = <span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L166" class="css-a4x74f"><span>166</span></td><td id="LC166" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L167" class="css-a4x74f"><span>167</span></td><td id="LC167" class="css-1dcdqdg"><code>    }, {
</code></td></tr><tr><td id="L168" class="css-a4x74f"><span>168</span></td><td id="LC168" class="css-1dcdqdg"><code>      key: <span class="code-string">"destroy"</span>,
</code></td></tr><tr><td id="L169" class="css-a4x74f"><span>169</span></td><td id="LC169" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L170" class="css-a4x74f"><span>170</span></td><td id="LC170" class="css-1dcdqdg"><code>        e.enabled &amp;&amp; (<span class="code-keyword">this</span>.config.addCSS &amp;&amp; (<span class="code-keyword">this</span>.element.style.userSelect = <span class="code-string">""</span>, <span class="code-keyword">this</span>.element.style.webKitUserSelect = <span class="code-string">""</span>, <span class="code-keyword">this</span>.element.style.touchAction = <span class="code-string">""</span>), <span class="code-keyword">this</span>.listeners(!<span class="code-number">1</span>), <span class="code-keyword">this</span>.element.rangeTouch = <span class="code-literal">null</span>);
</code></td></tr><tr><td id="L171" class="css-a4x74f"><span>171</span></td><td id="LC171" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L172" class="css-a4x74f"><span>172</span></td><td id="LC172" class="css-1dcdqdg"><code>    }, {
</code></td></tr><tr><td id="L173" class="css-a4x74f"><span>173</span></td><td id="LC173" class="css-1dcdqdg"><code>      key: <span class="code-string">"listeners"</span>,
</code></td></tr><tr><td id="L174" class="css-a4x74f"><span>174</span></td><td id="LC174" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L175" class="css-a4x74f"><span>175</span></td><td id="LC175" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> t = <span class="code-keyword">this</span>,
</code></td></tr><tr><td id="L176" class="css-a4x74f"><span>176</span></td><td id="LC176" class="css-1dcdqdg"><code>          n = e ? <span class="code-string">"addEventListener"</span> : <span class="code-string">"removeEventListener"</span>;
</code></td></tr><tr><td id="L177" class="css-a4x74f"><span>177</span></td><td id="LC177" class="css-1dcdqdg"><code>        [<span class="code-string">"touchstart"</span>, <span class="code-string">"touchmove"</span>, <span class="code-string">"touchend"</span>].forEach(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L178" class="css-a4x74f"><span>178</span></td><td id="LC178" class="css-1dcdqdg"><code>          t.element[n](e, <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">e</span>) </span>{
</code></td></tr><tr><td id="L179" class="css-a4x74f"><span>179</span></td><td id="LC179" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span> t.set(e);
</code></td></tr><tr><td id="L180" class="css-a4x74f"><span>180</span></td><td id="LC180" class="css-1dcdqdg"><code>          }, !<span class="code-number">1</span>);
</code></td></tr><tr><td id="L181" class="css-a4x74f"><span>181</span></td><td id="LC181" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L182" class="css-a4x74f"><span>182</span></td><td id="LC182" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L183" class="css-a4x74f"><span>183</span></td><td id="LC183" class="css-1dcdqdg"><code>    }, {
</code></td></tr><tr><td id="L184" class="css-a4x74f"><span>184</span></td><td id="LC184" class="css-1dcdqdg"><code>      key: <span class="code-string">"get"</span>,
</code></td></tr><tr><td id="L185" class="css-a4x74f"><span>185</span></td><td id="LC185" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L186" class="css-a4x74f"><span>186</span></td><td id="LC186" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!e.enabled || !is$<span class="code-number">1.</span>event(t)) <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L187" class="css-a4x74f"><span>187</span></td><td id="LC187" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> n,
</code></td></tr><tr><td id="L188" class="css-a4x74f"><span>188</span></td><td id="LC188" class="css-1dcdqdg"><code>          r = t.target,
</code></td></tr><tr><td id="L189" class="css-a4x74f"><span>189</span></td><td id="LC189" class="css-1dcdqdg"><code>          i = t.changedTouches[<span class="code-number">0</span>],
</code></td></tr><tr><td id="L190" class="css-a4x74f"><span>190</span></td><td id="LC190" class="css-1dcdqdg"><code>          o = <span class="code-built_in">parseFloat</span>(r.getAttribute(<span class="code-string">"min"</span>)) || <span class="code-number">0</span>,
</code></td></tr><tr><td id="L191" class="css-a4x74f"><span>191</span></td><td id="LC191" class="css-1dcdqdg"><code>          s = <span class="code-built_in">parseFloat</span>(r.getAttribute(<span class="code-string">"max"</span>)) || <span class="code-number">100</span>,
</code></td></tr><tr><td id="L192" class="css-a4x74f"><span>192</span></td><td id="LC192" class="css-1dcdqdg"><code>          u = <span class="code-built_in">parseFloat</span>(r.getAttribute(<span class="code-string">"step"</span>)) || <span class="code-number">1</span>,
</code></td></tr><tr><td id="L193" class="css-a4x74f"><span>193</span></td><td id="LC193" class="css-1dcdqdg"><code>          c = r.getBoundingClientRect(),
</code></td></tr><tr><td id="L194" class="css-a4x74f"><span>194</span></td><td id="LC194" class="css-1dcdqdg"><code>          a = <span class="code-number">100</span> / c.width * (<span class="code-keyword">this</span>.config.thumbWidth / <span class="code-number">2</span>) / <span class="code-number">100</span>;
</code></td></tr><tr><td id="L195" class="css-a4x74f"><span>195</span></td><td id="LC195" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-number">0</span> &gt; (n = <span class="code-number">100</span> / c.width * (i.clientX - c.left)) ? n = <span class="code-number">0</span> : <span class="code-number">100</span> &lt; n &amp;&amp; (n = <span class="code-number">100</span>), <span class="code-number">50</span> &gt; n ? n -= (<span class="code-number">100</span> - <span class="code-number">2</span> * n) * a : <span class="code-number">50</span> &lt; n &amp;&amp; (n += <span class="code-number">2</span> * (n - <span class="code-number">50</span>) * a), o + round(n / <span class="code-number">100</span> * (s - o), u);
</code></td></tr><tr><td id="L196" class="css-a4x74f"><span>196</span></td><td id="LC196" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L197" class="css-a4x74f"><span>197</span></td><td id="LC197" class="css-1dcdqdg"><code>    }, {
</code></td></tr><tr><td id="L198" class="css-a4x74f"><span>198</span></td><td id="LC198" class="css-1dcdqdg"><code>      key: <span class="code-string">"set"</span>,
</code></td></tr><tr><td id="L199" class="css-a4x74f"><span>199</span></td><td id="LC199" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L200" class="css-a4x74f"><span>200</span></td><td id="LC200" class="css-1dcdqdg"><code>        e.enabled &amp;&amp; is$<span class="code-number">1.</span>event(t) &amp;&amp; !t.target.disabled &amp;&amp; (t.preventDefault(), t.target.value = <span class="code-keyword">this</span>.get(t), trigger(t.target, <span class="code-string">"touchend"</span> === t.type ? <span class="code-string">"change"</span> : <span class="code-string">"input"</span>));
</code></td></tr><tr><td id="L201" class="css-a4x74f"><span>201</span></td><td id="LC201" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L202" class="css-a4x74f"><span>202</span></td><td id="LC202" class="css-1dcdqdg"><code>    }], [{
</code></td></tr><tr><td id="L203" class="css-a4x74f"><span>203</span></td><td id="LC203" class="css-1dcdqdg"><code>      key: <span class="code-string">"setup"</span>,
</code></td></tr><tr><td id="L204" class="css-a4x74f"><span>204</span></td><td id="LC204" class="css-1dcdqdg"><code>      value: <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L205" class="css-a4x74f"><span>205</span></td><td id="LC205" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> n = <span class="code-number">1</span> &lt; <span class="code-built_in">arguments</span>.length &amp;&amp; <span class="code-keyword">void</span> <span class="code-number">0</span> !== <span class="code-built_in">arguments</span>[<span class="code-number">1</span>] ? <span class="code-built_in">arguments</span>[<span class="code-number">1</span>] : {},
</code></td></tr><tr><td id="L206" class="css-a4x74f"><span>206</span></td><td id="LC206" class="css-1dcdqdg"><code>          r = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L207" class="css-a4x74f"><span>207</span></td><td id="LC207" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is$<span class="code-number">1.</span>empty(t) || is$<span class="code-number">1.</span>string(t) ? r = <span class="code-built_in">Array</span>.from(<span class="code-built_in">document</span>.querySelectorAll(is$<span class="code-number">1.</span>string(t) ? t : <span class="code-string">'input[type="range"]'</span>)) : is$<span class="code-number">1.</span>element(t) ? r = [t] : is$<span class="code-number">1.</span>nodeList(t) ? r = <span class="code-built_in">Array</span>.from(t) : is$<span class="code-number">1.</span>array(t) &amp;&amp; (r = t.filter(is$<span class="code-number">1.</span>element)), is$<span class="code-number">1.</span>empty(r)) <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L208" class="css-a4x74f"><span>208</span></td><td id="LC208" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> i = _objectSpread2({}, defaults$<span class="code-number">1</span>, {}, n);
</code></td></tr><tr><td id="L209" class="css-a4x74f"><span>209</span></td><td id="LC209" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is$<span class="code-number">1.</span>string(t) &amp;&amp; i.watch) {
</code></td></tr><tr><td id="L210" class="css-a4x74f"><span>210</span></td><td id="LC210" class="css-1dcdqdg"><code>          <span class="code-keyword">var</span> o = <span class="code-keyword">new</span> MutationObserver(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">n</span>) </span>{
</code></td></tr><tr><td id="L211" class="css-a4x74f"><span>211</span></td><td id="LC211" class="css-1dcdqdg"><code>            <span class="code-built_in">Array</span>.from(n).forEach(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">n</span>) </span>{
</code></td></tr><tr><td id="L212" class="css-a4x74f"><span>212</span></td><td id="LC212" class="css-1dcdqdg"><code>              <span class="code-built_in">Array</span>.from(n.addedNodes).forEach(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">n</span>) </span>{
</code></td></tr><tr><td id="L213" class="css-a4x74f"><span>213</span></td><td id="LC213" class="css-1dcdqdg"><code>                is$<span class="code-number">1.</span>element(n) &amp;&amp; matches$<span class="code-number">1</span>(n, t) &amp;&amp; <span class="code-keyword">new</span> e(n, i);
</code></td></tr><tr><td id="L214" class="css-a4x74f"><span>214</span></td><td id="LC214" class="css-1dcdqdg"><code>              });
</code></td></tr><tr><td id="L215" class="css-a4x74f"><span>215</span></td><td id="LC215" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L216" class="css-a4x74f"><span>216</span></td><td id="LC216" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L217" class="css-a4x74f"><span>217</span></td><td id="LC217" class="css-1dcdqdg"><code>          o.observe(<span class="code-built_in">document</span>.body, {
</code></td></tr><tr><td id="L218" class="css-a4x74f"><span>218</span></td><td id="LC218" class="css-1dcdqdg"><code>            childList: !<span class="code-number">0</span>,
</code></td></tr><tr><td id="L219" class="css-a4x74f"><span>219</span></td><td id="LC219" class="css-1dcdqdg"><code>            subtree: !<span class="code-number">0</span>
</code></td></tr><tr><td id="L220" class="css-a4x74f"><span>220</span></td><td id="LC220" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L221" class="css-a4x74f"><span>221</span></td><td id="LC221" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L222" class="css-a4x74f"><span>222</span></td><td id="LC222" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> r.map(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">t</span>) </span>{
</code></td></tr><tr><td id="L223" class="css-a4x74f"><span>223</span></td><td id="LC223" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-keyword">new</span> e(t, n);
</code></td></tr><tr><td id="L224" class="css-a4x74f"><span>224</span></td><td id="LC224" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L225" class="css-a4x74f"><span>225</span></td><td id="LC225" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L226" class="css-a4x74f"><span>226</span></td><td id="LC226" class="css-1dcdqdg"><code>    }, {
</code></td></tr><tr><td id="L227" class="css-a4x74f"><span>227</span></td><td id="LC227" class="css-1dcdqdg"><code>      key: <span class="code-string">"enabled"</span>,
</code></td></tr><tr><td id="L228" class="css-a4x74f"><span>228</span></td><td id="LC228" class="css-1dcdqdg"><code>      <span class="code-keyword">get</span>: function () {
</code></td></tr><tr><td id="L229" class="css-a4x74f"><span>229</span></td><td id="LC229" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-string">"ontouchstart"</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.documentElement;
</code></td></tr><tr><td id="L230" class="css-a4x74f"><span>230</span></td><td id="LC230" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L231" class="css-a4x74f"><span>231</span></td><td id="LC231" class="css-1dcdqdg"><code>    }]), e;
</code></td></tr><tr><td id="L232" class="css-a4x74f"><span>232</span></td><td id="LC232" class="css-1dcdqdg"><code>  }();
</code></td></tr><tr><td id="L233" class="css-a4x74f"><span>233</span></td><td id="LC233" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L234" class="css-a4x74f"><span>234</span></td><td id="LC234" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L235" class="css-a4x74f"><span>235</span></td><td id="LC235" class="css-1dcdqdg"><code>  <span class="code-comment">// Type checking utils</span>
</code></td></tr><tr><td id="L236" class="css-a4x74f"><span>236</span></td><td id="LC236" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L237" class="css-a4x74f"><span>237</span></td><td id="LC237" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L238" class="css-a4x74f"><span>238</span></td><td id="LC238" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> getConstructor = <span class="code-function"><span class="code-params">input</span> =&gt;</span> input !== <span class="code-literal">null</span> &amp;&amp; <span class="code-keyword">typeof</span> input !== <span class="code-string">'undefined'</span> ? input.constructor : <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L239" class="css-a4x74f"><span>239</span></td><td id="LC239" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> instanceOf = <span class="code-function">(<span class="code-params">input, constructor</span>) =&gt;</span> <span class="code-built_in">Boolean</span>(input &amp;&amp; <span class="code-keyword">constructor</span> &amp;&amp; input instanceof <span class="code-keyword">constructor</span>);
</code></td></tr><tr><td id="L240" class="css-a4x74f"><span>240</span></td><td id="LC240" class="css-1dcdqdg"><code>  const isNullOrUndefined = input =&gt; input === null || typeof input === 'undefined';
</code></td></tr><tr><td id="L241" class="css-a4x74f"><span>241</span></td><td id="LC241" class="css-1dcdqdg"><code>  const isObject = input =&gt; getConstructor(input) === Object;
</code></td></tr><tr><td id="L242" class="css-a4x74f"><span>242</span></td><td id="LC242" class="css-1dcdqdg"><code>  const isNumber = input =&gt; getConstructor(input) === Number &amp;&amp; !Number.isNaN(input);
</code></td></tr><tr><td id="L243" class="css-a4x74f"><span>243</span></td><td id="LC243" class="css-1dcdqdg"><code>  const isString = input =&gt; getConstructor(input) === String;
</code></td></tr><tr><td id="L244" class="css-a4x74f"><span>244</span></td><td id="LC244" class="css-1dcdqdg"><code>  const isBoolean = input =&gt; getConstructor(input) === Boolean;
</code></td></tr><tr><td id="L245" class="css-a4x74f"><span>245</span></td><td id="LC245" class="css-1dcdqdg"><code>  const isFunction = input =&gt; typeof input === 'function';
</code></td></tr><tr><td id="L246" class="css-a4x74f"><span>246</span></td><td id="LC246" class="css-1dcdqdg"><code>  const isArray = input =&gt; Array.isArray(input);
</code></td></tr><tr><td id="L247" class="css-a4x74f"><span>247</span></td><td id="LC247" class="css-1dcdqdg"><code>  const isWeakMap = input =&gt; instanceOf(input, WeakMap);
</code></td></tr><tr><td id="L248" class="css-a4x74f"><span>248</span></td><td id="LC248" class="css-1dcdqdg"><code>  const isNodeList = input =&gt; instanceOf(input, NodeList);
</code></td></tr><tr><td id="L249" class="css-a4x74f"><span>249</span></td><td id="LC249" class="css-1dcdqdg"><code>  const isTextNode = input =&gt; getConstructor(input) === Text;
</code></td></tr><tr><td id="L250" class="css-a4x74f"><span>250</span></td><td id="LC250" class="css-1dcdqdg"><code>  const isEvent = input =&gt; instanceOf(input, Event);
</code></td></tr><tr><td id="L251" class="css-a4x74f"><span>251</span></td><td id="LC251" class="css-1dcdqdg"><code>  const isKeyboardEvent = input =&gt; instanceOf(input, KeyboardEvent);
</code></td></tr><tr><td id="L252" class="css-a4x74f"><span>252</span></td><td id="LC252" class="css-1dcdqdg"><code>  const isCue = input =&gt; instanceOf(input, window.TextTrackCue) || instanceOf(input, window.VTTCue);
</code></td></tr><tr><td id="L253" class="css-a4x74f"><span>253</span></td><td id="LC253" class="css-1dcdqdg"><code>  const isTrack = input =&gt; instanceOf(input, TextTrack) || !isNullOrUndefined(input) &amp;&amp; isString(input.kind);
</code></td></tr><tr><td id="L254" class="css-a4x74f"><span>254</span></td><td id="LC254" class="css-1dcdqdg"><code>  const isPromise = input =&gt; instanceOf(input, Promise) &amp;&amp; isFunction(input.then);
</code></td></tr><tr><td id="L255" class="css-a4x74f"><span>255</span></td><td id="LC255" class="css-1dcdqdg"><code>  const isElement = input =&gt; input !== null &amp;&amp; typeof input === 'object' &amp;&amp; input.nodeType === 1 &amp;&amp; typeof input.style === 'object' &amp;&amp; typeof input.ownerDocument === 'object';
</code></td></tr><tr><td id="L256" class="css-a4x74f"><span>256</span></td><td id="LC256" class="css-1dcdqdg"><code>  const isEmpty = input =&gt; isNullOrUndefined(input) || (isString(input) || isArray(input) || isNodeList(input)) &amp;&amp; !input.length || isObject(input) &amp;&amp; !Object.keys(input).length;
</code></td></tr><tr><td id="L257" class="css-a4x74f"><span>257</span></td><td id="LC257" class="css-1dcdqdg"><code>  const isUrl = input =&gt; {
</code></td></tr><tr><td id="L258" class="css-a4x74f"><span>258</span></td><td id="LC258" class="css-1dcdqdg"><code>    <span class="code-comment">// Accept a URL object</span>
</code></td></tr><tr><td id="L259" class="css-a4x74f"><span>259</span></td><td id="LC259" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (instanceOf(input, <span class="code-built_in">window</span>.URL)) {
</code></td></tr><tr><td id="L260" class="css-a4x74f"><span>260</span></td><td id="LC260" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L261" class="css-a4x74f"><span>261</span></td><td id="LC261" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L262" class="css-a4x74f"><span>262</span></td><td id="LC262" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L263" class="css-a4x74f"><span>263</span></td><td id="LC263" class="css-1dcdqdg"><code>    <span class="code-comment">// Must be string from here</span>
</code></td></tr><tr><td id="L264" class="css-a4x74f"><span>264</span></td><td id="LC264" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!isString(input)) {
</code></td></tr><tr><td id="L265" class="css-a4x74f"><span>265</span></td><td id="LC265" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L266" class="css-a4x74f"><span>266</span></td><td id="LC266" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L267" class="css-a4x74f"><span>267</span></td><td id="LC267" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L268" class="css-a4x74f"><span>268</span></td><td id="LC268" class="css-1dcdqdg"><code>    <span class="code-comment">// Add the protocol if required</span>
</code></td></tr><tr><td id="L269" class="css-a4x74f"><span>269</span></td><td id="LC269" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> string = input;
</code></td></tr><tr><td id="L270" class="css-a4x74f"><span>270</span></td><td id="LC270" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!input.startsWith(<span class="code-string">'http://'</span>) || !input.startsWith(<span class="code-string">'https://'</span>)) {
</code></td></tr><tr><td id="L271" class="css-a4x74f"><span>271</span></td><td id="LC271" class="css-1dcdqdg"><code>      string = <span class="code-string">`http://<span class="code-subst">${input}</span>`</span>;
</code></td></tr><tr><td id="L272" class="css-a4x74f"><span>272</span></td><td id="LC272" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L273" class="css-a4x74f"><span>273</span></td><td id="LC273" class="css-1dcdqdg"><code>    <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L274" class="css-a4x74f"><span>274</span></td><td id="LC274" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> !isEmpty(<span class="code-keyword">new</span> URL(string).hostname);
</code></td></tr><tr><td id="L275" class="css-a4x74f"><span>275</span></td><td id="LC275" class="css-1dcdqdg"><code>    } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L276" class="css-a4x74f"><span>276</span></td><td id="LC276" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L277" class="css-a4x74f"><span>277</span></td><td id="LC277" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L278" class="css-a4x74f"><span>278</span></td><td id="LC278" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L279" class="css-a4x74f"><span>279</span></td><td id="LC279" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> is = {
</code></td></tr><tr><td id="L280" class="css-a4x74f"><span>280</span></td><td id="LC280" class="css-1dcdqdg"><code>    nullOrUndefined: isNullOrUndefined,
</code></td></tr><tr><td id="L281" class="css-a4x74f"><span>281</span></td><td id="LC281" class="css-1dcdqdg"><code>    object: isObject,
</code></td></tr><tr><td id="L282" class="css-a4x74f"><span>282</span></td><td id="LC282" class="css-1dcdqdg"><code>    number: isNumber,
</code></td></tr><tr><td id="L283" class="css-a4x74f"><span>283</span></td><td id="LC283" class="css-1dcdqdg"><code>    string: isString,
</code></td></tr><tr><td id="L284" class="css-a4x74f"><span>284</span></td><td id="LC284" class="css-1dcdqdg"><code>    boolean: isBoolean,
</code></td></tr><tr><td id="L285" class="css-a4x74f"><span>285</span></td><td id="LC285" class="css-1dcdqdg"><code>    <span class="code-function"><span class="code-keyword">function</span>: <span class="code-title">isFunction</span>,
</span></code></td></tr><tr><td id="L286" class="css-a4x74f"><span>286</span></td><td id="LC286" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">array</span>: <span class="code-title">isArray</span>,
</span></code></td></tr><tr><td id="L287" class="css-a4x74f"><span>287</span></td><td id="LC287" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">weakMap</span>: <span class="code-title">isWeakMap</span>,
</span></code></td></tr><tr><td id="L288" class="css-a4x74f"><span>288</span></td><td id="LC288" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">nodeList</span>: <span class="code-title">isNodeList</span>,
</span></code></td></tr><tr><td id="L289" class="css-a4x74f"><span>289</span></td><td id="LC289" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">element</span>: <span class="code-title">isElement</span>,
</span></code></td></tr><tr><td id="L290" class="css-a4x74f"><span>290</span></td><td id="LC290" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">textNode</span>: <span class="code-title">isTextNode</span>,
</span></code></td></tr><tr><td id="L291" class="css-a4x74f"><span>291</span></td><td id="LC291" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">event</span>: <span class="code-title">isEvent</span>,
</span></code></td></tr><tr><td id="L292" class="css-a4x74f"><span>292</span></td><td id="LC292" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">keyboardEvent</span>: <span class="code-title">isKeyboardEvent</span>,
</span></code></td></tr><tr><td id="L293" class="css-a4x74f"><span>293</span></td><td id="LC293" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">cue</span>: <span class="code-title">isCue</span>,
</span></code></td></tr><tr><td id="L294" class="css-a4x74f"><span>294</span></td><td id="LC294" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">track</span>: <span class="code-title">isTrack</span>,
</span></code></td></tr><tr><td id="L295" class="css-a4x74f"><span>295</span></td><td id="LC295" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">promise</span>: <span class="code-title">isPromise</span>,
</span></code></td></tr><tr><td id="L296" class="css-a4x74f"><span>296</span></td><td id="LC296" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">url</span>: <span class="code-title">isUrl</span>,
</span></code></td></tr><tr><td id="L297" class="css-a4x74f"><span>297</span></td><td id="LC297" class="css-1dcdqdg"><code><span class="code-function">    <span class="code-title">empty</span>: <span class="code-title">isEmpty</span>
</span></code></td></tr><tr><td id="L298" class="css-a4x74f"><span>298</span></td><td id="LC298" class="css-1dcdqdg"><code><span class="code-function">  };
</span></code></td></tr><tr><td id="L299" class="css-a4x74f"><span>299</span></td><td id="LC299" class="css-1dcdqdg"><code><span class="code-function">
</span></code></td></tr><tr><td id="L300" class="css-a4x74f"><span>300</span></td><td id="LC300" class="css-1dcdqdg"><code><span class="code-function">  // ==========================================================================
</span></code></td></tr><tr><td id="L301" class="css-a4x74f"><span>301</span></td><td id="LC301" class="css-1dcdqdg"><code><span class="code-function">  <span class="code-title">const</span> <span class="code-title">transitionEndEvent</span> = (<span class="code-params">(</span>) =&gt; </span>{
</code></td></tr><tr><td id="L302" class="css-a4x74f"><span>302</span></td><td id="LC302" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> element = <span class="code-built_in">document</span>.createElement(<span class="code-string">'span'</span>);
</code></td></tr><tr><td id="L303" class="css-a4x74f"><span>303</span></td><td id="LC303" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> events = {
</code></td></tr><tr><td id="L304" class="css-a4x74f"><span>304</span></td><td id="LC304" class="css-1dcdqdg"><code>      WebkitTransition: <span class="code-string">'webkitTransitionEnd'</span>,
</code></td></tr><tr><td id="L305" class="css-a4x74f"><span>305</span></td><td id="LC305" class="css-1dcdqdg"><code>      MozTransition: <span class="code-string">'transitionend'</span>,
</code></td></tr><tr><td id="L306" class="css-a4x74f"><span>306</span></td><td id="LC306" class="css-1dcdqdg"><code>      OTransition: <span class="code-string">'oTransitionEnd otransitionend'</span>,
</code></td></tr><tr><td id="L307" class="css-a4x74f"><span>307</span></td><td id="LC307" class="css-1dcdqdg"><code>      transition: <span class="code-string">'transitionend'</span>
</code></td></tr><tr><td id="L308" class="css-a4x74f"><span>308</span></td><td id="LC308" class="css-1dcdqdg"><code>    };
</code></td></tr><tr><td id="L309" class="css-a4x74f"><span>309</span></td><td id="LC309" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> type = <span class="code-built_in">Object</span>.keys(events).find(<span class="code-function"><span class="code-params">event</span> =&gt;</span> element.style[event] !== <span class="code-literal">undefined</span>);
</code></td></tr><tr><td id="L310" class="css-a4x74f"><span>310</span></td><td id="LC310" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> is.string(type) ? events[type] : <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L311" class="css-a4x74f"><span>311</span></td><td id="LC311" class="css-1dcdqdg"><code>  })();
</code></td></tr><tr><td id="L312" class="css-a4x74f"><span>312</span></td><td id="LC312" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L313" class="css-a4x74f"><span>313</span></td><td id="LC313" class="css-1dcdqdg"><code>  <span class="code-comment">// Force repaint of element</span>
</code></td></tr><tr><td id="L314" class="css-a4x74f"><span>314</span></td><td id="LC314" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">repaint</span>(<span class="code-params">element, delay</span>) </span>{
</code></td></tr><tr><td id="L315" class="css-a4x74f"><span>315</span></td><td id="LC315" class="css-1dcdqdg"><code>    setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L316" class="css-a4x74f"><span>316</span></td><td id="LC316" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L317" class="css-a4x74f"><span>317</span></td><td id="LC317" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L318" class="css-a4x74f"><span>318</span></td><td id="LC318" class="css-1dcdqdg"><code>        element.hidden = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L319" class="css-a4x74f"><span>319</span></td><td id="LC319" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L320" class="css-a4x74f"><span>320</span></td><td id="LC320" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-unused-expressions</span>
</code></td></tr><tr><td id="L321" class="css-a4x74f"><span>321</span></td><td id="LC321" class="css-1dcdqdg"><code>        element.offsetHeight;
</code></td></tr><tr><td id="L322" class="css-a4x74f"><span>322</span></td><td id="LC322" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L323" class="css-a4x74f"><span>323</span></td><td id="LC323" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L324" class="css-a4x74f"><span>324</span></td><td id="LC324" class="css-1dcdqdg"><code>        element.hidden = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L325" class="css-a4x74f"><span>325</span></td><td id="LC325" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L326" class="css-a4x74f"><span>326</span></td><td id="LC326" class="css-1dcdqdg"><code>        <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L327" class="css-a4x74f"><span>327</span></td><td id="LC327" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L328" class="css-a4x74f"><span>328</span></td><td id="LC328" class="css-1dcdqdg"><code>    }, delay);
</code></td></tr><tr><td id="L329" class="css-a4x74f"><span>329</span></td><td id="LC329" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L330" class="css-a4x74f"><span>330</span></td><td id="LC330" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L331" class="css-a4x74f"><span>331</span></td><td id="LC331" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L332" class="css-a4x74f"><span>332</span></td><td id="LC332" class="css-1dcdqdg"><code>  <span class="code-comment">// Browser sniffing</span>
</code></td></tr><tr><td id="L333" class="css-a4x74f"><span>333</span></td><td id="LC333" class="css-1dcdqdg"><code>  <span class="code-comment">// Unfortunately, due to mixed support, UA sniffing is required</span>
</code></td></tr><tr><td id="L334" class="css-a4x74f"><span>334</span></td><td id="LC334" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L335" class="css-a4x74f"><span>335</span></td><td id="LC335" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L336" class="css-a4x74f"><span>336</span></td><td id="LC336" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isIE = <span class="code-built_in">Boolean</span>(<span class="code-built_in">window</span>.document.documentMode);
</code></td></tr><tr><td id="L337" class="css-a4x74f"><span>337</span></td><td id="LC337" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isEdge = <span class="code-regexp">/Edge/g</span>.test(navigator.userAgent);
</code></td></tr><tr><td id="L338" class="css-a4x74f"><span>338</span></td><td id="LC338" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isWebKit = <span class="code-string">'WebkitAppearance'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.documentElement.style &amp;&amp; !<span class="code-regexp">/Edge/g</span>.test(navigator.userAgent);
</code></td></tr><tr><td id="L339" class="css-a4x74f"><span>339</span></td><td id="LC339" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isIPhone = <span class="code-regexp">/iPhone|iPod/gi</span>.test(navigator.userAgent) &amp;&amp; navigator.maxTouchPoints &gt; <span class="code-number">1</span>;
</code></td></tr><tr><td id="L340" class="css-a4x74f"><span>340</span></td><td id="LC340" class="css-1dcdqdg"><code>  <span class="code-comment">// navigator.platform may be deprecated but this check is still required</span>
</code></td></tr><tr><td id="L341" class="css-a4x74f"><span>341</span></td><td id="LC341" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isIPadOS = navigator.platform === <span class="code-string">'MacIntel'</span> &amp;&amp; navigator.maxTouchPoints &gt; <span class="code-number">1</span>;
</code></td></tr><tr><td id="L342" class="css-a4x74f"><span>342</span></td><td id="LC342" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> isIos = <span class="code-regexp">/iPad|iPhone|iPod/gi</span>.test(navigator.userAgent) &amp;&amp; navigator.maxTouchPoints &gt; <span class="code-number">1</span>;
</code></td></tr><tr><td id="L343" class="css-a4x74f"><span>343</span></td><td id="LC343" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> browser = {
</code></td></tr><tr><td id="L344" class="css-a4x74f"><span>344</span></td><td id="LC344" class="css-1dcdqdg"><code>    isIE,
</code></td></tr><tr><td id="L345" class="css-a4x74f"><span>345</span></td><td id="LC345" class="css-1dcdqdg"><code>    isEdge,
</code></td></tr><tr><td id="L346" class="css-a4x74f"><span>346</span></td><td id="LC346" class="css-1dcdqdg"><code>    isWebKit,
</code></td></tr><tr><td id="L347" class="css-a4x74f"><span>347</span></td><td id="LC347" class="css-1dcdqdg"><code>    isIPhone,
</code></td></tr><tr><td id="L348" class="css-a4x74f"><span>348</span></td><td id="LC348" class="css-1dcdqdg"><code>    isIPadOS,
</code></td></tr><tr><td id="L349" class="css-a4x74f"><span>349</span></td><td id="LC349" class="css-1dcdqdg"><code>    isIos
</code></td></tr><tr><td id="L350" class="css-a4x74f"><span>350</span></td><td id="LC350" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L351" class="css-a4x74f"><span>351</span></td><td id="LC351" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L352" class="css-a4x74f"><span>352</span></td><td id="LC352" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L353" class="css-a4x74f"><span>353</span></td><td id="LC353" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L354" class="css-a4x74f"><span>354</span></td><td id="LC354" class="css-1dcdqdg"><code>  <span class="code-comment">// Clone nested objects</span>
</code></td></tr><tr><td id="L355" class="css-a4x74f"><span>355</span></td><td id="LC355" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">cloneDeep</span>(<span class="code-params">object</span>) </span>{
</code></td></tr><tr><td id="L356" class="css-a4x74f"><span>356</span></td><td id="LC356" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-built_in">JSON</span>.parse(<span class="code-built_in">JSON</span>.stringify(object));
</code></td></tr><tr><td id="L357" class="css-a4x74f"><span>357</span></td><td id="LC357" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L358" class="css-a4x74f"><span>358</span></td><td id="LC358" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L359" class="css-a4x74f"><span>359</span></td><td id="LC359" class="css-1dcdqdg"><code>  <span class="code-comment">// Get a nested value in an object</span>
</code></td></tr><tr><td id="L360" class="css-a4x74f"><span>360</span></td><td id="LC360" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getDeep</span>(<span class="code-params">object, path</span>) </span>{
</code></td></tr><tr><td id="L361" class="css-a4x74f"><span>361</span></td><td id="LC361" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> path.split(<span class="code-string">'.'</span>).reduce(<span class="code-function">(<span class="code-params">obj, key</span>) =&gt;</span> obj &amp;&amp; obj[key], object);
</code></td></tr><tr><td id="L362" class="css-a4x74f"><span>362</span></td><td id="LC362" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L363" class="css-a4x74f"><span>363</span></td><td id="LC363" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L364" class="css-a4x74f"><span>364</span></td><td id="LC364" class="css-1dcdqdg"><code>  <span class="code-comment">// Deep extend destination object with N more objects</span>
</code></td></tr><tr><td id="L365" class="css-a4x74f"><span>365</span></td><td id="LC365" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">extend</span>(<span class="code-params">target = {}, ...sources</span>) </span>{
</code></td></tr><tr><td id="L366" class="css-a4x74f"><span>366</span></td><td id="LC366" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!sources.length) {
</code></td></tr><tr><td id="L367" class="css-a4x74f"><span>367</span></td><td id="LC367" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> target;
</code></td></tr><tr><td id="L368" class="css-a4x74f"><span>368</span></td><td id="LC368" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L369" class="css-a4x74f"><span>369</span></td><td id="LC369" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> source = sources.shift();
</code></td></tr><tr><td id="L370" class="css-a4x74f"><span>370</span></td><td id="LC370" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.object(source)) {
</code></td></tr><tr><td id="L371" class="css-a4x74f"><span>371</span></td><td id="LC371" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> target;
</code></td></tr><tr><td id="L372" class="css-a4x74f"><span>372</span></td><td id="LC372" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L373" class="css-a4x74f"><span>373</span></td><td id="LC373" class="css-1dcdqdg"><code>    <span class="code-built_in">Object</span>.keys(source).forEach(<span class="code-function"><span class="code-params">key</span> =&gt;</span> {
</code></td></tr><tr><td id="L374" class="css-a4x74f"><span>374</span></td><td id="LC374" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.object(source[key])) {
</code></td></tr><tr><td id="L375" class="css-a4x74f"><span>375</span></td><td id="LC375" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-built_in">Object</span>.keys(target).includes(key)) {
</code></td></tr><tr><td id="L376" class="css-a4x74f"><span>376</span></td><td id="LC376" class="css-1dcdqdg"><code>          <span class="code-built_in">Object</span>.assign(target, {
</code></td></tr><tr><td id="L377" class="css-a4x74f"><span>377</span></td><td id="LC377" class="css-1dcdqdg"><code>            [key]: {}
</code></td></tr><tr><td id="L378" class="css-a4x74f"><span>378</span></td><td id="LC378" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L379" class="css-a4x74f"><span>379</span></td><td id="LC379" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L380" class="css-a4x74f"><span>380</span></td><td id="LC380" class="css-1dcdqdg"><code>        extend(target[key], source[key]);
</code></td></tr><tr><td id="L381" class="css-a4x74f"><span>381</span></td><td id="LC381" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L382" class="css-a4x74f"><span>382</span></td><td id="LC382" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.assign(target, {
</code></td></tr><tr><td id="L383" class="css-a4x74f"><span>383</span></td><td id="LC383" class="css-1dcdqdg"><code>          [key]: source[key]
</code></td></tr><tr><td id="L384" class="css-a4x74f"><span>384</span></td><td id="LC384" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L385" class="css-a4x74f"><span>385</span></td><td id="LC385" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L386" class="css-a4x74f"><span>386</span></td><td id="LC386" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L387" class="css-a4x74f"><span>387</span></td><td id="LC387" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> extend(target, ...sources);
</code></td></tr><tr><td id="L388" class="css-a4x74f"><span>388</span></td><td id="LC388" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L389" class="css-a4x74f"><span>389</span></td><td id="LC389" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L390" class="css-a4x74f"><span>390</span></td><td id="LC390" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L391" class="css-a4x74f"><span>391</span></td><td id="LC391" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L392" class="css-a4x74f"><span>392</span></td><td id="LC392" class="css-1dcdqdg"><code>  <span class="code-comment">// Wrap an element</span>
</code></td></tr><tr><td id="L393" class="css-a4x74f"><span>393</span></td><td id="LC393" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">wrap</span>(<span class="code-params">elements, wrapper</span>) </span>{
</code></td></tr><tr><td id="L394" class="css-a4x74f"><span>394</span></td><td id="LC394" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert `elements` to an array, if necessary.</span>
</code></td></tr><tr><td id="L395" class="css-a4x74f"><span>395</span></td><td id="LC395" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> targets = elements.length ? elements : [elements];
</code></td></tr><tr><td id="L396" class="css-a4x74f"><span>396</span></td><td id="LC396" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L397" class="css-a4x74f"><span>397</span></td><td id="LC397" class="css-1dcdqdg"><code>    <span class="code-comment">// Loops backwards to prevent having to clone the wrapper on the</span>
</code></td></tr><tr><td id="L398" class="css-a4x74f"><span>398</span></td><td id="LC398" class="css-1dcdqdg"><code>    <span class="code-comment">// first element (see `child` below).</span>
</code></td></tr><tr><td id="L399" class="css-a4x74f"><span>399</span></td><td id="LC399" class="css-1dcdqdg"><code>    <span class="code-built_in">Array</span>.from(targets).reverse().forEach(<span class="code-function">(<span class="code-params">element, index</span>) =&gt;</span> {
</code></td></tr><tr><td id="L400" class="css-a4x74f"><span>400</span></td><td id="LC400" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> child = index &gt; <span class="code-number">0</span> ? wrapper.cloneNode(<span class="code-literal">true</span>) : wrapper;
</code></td></tr><tr><td id="L401" class="css-a4x74f"><span>401</span></td><td id="LC401" class="css-1dcdqdg"><code>      <span class="code-comment">// Cache the current parent and sibling.</span>
</code></td></tr><tr><td id="L402" class="css-a4x74f"><span>402</span></td><td id="LC402" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> parent = element.parentNode;
</code></td></tr><tr><td id="L403" class="css-a4x74f"><span>403</span></td><td id="LC403" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> sibling = element.nextSibling;
</code></td></tr><tr><td id="L404" class="css-a4x74f"><span>404</span></td><td id="LC404" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L405" class="css-a4x74f"><span>405</span></td><td id="LC405" class="css-1dcdqdg"><code>      <span class="code-comment">// Wrap the element (is automatically removed from its current</span>
</code></td></tr><tr><td id="L406" class="css-a4x74f"><span>406</span></td><td id="LC406" class="css-1dcdqdg"><code>      <span class="code-comment">// parent).</span>
</code></td></tr><tr><td id="L407" class="css-a4x74f"><span>407</span></td><td id="LC407" class="css-1dcdqdg"><code>      child.appendChild(element);
</code></td></tr><tr><td id="L408" class="css-a4x74f"><span>408</span></td><td id="LC408" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L409" class="css-a4x74f"><span>409</span></td><td id="LC409" class="css-1dcdqdg"><code>      <span class="code-comment">// If the element had a sibling, insert the wrapper before</span>
</code></td></tr><tr><td id="L410" class="css-a4x74f"><span>410</span></td><td id="LC410" class="css-1dcdqdg"><code>      <span class="code-comment">// the sibling to maintain the HTML structure; otherwise, just</span>
</code></td></tr><tr><td id="L411" class="css-a4x74f"><span>411</span></td><td id="LC411" class="css-1dcdqdg"><code>      <span class="code-comment">// append it to the parent.</span>
</code></td></tr><tr><td id="L412" class="css-a4x74f"><span>412</span></td><td id="LC412" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (sibling) {
</code></td></tr><tr><td id="L413" class="css-a4x74f"><span>413</span></td><td id="LC413" class="css-1dcdqdg"><code>        parent.insertBefore(child, sibling);
</code></td></tr><tr><td id="L414" class="css-a4x74f"><span>414</span></td><td id="LC414" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L415" class="css-a4x74f"><span>415</span></td><td id="LC415" class="css-1dcdqdg"><code>        parent.appendChild(child);
</code></td></tr><tr><td id="L416" class="css-a4x74f"><span>416</span></td><td id="LC416" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L417" class="css-a4x74f"><span>417</span></td><td id="LC417" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L418" class="css-a4x74f"><span>418</span></td><td id="LC418" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L419" class="css-a4x74f"><span>419</span></td><td id="LC419" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L420" class="css-a4x74f"><span>420</span></td><td id="LC420" class="css-1dcdqdg"><code>  <span class="code-comment">// Set attributes</span>
</code></td></tr><tr><td id="L421" class="css-a4x74f"><span>421</span></td><td id="LC421" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">setAttributes</span>(<span class="code-params">element, attributes</span>) </span>{
</code></td></tr><tr><td id="L422" class="css-a4x74f"><span>422</span></td><td id="LC422" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element) || is.empty(attributes)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L423" class="css-a4x74f"><span>423</span></td><td id="LC423" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L424" class="css-a4x74f"><span>424</span></td><td id="LC424" class="css-1dcdqdg"><code>    <span class="code-comment">// Assume null and undefined attributes should be left out,</span>
</code></td></tr><tr><td id="L425" class="css-a4x74f"><span>425</span></td><td id="LC425" class="css-1dcdqdg"><code>    <span class="code-comment">// Setting them would otherwise convert them to "null" and "undefined"</span>
</code></td></tr><tr><td id="L426" class="css-a4x74f"><span>426</span></td><td id="LC426" class="css-1dcdqdg"><code>    <span class="code-built_in">Object</span>.entries(attributes).filter(<span class="code-function">(<span class="code-params">[, value]</span>) =&gt;</span> !is.nullOrUndefined(value)).forEach(<span class="code-function">(<span class="code-params">[key, value]</span>) =&gt;</span> element.setAttribute(key, value));
</code></td></tr><tr><td id="L427" class="css-a4x74f"><span>427</span></td><td id="LC427" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L428" class="css-a4x74f"><span>428</span></td><td id="LC428" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L429" class="css-a4x74f"><span>429</span></td><td id="LC429" class="css-1dcdqdg"><code>  <span class="code-comment">// Create a DocumentFragment</span>
</code></td></tr><tr><td id="L430" class="css-a4x74f"><span>430</span></td><td id="LC430" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">createElement</span>(<span class="code-params">type, attributes, text</span>) </span>{
</code></td></tr><tr><td id="L431" class="css-a4x74f"><span>431</span></td><td id="LC431" class="css-1dcdqdg"><code>    <span class="code-comment">// Create a new &lt;element&gt;</span>
</code></td></tr><tr><td id="L432" class="css-a4x74f"><span>432</span></td><td id="LC432" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> element = <span class="code-built_in">document</span>.createElement(type);
</code></td></tr><tr><td id="L433" class="css-a4x74f"><span>433</span></td><td id="LC433" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L434" class="css-a4x74f"><span>434</span></td><td id="LC434" class="css-1dcdqdg"><code>    <span class="code-comment">// Set all passed attributes</span>
</code></td></tr><tr><td id="L435" class="css-a4x74f"><span>435</span></td><td id="LC435" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.object(attributes)) {
</code></td></tr><tr><td id="L436" class="css-a4x74f"><span>436</span></td><td id="LC436" class="css-1dcdqdg"><code>      setAttributes(element, attributes);
</code></td></tr><tr><td id="L437" class="css-a4x74f"><span>437</span></td><td id="LC437" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L438" class="css-a4x74f"><span>438</span></td><td id="LC438" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L439" class="css-a4x74f"><span>439</span></td><td id="LC439" class="css-1dcdqdg"><code>    <span class="code-comment">// Add text node</span>
</code></td></tr><tr><td id="L440" class="css-a4x74f"><span>440</span></td><td id="LC440" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.string(text)) {
</code></td></tr><tr><td id="L441" class="css-a4x74f"><span>441</span></td><td id="LC441" class="css-1dcdqdg"><code>      element.innerText = text;
</code></td></tr><tr><td id="L442" class="css-a4x74f"><span>442</span></td><td id="LC442" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L443" class="css-a4x74f"><span>443</span></td><td id="LC443" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L444" class="css-a4x74f"><span>444</span></td><td id="LC444" class="css-1dcdqdg"><code>    <span class="code-comment">// Return built element</span>
</code></td></tr><tr><td id="L445" class="css-a4x74f"><span>445</span></td><td id="LC445" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> element;
</code></td></tr><tr><td id="L446" class="css-a4x74f"><span>446</span></td><td id="LC446" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L447" class="css-a4x74f"><span>447</span></td><td id="LC447" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L448" class="css-a4x74f"><span>448</span></td><td id="LC448" class="css-1dcdqdg"><code>  <span class="code-comment">// Insert an element after another</span>
</code></td></tr><tr><td id="L449" class="css-a4x74f"><span>449</span></td><td id="LC449" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">insertAfter</span>(<span class="code-params">element, target</span>) </span>{
</code></td></tr><tr><td id="L450" class="css-a4x74f"><span>450</span></td><td id="LC450" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element) || !is.element(target)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L451" class="css-a4x74f"><span>451</span></td><td id="LC451" class="css-1dcdqdg"><code>    target.parentNode.insertBefore(element, target.nextSibling);
</code></td></tr><tr><td id="L452" class="css-a4x74f"><span>452</span></td><td id="LC452" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L453" class="css-a4x74f"><span>453</span></td><td id="LC453" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L454" class="css-a4x74f"><span>454</span></td><td id="LC454" class="css-1dcdqdg"><code>  <span class="code-comment">// Insert a DocumentFragment</span>
</code></td></tr><tr><td id="L455" class="css-a4x74f"><span>455</span></td><td id="LC455" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">insertElement</span>(<span class="code-params">type, parent, attributes, text</span>) </span>{
</code></td></tr><tr><td id="L456" class="css-a4x74f"><span>456</span></td><td id="LC456" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(parent)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L457" class="css-a4x74f"><span>457</span></td><td id="LC457" class="css-1dcdqdg"><code>    parent.appendChild(createElement(type, attributes, text));
</code></td></tr><tr><td id="L458" class="css-a4x74f"><span>458</span></td><td id="LC458" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L459" class="css-a4x74f"><span>459</span></td><td id="LC459" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L460" class="css-a4x74f"><span>460</span></td><td id="LC460" class="css-1dcdqdg"><code>  <span class="code-comment">// Remove element(s)</span>
</code></td></tr><tr><td id="L461" class="css-a4x74f"><span>461</span></td><td id="LC461" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">removeElement</span>(<span class="code-params">element</span>) </span>{
</code></td></tr><tr><td id="L462" class="css-a4x74f"><span>462</span></td><td id="LC462" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.nodeList(element) || is.array(element)) {
</code></td></tr><tr><td id="L463" class="css-a4x74f"><span>463</span></td><td id="LC463" class="css-1dcdqdg"><code>      <span class="code-built_in">Array</span>.from(element).forEach(removeElement);
</code></td></tr><tr><td id="L464" class="css-a4x74f"><span>464</span></td><td id="LC464" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L465" class="css-a4x74f"><span>465</span></td><td id="LC465" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L466" class="css-a4x74f"><span>466</span></td><td id="LC466" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element) || !is.element(element.parentNode)) {
</code></td></tr><tr><td id="L467" class="css-a4x74f"><span>467</span></td><td id="LC467" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L468" class="css-a4x74f"><span>468</span></td><td id="LC468" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L469" class="css-a4x74f"><span>469</span></td><td id="LC469" class="css-1dcdqdg"><code>    element.parentNode.removeChild(element);
</code></td></tr><tr><td id="L470" class="css-a4x74f"><span>470</span></td><td id="LC470" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L471" class="css-a4x74f"><span>471</span></td><td id="LC471" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L472" class="css-a4x74f"><span>472</span></td><td id="LC472" class="css-1dcdqdg"><code>  <span class="code-comment">// Remove all child elements</span>
</code></td></tr><tr><td id="L473" class="css-a4x74f"><span>473</span></td><td id="LC473" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">emptyElement</span>(<span class="code-params">element</span>) </span>{
</code></td></tr><tr><td id="L474" class="css-a4x74f"><span>474</span></td><td id="LC474" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L475" class="css-a4x74f"><span>475</span></td><td id="LC475" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L476" class="css-a4x74f"><span>476</span></td><td id="LC476" class="css-1dcdqdg"><code>      length
</code></td></tr><tr><td id="L477" class="css-a4x74f"><span>477</span></td><td id="LC477" class="css-1dcdqdg"><code>    } = element.childNodes;
</code></td></tr><tr><td id="L478" class="css-a4x74f"><span>478</span></td><td id="LC478" class="css-1dcdqdg"><code>    <span class="code-keyword">while</span> (length &gt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L479" class="css-a4x74f"><span>479</span></td><td id="LC479" class="css-1dcdqdg"><code>      element.removeChild(element.lastChild);
</code></td></tr><tr><td id="L480" class="css-a4x74f"><span>480</span></td><td id="LC480" class="css-1dcdqdg"><code>      length -= <span class="code-number">1</span>;
</code></td></tr><tr><td id="L481" class="css-a4x74f"><span>481</span></td><td id="LC481" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L482" class="css-a4x74f"><span>482</span></td><td id="LC482" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L483" class="css-a4x74f"><span>483</span></td><td id="LC483" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L484" class="css-a4x74f"><span>484</span></td><td id="LC484" class="css-1dcdqdg"><code>  <span class="code-comment">// Replace element</span>
</code></td></tr><tr><td id="L485" class="css-a4x74f"><span>485</span></td><td id="LC485" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">replaceElement</span>(<span class="code-params">newChild, oldChild</span>) </span>{
</code></td></tr><tr><td id="L486" class="css-a4x74f"><span>486</span></td><td id="LC486" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(oldChild) || !is.element(oldChild.parentNode) || !is.element(newChild)) <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L487" class="css-a4x74f"><span>487</span></td><td id="LC487" class="css-1dcdqdg"><code>    oldChild.parentNode.replaceChild(newChild, oldChild);
</code></td></tr><tr><td id="L488" class="css-a4x74f"><span>488</span></td><td id="LC488" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> newChild;
</code></td></tr><tr><td id="L489" class="css-a4x74f"><span>489</span></td><td id="LC489" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L490" class="css-a4x74f"><span>490</span></td><td id="LC490" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L491" class="css-a4x74f"><span>491</span></td><td id="LC491" class="css-1dcdqdg"><code>  <span class="code-comment">// Get an attribute object from a string selector</span>
</code></td></tr><tr><td id="L492" class="css-a4x74f"><span>492</span></td><td id="LC492" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getAttributesFromSelector</span>(<span class="code-params">sel, existingAttributes</span>) </span>{
</code></td></tr><tr><td id="L493" class="css-a4x74f"><span>493</span></td><td id="LC493" class="css-1dcdqdg"><code>    <span class="code-comment">// For example:</span>
</code></td></tr><tr><td id="L494" class="css-a4x74f"><span>494</span></td><td id="LC494" class="css-1dcdqdg"><code>    <span class="code-comment">// '.test' to { class: 'test' }</span>
</code></td></tr><tr><td id="L495" class="css-a4x74f"><span>495</span></td><td id="LC495" class="css-1dcdqdg"><code>    <span class="code-comment">// '#test' to { id: 'test' }</span>
</code></td></tr><tr><td id="L496" class="css-a4x74f"><span>496</span></td><td id="LC496" class="css-1dcdqdg"><code>    <span class="code-comment">// '[data-test="test"]' to { 'data-test': 'test' }</span>
</code></td></tr><tr><td id="L497" class="css-a4x74f"><span>497</span></td><td id="LC497" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L498" class="css-a4x74f"><span>498</span></td><td id="LC498" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.string(sel) || is.empty(sel)) <span class="code-keyword">return</span> {};
</code></td></tr><tr><td id="L499" class="css-a4x74f"><span>499</span></td><td id="LC499" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> attributes = {};
</code></td></tr><tr><td id="L500" class="css-a4x74f"><span>500</span></td><td id="LC500" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> existing = extend({}, existingAttributes);
</code></td></tr><tr><td id="L501" class="css-a4x74f"><span>501</span></td><td id="LC501" class="css-1dcdqdg"><code>    sel.split(<span class="code-string">','</span>).forEach(<span class="code-function"><span class="code-params">s</span> =&gt;</span> {
</code></td></tr><tr><td id="L502" class="css-a4x74f"><span>502</span></td><td id="LC502" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove whitespace</span>
</code></td></tr><tr><td id="L503" class="css-a4x74f"><span>503</span></td><td id="LC503" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> selector = s.trim();
</code></td></tr><tr><td id="L504" class="css-a4x74f"><span>504</span></td><td id="LC504" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> className = selector.replace(<span class="code-string">'.'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L505" class="css-a4x74f"><span>505</span></td><td id="LC505" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> stripped = selector.replace(<span class="code-regexp">/[[\]]/g</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L506" class="css-a4x74f"><span>506</span></td><td id="LC506" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the parts and value</span>
</code></td></tr><tr><td id="L507" class="css-a4x74f"><span>507</span></td><td id="LC507" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> parts = stripped.split(<span class="code-string">'='</span>);
</code></td></tr><tr><td id="L508" class="css-a4x74f"><span>508</span></td><td id="LC508" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> [key] = parts;
</code></td></tr><tr><td id="L509" class="css-a4x74f"><span>509</span></td><td id="LC509" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> value = parts.length &gt; <span class="code-number">1</span> ? parts[<span class="code-number">1</span>].replace(<span class="code-regexp">/["']/g</span>, <span class="code-string">''</span>) : <span class="code-string">''</span>;
</code></td></tr><tr><td id="L510" class="css-a4x74f"><span>510</span></td><td id="LC510" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the first character</span>
</code></td></tr><tr><td id="L511" class="css-a4x74f"><span>511</span></td><td id="LC511" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> start = selector.charAt(<span class="code-number">0</span>);
</code></td></tr><tr><td id="L512" class="css-a4x74f"><span>512</span></td><td id="LC512" class="css-1dcdqdg"><code>      <span class="code-keyword">switch</span> (start) {
</code></td></tr><tr><td id="L513" class="css-a4x74f"><span>513</span></td><td id="LC513" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'.'</span>:
</code></td></tr><tr><td id="L514" class="css-a4x74f"><span>514</span></td><td id="LC514" class="css-1dcdqdg"><code>          <span class="code-comment">// Add to existing classname</span>
</code></td></tr><tr><td id="L515" class="css-a4x74f"><span>515</span></td><td id="LC515" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.string(existing.class)) {
</code></td></tr><tr><td id="L516" class="css-a4x74f"><span>516</span></td><td id="LC516" class="css-1dcdqdg"><code>            attributes.class = <span class="code-string">`<span class="code-subst">${existing.class}</span> <span class="code-subst">${className}</span>`</span>;
</code></td></tr><tr><td id="L517" class="css-a4x74f"><span>517</span></td><td id="LC517" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L518" class="css-a4x74f"><span>518</span></td><td id="LC518" class="css-1dcdqdg"><code>            attributes.class = className;
</code></td></tr><tr><td id="L519" class="css-a4x74f"><span>519</span></td><td id="LC519" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L520" class="css-a4x74f"><span>520</span></td><td id="LC520" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L521" class="css-a4x74f"><span>521</span></td><td id="LC521" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'#'</span>:
</code></td></tr><tr><td id="L522" class="css-a4x74f"><span>522</span></td><td id="LC522" class="css-1dcdqdg"><code>          <span class="code-comment">// ID selector</span>
</code></td></tr><tr><td id="L523" class="css-a4x74f"><span>523</span></td><td id="LC523" class="css-1dcdqdg"><code>          attributes.id = selector.replace(<span class="code-string">'#'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L524" class="css-a4x74f"><span>524</span></td><td id="LC524" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L525" class="css-a4x74f"><span>525</span></td><td id="LC525" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'['</span>:
</code></td></tr><tr><td id="L526" class="css-a4x74f"><span>526</span></td><td id="LC526" class="css-1dcdqdg"><code>          <span class="code-comment">// Attribute selector</span>
</code></td></tr><tr><td id="L527" class="css-a4x74f"><span>527</span></td><td id="LC527" class="css-1dcdqdg"><code>          attributes[key] = value;
</code></td></tr><tr><td id="L528" class="css-a4x74f"><span>528</span></td><td id="LC528" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L529" class="css-a4x74f"><span>529</span></td><td id="LC529" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L530" class="css-a4x74f"><span>530</span></td><td id="LC530" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L531" class="css-a4x74f"><span>531</span></td><td id="LC531" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> extend(existing, attributes);
</code></td></tr><tr><td id="L532" class="css-a4x74f"><span>532</span></td><td id="LC532" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L533" class="css-a4x74f"><span>533</span></td><td id="LC533" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L534" class="css-a4x74f"><span>534</span></td><td id="LC534" class="css-1dcdqdg"><code>  <span class="code-comment">// Toggle hidden</span>
</code></td></tr><tr><td id="L535" class="css-a4x74f"><span>535</span></td><td id="LC535" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">toggleHidden</span>(<span class="code-params">element, hidden</span>) </span>{
</code></td></tr><tr><td id="L536" class="css-a4x74f"><span>536</span></td><td id="LC536" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L537" class="css-a4x74f"><span>537</span></td><td id="LC537" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> hide = hidden;
</code></td></tr><tr><td id="L538" class="css-a4x74f"><span>538</span></td><td id="LC538" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.boolean(hide)) {
</code></td></tr><tr><td id="L539" class="css-a4x74f"><span>539</span></td><td id="LC539" class="css-1dcdqdg"><code>      hide = !element.hidden;
</code></td></tr><tr><td id="L540" class="css-a4x74f"><span>540</span></td><td id="LC540" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L541" class="css-a4x74f"><span>541</span></td><td id="LC541" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L542" class="css-a4x74f"><span>542</span></td><td id="LC542" class="css-1dcdqdg"><code>    <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L543" class="css-a4x74f"><span>543</span></td><td id="LC543" class="css-1dcdqdg"><code>    element.hidden = hide;
</code></td></tr><tr><td id="L544" class="css-a4x74f"><span>544</span></td><td id="LC544" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L545" class="css-a4x74f"><span>545</span></td><td id="LC545" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L546" class="css-a4x74f"><span>546</span></td><td id="LC546" class="css-1dcdqdg"><code>  <span class="code-comment">// Mirror Element.classList.toggle, with IE compatibility for "force" argument</span>
</code></td></tr><tr><td id="L547" class="css-a4x74f"><span>547</span></td><td id="LC547" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">toggleClass</span>(<span class="code-params">element, className, force</span>) </span>{
</code></td></tr><tr><td id="L548" class="css-a4x74f"><span>548</span></td><td id="LC548" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.nodeList(element)) {
</code></td></tr><tr><td id="L549" class="css-a4x74f"><span>549</span></td><td id="LC549" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Array</span>.from(element).map(<span class="code-function"><span class="code-params">e</span> =&gt;</span> toggleClass(e, className, force));
</code></td></tr><tr><td id="L550" class="css-a4x74f"><span>550</span></td><td id="LC550" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L551" class="css-a4x74f"><span>551</span></td><td id="LC551" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.element(element)) {
</code></td></tr><tr><td id="L552" class="css-a4x74f"><span>552</span></td><td id="LC552" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> method = <span class="code-string">'toggle'</span>;
</code></td></tr><tr><td id="L553" class="css-a4x74f"><span>553</span></td><td id="LC553" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">typeof</span> force !== <span class="code-string">'undefined'</span>) {
</code></td></tr><tr><td id="L554" class="css-a4x74f"><span>554</span></td><td id="LC554" class="css-1dcdqdg"><code>        method = force ? <span class="code-string">'add'</span> : <span class="code-string">'remove'</span>;
</code></td></tr><tr><td id="L555" class="css-a4x74f"><span>555</span></td><td id="LC555" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L556" class="css-a4x74f"><span>556</span></td><td id="LC556" class="css-1dcdqdg"><code>      element.classList[method](className);
</code></td></tr><tr><td id="L557" class="css-a4x74f"><span>557</span></td><td id="LC557" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> element.classList.contains(className);
</code></td></tr><tr><td id="L558" class="css-a4x74f"><span>558</span></td><td id="LC558" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L559" class="css-a4x74f"><span>559</span></td><td id="LC559" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L560" class="css-a4x74f"><span>560</span></td><td id="LC560" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L561" class="css-a4x74f"><span>561</span></td><td id="LC561" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L562" class="css-a4x74f"><span>562</span></td><td id="LC562" class="css-1dcdqdg"><code>  <span class="code-comment">// Has class name</span>
</code></td></tr><tr><td id="L563" class="css-a4x74f"><span>563</span></td><td id="LC563" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">hasClass</span>(<span class="code-params">element, className</span>) </span>{
</code></td></tr><tr><td id="L564" class="css-a4x74f"><span>564</span></td><td id="LC564" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> is.element(element) &amp;&amp; element.classList.contains(className);
</code></td></tr><tr><td id="L565" class="css-a4x74f"><span>565</span></td><td id="LC565" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L566" class="css-a4x74f"><span>566</span></td><td id="LC566" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L567" class="css-a4x74f"><span>567</span></td><td id="LC567" class="css-1dcdqdg"><code>  <span class="code-comment">// Element matches selector</span>
</code></td></tr><tr><td id="L568" class="css-a4x74f"><span>568</span></td><td id="LC568" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">matches</span>(<span class="code-params">element, selector</span>) </span>{
</code></td></tr><tr><td id="L569" class="css-a4x74f"><span>569</span></td><td id="LC569" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L570" class="css-a4x74f"><span>570</span></td><td id="LC570" class="css-1dcdqdg"><code>      prototype
</code></td></tr><tr><td id="L571" class="css-a4x74f"><span>571</span></td><td id="LC571" class="css-1dcdqdg"><code>    } = Element;
</code></td></tr><tr><td id="L572" class="css-a4x74f"><span>572</span></td><td id="LC572" class="css-1dcdqdg"><code>    <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">match</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L573" class="css-a4x74f"><span>573</span></td><td id="LC573" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Array</span>.from(<span class="code-built_in">document</span>.querySelectorAll(selector)).includes(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L574" class="css-a4x74f"><span>574</span></td><td id="LC574" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L575" class="css-a4x74f"><span>575</span></td><td id="LC575" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> method = prototype.matches || prototype.webkitMatchesSelector || prototype.mozMatchesSelector || prototype.msMatchesSelector || match;
</code></td></tr><tr><td id="L576" class="css-a4x74f"><span>576</span></td><td id="LC576" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> method.call(element, selector);
</code></td></tr><tr><td id="L577" class="css-a4x74f"><span>577</span></td><td id="LC577" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L578" class="css-a4x74f"><span>578</span></td><td id="LC578" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L579" class="css-a4x74f"><span>579</span></td><td id="LC579" class="css-1dcdqdg"><code>  <span class="code-comment">// Closest ancestor element matching selector (also tests element itself)</span>
</code></td></tr><tr><td id="L580" class="css-a4x74f"><span>580</span></td><td id="LC580" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">closest$1</span>(<span class="code-params">element, selector</span>) </span>{
</code></td></tr><tr><td id="L581" class="css-a4x74f"><span>581</span></td><td id="LC581" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L582" class="css-a4x74f"><span>582</span></td><td id="LC582" class="css-1dcdqdg"><code>      prototype
</code></td></tr><tr><td id="L583" class="css-a4x74f"><span>583</span></td><td id="LC583" class="css-1dcdqdg"><code>    } = Element;
</code></td></tr><tr><td id="L584" class="css-a4x74f"><span>584</span></td><td id="LC584" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L585" class="css-a4x74f"><span>585</span></td><td id="LC585" class="css-1dcdqdg"><code>    <span class="code-comment">// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill</span>
</code></td></tr><tr><td id="L586" class="css-a4x74f"><span>586</span></td><td id="LC586" class="css-1dcdqdg"><code>    <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">closestElement</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L587" class="css-a4x74f"><span>587</span></td><td id="LC587" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> el = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L588" class="css-a4x74f"><span>588</span></td><td id="LC588" class="css-1dcdqdg"><code>      <span class="code-keyword">do</span> {
</code></td></tr><tr><td id="L589" class="css-a4x74f"><span>589</span></td><td id="LC589" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (matches.matches(el, selector)) <span class="code-keyword">return</span> el;
</code></td></tr><tr><td id="L590" class="css-a4x74f"><span>590</span></td><td id="LC590" class="css-1dcdqdg"><code>        el = el.parentElement || el.parentNode;
</code></td></tr><tr><td id="L591" class="css-a4x74f"><span>591</span></td><td id="LC591" class="css-1dcdqdg"><code>      } <span class="code-keyword">while</span> (el !== <span class="code-literal">null</span> &amp;&amp; el.nodeType === <span class="code-number">1</span>);
</code></td></tr><tr><td id="L592" class="css-a4x74f"><span>592</span></td><td id="LC592" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L593" class="css-a4x74f"><span>593</span></td><td id="LC593" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L594" class="css-a4x74f"><span>594</span></td><td id="LC594" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> method = prototype.closest || closestElement;
</code></td></tr><tr><td id="L595" class="css-a4x74f"><span>595</span></td><td id="LC595" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> method.call(element, selector);
</code></td></tr><tr><td id="L596" class="css-a4x74f"><span>596</span></td><td id="LC596" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L597" class="css-a4x74f"><span>597</span></td><td id="LC597" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L598" class="css-a4x74f"><span>598</span></td><td id="LC598" class="css-1dcdqdg"><code>  <span class="code-comment">// Find all elements</span>
</code></td></tr><tr><td id="L599" class="css-a4x74f"><span>599</span></td><td id="LC599" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getElements</span>(<span class="code-params">selector</span>) </span>{
</code></td></tr><tr><td id="L600" class="css-a4x74f"><span>600</span></td><td id="LC600" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.elements.container.querySelectorAll(selector);
</code></td></tr><tr><td id="L601" class="css-a4x74f"><span>601</span></td><td id="LC601" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L602" class="css-a4x74f"><span>602</span></td><td id="LC602" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L603" class="css-a4x74f"><span>603</span></td><td id="LC603" class="css-1dcdqdg"><code>  <span class="code-comment">// Find a single element</span>
</code></td></tr><tr><td id="L604" class="css-a4x74f"><span>604</span></td><td id="LC604" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getElement</span>(<span class="code-params">selector</span>) </span>{
</code></td></tr><tr><td id="L605" class="css-a4x74f"><span>605</span></td><td id="LC605" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.elements.container.querySelector(selector);
</code></td></tr><tr><td id="L606" class="css-a4x74f"><span>606</span></td><td id="LC606" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L607" class="css-a4x74f"><span>607</span></td><td id="LC607" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L608" class="css-a4x74f"><span>608</span></td><td id="LC608" class="css-1dcdqdg"><code>  <span class="code-comment">// Set focus and tab focus class</span>
</code></td></tr><tr><td id="L609" class="css-a4x74f"><span>609</span></td><td id="LC609" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">setFocus</span>(<span class="code-params">element = null, focusVisible = false</span>) </span>{
</code></td></tr><tr><td id="L610" class="css-a4x74f"><span>610</span></td><td id="LC610" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L611" class="css-a4x74f"><span>611</span></td><td id="LC611" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L612" class="css-a4x74f"><span>612</span></td><td id="LC612" class="css-1dcdqdg"><code>    <span class="code-comment">// Set regular focus</span>
</code></td></tr><tr><td id="L613" class="css-a4x74f"><span>613</span></td><td id="LC613" class="css-1dcdqdg"><code>    element.focus({
</code></td></tr><tr><td id="L614" class="css-a4x74f"><span>614</span></td><td id="LC614" class="css-1dcdqdg"><code>      preventScroll: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L615" class="css-a4x74f"><span>615</span></td><td id="LC615" class="css-1dcdqdg"><code>      focusVisible
</code></td></tr><tr><td id="L616" class="css-a4x74f"><span>616</span></td><td id="LC616" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L617" class="css-a4x74f"><span>617</span></td><td id="LC617" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L618" class="css-a4x74f"><span>618</span></td><td id="LC618" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L619" class="css-a4x74f"><span>619</span></td><td id="LC619" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L620" class="css-a4x74f"><span>620</span></td><td id="LC620" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L621" class="css-a4x74f"><span>621</span></td><td id="LC621" class="css-1dcdqdg"><code>  <span class="code-comment">// Default codecs for checking mimetype support</span>
</code></td></tr><tr><td id="L622" class="css-a4x74f"><span>622</span></td><td id="LC622" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> defaultCodecs = {
</code></td></tr><tr><td id="L623" class="css-a4x74f"><span>623</span></td><td id="LC623" class="css-1dcdqdg"><code>    <span class="code-string">'audio/ogg'</span>: <span class="code-string">'vorbis'</span>,
</code></td></tr><tr><td id="L624" class="css-a4x74f"><span>624</span></td><td id="LC624" class="css-1dcdqdg"><code>    <span class="code-string">'audio/wav'</span>: <span class="code-string">'1'</span>,
</code></td></tr><tr><td id="L625" class="css-a4x74f"><span>625</span></td><td id="LC625" class="css-1dcdqdg"><code>    <span class="code-string">'video/webm'</span>: <span class="code-string">'vp8, vorbis'</span>,
</code></td></tr><tr><td id="L626" class="css-a4x74f"><span>626</span></td><td id="LC626" class="css-1dcdqdg"><code>    <span class="code-string">'video/mp4'</span>: <span class="code-string">'avc1.42E01E, mp4a.40.2'</span>,
</code></td></tr><tr><td id="L627" class="css-a4x74f"><span>627</span></td><td id="LC627" class="css-1dcdqdg"><code>    <span class="code-string">'video/ogg'</span>: <span class="code-string">'theora'</span>
</code></td></tr><tr><td id="L628" class="css-a4x74f"><span>628</span></td><td id="LC628" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L629" class="css-a4x74f"><span>629</span></td><td id="LC629" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L630" class="css-a4x74f"><span>630</span></td><td id="LC630" class="css-1dcdqdg"><code>  <span class="code-comment">// Check for feature support</span>
</code></td></tr><tr><td id="L631" class="css-a4x74f"><span>631</span></td><td id="LC631" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> support = {
</code></td></tr><tr><td id="L632" class="css-a4x74f"><span>632</span></td><td id="LC632" class="css-1dcdqdg"><code>    <span class="code-comment">// Basic support</span>
</code></td></tr><tr><td id="L633" class="css-a4x74f"><span>633</span></td><td id="LC633" class="css-1dcdqdg"><code>    audio: <span class="code-string">'canPlayType'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.createElement(<span class="code-string">'audio'</span>),
</code></td></tr><tr><td id="L634" class="css-a4x74f"><span>634</span></td><td id="LC634" class="css-1dcdqdg"><code>    video: <span class="code-string">'canPlayType'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.createElement(<span class="code-string">'video'</span>),
</code></td></tr><tr><td id="L635" class="css-a4x74f"><span>635</span></td><td id="LC635" class="css-1dcdqdg"><code>    <span class="code-comment">// Check for support</span>
</code></td></tr><tr><td id="L636" class="css-a4x74f"><span>636</span></td><td id="LC636" class="css-1dcdqdg"><code>    <span class="code-comment">// Basic functionality vs full UI</span>
</code></td></tr><tr><td id="L637" class="css-a4x74f"><span>637</span></td><td id="LC637" class="css-1dcdqdg"><code>    check(type, provider) {
</code></td></tr><tr><td id="L638" class="css-a4x74f"><span>638</span></td><td id="LC638" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> api = support[type] || provider !== <span class="code-string">'html5'</span>;
</code></td></tr><tr><td id="L639" class="css-a4x74f"><span>639</span></td><td id="LC639" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> ui = api &amp;&amp; support.rangeInput;
</code></td></tr><tr><td id="L640" class="css-a4x74f"><span>640</span></td><td id="LC640" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> {
</code></td></tr><tr><td id="L641" class="css-a4x74f"><span>641</span></td><td id="LC641" class="css-1dcdqdg"><code>        api,
</code></td></tr><tr><td id="L642" class="css-a4x74f"><span>642</span></td><td id="LC642" class="css-1dcdqdg"><code>        ui
</code></td></tr><tr><td id="L643" class="css-a4x74f"><span>643</span></td><td id="LC643" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L644" class="css-a4x74f"><span>644</span></td><td id="LC644" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L645" class="css-a4x74f"><span>645</span></td><td id="LC645" class="css-1dcdqdg"><code>    <span class="code-comment">// Picture-in-picture support</span>
</code></td></tr><tr><td id="L646" class="css-a4x74f"><span>646</span></td><td id="LC646" class="css-1dcdqdg"><code>    <span class="code-comment">// Safari &amp; Chrome only currently</span>
</code></td></tr><tr><td id="L647" class="css-a4x74f"><span>647</span></td><td id="LC647" class="css-1dcdqdg"><code>    pip: <span class="code-function">(<span class="code-params">(</span>) =&gt;</span> {
</code></td></tr><tr><td id="L648" class="css-a4x74f"><span>648</span></td><td id="LC648" class="css-1dcdqdg"><code>      <span class="code-comment">// While iPhone's support picture-in-picture for some apps, seemingly Safari isn't one of them</span>
</code></td></tr><tr><td id="L649" class="css-a4x74f"><span>649</span></td><td id="LC649" class="css-1dcdqdg"><code>      <span class="code-comment">// It will throw the following error when trying to enter picture-in-picture</span>
</code></td></tr><tr><td id="L650" class="css-a4x74f"><span>650</span></td><td id="LC650" class="css-1dcdqdg"><code>      <span class="code-comment">// `NotSupportedError: The Picture-in-Picture mode is not supported.`</span>
</code></td></tr><tr><td id="L651" class="css-a4x74f"><span>651</span></td><td id="LC651" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (browser.isIPhone) {
</code></td></tr><tr><td id="L652" class="css-a4x74f"><span>652</span></td><td id="LC652" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L653" class="css-a4x74f"><span>653</span></td><td id="LC653" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L654" class="css-a4x74f"><span>654</span></td><td id="LC654" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L655" class="css-a4x74f"><span>655</span></td><td id="LC655" class="css-1dcdqdg"><code>      <span class="code-comment">// Safari</span>
</code></td></tr><tr><td id="L656" class="css-a4x74f"><span>656</span></td><td id="LC656" class="css-1dcdqdg"><code>      <span class="code-comment">// https://developer.apple.com/documentation/webkitjs/adding_picture_in_picture_to_your_safari_media_controls</span>
</code></td></tr><tr><td id="L657" class="css-a4x74f"><span>657</span></td><td id="LC657" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.function(createElement(<span class="code-string">'video'</span>).webkitSetPresentationMode)) {
</code></td></tr><tr><td id="L658" class="css-a4x74f"><span>658</span></td><td id="LC658" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L659" class="css-a4x74f"><span>659</span></td><td id="LC659" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L660" class="css-a4x74f"><span>660</span></td><td id="LC660" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L661" class="css-a4x74f"><span>661</span></td><td id="LC661" class="css-1dcdqdg"><code>      <span class="code-comment">// Chrome</span>
</code></td></tr><tr><td id="L662" class="css-a4x74f"><span>662</span></td><td id="LC662" class="css-1dcdqdg"><code>      <span class="code-comment">// https://developers.google.com/web/updates/2018/10/watch-video-using-picture-in-picture</span>
</code></td></tr><tr><td id="L663" class="css-a4x74f"><span>663</span></td><td id="LC663" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-built_in">document</span>.pictureInPictureEnabled &amp;&amp; !createElement(<span class="code-string">'video'</span>).disablePictureInPicture) {
</code></td></tr><tr><td id="L664" class="css-a4x74f"><span>664</span></td><td id="LC664" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L665" class="css-a4x74f"><span>665</span></td><td id="LC665" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L666" class="css-a4x74f"><span>666</span></td><td id="LC666" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L667" class="css-a4x74f"><span>667</span></td><td id="LC667" class="css-1dcdqdg"><code>    })(),
</code></td></tr><tr><td id="L668" class="css-a4x74f"><span>668</span></td><td id="LC668" class="css-1dcdqdg"><code>    <span class="code-comment">// Airplay support</span>
</code></td></tr><tr><td id="L669" class="css-a4x74f"><span>669</span></td><td id="LC669" class="css-1dcdqdg"><code>    <span class="code-comment">// Safari only currently</span>
</code></td></tr><tr><td id="L670" class="css-a4x74f"><span>670</span></td><td id="LC670" class="css-1dcdqdg"><code>    airplay: is.function(<span class="code-built_in">window</span>.WebKitPlaybackTargetAvailabilityEvent),
</code></td></tr><tr><td id="L671" class="css-a4x74f"><span>671</span></td><td id="LC671" class="css-1dcdqdg"><code>    <span class="code-comment">// Inline playback support</span>
</code></td></tr><tr><td id="L672" class="css-a4x74f"><span>672</span></td><td id="LC672" class="css-1dcdqdg"><code>    <span class="code-comment">// https://webkit.org/blog/6784/new-video-policies-for-ios/</span>
</code></td></tr><tr><td id="L673" class="css-a4x74f"><span>673</span></td><td id="LC673" class="css-1dcdqdg"><code>    playsinline: <span class="code-string">'playsInline'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.createElement(<span class="code-string">'video'</span>),
</code></td></tr><tr><td id="L674" class="css-a4x74f"><span>674</span></td><td id="LC674" class="css-1dcdqdg"><code>    <span class="code-comment">// Check for mime type support against a player instance</span>
</code></td></tr><tr><td id="L675" class="css-a4x74f"><span>675</span></td><td id="LC675" class="css-1dcdqdg"><code>    <span class="code-comment">// Credits: http://diveintohtml5.info/everything.html</span>
</code></td></tr><tr><td id="L676" class="css-a4x74f"><span>676</span></td><td id="LC676" class="css-1dcdqdg"><code>    <span class="code-comment">// Related: http://www.leanbackplayer.com/test/h5mt.html</span>
</code></td></tr><tr><td id="L677" class="css-a4x74f"><span>677</span></td><td id="LC677" class="css-1dcdqdg"><code>    mime(input) {
</code></td></tr><tr><td id="L678" class="css-a4x74f"><span>678</span></td><td id="LC678" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(input)) {
</code></td></tr><tr><td id="L679" class="css-a4x74f"><span>679</span></td><td id="LC679" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L680" class="css-a4x74f"><span>680</span></td><td id="LC680" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L681" class="css-a4x74f"><span>681</span></td><td id="LC681" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> [mediaType] = input.split(<span class="code-string">'/'</span>);
</code></td></tr><tr><td id="L682" class="css-a4x74f"><span>682</span></td><td id="LC682" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> type = input;
</code></td></tr><tr><td id="L683" class="css-a4x74f"><span>683</span></td><td id="LC683" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L684" class="css-a4x74f"><span>684</span></td><td id="LC684" class="css-1dcdqdg"><code>      <span class="code-comment">// Verify we're using HTML5 and there's no media type mismatch</span>
</code></td></tr><tr><td id="L685" class="css-a4x74f"><span>685</span></td><td id="LC685" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isHTML5 || mediaType !== <span class="code-keyword">this</span>.type) {
</code></td></tr><tr><td id="L686" class="css-a4x74f"><span>686</span></td><td id="LC686" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L687" class="css-a4x74f"><span>687</span></td><td id="LC687" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L688" class="css-a4x74f"><span>688</span></td><td id="LC688" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L689" class="css-a4x74f"><span>689</span></td><td id="LC689" class="css-1dcdqdg"><code>      <span class="code-comment">// Add codec if required</span>
</code></td></tr><tr><td id="L690" class="css-a4x74f"><span>690</span></td><td id="LC690" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(defaultCodecs).includes(type)) {
</code></td></tr><tr><td id="L691" class="css-a4x74f"><span>691</span></td><td id="LC691" class="css-1dcdqdg"><code>        type += <span class="code-string">`; codecs="<span class="code-subst">${defaultCodecs[input]}</span>"`</span>;
</code></td></tr><tr><td id="L692" class="css-a4x74f"><span>692</span></td><td id="LC692" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L693" class="css-a4x74f"><span>693</span></td><td id="LC693" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L694" class="css-a4x74f"><span>694</span></td><td id="LC694" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(type &amp;&amp; <span class="code-keyword">this</span>.media.canPlayType(type).replace(<span class="code-regexp">/no/</span>, <span class="code-string">''</span>));
</code></td></tr><tr><td id="L695" class="css-a4x74f"><span>695</span></td><td id="LC695" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L696" class="css-a4x74f"><span>696</span></td><td id="LC696" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L697" class="css-a4x74f"><span>697</span></td><td id="LC697" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L698" class="css-a4x74f"><span>698</span></td><td id="LC698" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L699" class="css-a4x74f"><span>699</span></td><td id="LC699" class="css-1dcdqdg"><code>    <span class="code-comment">// Check for textTracks support</span>
</code></td></tr><tr><td id="L700" class="css-a4x74f"><span>700</span></td><td id="LC700" class="css-1dcdqdg"><code>    textTracks: <span class="code-string">'textTracks'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.createElement(<span class="code-string">'video'</span>),
</code></td></tr><tr><td id="L701" class="css-a4x74f"><span>701</span></td><td id="LC701" class="css-1dcdqdg"><code>    <span class="code-comment">// &lt;input type="range"&gt; Sliders</span>
</code></td></tr><tr><td id="L702" class="css-a4x74f"><span>702</span></td><td id="LC702" class="css-1dcdqdg"><code>    rangeInput: <span class="code-function">(<span class="code-params">(</span>) =&gt;</span> {
</code></td></tr><tr><td id="L703" class="css-a4x74f"><span>703</span></td><td id="LC703" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> range = <span class="code-built_in">document</span>.createElement(<span class="code-string">'input'</span>);
</code></td></tr><tr><td id="L704" class="css-a4x74f"><span>704</span></td><td id="LC704" class="css-1dcdqdg"><code>      range.type = <span class="code-string">'range'</span>;
</code></td></tr><tr><td id="L705" class="css-a4x74f"><span>705</span></td><td id="LC705" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> range.type === <span class="code-string">'range'</span>;
</code></td></tr><tr><td id="L706" class="css-a4x74f"><span>706</span></td><td id="LC706" class="css-1dcdqdg"><code>    })(),
</code></td></tr><tr><td id="L707" class="css-a4x74f"><span>707</span></td><td id="LC707" class="css-1dcdqdg"><code>    <span class="code-comment">// Touch</span>
</code></td></tr><tr><td id="L708" class="css-a4x74f"><span>708</span></td><td id="LC708" class="css-1dcdqdg"><code>    <span class="code-comment">// <span class="code-doctag">NOTE:</span> Remember a device can be mouse + touch enabled so we check on first touch event</span>
</code></td></tr><tr><td id="L709" class="css-a4x74f"><span>709</span></td><td id="LC709" class="css-1dcdqdg"><code>    touch: <span class="code-string">'ontouchstart'</span> <span class="code-keyword">in</span> <span class="code-built_in">document</span>.documentElement,
</code></td></tr><tr><td id="L710" class="css-a4x74f"><span>710</span></td><td id="LC710" class="css-1dcdqdg"><code>    <span class="code-comment">// Detect transitions support</span>
</code></td></tr><tr><td id="L711" class="css-a4x74f"><span>711</span></td><td id="LC711" class="css-1dcdqdg"><code>    transitions: transitionEndEvent !== <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L712" class="css-a4x74f"><span>712</span></td><td id="LC712" class="css-1dcdqdg"><code>    <span class="code-comment">// Reduced motion iOS &amp; MacOS setting</span>
</code></td></tr><tr><td id="L713" class="css-a4x74f"><span>713</span></td><td id="LC713" class="css-1dcdqdg"><code>    <span class="code-comment">// https://webkit.org/blog/7551/responsive-design-for-motion/</span>
</code></td></tr><tr><td id="L714" class="css-a4x74f"><span>714</span></td><td id="LC714" class="css-1dcdqdg"><code>    reducedMotion: <span class="code-string">'matchMedia'</span> <span class="code-keyword">in</span> <span class="code-built_in">window</span> &amp;&amp; <span class="code-built_in">window</span>.matchMedia(<span class="code-string">'(prefers-reduced-motion)'</span>).matches
</code></td></tr><tr><td id="L715" class="css-a4x74f"><span>715</span></td><td id="LC715" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L716" class="css-a4x74f"><span>716</span></td><td id="LC716" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L717" class="css-a4x74f"><span>717</span></td><td id="LC717" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L718" class="css-a4x74f"><span>718</span></td><td id="LC718" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L719" class="css-a4x74f"><span>719</span></td><td id="LC719" class="css-1dcdqdg"><code>  <span class="code-comment">// Check for passive event listener support</span>
</code></td></tr><tr><td id="L720" class="css-a4x74f"><span>720</span></td><td id="LC720" class="css-1dcdqdg"><code>  <span class="code-comment">// https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md</span>
</code></td></tr><tr><td id="L721" class="css-a4x74f"><span>721</span></td><td id="LC721" class="css-1dcdqdg"><code>  <span class="code-comment">// https://www.youtube.com/watch?v=NPM6172J22g</span>
</code></td></tr><tr><td id="L722" class="css-a4x74f"><span>722</span></td><td id="LC722" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> supportsPassiveListeners = <span class="code-function">(<span class="code-params">(</span>) =&gt;</span> {
</code></td></tr><tr><td id="L723" class="css-a4x74f"><span>723</span></td><td id="LC723" class="css-1dcdqdg"><code>    <span class="code-comment">// Test via a getter in the options object to see if the passive property is accessed</span>
</code></td></tr><tr><td id="L724" class="css-a4x74f"><span>724</span></td><td id="LC724" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> supported = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L725" class="css-a4x74f"><span>725</span></td><td id="LC725" class="css-1dcdqdg"><code>    <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L726" class="css-a4x74f"><span>726</span></td><td id="LC726" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> options = <span class="code-built_in">Object</span>.defineProperty({}, <span class="code-string">'passive'</span>, {
</code></td></tr><tr><td id="L727" class="css-a4x74f"><span>727</span></td><td id="LC727" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L728" class="css-a4x74f"><span>728</span></td><td id="LC728" class="css-1dcdqdg"><code>          supported = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L729" class="css-a4x74f"><span>729</span></td><td id="LC729" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L730" class="css-a4x74f"><span>730</span></td><td id="LC730" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L731" class="css-a4x74f"><span>731</span></td><td id="LC731" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L732" class="css-a4x74f"><span>732</span></td><td id="LC732" class="css-1dcdqdg"><code>      <span class="code-built_in">window</span>.addEventListener(<span class="code-string">'test'</span>, <span class="code-literal">null</span>, options);
</code></td></tr><tr><td id="L733" class="css-a4x74f"><span>733</span></td><td id="LC733" class="css-1dcdqdg"><code>      <span class="code-built_in">window</span>.removeEventListener(<span class="code-string">'test'</span>, <span class="code-literal">null</span>, options);
</code></td></tr><tr><td id="L734" class="css-a4x74f"><span>734</span></td><td id="LC734" class="css-1dcdqdg"><code>    } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L735" class="css-a4x74f"><span>735</span></td><td id="LC735" class="css-1dcdqdg"><code>      <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L736" class="css-a4x74f"><span>736</span></td><td id="LC736" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L737" class="css-a4x74f"><span>737</span></td><td id="LC737" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> supported;
</code></td></tr><tr><td id="L738" class="css-a4x74f"><span>738</span></td><td id="LC738" class="css-1dcdqdg"><code>  })();
</code></td></tr><tr><td id="L739" class="css-a4x74f"><span>739</span></td><td id="LC739" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L740" class="css-a4x74f"><span>740</span></td><td id="LC740" class="css-1dcdqdg"><code>  <span class="code-comment">// Toggle event listener</span>
</code></td></tr><tr><td id="L741" class="css-a4x74f"><span>741</span></td><td id="LC741" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">toggleListener</span>(<span class="code-params">element, event, callback, toggle = false, passive = true, capture = false</span>) </span>{
</code></td></tr><tr><td id="L742" class="css-a4x74f"><span>742</span></td><td id="LC742" class="css-1dcdqdg"><code>    <span class="code-comment">// Bail if no element, event, or callback</span>
</code></td></tr><tr><td id="L743" class="css-a4x74f"><span>743</span></td><td id="LC743" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!element || !(<span class="code-string">'addEventListener'</span> <span class="code-keyword">in</span> element) || is.empty(event) || !is.function(callback)) {
</code></td></tr><tr><td id="L744" class="css-a4x74f"><span>744</span></td><td id="LC744" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L745" class="css-a4x74f"><span>745</span></td><td id="LC745" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L746" class="css-a4x74f"><span>746</span></td><td id="LC746" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L747" class="css-a4x74f"><span>747</span></td><td id="LC747" class="css-1dcdqdg"><code>    <span class="code-comment">// Allow multiple events</span>
</code></td></tr><tr><td id="L748" class="css-a4x74f"><span>748</span></td><td id="LC748" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> events = event.split(<span class="code-string">' '</span>);
</code></td></tr><tr><td id="L749" class="css-a4x74f"><span>749</span></td><td id="LC749" class="css-1dcdqdg"><code>    <span class="code-comment">// Build options</span>
</code></td></tr><tr><td id="L750" class="css-a4x74f"><span>750</span></td><td id="LC750" class="css-1dcdqdg"><code>    <span class="code-comment">// Default to just the capture boolean for browsers with no passive listener support</span>
</code></td></tr><tr><td id="L751" class="css-a4x74f"><span>751</span></td><td id="LC751" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> options = capture;
</code></td></tr><tr><td id="L752" class="css-a4x74f"><span>752</span></td><td id="LC752" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L753" class="css-a4x74f"><span>753</span></td><td id="LC753" class="css-1dcdqdg"><code>    <span class="code-comment">// If passive events listeners are supported</span>
</code></td></tr><tr><td id="L754" class="css-a4x74f"><span>754</span></td><td id="LC754" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (supportsPassiveListeners) {
</code></td></tr><tr><td id="L755" class="css-a4x74f"><span>755</span></td><td id="LC755" class="css-1dcdqdg"><code>      options = {
</code></td></tr><tr><td id="L756" class="css-a4x74f"><span>756</span></td><td id="LC756" class="css-1dcdqdg"><code>        <span class="code-comment">// Whether the listener can be passive (i.e. default never prevented)</span>
</code></td></tr><tr><td id="L757" class="css-a4x74f"><span>757</span></td><td id="LC757" class="css-1dcdqdg"><code>        passive,
</code></td></tr><tr><td id="L758" class="css-a4x74f"><span>758</span></td><td id="LC758" class="css-1dcdqdg"><code>        <span class="code-comment">// Whether the listener is a capturing listener or not</span>
</code></td></tr><tr><td id="L759" class="css-a4x74f"><span>759</span></td><td id="LC759" class="css-1dcdqdg"><code>        capture
</code></td></tr><tr><td id="L760" class="css-a4x74f"><span>760</span></td><td id="LC760" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L761" class="css-a4x74f"><span>761</span></td><td id="LC761" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L762" class="css-a4x74f"><span>762</span></td><td id="LC762" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L763" class="css-a4x74f"><span>763</span></td><td id="LC763" class="css-1dcdqdg"><code>    <span class="code-comment">// If a single node is passed, bind the event listener</span>
</code></td></tr><tr><td id="L764" class="css-a4x74f"><span>764</span></td><td id="LC764" class="css-1dcdqdg"><code>    events.forEach(<span class="code-function"><span class="code-params">type</span> =&gt;</span> {
</code></td></tr><tr><td id="L765" class="css-a4x74f"><span>765</span></td><td id="LC765" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span> &amp;&amp; <span class="code-keyword">this</span>.eventListeners &amp;&amp; toggle) {
</code></td></tr><tr><td id="L766" class="css-a4x74f"><span>766</span></td><td id="LC766" class="css-1dcdqdg"><code>        <span class="code-comment">// Cache event listener</span>
</code></td></tr><tr><td id="L767" class="css-a4x74f"><span>767</span></td><td id="LC767" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.eventListeners.push({
</code></td></tr><tr><td id="L768" class="css-a4x74f"><span>768</span></td><td id="LC768" class="css-1dcdqdg"><code>          element,
</code></td></tr><tr><td id="L769" class="css-a4x74f"><span>769</span></td><td id="LC769" class="css-1dcdqdg"><code>          type,
</code></td></tr><tr><td id="L770" class="css-a4x74f"><span>770</span></td><td id="LC770" class="css-1dcdqdg"><code>          callback,
</code></td></tr><tr><td id="L771" class="css-a4x74f"><span>771</span></td><td id="LC771" class="css-1dcdqdg"><code>          options
</code></td></tr><tr><td id="L772" class="css-a4x74f"><span>772</span></td><td id="LC772" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L773" class="css-a4x74f"><span>773</span></td><td id="LC773" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L774" class="css-a4x74f"><span>774</span></td><td id="LC774" class="css-1dcdqdg"><code>      element[toggle ? <span class="code-string">'addEventListener'</span> : <span class="code-string">'removeEventListener'</span>](type, callback, options);
</code></td></tr><tr><td id="L775" class="css-a4x74f"><span>775</span></td><td id="LC775" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L776" class="css-a4x74f"><span>776</span></td><td id="LC776" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L777" class="css-a4x74f"><span>777</span></td><td id="LC777" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L778" class="css-a4x74f"><span>778</span></td><td id="LC778" class="css-1dcdqdg"><code>  <span class="code-comment">// Bind event handler</span>
</code></td></tr><tr><td id="L779" class="css-a4x74f"><span>779</span></td><td id="LC779" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">on</span>(<span class="code-params">element, events = <span class="code-string">''</span>, callback, passive = true, capture = false</span>) </span>{
</code></td></tr><tr><td id="L780" class="css-a4x74f"><span>780</span></td><td id="LC780" class="css-1dcdqdg"><code>    toggleListener.call(<span class="code-keyword">this</span>, element, events, callback, <span class="code-literal">true</span>, passive, capture);
</code></td></tr><tr><td id="L781" class="css-a4x74f"><span>781</span></td><td id="LC781" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L782" class="css-a4x74f"><span>782</span></td><td id="LC782" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L783" class="css-a4x74f"><span>783</span></td><td id="LC783" class="css-1dcdqdg"><code>  <span class="code-comment">// Unbind event handler</span>
</code></td></tr><tr><td id="L784" class="css-a4x74f"><span>784</span></td><td id="LC784" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">off</span>(<span class="code-params">element, events = <span class="code-string">''</span>, callback, passive = true, capture = false</span>) </span>{
</code></td></tr><tr><td id="L785" class="css-a4x74f"><span>785</span></td><td id="LC785" class="css-1dcdqdg"><code>    toggleListener.call(<span class="code-keyword">this</span>, element, events, callback, <span class="code-literal">false</span>, passive, capture);
</code></td></tr><tr><td id="L786" class="css-a4x74f"><span>786</span></td><td id="LC786" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L787" class="css-a4x74f"><span>787</span></td><td id="LC787" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L788" class="css-a4x74f"><span>788</span></td><td id="LC788" class="css-1dcdqdg"><code>  <span class="code-comment">// Bind once-only event handler</span>
</code></td></tr><tr><td id="L789" class="css-a4x74f"><span>789</span></td><td id="LC789" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">once</span>(<span class="code-params">element, events = <span class="code-string">''</span>, callback, passive = true, capture = false</span>) </span>{
</code></td></tr><tr><td id="L790" class="css-a4x74f"><span>790</span></td><td id="LC790" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> onceCallback = <span class="code-function">(<span class="code-params">...args</span>) =&gt;</span> {
</code></td></tr><tr><td id="L791" class="css-a4x74f"><span>791</span></td><td id="LC791" class="css-1dcdqdg"><code>      off(element, events, onceCallback, passive, capture);
</code></td></tr><tr><td id="L792" class="css-a4x74f"><span>792</span></td><td id="LC792" class="css-1dcdqdg"><code>      callback.apply(<span class="code-keyword">this</span>, args);
</code></td></tr><tr><td id="L793" class="css-a4x74f"><span>793</span></td><td id="LC793" class="css-1dcdqdg"><code>    };
</code></td></tr><tr><td id="L794" class="css-a4x74f"><span>794</span></td><td id="LC794" class="css-1dcdqdg"><code>    toggleListener.call(<span class="code-keyword">this</span>, element, events, onceCallback, <span class="code-literal">true</span>, passive, capture);
</code></td></tr><tr><td id="L795" class="css-a4x74f"><span>795</span></td><td id="LC795" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L796" class="css-a4x74f"><span>796</span></td><td id="LC796" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L797" class="css-a4x74f"><span>797</span></td><td id="LC797" class="css-1dcdqdg"><code>  <span class="code-comment">// Trigger event</span>
</code></td></tr><tr><td id="L798" class="css-a4x74f"><span>798</span></td><td id="LC798" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">triggerEvent</span>(<span class="code-params">element, type = <span class="code-string">''</span>, bubbles = false, detail = {}</span>) </span>{
</code></td></tr><tr><td id="L799" class="css-a4x74f"><span>799</span></td><td id="LC799" class="css-1dcdqdg"><code>    <span class="code-comment">// Bail if no element</span>
</code></td></tr><tr><td id="L800" class="css-a4x74f"><span>800</span></td><td id="LC800" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.element(element) || is.empty(type)) {
</code></td></tr><tr><td id="L801" class="css-a4x74f"><span>801</span></td><td id="LC801" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L802" class="css-a4x74f"><span>802</span></td><td id="LC802" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L803" class="css-a4x74f"><span>803</span></td><td id="LC803" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L804" class="css-a4x74f"><span>804</span></td><td id="LC804" class="css-1dcdqdg"><code>    <span class="code-comment">// Create and dispatch the event</span>
</code></td></tr><tr><td id="L805" class="css-a4x74f"><span>805</span></td><td id="LC805" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> event = <span class="code-keyword">new</span> CustomEvent(type, {
</code></td></tr><tr><td id="L806" class="css-a4x74f"><span>806</span></td><td id="LC806" class="css-1dcdqdg"><code>      bubbles,
</code></td></tr><tr><td id="L807" class="css-a4x74f"><span>807</span></td><td id="LC807" class="css-1dcdqdg"><code>      detail: {
</code></td></tr><tr><td id="L808" class="css-a4x74f"><span>808</span></td><td id="LC808" class="css-1dcdqdg"><code>        ...detail,
</code></td></tr><tr><td id="L809" class="css-a4x74f"><span>809</span></td><td id="LC809" class="css-1dcdqdg"><code>        plyr: <span class="code-keyword">this</span>
</code></td></tr><tr><td id="L810" class="css-a4x74f"><span>810</span></td><td id="LC810" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L811" class="css-a4x74f"><span>811</span></td><td id="LC811" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L812" class="css-a4x74f"><span>812</span></td><td id="LC812" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L813" class="css-a4x74f"><span>813</span></td><td id="LC813" class="css-1dcdqdg"><code>    <span class="code-comment">// Dispatch the event</span>
</code></td></tr><tr><td id="L814" class="css-a4x74f"><span>814</span></td><td id="LC814" class="css-1dcdqdg"><code>    element.dispatchEvent(event);
</code></td></tr><tr><td id="L815" class="css-a4x74f"><span>815</span></td><td id="LC815" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L816" class="css-a4x74f"><span>816</span></td><td id="LC816" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L817" class="css-a4x74f"><span>817</span></td><td id="LC817" class="css-1dcdqdg"><code>  <span class="code-comment">// Unbind all cached event listeners</span>
</code></td></tr><tr><td id="L818" class="css-a4x74f"><span>818</span></td><td id="LC818" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">unbindListeners</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L819" class="css-a4x74f"><span>819</span></td><td id="LC819" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-keyword">this</span> &amp;&amp; <span class="code-keyword">this</span>.eventListeners) {
</code></td></tr><tr><td id="L820" class="css-a4x74f"><span>820</span></td><td id="LC820" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.eventListeners.forEach(<span class="code-function"><span class="code-params">item</span> =&gt;</span> {
</code></td></tr><tr><td id="L821" class="css-a4x74f"><span>821</span></td><td id="LC821" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L822" class="css-a4x74f"><span>822</span></td><td id="LC822" class="css-1dcdqdg"><code>          element,
</code></td></tr><tr><td id="L823" class="css-a4x74f"><span>823</span></td><td id="LC823" class="css-1dcdqdg"><code>          type,
</code></td></tr><tr><td id="L824" class="css-a4x74f"><span>824</span></td><td id="LC824" class="css-1dcdqdg"><code>          callback,
</code></td></tr><tr><td id="L825" class="css-a4x74f"><span>825</span></td><td id="LC825" class="css-1dcdqdg"><code>          options
</code></td></tr><tr><td id="L826" class="css-a4x74f"><span>826</span></td><td id="LC826" class="css-1dcdqdg"><code>        } = item;
</code></td></tr><tr><td id="L827" class="css-a4x74f"><span>827</span></td><td id="LC827" class="css-1dcdqdg"><code>        element.removeEventListener(type, callback, options);
</code></td></tr><tr><td id="L828" class="css-a4x74f"><span>828</span></td><td id="LC828" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L829" class="css-a4x74f"><span>829</span></td><td id="LC829" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.eventListeners = [];
</code></td></tr><tr><td id="L830" class="css-a4x74f"><span>830</span></td><td id="LC830" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L831" class="css-a4x74f"><span>831</span></td><td id="LC831" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L832" class="css-a4x74f"><span>832</span></td><td id="LC832" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L833" class="css-a4x74f"><span>833</span></td><td id="LC833" class="css-1dcdqdg"><code>  <span class="code-comment">// Run method when / if player is ready</span>
</code></td></tr><tr><td id="L834" class="css-a4x74f"><span>834</span></td><td id="LC834" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">ready</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L835" class="css-a4x74f"><span>835</span></td><td id="LC835" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function"><span class="code-params">resolve</span> =&gt;</span> <span class="code-keyword">this</span>.ready ? setTimeout(resolve, <span class="code-number">0</span>) : on.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.container, <span class="code-string">'ready'</span>, resolve)).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L836" class="css-a4x74f"><span>836</span></td><td id="LC836" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L837" class="css-a4x74f"><span>837</span></td><td id="LC837" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L838" class="css-a4x74f"><span>838</span></td><td id="LC838" class="css-1dcdqdg"><code>  <span class="code-comment">/**
</span></code></td></tr><tr><td id="L839" class="css-a4x74f"><span>839</span></td><td id="LC839" class="css-1dcdqdg"><code><span class="code-comment">   * Silence a Promise-like object.
</span></code></td></tr><tr><td id="L840" class="css-a4x74f"><span>840</span></td><td id="LC840" class="css-1dcdqdg"><code><span class="code-comment">   * This is useful for avoiding non-harmful, but potentially confusing "uncaught
</span></code></td></tr><tr><td id="L841" class="css-a4x74f"><span>841</span></td><td id="LC841" class="css-1dcdqdg"><code><span class="code-comment">   * play promise" rejection error messages.
</span></code></td></tr><tr><td id="L842" class="css-a4x74f"><span>842</span></td><td id="LC842" class="css-1dcdqdg"><code><span class="code-comment">   * @param  {Object} value An object that may or may not be `Promise`-like.
</span></code></td></tr><tr><td id="L843" class="css-a4x74f"><span>843</span></td><td id="LC843" class="css-1dcdqdg"><code><span class="code-comment">   */</span>
</code></td></tr><tr><td id="L844" class="css-a4x74f"><span>844</span></td><td id="LC844" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">silencePromise</span>(<span class="code-params">value</span>) </span>{
</code></td></tr><tr><td id="L845" class="css-a4x74f"><span>845</span></td><td id="LC845" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.promise(value)) {
</code></td></tr><tr><td id="L846" class="css-a4x74f"><span>846</span></td><td id="LC846" class="css-1dcdqdg"><code>      value.then(<span class="code-literal">null</span>, () =&gt; {});
</code></td></tr><tr><td id="L847" class="css-a4x74f"><span>847</span></td><td id="LC847" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L848" class="css-a4x74f"><span>848</span></td><td id="LC848" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L849" class="css-a4x74f"><span>849</span></td><td id="LC849" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L850" class="css-a4x74f"><span>850</span></td><td id="LC850" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L851" class="css-a4x74f"><span>851</span></td><td id="LC851" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L852" class="css-a4x74f"><span>852</span></td><td id="LC852" class="css-1dcdqdg"><code>  <span class="code-comment">// Remove duplicates in an array</span>
</code></td></tr><tr><td id="L853" class="css-a4x74f"><span>853</span></td><td id="LC853" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">dedupe</span>(<span class="code-params">array</span>) </span>{
</code></td></tr><tr><td id="L854" class="css-a4x74f"><span>854</span></td><td id="LC854" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.array(array)) {
</code></td></tr><tr><td id="L855" class="css-a4x74f"><span>855</span></td><td id="LC855" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> array;
</code></td></tr><tr><td id="L856" class="css-a4x74f"><span>856</span></td><td id="LC856" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L857" class="css-a4x74f"><span>857</span></td><td id="LC857" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> array.filter(<span class="code-function">(<span class="code-params">item, index</span>) =&gt;</span> array.indexOf(item) === index);
</code></td></tr><tr><td id="L858" class="css-a4x74f"><span>858</span></td><td id="LC858" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L859" class="css-a4x74f"><span>859</span></td><td id="LC859" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L860" class="css-a4x74f"><span>860</span></td><td id="LC860" class="css-1dcdqdg"><code>  <span class="code-comment">// Get the closest value in an array</span>
</code></td></tr><tr><td id="L861" class="css-a4x74f"><span>861</span></td><td id="LC861" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">closest</span>(<span class="code-params">array, value</span>) </span>{
</code></td></tr><tr><td id="L862" class="css-a4x74f"><span>862</span></td><td id="LC862" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.array(array) || !array.length) {
</code></td></tr><tr><td id="L863" class="css-a4x74f"><span>863</span></td><td id="LC863" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L864" class="css-a4x74f"><span>864</span></td><td id="LC864" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L865" class="css-a4x74f"><span>865</span></td><td id="LC865" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> array.reduce(<span class="code-function">(<span class="code-params">prev, curr</span>) =&gt;</span> <span class="code-built_in">Math</span>.abs(curr - value) &lt; <span class="code-built_in">Math</span>.abs(prev - value) ? curr : prev);
</code></td></tr><tr><td id="L866" class="css-a4x74f"><span>866</span></td><td id="LC866" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L867" class="css-a4x74f"><span>867</span></td><td id="LC867" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L868" class="css-a4x74f"><span>868</span></td><td id="LC868" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L869" class="css-a4x74f"><span>869</span></td><td id="LC869" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L870" class="css-a4x74f"><span>870</span></td><td id="LC870" class="css-1dcdqdg"><code>  <span class="code-comment">// Check support for a CSS declaration</span>
</code></td></tr><tr><td id="L871" class="css-a4x74f"><span>871</span></td><td id="LC871" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">supportsCSS</span>(<span class="code-params">declaration</span>) </span>{
</code></td></tr><tr><td id="L872" class="css-a4x74f"><span>872</span></td><td id="LC872" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!<span class="code-built_in">window</span> || !<span class="code-built_in">window</span>.CSS) {
</code></td></tr><tr><td id="L873" class="css-a4x74f"><span>873</span></td><td id="LC873" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L874" class="css-a4x74f"><span>874</span></td><td id="LC874" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L875" class="css-a4x74f"><span>875</span></td><td id="LC875" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-built_in">window</span>.CSS.supports(declaration);
</code></td></tr><tr><td id="L876" class="css-a4x74f"><span>876</span></td><td id="LC876" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L877" class="css-a4x74f"><span>877</span></td><td id="LC877" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L878" class="css-a4x74f"><span>878</span></td><td id="LC878" class="css-1dcdqdg"><code>  <span class="code-comment">// Standard/common aspect ratios</span>
</code></td></tr><tr><td id="L879" class="css-a4x74f"><span>879</span></td><td id="LC879" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> standardRatios = [[<span class="code-number">1</span>, <span class="code-number">1</span>], [<span class="code-number">4</span>, <span class="code-number">3</span>], [<span class="code-number">3</span>, <span class="code-number">4</span>], [<span class="code-number">5</span>, <span class="code-number">4</span>], [<span class="code-number">4</span>, <span class="code-number">5</span>], [<span class="code-number">3</span>, <span class="code-number">2</span>], [<span class="code-number">2</span>, <span class="code-number">3</span>], [<span class="code-number">16</span>, <span class="code-number">10</span>], [<span class="code-number">10</span>, <span class="code-number">16</span>], [<span class="code-number">16</span>, <span class="code-number">9</span>], [<span class="code-number">9</span>, <span class="code-number">16</span>], [<span class="code-number">21</span>, <span class="code-number">9</span>], [<span class="code-number">9</span>, <span class="code-number">21</span>], [<span class="code-number">32</span>, <span class="code-number">9</span>], [<span class="code-number">9</span>, <span class="code-number">32</span>]].reduce(<span class="code-function">(<span class="code-params">out, [x, y]</span>) =&gt;</span> ({
</code></td></tr><tr><td id="L880" class="css-a4x74f"><span>880</span></td><td id="LC880" class="css-1dcdqdg"><code>    ...out,
</code></td></tr><tr><td id="L881" class="css-a4x74f"><span>881</span></td><td id="LC881" class="css-1dcdqdg"><code>    [x / y]: [x, y]
</code></td></tr><tr><td id="L882" class="css-a4x74f"><span>882</span></td><td id="LC882" class="css-1dcdqdg"><code>  }), {});
</code></td></tr><tr><td id="L883" class="css-a4x74f"><span>883</span></td><td id="LC883" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L884" class="css-a4x74f"><span>884</span></td><td id="LC884" class="css-1dcdqdg"><code>  <span class="code-comment">// Validate an aspect ratio</span>
</code></td></tr><tr><td id="L885" class="css-a4x74f"><span>885</span></td><td id="LC885" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">validateAspectRatio</span>(<span class="code-params">input</span>) </span>{
</code></td></tr><tr><td id="L886" class="css-a4x74f"><span>886</span></td><td id="LC886" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.array(input) &amp;&amp; (!is.string(input) || !input.includes(<span class="code-string">':'</span>))) {
</code></td></tr><tr><td id="L887" class="css-a4x74f"><span>887</span></td><td id="LC887" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L888" class="css-a4x74f"><span>888</span></td><td id="LC888" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L889" class="css-a4x74f"><span>889</span></td><td id="LC889" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> ratio = is.array(input) ? input : input.split(<span class="code-string">':'</span>);
</code></td></tr><tr><td id="L890" class="css-a4x74f"><span>890</span></td><td id="LC890" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> ratio.map(<span class="code-built_in">Number</span>).every(is.number);
</code></td></tr><tr><td id="L891" class="css-a4x74f"><span>891</span></td><td id="LC891" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L892" class="css-a4x74f"><span>892</span></td><td id="LC892" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L893" class="css-a4x74f"><span>893</span></td><td id="LC893" class="css-1dcdqdg"><code>  <span class="code-comment">// Reduce an aspect ratio to it's lowest form</span>
</code></td></tr><tr><td id="L894" class="css-a4x74f"><span>894</span></td><td id="LC894" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">reduceAspectRatio</span>(<span class="code-params">ratio</span>) </span>{
</code></td></tr><tr><td id="L895" class="css-a4x74f"><span>895</span></td><td id="LC895" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.array(ratio) || !ratio.every(is.number)) {
</code></td></tr><tr><td id="L896" class="css-a4x74f"><span>896</span></td><td id="LC896" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L897" class="css-a4x74f"><span>897</span></td><td id="LC897" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L898" class="css-a4x74f"><span>898</span></td><td id="LC898" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> [width, height] = ratio;
</code></td></tr><tr><td id="L899" class="css-a4x74f"><span>899</span></td><td id="LC899" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> getDivider = <span class="code-function">(<span class="code-params">w, h</span>) =&gt;</span> h === <span class="code-number">0</span> ? w : getDivider(h, w % h);
</code></td></tr><tr><td id="L900" class="css-a4x74f"><span>900</span></td><td id="LC900" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> divider = getDivider(width, height);
</code></td></tr><tr><td id="L901" class="css-a4x74f"><span>901</span></td><td id="LC901" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> [width / divider, height / divider];
</code></td></tr><tr><td id="L902" class="css-a4x74f"><span>902</span></td><td id="LC902" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L903" class="css-a4x74f"><span>903</span></td><td id="LC903" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L904" class="css-a4x74f"><span>904</span></td><td id="LC904" class="css-1dcdqdg"><code>  <span class="code-comment">// Calculate an aspect ratio</span>
</code></td></tr><tr><td id="L905" class="css-a4x74f"><span>905</span></td><td id="LC905" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getAspectRatio</span>(<span class="code-params">input</span>) </span>{
</code></td></tr><tr><td id="L906" class="css-a4x74f"><span>906</span></td><td id="LC906" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> parse = <span class="code-function"><span class="code-params">ratio</span> =&gt;</span> validateAspectRatio(ratio) ? ratio.split(<span class="code-string">':'</span>).map(<span class="code-built_in">Number</span>) : <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L907" class="css-a4x74f"><span>907</span></td><td id="LC907" class="css-1dcdqdg"><code>    <span class="code-comment">// Try provided ratio</span>
</code></td></tr><tr><td id="L908" class="css-a4x74f"><span>908</span></td><td id="LC908" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> ratio = parse(input);
</code></td></tr><tr><td id="L909" class="css-a4x74f"><span>909</span></td><td id="LC909" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L910" class="css-a4x74f"><span>910</span></td><td id="LC910" class="css-1dcdqdg"><code>    <span class="code-comment">// Get from config</span>
</code></td></tr><tr><td id="L911" class="css-a4x74f"><span>911</span></td><td id="LC911" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (ratio === <span class="code-literal">null</span>) {
</code></td></tr><tr><td id="L912" class="css-a4x74f"><span>912</span></td><td id="LC912" class="css-1dcdqdg"><code>      ratio = parse(<span class="code-keyword">this</span>.config.ratio);
</code></td></tr><tr><td id="L913" class="css-a4x74f"><span>913</span></td><td id="LC913" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L914" class="css-a4x74f"><span>914</span></td><td id="LC914" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L915" class="css-a4x74f"><span>915</span></td><td id="LC915" class="css-1dcdqdg"><code>    <span class="code-comment">// Get from embed</span>
</code></td></tr><tr><td id="L916" class="css-a4x74f"><span>916</span></td><td id="LC916" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (ratio === <span class="code-literal">null</span> &amp;&amp; !is.empty(<span class="code-keyword">this</span>.embed) &amp;&amp; is.array(<span class="code-keyword">this</span>.embed.ratio)) {
</code></td></tr><tr><td id="L917" class="css-a4x74f"><span>917</span></td><td id="LC917" class="css-1dcdqdg"><code>      ({
</code></td></tr><tr><td id="L918" class="css-a4x74f"><span>918</span></td><td id="LC918" class="css-1dcdqdg"><code>        ratio
</code></td></tr><tr><td id="L919" class="css-a4x74f"><span>919</span></td><td id="LC919" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.embed);
</code></td></tr><tr><td id="L920" class="css-a4x74f"><span>920</span></td><td id="LC920" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L921" class="css-a4x74f"><span>921</span></td><td id="LC921" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L922" class="css-a4x74f"><span>922</span></td><td id="LC922" class="css-1dcdqdg"><code>    <span class="code-comment">// Get from HTML5 video</span>
</code></td></tr><tr><td id="L923" class="css-a4x74f"><span>923</span></td><td id="LC923" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (ratio === <span class="code-literal">null</span> &amp;&amp; <span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L924" class="css-a4x74f"><span>924</span></td><td id="LC924" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L925" class="css-a4x74f"><span>925</span></td><td id="LC925" class="css-1dcdqdg"><code>        videoWidth,
</code></td></tr><tr><td id="L926" class="css-a4x74f"><span>926</span></td><td id="LC926" class="css-1dcdqdg"><code>        videoHeight
</code></td></tr><tr><td id="L927" class="css-a4x74f"><span>927</span></td><td id="LC927" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.media;
</code></td></tr><tr><td id="L928" class="css-a4x74f"><span>928</span></td><td id="LC928" class="css-1dcdqdg"><code>      ratio = [videoWidth, videoHeight];
</code></td></tr><tr><td id="L929" class="css-a4x74f"><span>929</span></td><td id="LC929" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L930" class="css-a4x74f"><span>930</span></td><td id="LC930" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> reduceAspectRatio(ratio);
</code></td></tr><tr><td id="L931" class="css-a4x74f"><span>931</span></td><td id="LC931" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L932" class="css-a4x74f"><span>932</span></td><td id="LC932" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L933" class="css-a4x74f"><span>933</span></td><td id="LC933" class="css-1dcdqdg"><code>  <span class="code-comment">// Set aspect ratio for responsive container</span>
</code></td></tr><tr><td id="L934" class="css-a4x74f"><span>934</span></td><td id="LC934" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">setAspectRatio</span>(<span class="code-params">input</span>) </span>{
</code></td></tr><tr><td id="L935" class="css-a4x74f"><span>935</span></td><td id="LC935" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L936" class="css-a4x74f"><span>936</span></td><td id="LC936" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> {};
</code></td></tr><tr><td id="L937" class="css-a4x74f"><span>937</span></td><td id="LC937" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L938" class="css-a4x74f"><span>938</span></td><td id="LC938" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L939" class="css-a4x74f"><span>939</span></td><td id="LC939" class="css-1dcdqdg"><code>      wrapper
</code></td></tr><tr><td id="L940" class="css-a4x74f"><span>940</span></td><td id="LC940" class="css-1dcdqdg"><code>    } = <span class="code-keyword">this</span>.elements;
</code></td></tr><tr><td id="L941" class="css-a4x74f"><span>941</span></td><td id="LC941" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> ratio = getAspectRatio.call(<span class="code-keyword">this</span>, input);
</code></td></tr><tr><td id="L942" class="css-a4x74f"><span>942</span></td><td id="LC942" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.array(ratio)) {
</code></td></tr><tr><td id="L943" class="css-a4x74f"><span>943</span></td><td id="LC943" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> {};
</code></td></tr><tr><td id="L944" class="css-a4x74f"><span>944</span></td><td id="LC944" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L945" class="css-a4x74f"><span>945</span></td><td id="LC945" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> [x, y] = reduceAspectRatio(ratio);
</code></td></tr><tr><td id="L946" class="css-a4x74f"><span>946</span></td><td id="LC946" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> useNative = supportsCSS(<span class="code-string">`aspect-ratio: <span class="code-subst">${x}</span>/<span class="code-subst">${y}</span>`</span>);
</code></td></tr><tr><td id="L947" class="css-a4x74f"><span>947</span></td><td id="LC947" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> padding = <span class="code-number">100</span> / x * y;
</code></td></tr><tr><td id="L948" class="css-a4x74f"><span>948</span></td><td id="LC948" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (useNative) {
</code></td></tr><tr><td id="L949" class="css-a4x74f"><span>949</span></td><td id="LC949" class="css-1dcdqdg"><code>      wrapper.style.aspectRatio = <span class="code-string">`<span class="code-subst">${x}</span>/<span class="code-subst">${y}</span>`</span>;
</code></td></tr><tr><td id="L950" class="css-a4x74f"><span>950</span></td><td id="LC950" class="css-1dcdqdg"><code>    } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L951" class="css-a4x74f"><span>951</span></td><td id="LC951" class="css-1dcdqdg"><code>      wrapper.style.paddingBottom = <span class="code-string">`<span class="code-subst">${padding}</span>%`</span>;
</code></td></tr><tr><td id="L952" class="css-a4x74f"><span>952</span></td><td id="LC952" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L953" class="css-a4x74f"><span>953</span></td><td id="LC953" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L954" class="css-a4x74f"><span>954</span></td><td id="LC954" class="css-1dcdqdg"><code>    <span class="code-comment">// For Vimeo we have an extra &lt;div&gt; to hide the standard controls and UI</span>
</code></td></tr><tr><td id="L955" class="css-a4x74f"><span>955</span></td><td id="LC955" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo &amp;&amp; !<span class="code-keyword">this</span>.config.vimeo.premium &amp;&amp; <span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L956" class="css-a4x74f"><span>956</span></td><td id="LC956" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> height = <span class="code-number">100</span> / <span class="code-keyword">this</span>.media.offsetWidth * <span class="code-built_in">parseInt</span>(<span class="code-built_in">window</span>.getComputedStyle(<span class="code-keyword">this</span>.media).paddingBottom, <span class="code-number">10</span>);
</code></td></tr><tr><td id="L957" class="css-a4x74f"><span>957</span></td><td id="LC957" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> offset = (height - padding) / (height / <span class="code-number">50</span>);
</code></td></tr><tr><td id="L958" class="css-a4x74f"><span>958</span></td><td id="LC958" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.fullscreen.active) {
</code></td></tr><tr><td id="L959" class="css-a4x74f"><span>959</span></td><td id="LC959" class="css-1dcdqdg"><code>        wrapper.style.paddingBottom = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L960" class="css-a4x74f"><span>960</span></td><td id="LC960" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L961" class="css-a4x74f"><span>961</span></td><td id="LC961" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.style.transform = <span class="code-string">`translateY(-<span class="code-subst">${offset}</span>%)`</span>;
</code></td></tr><tr><td id="L962" class="css-a4x74f"><span>962</span></td><td id="LC962" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L963" class="css-a4x74f"><span>963</span></td><td id="LC963" class="css-1dcdqdg"><code>    } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L964" class="css-a4x74f"><span>964</span></td><td id="LC964" class="css-1dcdqdg"><code>      wrapper.classList.add(<span class="code-keyword">this</span>.config.classNames.videoFixedRatio);
</code></td></tr><tr><td id="L965" class="css-a4x74f"><span>965</span></td><td id="LC965" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L966" class="css-a4x74f"><span>966</span></td><td id="LC966" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> {
</code></td></tr><tr><td id="L967" class="css-a4x74f"><span>967</span></td><td id="LC967" class="css-1dcdqdg"><code>      padding,
</code></td></tr><tr><td id="L968" class="css-a4x74f"><span>968</span></td><td id="LC968" class="css-1dcdqdg"><code>      ratio
</code></td></tr><tr><td id="L969" class="css-a4x74f"><span>969</span></td><td id="LC969" class="css-1dcdqdg"><code>    };
</code></td></tr><tr><td id="L970" class="css-a4x74f"><span>970</span></td><td id="LC970" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L971" class="css-a4x74f"><span>971</span></td><td id="LC971" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L972" class="css-a4x74f"><span>972</span></td><td id="LC972" class="css-1dcdqdg"><code>  <span class="code-comment">// Round an aspect ratio to closest standard ratio</span>
</code></td></tr><tr><td id="L973" class="css-a4x74f"><span>973</span></td><td id="LC973" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">roundAspectRatio</span>(<span class="code-params">x, y, tolerance = <span class="code-number">0.05</span></span>) </span>{
</code></td></tr><tr><td id="L974" class="css-a4x74f"><span>974</span></td><td id="LC974" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> ratio = x / y;
</code></td></tr><tr><td id="L975" class="css-a4x74f"><span>975</span></td><td id="LC975" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> closestRatio = closest(<span class="code-built_in">Object</span>.keys(standardRatios), ratio);
</code></td></tr><tr><td id="L976" class="css-a4x74f"><span>976</span></td><td id="LC976" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L977" class="css-a4x74f"><span>977</span></td><td id="LC977" class="css-1dcdqdg"><code>    <span class="code-comment">// Check match is within tolerance</span>
</code></td></tr><tr><td id="L978" class="css-a4x74f"><span>978</span></td><td id="LC978" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-built_in">Math</span>.abs(closestRatio - ratio) &lt;= tolerance) {
</code></td></tr><tr><td id="L979" class="css-a4x74f"><span>979</span></td><td id="LC979" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> standardRatios[closestRatio];
</code></td></tr><tr><td id="L980" class="css-a4x74f"><span>980</span></td><td id="LC980" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L981" class="css-a4x74f"><span>981</span></td><td id="LC981" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L982" class="css-a4x74f"><span>982</span></td><td id="LC982" class="css-1dcdqdg"><code>    <span class="code-comment">// No match</span>
</code></td></tr><tr><td id="L983" class="css-a4x74f"><span>983</span></td><td id="LC983" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> [x, y];
</code></td></tr><tr><td id="L984" class="css-a4x74f"><span>984</span></td><td id="LC984" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L985" class="css-a4x74f"><span>985</span></td><td id="LC985" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L986" class="css-a4x74f"><span>986</span></td><td id="LC986" class="css-1dcdqdg"><code>  <span class="code-comment">// Get the size of the viewport</span>
</code></td></tr><tr><td id="L987" class="css-a4x74f"><span>987</span></td><td id="LC987" class="css-1dcdqdg"><code>  <span class="code-comment">// https://stackoverflow.com/questions/1248081/how-to-get-the-browser-viewport-dimensions</span>
</code></td></tr><tr><td id="L988" class="css-a4x74f"><span>988</span></td><td id="LC988" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getViewportSize</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L989" class="css-a4x74f"><span>989</span></td><td id="LC989" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> width = <span class="code-built_in">Math</span>.max(<span class="code-built_in">document</span>.documentElement.clientWidth || <span class="code-number">0</span>, <span class="code-built_in">window</span>.innerWidth || <span class="code-number">0</span>);
</code></td></tr><tr><td id="L990" class="css-a4x74f"><span>990</span></td><td id="LC990" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> height = <span class="code-built_in">Math</span>.max(<span class="code-built_in">document</span>.documentElement.clientHeight || <span class="code-number">0</span>, <span class="code-built_in">window</span>.innerHeight || <span class="code-number">0</span>);
</code></td></tr><tr><td id="L991" class="css-a4x74f"><span>991</span></td><td id="LC991" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> [width, height];
</code></td></tr><tr><td id="L992" class="css-a4x74f"><span>992</span></td><td id="LC992" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L993" class="css-a4x74f"><span>993</span></td><td id="LC993" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L994" class="css-a4x74f"><span>994</span></td><td id="LC994" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L995" class="css-a4x74f"><span>995</span></td><td id="LC995" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> html5 = {
</code></td></tr><tr><td id="L996" class="css-a4x74f"><span>996</span></td><td id="LC996" class="css-1dcdqdg"><code>    getSources() {
</code></td></tr><tr><td id="L997" class="css-a4x74f"><span>997</span></td><td id="LC997" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L998" class="css-a4x74f"><span>998</span></td><td id="LC998" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> [];
</code></td></tr><tr><td id="L999" class="css-a4x74f"><span>999</span></td><td id="LC999" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1000" class="css-a4x74f"><span>1000</span></td><td id="LC1000" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> sources = <span class="code-built_in">Array</span>.from(<span class="code-keyword">this</span>.media.querySelectorAll(<span class="code-string">'source'</span>));
</code></td></tr><tr><td id="L1001" class="css-a4x74f"><span>1001</span></td><td id="LC1001" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1002" class="css-a4x74f"><span>1002</span></td><td id="LC1002" class="css-1dcdqdg"><code>      <span class="code-comment">// Filter out unsupported sources (if type is specified)</span>
</code></td></tr><tr><td id="L1003" class="css-a4x74f"><span>1003</span></td><td id="LC1003" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> sources.filter(<span class="code-function"><span class="code-params">source</span> =&gt;</span> {
</code></td></tr><tr><td id="L1004" class="css-a4x74f"><span>1004</span></td><td id="LC1004" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> type = source.getAttribute(<span class="code-string">'type'</span>);
</code></td></tr><tr><td id="L1005" class="css-a4x74f"><span>1005</span></td><td id="LC1005" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.empty(type)) {
</code></td></tr><tr><td id="L1006" class="css-a4x74f"><span>1006</span></td><td id="LC1006" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1007" class="css-a4x74f"><span>1007</span></td><td id="LC1007" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1008" class="css-a4x74f"><span>1008</span></td><td id="LC1008" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> support.mime.call(<span class="code-keyword">this</span>, type);
</code></td></tr><tr><td id="L1009" class="css-a4x74f"><span>1009</span></td><td id="LC1009" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1010" class="css-a4x74f"><span>1010</span></td><td id="LC1010" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1011" class="css-a4x74f"><span>1011</span></td><td id="LC1011" class="css-1dcdqdg"><code>    <span class="code-comment">// Get quality levels</span>
</code></td></tr><tr><td id="L1012" class="css-a4x74f"><span>1012</span></td><td id="LC1012" class="css-1dcdqdg"><code>    getQualityOptions() {
</code></td></tr><tr><td id="L1013" class="css-a4x74f"><span>1013</span></td><td id="LC1013" class="css-1dcdqdg"><code>      <span class="code-comment">// Whether we're forcing all options (e.g. for streaming)</span>
</code></td></tr><tr><td id="L1014" class="css-a4x74f"><span>1014</span></td><td id="LC1014" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.quality.forced) {
</code></td></tr><tr><td id="L1015" class="css-a4x74f"><span>1015</span></td><td id="LC1015" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.config.quality.options;
</code></td></tr><tr><td id="L1016" class="css-a4x74f"><span>1016</span></td><td id="LC1016" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1017" class="css-a4x74f"><span>1017</span></td><td id="LC1017" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1018" class="css-a4x74f"><span>1018</span></td><td id="LC1018" class="css-1dcdqdg"><code>      <span class="code-comment">// Get sizes from &lt;source&gt; elements</span>
</code></td></tr><tr><td id="L1019" class="css-a4x74f"><span>1019</span></td><td id="LC1019" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> html5.getSources.call(<span class="code-keyword">this</span>).map(<span class="code-function"><span class="code-params">source</span> =&gt;</span> <span class="code-built_in">Number</span>(source.getAttribute(<span class="code-string">'size'</span>))).filter(<span class="code-built_in">Boolean</span>);
</code></td></tr><tr><td id="L1020" class="css-a4x74f"><span>1020</span></td><td id="LC1020" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1021" class="css-a4x74f"><span>1021</span></td><td id="LC1021" class="css-1dcdqdg"><code>    setup() {
</code></td></tr><tr><td id="L1022" class="css-a4x74f"><span>1022</span></td><td id="LC1022" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L1023" class="css-a4x74f"><span>1023</span></td><td id="LC1023" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1024" class="css-a4x74f"><span>1024</span></td><td id="LC1024" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1025" class="css-a4x74f"><span>1025</span></td><td id="LC1025" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> player = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L1026" class="css-a4x74f"><span>1026</span></td><td id="LC1026" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1027" class="css-a4x74f"><span>1027</span></td><td id="LC1027" class="css-1dcdqdg"><code>      <span class="code-comment">// Set speed options from config</span>
</code></td></tr><tr><td id="L1028" class="css-a4x74f"><span>1028</span></td><td id="LC1028" class="css-1dcdqdg"><code>      player.options.speed = player.config.speed.options;
</code></td></tr><tr><td id="L1029" class="css-a4x74f"><span>1029</span></td><td id="LC1029" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1030" class="css-a4x74f"><span>1030</span></td><td id="LC1030" class="css-1dcdqdg"><code>      <span class="code-comment">// Set aspect ratio if fixed</span>
</code></td></tr><tr><td id="L1031" class="css-a4x74f"><span>1031</span></td><td id="LC1031" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.config.ratio)) {
</code></td></tr><tr><td id="L1032" class="css-a4x74f"><span>1032</span></td><td id="LC1032" class="css-1dcdqdg"><code>        setAspectRatio.call(player);
</code></td></tr><tr><td id="L1033" class="css-a4x74f"><span>1033</span></td><td id="LC1033" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1034" class="css-a4x74f"><span>1034</span></td><td id="LC1034" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1035" class="css-a4x74f"><span>1035</span></td><td id="LC1035" class="css-1dcdqdg"><code>      <span class="code-comment">// Quality</span>
</code></td></tr><tr><td id="L1036" class="css-a4x74f"><span>1036</span></td><td id="LC1036" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'quality'</span>, {
</code></td></tr><tr><td id="L1037" class="css-a4x74f"><span>1037</span></td><td id="LC1037" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L1038" class="css-a4x74f"><span>1038</span></td><td id="LC1038" class="css-1dcdqdg"><code>          <span class="code-comment">// Get sources</span>
</code></td></tr><tr><td id="L1039" class="css-a4x74f"><span>1039</span></td><td id="LC1039" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> sources = html5.getSources.call(player);
</code></td></tr><tr><td id="L1040" class="css-a4x74f"><span>1040</span></td><td id="LC1040" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> source = sources.find(<span class="code-function"><span class="code-params">s</span> =&gt;</span> s.getAttribute(<span class="code-string">'src'</span>) === player.source);
</code></td></tr><tr><td id="L1041" class="css-a4x74f"><span>1041</span></td><td id="LC1041" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1042" class="css-a4x74f"><span>1042</span></td><td id="LC1042" class="css-1dcdqdg"><code>          <span class="code-comment">// Return size, if match is found</span>
</code></td></tr><tr><td id="L1043" class="css-a4x74f"><span>1043</span></td><td id="LC1043" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> source &amp;&amp; <span class="code-built_in">Number</span>(source.getAttribute(<span class="code-string">'size'</span>));
</code></td></tr><tr><td id="L1044" class="css-a4x74f"><span>1044</span></td><td id="LC1044" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L1045" class="css-a4x74f"><span>1045</span></td><td id="LC1045" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L1046" class="css-a4x74f"><span>1046</span></td><td id="LC1046" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (player.quality === input) {
</code></td></tr><tr><td id="L1047" class="css-a4x74f"><span>1047</span></td><td id="LC1047" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1048" class="css-a4x74f"><span>1048</span></td><td id="LC1048" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1049" class="css-a4x74f"><span>1049</span></td><td id="LC1049" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1050" class="css-a4x74f"><span>1050</span></td><td id="LC1050" class="css-1dcdqdg"><code>          <span class="code-comment">// If we're using an external handler...</span>
</code></td></tr><tr><td id="L1051" class="css-a4x74f"><span>1051</span></td><td id="LC1051" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (player.config.quality.forced &amp;&amp; is.function(player.config.quality.onChange)) {
</code></td></tr><tr><td id="L1052" class="css-a4x74f"><span>1052</span></td><td id="LC1052" class="css-1dcdqdg"><code>            player.config.quality.onChange(input);
</code></td></tr><tr><td id="L1053" class="css-a4x74f"><span>1053</span></td><td id="LC1053" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1054" class="css-a4x74f"><span>1054</span></td><td id="LC1054" class="css-1dcdqdg"><code>            <span class="code-comment">// Get sources</span>
</code></td></tr><tr><td id="L1055" class="css-a4x74f"><span>1055</span></td><td id="LC1055" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> sources = html5.getSources.call(player);
</code></td></tr><tr><td id="L1056" class="css-a4x74f"><span>1056</span></td><td id="LC1056" class="css-1dcdqdg"><code>            <span class="code-comment">// Get first match for requested size</span>
</code></td></tr><tr><td id="L1057" class="css-a4x74f"><span>1057</span></td><td id="LC1057" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> source = sources.find(<span class="code-function"><span class="code-params">s</span> =&gt;</span> <span class="code-built_in">Number</span>(s.getAttribute(<span class="code-string">'size'</span>)) === input);
</code></td></tr><tr><td id="L1058" class="css-a4x74f"><span>1058</span></td><td id="LC1058" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1059" class="css-a4x74f"><span>1059</span></td><td id="LC1059" class="css-1dcdqdg"><code>            <span class="code-comment">// No matching source found</span>
</code></td></tr><tr><td id="L1060" class="css-a4x74f"><span>1060</span></td><td id="LC1060" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!source) {
</code></td></tr><tr><td id="L1061" class="css-a4x74f"><span>1061</span></td><td id="LC1061" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1062" class="css-a4x74f"><span>1062</span></td><td id="LC1062" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L1063" class="css-a4x74f"><span>1063</span></td><td id="LC1063" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1064" class="css-a4x74f"><span>1064</span></td><td id="LC1064" class="css-1dcdqdg"><code>            <span class="code-comment">// Get current state</span>
</code></td></tr><tr><td id="L1065" class="css-a4x74f"><span>1065</span></td><td id="LC1065" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L1066" class="css-a4x74f"><span>1066</span></td><td id="LC1066" class="css-1dcdqdg"><code>              currentTime,
</code></td></tr><tr><td id="L1067" class="css-a4x74f"><span>1067</span></td><td id="LC1067" class="css-1dcdqdg"><code>              paused,
</code></td></tr><tr><td id="L1068" class="css-a4x74f"><span>1068</span></td><td id="LC1068" class="css-1dcdqdg"><code>              preload,
</code></td></tr><tr><td id="L1069" class="css-a4x74f"><span>1069</span></td><td id="LC1069" class="css-1dcdqdg"><code>              readyState,
</code></td></tr><tr><td id="L1070" class="css-a4x74f"><span>1070</span></td><td id="LC1070" class="css-1dcdqdg"><code>              playbackRate
</code></td></tr><tr><td id="L1071" class="css-a4x74f"><span>1071</span></td><td id="LC1071" class="css-1dcdqdg"><code>            } = player.media;
</code></td></tr><tr><td id="L1072" class="css-a4x74f"><span>1072</span></td><td id="LC1072" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1073" class="css-a4x74f"><span>1073</span></td><td id="LC1073" class="css-1dcdqdg"><code>            <span class="code-comment">// Set new source</span>
</code></td></tr><tr><td id="L1074" class="css-a4x74f"><span>1074</span></td><td id="LC1074" class="css-1dcdqdg"><code>            player.media.src = source.getAttribute(<span class="code-string">'src'</span>);
</code></td></tr><tr><td id="L1075" class="css-a4x74f"><span>1075</span></td><td id="LC1075" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1076" class="css-a4x74f"><span>1076</span></td><td id="LC1076" class="css-1dcdqdg"><code>            <span class="code-comment">// Prevent loading if preload="none" and the current source isn't loaded (#1044)</span>
</code></td></tr><tr><td id="L1077" class="css-a4x74f"><span>1077</span></td><td id="LC1077" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (preload !== <span class="code-string">'none'</span> || readyState) {
</code></td></tr><tr><td id="L1078" class="css-a4x74f"><span>1078</span></td><td id="LC1078" class="css-1dcdqdg"><code>              <span class="code-comment">// Restore time</span>
</code></td></tr><tr><td id="L1079" class="css-a4x74f"><span>1079</span></td><td id="LC1079" class="css-1dcdqdg"><code>              player.once(<span class="code-string">'loadedmetadata'</span>, () =&gt; {
</code></td></tr><tr><td id="L1080" class="css-a4x74f"><span>1080</span></td><td id="LC1080" class="css-1dcdqdg"><code>                player.speed = playbackRate;
</code></td></tr><tr><td id="L1081" class="css-a4x74f"><span>1081</span></td><td id="LC1081" class="css-1dcdqdg"><code>                player.currentTime = currentTime;
</code></td></tr><tr><td id="L1082" class="css-a4x74f"><span>1082</span></td><td id="LC1082" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1083" class="css-a4x74f"><span>1083</span></td><td id="LC1083" class="css-1dcdqdg"><code>                <span class="code-comment">// Resume playing</span>
</code></td></tr><tr><td id="L1084" class="css-a4x74f"><span>1084</span></td><td id="LC1084" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (!paused) {
</code></td></tr><tr><td id="L1085" class="css-a4x74f"><span>1085</span></td><td id="LC1085" class="css-1dcdqdg"><code>                  silencePromise(player.play());
</code></td></tr><tr><td id="L1086" class="css-a4x74f"><span>1086</span></td><td id="LC1086" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L1087" class="css-a4x74f"><span>1087</span></td><td id="LC1087" class="css-1dcdqdg"><code>              });
</code></td></tr><tr><td id="L1088" class="css-a4x74f"><span>1088</span></td><td id="LC1088" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1089" class="css-a4x74f"><span>1089</span></td><td id="LC1089" class="css-1dcdqdg"><code>              <span class="code-comment">// Load new source</span>
</code></td></tr><tr><td id="L1090" class="css-a4x74f"><span>1090</span></td><td id="LC1090" class="css-1dcdqdg"><code>              player.media.load();
</code></td></tr><tr><td id="L1091" class="css-a4x74f"><span>1091</span></td><td id="LC1091" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L1092" class="css-a4x74f"><span>1092</span></td><td id="LC1092" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1093" class="css-a4x74f"><span>1093</span></td><td id="LC1093" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1094" class="css-a4x74f"><span>1094</span></td><td id="LC1094" class="css-1dcdqdg"><code>          <span class="code-comment">// Trigger change event</span>
</code></td></tr><tr><td id="L1095" class="css-a4x74f"><span>1095</span></td><td id="LC1095" class="css-1dcdqdg"><code>          triggerEvent.call(player, player.media, <span class="code-string">'qualitychange'</span>, <span class="code-literal">false</span>, {
</code></td></tr><tr><td id="L1096" class="css-a4x74f"><span>1096</span></td><td id="LC1096" class="css-1dcdqdg"><code>            quality: input
</code></td></tr><tr><td id="L1097" class="css-a4x74f"><span>1097</span></td><td id="LC1097" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L1098" class="css-a4x74f"><span>1098</span></td><td id="LC1098" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1099" class="css-a4x74f"><span>1099</span></td><td id="LC1099" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1100" class="css-a4x74f"><span>1100</span></td><td id="LC1100" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1101" class="css-a4x74f"><span>1101</span></td><td id="LC1101" class="css-1dcdqdg"><code>    <span class="code-comment">// Cancel current network requests</span>
</code></td></tr><tr><td id="L1102" class="css-a4x74f"><span>1102</span></td><td id="LC1102" class="css-1dcdqdg"><code>    <span class="code-comment">// See https://github.com/sampotts/plyr/issues/174</span>
</code></td></tr><tr><td id="L1103" class="css-a4x74f"><span>1103</span></td><td id="LC1103" class="css-1dcdqdg"><code>    cancelRequests() {
</code></td></tr><tr><td id="L1104" class="css-a4x74f"><span>1104</span></td><td id="LC1104" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L1105" class="css-a4x74f"><span>1105</span></td><td id="LC1105" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1106" class="css-a4x74f"><span>1106</span></td><td id="LC1106" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1107" class="css-a4x74f"><span>1107</span></td><td id="LC1107" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1108" class="css-a4x74f"><span>1108</span></td><td id="LC1108" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove child sources</span>
</code></td></tr><tr><td id="L1109" class="css-a4x74f"><span>1109</span></td><td id="LC1109" class="css-1dcdqdg"><code>      removeElement(html5.getSources.call(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L1110" class="css-a4x74f"><span>1110</span></td><td id="LC1110" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1111" class="css-a4x74f"><span>1111</span></td><td id="LC1111" class="css-1dcdqdg"><code>      <span class="code-comment">// Set blank video src attribute</span>
</code></td></tr><tr><td id="L1112" class="css-a4x74f"><span>1112</span></td><td id="LC1112" class="css-1dcdqdg"><code>      <span class="code-comment">// This is to prevent a MEDIA_ERR_SRC_NOT_SUPPORTED error</span>
</code></td></tr><tr><td id="L1113" class="css-a4x74f"><span>1113</span></td><td id="LC1113" class="css-1dcdqdg"><code>      <span class="code-comment">// Info: http://stackoverflow.com/questions/32231579/how-to-properly-dispose-of-an-html5-video-and-close-socket-or-connection</span>
</code></td></tr><tr><td id="L1114" class="css-a4x74f"><span>1114</span></td><td id="LC1114" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'src'</span>, <span class="code-keyword">this</span>.config.blankVideo);
</code></td></tr><tr><td id="L1115" class="css-a4x74f"><span>1115</span></td><td id="LC1115" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1116" class="css-a4x74f"><span>1116</span></td><td id="LC1116" class="css-1dcdqdg"><code>      <span class="code-comment">// Load the new empty source</span>
</code></td></tr><tr><td id="L1117" class="css-a4x74f"><span>1117</span></td><td id="LC1117" class="css-1dcdqdg"><code>      <span class="code-comment">// This will cancel existing requests</span>
</code></td></tr><tr><td id="L1118" class="css-a4x74f"><span>1118</span></td><td id="LC1118" class="css-1dcdqdg"><code>      <span class="code-comment">// See https://github.com/sampotts/plyr/issues/174</span>
</code></td></tr><tr><td id="L1119" class="css-a4x74f"><span>1119</span></td><td id="LC1119" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.load();
</code></td></tr><tr><td id="L1120" class="css-a4x74f"><span>1120</span></td><td id="LC1120" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1121" class="css-a4x74f"><span>1121</span></td><td id="LC1121" class="css-1dcdqdg"><code>      <span class="code-comment">// Debugging</span>
</code></td></tr><tr><td id="L1122" class="css-a4x74f"><span>1122</span></td><td id="LC1122" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.debug.log(<span class="code-string">'Cancelled network requests'</span>);
</code></td></tr><tr><td id="L1123" class="css-a4x74f"><span>1123</span></td><td id="LC1123" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1124" class="css-a4x74f"><span>1124</span></td><td id="LC1124" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L1125" class="css-a4x74f"><span>1125</span></td><td id="LC1125" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1126" class="css-a4x74f"><span>1126</span></td><td id="LC1126" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1127" class="css-a4x74f"><span>1127</span></td><td id="LC1127" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1128" class="css-a4x74f"><span>1128</span></td><td id="LC1128" class="css-1dcdqdg"><code>  <span class="code-comment">// Generate a random ID</span>
</code></td></tr><tr><td id="L1129" class="css-a4x74f"><span>1129</span></td><td id="LC1129" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">generateId</span>(<span class="code-params">prefix</span>) </span>{
</code></td></tr><tr><td id="L1130" class="css-a4x74f"><span>1130</span></td><td id="LC1130" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-string">`<span class="code-subst">${prefix}</span>-<span class="code-subst">${<span class="code-built_in">Math</span>.floor(<span class="code-built_in">Math</span>.random() * <span class="code-number">10000</span>)}</span>`</span>;
</code></td></tr><tr><td id="L1131" class="css-a4x74f"><span>1131</span></td><td id="LC1131" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1132" class="css-a4x74f"><span>1132</span></td><td id="LC1132" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1133" class="css-a4x74f"><span>1133</span></td><td id="LC1133" class="css-1dcdqdg"><code>  <span class="code-comment">// Format string</span>
</code></td></tr><tr><td id="L1134" class="css-a4x74f"><span>1134</span></td><td id="LC1134" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">format</span>(<span class="code-params">input, ...args</span>) </span>{
</code></td></tr><tr><td id="L1135" class="css-a4x74f"><span>1135</span></td><td id="LC1135" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.empty(input)) <span class="code-keyword">return</span> input;
</code></td></tr><tr><td id="L1136" class="css-a4x74f"><span>1136</span></td><td id="LC1136" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> input.toString().replace(<span class="code-regexp">/{(\d+)}/g</span>, (_, i) =&gt; args[i].toString());
</code></td></tr><tr><td id="L1137" class="css-a4x74f"><span>1137</span></td><td id="LC1137" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1138" class="css-a4x74f"><span>1138</span></td><td id="LC1138" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1139" class="css-a4x74f"><span>1139</span></td><td id="LC1139" class="css-1dcdqdg"><code>  <span class="code-comment">// Get percentage</span>
</code></td></tr><tr><td id="L1140" class="css-a4x74f"><span>1140</span></td><td id="LC1140" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getPercentage</span>(<span class="code-params">current, max</span>) </span>{
</code></td></tr><tr><td id="L1141" class="css-a4x74f"><span>1141</span></td><td id="LC1141" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (current === <span class="code-number">0</span> || max === <span class="code-number">0</span> || <span class="code-built_in">Number</span>.isNaN(current) || <span class="code-built_in">Number</span>.isNaN(max)) {
</code></td></tr><tr><td id="L1142" class="css-a4x74f"><span>1142</span></td><td id="LC1142" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1143" class="css-a4x74f"><span>1143</span></td><td id="LC1143" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1144" class="css-a4x74f"><span>1144</span></td><td id="LC1144" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> (current / max * <span class="code-number">100</span>).toFixed(<span class="code-number">2</span>);
</code></td></tr><tr><td id="L1145" class="css-a4x74f"><span>1145</span></td><td id="LC1145" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1146" class="css-a4x74f"><span>1146</span></td><td id="LC1146" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1147" class="css-a4x74f"><span>1147</span></td><td id="LC1147" class="css-1dcdqdg"><code>  <span class="code-comment">// Replace all occurrences of a string in a string</span>
</code></td></tr><tr><td id="L1148" class="css-a4x74f"><span>1148</span></td><td id="LC1148" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> replaceAll = <span class="code-function">(<span class="code-params">input = <span class="code-string">''</span>, find = <span class="code-string">''</span>, replace = <span class="code-string">''</span></span>) =&gt;</span> input.replace(<span class="code-keyword">new</span> <span class="code-built_in">RegExp</span>(find.toString().replace(<span class="code-regexp">/([.*+?^=!:${}()|[\]/\\])/g</span>, <span class="code-string">'\\$1'</span>), <span class="code-string">'g'</span>), replace.toString());
</code></td></tr><tr><td id="L1149" class="css-a4x74f"><span>1149</span></td><td id="LC1149" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1150" class="css-a4x74f"><span>1150</span></td><td id="LC1150" class="css-1dcdqdg"><code>  <span class="code-comment">// Convert to title case</span>
</code></td></tr><tr><td id="L1151" class="css-a4x74f"><span>1151</span></td><td id="LC1151" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> toTitleCase = <span class="code-function">(<span class="code-params">input = <span class="code-string">''</span></span>) =&gt;</span> input.toString().replace(<span class="code-regexp">/\w\S*/g</span>, text =&gt; text.charAt(<span class="code-number">0</span>).toUpperCase() + text.slice(<span class="code-number">1</span>).toLowerCase());
</code></td></tr><tr><td id="L1152" class="css-a4x74f"><span>1152</span></td><td id="LC1152" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1153" class="css-a4x74f"><span>1153</span></td><td id="LC1153" class="css-1dcdqdg"><code>  <span class="code-comment">// Convert string to pascalCase</span>
</code></td></tr><tr><td id="L1154" class="css-a4x74f"><span>1154</span></td><td id="LC1154" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">toPascalCase</span>(<span class="code-params">input = <span class="code-string">''</span></span>) </span>{
</code></td></tr><tr><td id="L1155" class="css-a4x74f"><span>1155</span></td><td id="LC1155" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> string = input.toString();
</code></td></tr><tr><td id="L1156" class="css-a4x74f"><span>1156</span></td><td id="LC1156" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1157" class="css-a4x74f"><span>1157</span></td><td id="LC1157" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert kebab case</span>
</code></td></tr><tr><td id="L1158" class="css-a4x74f"><span>1158</span></td><td id="LC1158" class="css-1dcdqdg"><code>    string = replaceAll(string, <span class="code-string">'-'</span>, <span class="code-string">' '</span>);
</code></td></tr><tr><td id="L1159" class="css-a4x74f"><span>1159</span></td><td id="LC1159" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1160" class="css-a4x74f"><span>1160</span></td><td id="LC1160" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert snake case</span>
</code></td></tr><tr><td id="L1161" class="css-a4x74f"><span>1161</span></td><td id="LC1161" class="css-1dcdqdg"><code>    string = replaceAll(string, <span class="code-string">'_'</span>, <span class="code-string">' '</span>);
</code></td></tr><tr><td id="L1162" class="css-a4x74f"><span>1162</span></td><td id="LC1162" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1163" class="css-a4x74f"><span>1163</span></td><td id="LC1163" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert to title case</span>
</code></td></tr><tr><td id="L1164" class="css-a4x74f"><span>1164</span></td><td id="LC1164" class="css-1dcdqdg"><code>    string = toTitleCase(string);
</code></td></tr><tr><td id="L1165" class="css-a4x74f"><span>1165</span></td><td id="LC1165" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1166" class="css-a4x74f"><span>1166</span></td><td id="LC1166" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert to pascal case</span>
</code></td></tr><tr><td id="L1167" class="css-a4x74f"><span>1167</span></td><td id="LC1167" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> replaceAll(string, <span class="code-string">' '</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L1168" class="css-a4x74f"><span>1168</span></td><td id="LC1168" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1169" class="css-a4x74f"><span>1169</span></td><td id="LC1169" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1170" class="css-a4x74f"><span>1170</span></td><td id="LC1170" class="css-1dcdqdg"><code>  <span class="code-comment">// Convert string to pascalCase</span>
</code></td></tr><tr><td id="L1171" class="css-a4x74f"><span>1171</span></td><td id="LC1171" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">toCamelCase</span>(<span class="code-params">input = <span class="code-string">''</span></span>) </span>{
</code></td></tr><tr><td id="L1172" class="css-a4x74f"><span>1172</span></td><td id="LC1172" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> string = input.toString();
</code></td></tr><tr><td id="L1173" class="css-a4x74f"><span>1173</span></td><td id="LC1173" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1174" class="css-a4x74f"><span>1174</span></td><td id="LC1174" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert to pascal case</span>
</code></td></tr><tr><td id="L1175" class="css-a4x74f"><span>1175</span></td><td id="LC1175" class="css-1dcdqdg"><code>    string = toPascalCase(string);
</code></td></tr><tr><td id="L1176" class="css-a4x74f"><span>1176</span></td><td id="LC1176" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1177" class="css-a4x74f"><span>1177</span></td><td id="LC1177" class="css-1dcdqdg"><code>    <span class="code-comment">// Convert first character to lowercase</span>
</code></td></tr><tr><td id="L1178" class="css-a4x74f"><span>1178</span></td><td id="LC1178" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> string.charAt(<span class="code-number">0</span>).toLowerCase() + string.slice(<span class="code-number">1</span>);
</code></td></tr><tr><td id="L1179" class="css-a4x74f"><span>1179</span></td><td id="LC1179" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1180" class="css-a4x74f"><span>1180</span></td><td id="LC1180" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1181" class="css-a4x74f"><span>1181</span></td><td id="LC1181" class="css-1dcdqdg"><code>  <span class="code-comment">// Remove HTML from a string</span>
</code></td></tr><tr><td id="L1182" class="css-a4x74f"><span>1182</span></td><td id="LC1182" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">stripHTML</span>(<span class="code-params">source</span>) </span>{
</code></td></tr><tr><td id="L1183" class="css-a4x74f"><span>1183</span></td><td id="LC1183" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> fragment = <span class="code-built_in">document</span>.createDocumentFragment();
</code></td></tr><tr><td id="L1184" class="css-a4x74f"><span>1184</span></td><td id="LC1184" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> element = <span class="code-built_in">document</span>.createElement(<span class="code-string">'div'</span>);
</code></td></tr><tr><td id="L1185" class="css-a4x74f"><span>1185</span></td><td id="LC1185" class="css-1dcdqdg"><code>    fragment.appendChild(element);
</code></td></tr><tr><td id="L1186" class="css-a4x74f"><span>1186</span></td><td id="LC1186" class="css-1dcdqdg"><code>    element.innerHTML = source;
</code></td></tr><tr><td id="L1187" class="css-a4x74f"><span>1187</span></td><td id="LC1187" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> fragment.firstChild.innerText;
</code></td></tr><tr><td id="L1188" class="css-a4x74f"><span>1188</span></td><td id="LC1188" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1189" class="css-a4x74f"><span>1189</span></td><td id="LC1189" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1190" class="css-a4x74f"><span>1190</span></td><td id="LC1190" class="css-1dcdqdg"><code>  <span class="code-comment">// Like outerHTML, but also works for DocumentFragment</span>
</code></td></tr><tr><td id="L1191" class="css-a4x74f"><span>1191</span></td><td id="LC1191" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getHTML</span>(<span class="code-params">element</span>) </span>{
</code></td></tr><tr><td id="L1192" class="css-a4x74f"><span>1192</span></td><td id="LC1192" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> wrapper = <span class="code-built_in">document</span>.createElement(<span class="code-string">'div'</span>);
</code></td></tr><tr><td id="L1193" class="css-a4x74f"><span>1193</span></td><td id="LC1193" class="css-1dcdqdg"><code>    wrapper.appendChild(element);
</code></td></tr><tr><td id="L1194" class="css-a4x74f"><span>1194</span></td><td id="LC1194" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> wrapper.innerHTML;
</code></td></tr><tr><td id="L1195" class="css-a4x74f"><span>1195</span></td><td id="LC1195" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1196" class="css-a4x74f"><span>1196</span></td><td id="LC1196" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1197" class="css-a4x74f"><span>1197</span></td><td id="LC1197" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1198" class="css-a4x74f"><span>1198</span></td><td id="LC1198" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1199" class="css-a4x74f"><span>1199</span></td><td id="LC1199" class="css-1dcdqdg"><code>  <span class="code-comment">// Skip i18n for abbreviations and brand names</span>
</code></td></tr><tr><td id="L1200" class="css-a4x74f"><span>1200</span></td><td id="LC1200" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> resources = {
</code></td></tr><tr><td id="L1201" class="css-a4x74f"><span>1201</span></td><td id="LC1201" class="css-1dcdqdg"><code>    pip: <span class="code-string">'PIP'</span>,
</code></td></tr><tr><td id="L1202" class="css-a4x74f"><span>1202</span></td><td id="LC1202" class="css-1dcdqdg"><code>    airplay: <span class="code-string">'AirPlay'</span>,
</code></td></tr><tr><td id="L1203" class="css-a4x74f"><span>1203</span></td><td id="LC1203" class="css-1dcdqdg"><code>    html5: <span class="code-string">'HTML5'</span>,
</code></td></tr><tr><td id="L1204" class="css-a4x74f"><span>1204</span></td><td id="LC1204" class="css-1dcdqdg"><code>    vimeo: <span class="code-string">'Vimeo'</span>,
</code></td></tr><tr><td id="L1205" class="css-a4x74f"><span>1205</span></td><td id="LC1205" class="css-1dcdqdg"><code>    youtube: <span class="code-string">'YouTube'</span>
</code></td></tr><tr><td id="L1206" class="css-a4x74f"><span>1206</span></td><td id="LC1206" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L1207" class="css-a4x74f"><span>1207</span></td><td id="LC1207" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> i18n = {
</code></td></tr><tr><td id="L1208" class="css-a4x74f"><span>1208</span></td><td id="LC1208" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span>(key = '', config = {}) {
</code></td></tr><tr><td id="L1209" class="css-a4x74f"><span>1209</span></td><td id="LC1209" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(key) || is.empty(config)) {
</code></td></tr><tr><td id="L1210" class="css-a4x74f"><span>1210</span></td><td id="LC1210" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-string">''</span>;
</code></td></tr><tr><td id="L1211" class="css-a4x74f"><span>1211</span></td><td id="LC1211" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1212" class="css-a4x74f"><span>1212</span></td><td id="LC1212" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> string = getDeep(config.i18n, key);
</code></td></tr><tr><td id="L1213" class="css-a4x74f"><span>1213</span></td><td id="LC1213" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(string)) {
</code></td></tr><tr><td id="L1214" class="css-a4x74f"><span>1214</span></td><td id="LC1214" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(resources).includes(key)) {
</code></td></tr><tr><td id="L1215" class="css-a4x74f"><span>1215</span></td><td id="LC1215" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> resources[key];
</code></td></tr><tr><td id="L1216" class="css-a4x74f"><span>1216</span></td><td id="LC1216" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1217" class="css-a4x74f"><span>1217</span></td><td id="LC1217" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-string">''</span>;
</code></td></tr><tr><td id="L1218" class="css-a4x74f"><span>1218</span></td><td id="LC1218" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1219" class="css-a4x74f"><span>1219</span></td><td id="LC1219" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> replace = {
</code></td></tr><tr><td id="L1220" class="css-a4x74f"><span>1220</span></td><td id="LC1220" class="css-1dcdqdg"><code>        <span class="code-string">'{seektime}'</span>: config.seekTime,
</code></td></tr><tr><td id="L1221" class="css-a4x74f"><span>1221</span></td><td id="LC1221" class="css-1dcdqdg"><code>        <span class="code-string">'{title}'</span>: config.title
</code></td></tr><tr><td id="L1222" class="css-a4x74f"><span>1222</span></td><td id="LC1222" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L1223" class="css-a4x74f"><span>1223</span></td><td id="LC1223" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.entries(replace).forEach(<span class="code-function">(<span class="code-params">[k, v]</span>) =&gt;</span> {
</code></td></tr><tr><td id="L1224" class="css-a4x74f"><span>1224</span></td><td id="LC1224" class="css-1dcdqdg"><code>        string = replaceAll(string, k, v);
</code></td></tr><tr><td id="L1225" class="css-a4x74f"><span>1225</span></td><td id="LC1225" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1226" class="css-a4x74f"><span>1226</span></td><td id="LC1226" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> string;
</code></td></tr><tr><td id="L1227" class="css-a4x74f"><span>1227</span></td><td id="LC1227" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1228" class="css-a4x74f"><span>1228</span></td><td id="LC1228" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L1229" class="css-a4x74f"><span>1229</span></td><td id="LC1229" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1230" class="css-a4x74f"><span>1230</span></td><td id="LC1230" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Storage</span> </span>{
</code></td></tr><tr><td id="L1231" class="css-a4x74f"><span>1231</span></td><td id="LC1231" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(player) {
</code></td></tr><tr><td id="L1232" class="css-a4x74f"><span>1232</span></td><td id="LC1232" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"get"</span>, key =&gt; {
</code></td></tr><tr><td id="L1233" class="css-a4x74f"><span>1233</span></td><td id="LC1233" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!Storage.supported || !<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L1234" class="css-a4x74f"><span>1234</span></td><td id="LC1234" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L1235" class="css-a4x74f"><span>1235</span></td><td id="LC1235" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1236" class="css-a4x74f"><span>1236</span></td><td id="LC1236" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> store = <span class="code-built_in">window</span>.localStorage.getItem(<span class="code-keyword">this</span>.key);
</code></td></tr><tr><td id="L1237" class="css-a4x74f"><span>1237</span></td><td id="LC1237" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.empty(store)) {
</code></td></tr><tr><td id="L1238" class="css-a4x74f"><span>1238</span></td><td id="LC1238" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L1239" class="css-a4x74f"><span>1239</span></td><td id="LC1239" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1240" class="css-a4x74f"><span>1240</span></td><td id="LC1240" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> json = <span class="code-built_in">JSON</span>.parse(store);
</code></td></tr><tr><td id="L1241" class="css-a4x74f"><span>1241</span></td><td id="LC1241" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> is.string(key) &amp;&amp; key.length ? json[key] : json;
</code></td></tr><tr><td id="L1242" class="css-a4x74f"><span>1242</span></td><td id="LC1242" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1243" class="css-a4x74f"><span>1243</span></td><td id="LC1243" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"set"</span>, object =&gt; {
</code></td></tr><tr><td id="L1244" class="css-a4x74f"><span>1244</span></td><td id="LC1244" class="css-1dcdqdg"><code>        <span class="code-comment">// Bail if we don't have localStorage support or it's disabled</span>
</code></td></tr><tr><td id="L1245" class="css-a4x74f"><span>1245</span></td><td id="LC1245" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!Storage.supported || !<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L1246" class="css-a4x74f"><span>1246</span></td><td id="LC1246" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1247" class="css-a4x74f"><span>1247</span></td><td id="LC1247" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1248" class="css-a4x74f"><span>1248</span></td><td id="LC1248" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1249" class="css-a4x74f"><span>1249</span></td><td id="LC1249" class="css-1dcdqdg"><code>        <span class="code-comment">// Can only store objectst</span>
</code></td></tr><tr><td id="L1250" class="css-a4x74f"><span>1250</span></td><td id="LC1250" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.object(object)) {
</code></td></tr><tr><td id="L1251" class="css-a4x74f"><span>1251</span></td><td id="LC1251" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1252" class="css-a4x74f"><span>1252</span></td><td id="LC1252" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1253" class="css-a4x74f"><span>1253</span></td><td id="LC1253" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1254" class="css-a4x74f"><span>1254</span></td><td id="LC1254" class="css-1dcdqdg"><code>        <span class="code-comment">// Get current storage</span>
</code></td></tr><tr><td id="L1255" class="css-a4x74f"><span>1255</span></td><td id="LC1255" class="css-1dcdqdg"><code>        <span class="code-keyword">let</span> storage = <span class="code-keyword">this</span>.get();
</code></td></tr><tr><td id="L1256" class="css-a4x74f"><span>1256</span></td><td id="LC1256" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1257" class="css-a4x74f"><span>1257</span></td><td id="LC1257" class="css-1dcdqdg"><code>        <span class="code-comment">// Default to empty object</span>
</code></td></tr><tr><td id="L1258" class="css-a4x74f"><span>1258</span></td><td id="LC1258" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.empty(storage)) {
</code></td></tr><tr><td id="L1259" class="css-a4x74f"><span>1259</span></td><td id="LC1259" class="css-1dcdqdg"><code>          storage = {};
</code></td></tr><tr><td id="L1260" class="css-a4x74f"><span>1260</span></td><td id="LC1260" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1261" class="css-a4x74f"><span>1261</span></td><td id="LC1261" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1262" class="css-a4x74f"><span>1262</span></td><td id="LC1262" class="css-1dcdqdg"><code>        <span class="code-comment">// Update the working copy of the values</span>
</code></td></tr><tr><td id="L1263" class="css-a4x74f"><span>1263</span></td><td id="LC1263" class="css-1dcdqdg"><code>        extend(storage, object);
</code></td></tr><tr><td id="L1264" class="css-a4x74f"><span>1264</span></td><td id="LC1264" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1265" class="css-a4x74f"><span>1265</span></td><td id="LC1265" class="css-1dcdqdg"><code>        <span class="code-comment">// Update storage</span>
</code></td></tr><tr><td id="L1266" class="css-a4x74f"><span>1266</span></td><td id="LC1266" class="css-1dcdqdg"><code>        <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1267" class="css-a4x74f"><span>1267</span></td><td id="LC1267" class="css-1dcdqdg"><code>          <span class="code-built_in">window</span>.localStorage.setItem(<span class="code-keyword">this</span>.key, <span class="code-built_in">JSON</span>.stringify(storage));
</code></td></tr><tr><td id="L1268" class="css-a4x74f"><span>1268</span></td><td id="LC1268" class="css-1dcdqdg"><code>        } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L1269" class="css-a4x74f"><span>1269</span></td><td id="LC1269" class="css-1dcdqdg"><code>          <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L1270" class="css-a4x74f"><span>1270</span></td><td id="LC1270" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1271" class="css-a4x74f"><span>1271</span></td><td id="LC1271" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1272" class="css-a4x74f"><span>1272</span></td><td id="LC1272" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.enabled = player.config.storage.enabled;
</code></td></tr><tr><td id="L1273" class="css-a4x74f"><span>1273</span></td><td id="LC1273" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.key = player.config.storage.key;
</code></td></tr><tr><td id="L1274" class="css-a4x74f"><span>1274</span></td><td id="LC1274" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1275" class="css-a4x74f"><span>1275</span></td><td id="LC1275" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1276" class="css-a4x74f"><span>1276</span></td><td id="LC1276" class="css-1dcdqdg"><code>    <span class="code-comment">// Check for actual support (see if we can use it)</span>
</code></td></tr><tr><td id="L1277" class="css-a4x74f"><span>1277</span></td><td id="LC1277" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> <span class="code-keyword">get</span> supported() {
</code></td></tr><tr><td id="L1278" class="css-a4x74f"><span>1278</span></td><td id="LC1278" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1279" class="css-a4x74f"><span>1279</span></td><td id="LC1279" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!(<span class="code-string">'localStorage'</span> <span class="code-keyword">in</span> <span class="code-built_in">window</span>)) {
</code></td></tr><tr><td id="L1280" class="css-a4x74f"><span>1280</span></td><td id="LC1280" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L1281" class="css-a4x74f"><span>1281</span></td><td id="LC1281" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1282" class="css-a4x74f"><span>1282</span></td><td id="LC1282" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> test = <span class="code-string">'___test'</span>;
</code></td></tr><tr><td id="L1283" class="css-a4x74f"><span>1283</span></td><td id="LC1283" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1284" class="css-a4x74f"><span>1284</span></td><td id="LC1284" class="css-1dcdqdg"><code>        <span class="code-comment">// Try to use it (it might be disabled, e.g. user is in private mode)</span>
</code></td></tr><tr><td id="L1285" class="css-a4x74f"><span>1285</span></td><td id="LC1285" class="css-1dcdqdg"><code>        <span class="code-comment">// see: https://github.com/sampotts/plyr/issues/131</span>
</code></td></tr><tr><td id="L1286" class="css-a4x74f"><span>1286</span></td><td id="LC1286" class="css-1dcdqdg"><code>        <span class="code-built_in">window</span>.localStorage.setItem(test, test);
</code></td></tr><tr><td id="L1287" class="css-a4x74f"><span>1287</span></td><td id="LC1287" class="css-1dcdqdg"><code>        <span class="code-built_in">window</span>.localStorage.removeItem(test);
</code></td></tr><tr><td id="L1288" class="css-a4x74f"><span>1288</span></td><td id="LC1288" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1289" class="css-a4x74f"><span>1289</span></td><td id="LC1289" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L1290" class="css-a4x74f"><span>1290</span></td><td id="LC1290" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L1291" class="css-a4x74f"><span>1291</span></td><td id="LC1291" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1292" class="css-a4x74f"><span>1292</span></td><td id="LC1292" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1293" class="css-a4x74f"><span>1293</span></td><td id="LC1293" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1294" class="css-a4x74f"><span>1294</span></td><td id="LC1294" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1295" class="css-a4x74f"><span>1295</span></td><td id="LC1295" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1296" class="css-a4x74f"><span>1296</span></td><td id="LC1296" class="css-1dcdqdg"><code>  <span class="code-comment">// Fetch wrapper</span>
</code></td></tr><tr><td id="L1297" class="css-a4x74f"><span>1297</span></td><td id="LC1297" class="css-1dcdqdg"><code>  <span class="code-comment">// Using XHR to avoid issues with older browsers</span>
</code></td></tr><tr><td id="L1298" class="css-a4x74f"><span>1298</span></td><td id="LC1298" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1299" class="css-a4x74f"><span>1299</span></td><td id="LC1299" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1300" class="css-a4x74f"><span>1300</span></td><td id="LC1300" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">fetch</span>(<span class="code-params">url, responseType = <span class="code-string">'text'</span></span>) </span>{
</code></td></tr><tr><td id="L1301" class="css-a4x74f"><span>1301</span></td><td id="LC1301" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function">(<span class="code-params">resolve, reject</span>) =&gt;</span> {
</code></td></tr><tr><td id="L1302" class="css-a4x74f"><span>1302</span></td><td id="LC1302" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1303" class="css-a4x74f"><span>1303</span></td><td id="LC1303" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> request = <span class="code-keyword">new</span> XMLHttpRequest();
</code></td></tr><tr><td id="L1304" class="css-a4x74f"><span>1304</span></td><td id="LC1304" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1305" class="css-a4x74f"><span>1305</span></td><td id="LC1305" class="css-1dcdqdg"><code>        <span class="code-comment">// Check for CORS support</span>
</code></td></tr><tr><td id="L1306" class="css-a4x74f"><span>1306</span></td><td id="LC1306" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!(<span class="code-string">'withCredentials'</span> <span class="code-keyword">in</span> request)) {
</code></td></tr><tr><td id="L1307" class="css-a4x74f"><span>1307</span></td><td id="LC1307" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1308" class="css-a4x74f"><span>1308</span></td><td id="LC1308" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1309" class="css-a4x74f"><span>1309</span></td><td id="LC1309" class="css-1dcdqdg"><code>        request.addEventListener(<span class="code-string">'load'</span>, () =&gt; {
</code></td></tr><tr><td id="L1310" class="css-a4x74f"><span>1310</span></td><td id="LC1310" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (responseType === <span class="code-string">'text'</span>) {
</code></td></tr><tr><td id="L1311" class="css-a4x74f"><span>1311</span></td><td id="LC1311" class="css-1dcdqdg"><code>            <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1312" class="css-a4x74f"><span>1312</span></td><td id="LC1312" class="css-1dcdqdg"><code>              resolve(<span class="code-built_in">JSON</span>.parse(request.responseText));
</code></td></tr><tr><td id="L1313" class="css-a4x74f"><span>1313</span></td><td id="LC1313" class="css-1dcdqdg"><code>            } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L1314" class="css-a4x74f"><span>1314</span></td><td id="LC1314" class="css-1dcdqdg"><code>              resolve(request.responseText);
</code></td></tr><tr><td id="L1315" class="css-a4x74f"><span>1315</span></td><td id="LC1315" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L1316" class="css-a4x74f"><span>1316</span></td><td id="LC1316" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1317" class="css-a4x74f"><span>1317</span></td><td id="LC1317" class="css-1dcdqdg"><code>            resolve(request.response);
</code></td></tr><tr><td id="L1318" class="css-a4x74f"><span>1318</span></td><td id="LC1318" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1319" class="css-a4x74f"><span>1319</span></td><td id="LC1319" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L1320" class="css-a4x74f"><span>1320</span></td><td id="LC1320" class="css-1dcdqdg"><code>        request.addEventListener(<span class="code-string">'error'</span>, () =&gt; {
</code></td></tr><tr><td id="L1321" class="css-a4x74f"><span>1321</span></td><td id="LC1321" class="css-1dcdqdg"><code>          <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-built_in">Error</span>(request.status);
</code></td></tr><tr><td id="L1322" class="css-a4x74f"><span>1322</span></td><td id="LC1322" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L1323" class="css-a4x74f"><span>1323</span></td><td id="LC1323" class="css-1dcdqdg"><code>        request.open(<span class="code-string">'GET'</span>, url, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L1324" class="css-a4x74f"><span>1324</span></td><td id="LC1324" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1325" class="css-a4x74f"><span>1325</span></td><td id="LC1325" class="css-1dcdqdg"><code>        <span class="code-comment">// Set the required response type</span>
</code></td></tr><tr><td id="L1326" class="css-a4x74f"><span>1326</span></td><td id="LC1326" class="css-1dcdqdg"><code>        request.responseType = responseType;
</code></td></tr><tr><td id="L1327" class="css-a4x74f"><span>1327</span></td><td id="LC1327" class="css-1dcdqdg"><code>        request.send();
</code></td></tr><tr><td id="L1328" class="css-a4x74f"><span>1328</span></td><td id="LC1328" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (error) {
</code></td></tr><tr><td id="L1329" class="css-a4x74f"><span>1329</span></td><td id="LC1329" class="css-1dcdqdg"><code>        reject(error);
</code></td></tr><tr><td id="L1330" class="css-a4x74f"><span>1330</span></td><td id="LC1330" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1331" class="css-a4x74f"><span>1331</span></td><td id="LC1331" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L1332" class="css-a4x74f"><span>1332</span></td><td id="LC1332" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1333" class="css-a4x74f"><span>1333</span></td><td id="LC1333" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1334" class="css-a4x74f"><span>1334</span></td><td id="LC1334" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1335" class="css-a4x74f"><span>1335</span></td><td id="LC1335" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1336" class="css-a4x74f"><span>1336</span></td><td id="LC1336" class="css-1dcdqdg"><code>  <span class="code-comment">// Load an external SVG sprite</span>
</code></td></tr><tr><td id="L1337" class="css-a4x74f"><span>1337</span></td><td id="LC1337" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadSprite</span>(<span class="code-params">url, id</span>) </span>{
</code></td></tr><tr><td id="L1338" class="css-a4x74f"><span>1338</span></td><td id="LC1338" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.string(url)) {
</code></td></tr><tr><td id="L1339" class="css-a4x74f"><span>1339</span></td><td id="LC1339" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1340" class="css-a4x74f"><span>1340</span></td><td id="LC1340" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1341" class="css-a4x74f"><span>1341</span></td><td id="LC1341" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> prefix = <span class="code-string">'cache'</span>;
</code></td></tr><tr><td id="L1342" class="css-a4x74f"><span>1342</span></td><td id="LC1342" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> hasId = is.string(id);
</code></td></tr><tr><td id="L1343" class="css-a4x74f"><span>1343</span></td><td id="LC1343" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> isCached = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L1344" class="css-a4x74f"><span>1344</span></td><td id="LC1344" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> exists = <span class="code-function"><span class="code-params">()</span> =&gt;</span> <span class="code-built_in">document</span>.getElementById(id) !== <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L1345" class="css-a4x74f"><span>1345</span></td><td id="LC1345" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> update = <span class="code-function">(<span class="code-params">container, data</span>) =&gt;</span> {
</code></td></tr><tr><td id="L1346" class="css-a4x74f"><span>1346</span></td><td id="LC1346" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L1347" class="css-a4x74f"><span>1347</span></td><td id="LC1347" class="css-1dcdqdg"><code>      container.innerHTML = data;
</code></td></tr><tr><td id="L1348" class="css-a4x74f"><span>1348</span></td><td id="LC1348" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1349" class="css-a4x74f"><span>1349</span></td><td id="LC1349" class="css-1dcdqdg"><code>      <span class="code-comment">// Check again incase of race condition</span>
</code></td></tr><tr><td id="L1350" class="css-a4x74f"><span>1350</span></td><td id="LC1350" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (hasId &amp;&amp; exists()) {
</code></td></tr><tr><td id="L1351" class="css-a4x74f"><span>1351</span></td><td id="LC1351" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1352" class="css-a4x74f"><span>1352</span></td><td id="LC1352" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1353" class="css-a4x74f"><span>1353</span></td><td id="LC1353" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1354" class="css-a4x74f"><span>1354</span></td><td id="LC1354" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject the SVG to the body</span>
</code></td></tr><tr><td id="L1355" class="css-a4x74f"><span>1355</span></td><td id="LC1355" class="css-1dcdqdg"><code>      <span class="code-built_in">document</span>.body.insertAdjacentElement(<span class="code-string">'afterbegin'</span>, container);
</code></td></tr><tr><td id="L1356" class="css-a4x74f"><span>1356</span></td><td id="LC1356" class="css-1dcdqdg"><code>    };
</code></td></tr><tr><td id="L1357" class="css-a4x74f"><span>1357</span></td><td id="LC1357" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1358" class="css-a4x74f"><span>1358</span></td><td id="LC1358" class="css-1dcdqdg"><code>    <span class="code-comment">// Only load once if ID set</span>
</code></td></tr><tr><td id="L1359" class="css-a4x74f"><span>1359</span></td><td id="LC1359" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!hasId || !exists()) {
</code></td></tr><tr><td id="L1360" class="css-a4x74f"><span>1360</span></td><td id="LC1360" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> useStorage = Storage.supported;
</code></td></tr><tr><td id="L1361" class="css-a4x74f"><span>1361</span></td><td id="LC1361" class="css-1dcdqdg"><code>      <span class="code-comment">// Create container</span>
</code></td></tr><tr><td id="L1362" class="css-a4x74f"><span>1362</span></td><td id="LC1362" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> container = <span class="code-built_in">document</span>.createElement(<span class="code-string">'div'</span>);
</code></td></tr><tr><td id="L1363" class="css-a4x74f"><span>1363</span></td><td id="LC1363" class="css-1dcdqdg"><code>      container.setAttribute(<span class="code-string">'hidden'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L1364" class="css-a4x74f"><span>1364</span></td><td id="LC1364" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (hasId) {
</code></td></tr><tr><td id="L1365" class="css-a4x74f"><span>1365</span></td><td id="LC1365" class="css-1dcdqdg"><code>        container.setAttribute(<span class="code-string">'id'</span>, id);
</code></td></tr><tr><td id="L1366" class="css-a4x74f"><span>1366</span></td><td id="LC1366" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1367" class="css-a4x74f"><span>1367</span></td><td id="LC1367" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1368" class="css-a4x74f"><span>1368</span></td><td id="LC1368" class="css-1dcdqdg"><code>      <span class="code-comment">// Check in cache</span>
</code></td></tr><tr><td id="L1369" class="css-a4x74f"><span>1369</span></td><td id="LC1369" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (useStorage) {
</code></td></tr><tr><td id="L1370" class="css-a4x74f"><span>1370</span></td><td id="LC1370" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> cached = <span class="code-built_in">window</span>.localStorage.getItem(<span class="code-string">`<span class="code-subst">${prefix}</span>-<span class="code-subst">${id}</span>`</span>);
</code></td></tr><tr><td id="L1371" class="css-a4x74f"><span>1371</span></td><td id="LC1371" class="css-1dcdqdg"><code>        isCached = cached !== <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L1372" class="css-a4x74f"><span>1372</span></td><td id="LC1372" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (isCached) {
</code></td></tr><tr><td id="L1373" class="css-a4x74f"><span>1373</span></td><td id="LC1373" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> data = <span class="code-built_in">JSON</span>.parse(cached);
</code></td></tr><tr><td id="L1374" class="css-a4x74f"><span>1374</span></td><td id="LC1374" class="css-1dcdqdg"><code>          update(container, data.content);
</code></td></tr><tr><td id="L1375" class="css-a4x74f"><span>1375</span></td><td id="LC1375" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1376" class="css-a4x74f"><span>1376</span></td><td id="LC1376" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1377" class="css-a4x74f"><span>1377</span></td><td id="LC1377" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1378" class="css-a4x74f"><span>1378</span></td><td id="LC1378" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the sprite</span>
</code></td></tr><tr><td id="L1379" class="css-a4x74f"><span>1379</span></td><td id="LC1379" class="css-1dcdqdg"><code>      fetch(url).then(<span class="code-function"><span class="code-params">result</span> =&gt;</span> {
</code></td></tr><tr><td id="L1380" class="css-a4x74f"><span>1380</span></td><td id="LC1380" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.empty(result)) {
</code></td></tr><tr><td id="L1381" class="css-a4x74f"><span>1381</span></td><td id="LC1381" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1382" class="css-a4x74f"><span>1382</span></td><td id="LC1382" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1383" class="css-a4x74f"><span>1383</span></td><td id="LC1383" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (useStorage) {
</code></td></tr><tr><td id="L1384" class="css-a4x74f"><span>1384</span></td><td id="LC1384" class="css-1dcdqdg"><code>          <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1385" class="css-a4x74f"><span>1385</span></td><td id="LC1385" class="css-1dcdqdg"><code>            <span class="code-built_in">window</span>.localStorage.setItem(<span class="code-string">`<span class="code-subst">${prefix}</span>-<span class="code-subst">${id}</span>`</span>, <span class="code-built_in">JSON</span>.stringify({
</code></td></tr><tr><td id="L1386" class="css-a4x74f"><span>1386</span></td><td id="LC1386" class="css-1dcdqdg"><code>              content: result
</code></td></tr><tr><td id="L1387" class="css-a4x74f"><span>1387</span></td><td id="LC1387" class="css-1dcdqdg"><code>            }));
</code></td></tr><tr><td id="L1388" class="css-a4x74f"><span>1388</span></td><td id="LC1388" class="css-1dcdqdg"><code>          } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L1389" class="css-a4x74f"><span>1389</span></td><td id="LC1389" class="css-1dcdqdg"><code>            <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L1390" class="css-a4x74f"><span>1390</span></td><td id="LC1390" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1391" class="css-a4x74f"><span>1391</span></td><td id="LC1391" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1392" class="css-a4x74f"><span>1392</span></td><td id="LC1392" class="css-1dcdqdg"><code>        update(container, result);
</code></td></tr><tr><td id="L1393" class="css-a4x74f"><span>1393</span></td><td id="LC1393" class="css-1dcdqdg"><code>      }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L1394" class="css-a4x74f"><span>1394</span></td><td id="LC1394" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1395" class="css-a4x74f"><span>1395</span></td><td id="LC1395" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1396" class="css-a4x74f"><span>1396</span></td><td id="LC1396" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1397" class="css-a4x74f"><span>1397</span></td><td id="LC1397" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1398" class="css-a4x74f"><span>1398</span></td><td id="LC1398" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1399" class="css-a4x74f"><span>1399</span></td><td id="LC1399" class="css-1dcdqdg"><code>  <span class="code-comment">// Time helpers</span>
</code></td></tr><tr><td id="L1400" class="css-a4x74f"><span>1400</span></td><td id="LC1400" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> getHours = <span class="code-function"><span class="code-params">value</span> =&gt;</span> <span class="code-built_in">Math</span>.trunc(value / <span class="code-number">60</span> / <span class="code-number">60</span> % <span class="code-number">60</span>, <span class="code-number">10</span>);
</code></td></tr><tr><td id="L1401" class="css-a4x74f"><span>1401</span></td><td id="LC1401" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> getMinutes = <span class="code-function"><span class="code-params">value</span> =&gt;</span> <span class="code-built_in">Math</span>.trunc(value / <span class="code-number">60</span> % <span class="code-number">60</span>, <span class="code-number">10</span>);
</code></td></tr><tr><td id="L1402" class="css-a4x74f"><span>1402</span></td><td id="LC1402" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> getSeconds = <span class="code-function"><span class="code-params">value</span> =&gt;</span> <span class="code-built_in">Math</span>.trunc(value % <span class="code-number">60</span>, <span class="code-number">10</span>);
</code></td></tr><tr><td id="L1403" class="css-a4x74f"><span>1403</span></td><td id="LC1403" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1404" class="css-a4x74f"><span>1404</span></td><td id="LC1404" class="css-1dcdqdg"><code>  <span class="code-comment">// Format time to UI friendly string</span>
</code></td></tr><tr><td id="L1405" class="css-a4x74f"><span>1405</span></td><td id="LC1405" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">formatTime</span>(<span class="code-params">time = <span class="code-number">0</span>, displayHours = false, inverted = false</span>) </span>{
</code></td></tr><tr><td id="L1406" class="css-a4x74f"><span>1406</span></td><td id="LC1406" class="css-1dcdqdg"><code>    <span class="code-comment">// Bail if the value isn't a number</span>
</code></td></tr><tr><td id="L1407" class="css-a4x74f"><span>1407</span></td><td id="LC1407" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (!is.number(time)) {
</code></td></tr><tr><td id="L1408" class="css-a4x74f"><span>1408</span></td><td id="LC1408" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> formatTime(<span class="code-literal">undefined</span>, displayHours, inverted);
</code></td></tr><tr><td id="L1409" class="css-a4x74f"><span>1409</span></td><td id="LC1409" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1410" class="css-a4x74f"><span>1410</span></td><td id="LC1410" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1411" class="css-a4x74f"><span>1411</span></td><td id="LC1411" class="css-1dcdqdg"><code>    <span class="code-comment">// Format time component to add leading zero</span>
</code></td></tr><tr><td id="L1412" class="css-a4x74f"><span>1412</span></td><td id="LC1412" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> format = <span class="code-function"><span class="code-params">value</span> =&gt;</span> <span class="code-string">`0<span class="code-subst">${value}</span>`</span>.slice(<span class="code-number">-2</span>);
</code></td></tr><tr><td id="L1413" class="css-a4x74f"><span>1413</span></td><td id="LC1413" class="css-1dcdqdg"><code>    <span class="code-comment">// Breakdown to hours, mins, secs</span>
</code></td></tr><tr><td id="L1414" class="css-a4x74f"><span>1414</span></td><td id="LC1414" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> hours = getHours(time);
</code></td></tr><tr><td id="L1415" class="css-a4x74f"><span>1415</span></td><td id="LC1415" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> mins = getMinutes(time);
</code></td></tr><tr><td id="L1416" class="css-a4x74f"><span>1416</span></td><td id="LC1416" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> secs = getSeconds(time);
</code></td></tr><tr><td id="L1417" class="css-a4x74f"><span>1417</span></td><td id="LC1417" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1418" class="css-a4x74f"><span>1418</span></td><td id="LC1418" class="css-1dcdqdg"><code>    <span class="code-comment">// Do we need to display hours?</span>
</code></td></tr><tr><td id="L1419" class="css-a4x74f"><span>1419</span></td><td id="LC1419" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (displayHours || hours &gt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L1420" class="css-a4x74f"><span>1420</span></td><td id="LC1420" class="css-1dcdqdg"><code>      hours = <span class="code-string">`<span class="code-subst">${hours}</span>:`</span>;
</code></td></tr><tr><td id="L1421" class="css-a4x74f"><span>1421</span></td><td id="LC1421" class="css-1dcdqdg"><code>    } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1422" class="css-a4x74f"><span>1422</span></td><td id="LC1422" class="css-1dcdqdg"><code>      hours = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L1423" class="css-a4x74f"><span>1423</span></td><td id="LC1423" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L1424" class="css-a4x74f"><span>1424</span></td><td id="LC1424" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1425" class="css-a4x74f"><span>1425</span></td><td id="LC1425" class="css-1dcdqdg"><code>    <span class="code-comment">// Render</span>
</code></td></tr><tr><td id="L1426" class="css-a4x74f"><span>1426</span></td><td id="LC1426" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-string">`<span class="code-subst">${inverted &amp;&amp; time &gt; <span class="code-number">0</span> ? <span class="code-string">'-'</span> : <span class="code-string">''</span>}</span><span class="code-subst">${hours}</span><span class="code-subst">${format(mins)}</span>:<span class="code-subst">${format(secs)}</span>`</span>;
</code></td></tr><tr><td id="L1427" class="css-a4x74f"><span>1427</span></td><td id="LC1427" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L1428" class="css-a4x74f"><span>1428</span></td><td id="LC1428" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1429" class="css-a4x74f"><span>1429</span></td><td id="LC1429" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L1430" class="css-a4x74f"><span>1430</span></td><td id="LC1430" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1431" class="css-a4x74f"><span>1431</span></td><td id="LC1431" class="css-1dcdqdg"><code>  <span class="code-comment">// <span class="code-doctag">TODO:</span> Don't export a massive object - break down and create class</span>
</code></td></tr><tr><td id="L1432" class="css-a4x74f"><span>1432</span></td><td id="LC1432" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> controls = {
</code></td></tr><tr><td id="L1433" class="css-a4x74f"><span>1433</span></td><td id="LC1433" class="css-1dcdqdg"><code>    <span class="code-comment">// Get icon URL</span>
</code></td></tr><tr><td id="L1434" class="css-a4x74f"><span>1434</span></td><td id="LC1434" class="css-1dcdqdg"><code>    getIconUrl() {
</code></td></tr><tr><td id="L1435" class="css-a4x74f"><span>1435</span></td><td id="LC1435" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> url = <span class="code-keyword">new</span> URL(<span class="code-keyword">this</span>.config.iconUrl, <span class="code-built_in">window</span>.location);
</code></td></tr><tr><td id="L1436" class="css-a4x74f"><span>1436</span></td><td id="LC1436" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> host = <span class="code-built_in">window</span>.location.host ? <span class="code-built_in">window</span>.location.host : <span class="code-built_in">window</span>.top.location.host;
</code></td></tr><tr><td id="L1437" class="css-a4x74f"><span>1437</span></td><td id="LC1437" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> cors = url.host !== host || browser.isIE &amp;&amp; !<span class="code-built_in">window</span>.svg4everybody;
</code></td></tr><tr><td id="L1438" class="css-a4x74f"><span>1438</span></td><td id="LC1438" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> {
</code></td></tr><tr><td id="L1439" class="css-a4x74f"><span>1439</span></td><td id="LC1439" class="css-1dcdqdg"><code>        url: <span class="code-keyword">this</span>.config.iconUrl,
</code></td></tr><tr><td id="L1440" class="css-a4x74f"><span>1440</span></td><td id="LC1440" class="css-1dcdqdg"><code>        cors
</code></td></tr><tr><td id="L1441" class="css-a4x74f"><span>1441</span></td><td id="LC1441" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L1442" class="css-a4x74f"><span>1442</span></td><td id="LC1442" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1443" class="css-a4x74f"><span>1443</span></td><td id="LC1443" class="css-1dcdqdg"><code>    <span class="code-comment">// Find the UI controls</span>
</code></td></tr><tr><td id="L1444" class="css-a4x74f"><span>1444</span></td><td id="LC1444" class="css-1dcdqdg"><code>    findElements() {
</code></td></tr><tr><td id="L1445" class="css-a4x74f"><span>1445</span></td><td id="LC1445" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L1446" class="css-a4x74f"><span>1446</span></td><td id="LC1446" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.controls = getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.controls.wrapper);
</code></td></tr><tr><td id="L1447" class="css-a4x74f"><span>1447</span></td><td id="LC1447" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1448" class="css-a4x74f"><span>1448</span></td><td id="LC1448" class="css-1dcdqdg"><code>        <span class="code-comment">// Buttons</span>
</code></td></tr><tr><td id="L1449" class="css-a4x74f"><span>1449</span></td><td id="LC1449" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.buttons = {
</code></td></tr><tr><td id="L1450" class="css-a4x74f"><span>1450</span></td><td id="LC1450" class="css-1dcdqdg"><code>          play: getElements.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.play),
</code></td></tr><tr><td id="L1451" class="css-a4x74f"><span>1451</span></td><td id="LC1451" class="css-1dcdqdg"><code>          pause: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.pause),
</code></td></tr><tr><td id="L1452" class="css-a4x74f"><span>1452</span></td><td id="LC1452" class="css-1dcdqdg"><code>          restart: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.restart),
</code></td></tr><tr><td id="L1453" class="css-a4x74f"><span>1453</span></td><td id="LC1453" class="css-1dcdqdg"><code>          rewind: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.rewind),
</code></td></tr><tr><td id="L1454" class="css-a4x74f"><span>1454</span></td><td id="LC1454" class="css-1dcdqdg"><code>          fastForward: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.fastForward),
</code></td></tr><tr><td id="L1455" class="css-a4x74f"><span>1455</span></td><td id="LC1455" class="css-1dcdqdg"><code>          mute: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.mute),
</code></td></tr><tr><td id="L1456" class="css-a4x74f"><span>1456</span></td><td id="LC1456" class="css-1dcdqdg"><code>          pip: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.pip),
</code></td></tr><tr><td id="L1457" class="css-a4x74f"><span>1457</span></td><td id="LC1457" class="css-1dcdqdg"><code>          airplay: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.airplay),
</code></td></tr><tr><td id="L1458" class="css-a4x74f"><span>1458</span></td><td id="LC1458" class="css-1dcdqdg"><code>          settings: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.settings),
</code></td></tr><tr><td id="L1459" class="css-a4x74f"><span>1459</span></td><td id="LC1459" class="css-1dcdqdg"><code>          captions: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.captions),
</code></td></tr><tr><td id="L1460" class="css-a4x74f"><span>1460</span></td><td id="LC1460" class="css-1dcdqdg"><code>          fullscreen: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.buttons.fullscreen)
</code></td></tr><tr><td id="L1461" class="css-a4x74f"><span>1461</span></td><td id="LC1461" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L1462" class="css-a4x74f"><span>1462</span></td><td id="LC1462" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1463" class="css-a4x74f"><span>1463</span></td><td id="LC1463" class="css-1dcdqdg"><code>        <span class="code-comment">// Progress</span>
</code></td></tr><tr><td id="L1464" class="css-a4x74f"><span>1464</span></td><td id="LC1464" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.progress = getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.progress);
</code></td></tr><tr><td id="L1465" class="css-a4x74f"><span>1465</span></td><td id="LC1465" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1466" class="css-a4x74f"><span>1466</span></td><td id="LC1466" class="css-1dcdqdg"><code>        <span class="code-comment">// Inputs</span>
</code></td></tr><tr><td id="L1467" class="css-a4x74f"><span>1467</span></td><td id="LC1467" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.inputs = {
</code></td></tr><tr><td id="L1468" class="css-a4x74f"><span>1468</span></td><td id="LC1468" class="css-1dcdqdg"><code>          seek: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.inputs.seek),
</code></td></tr><tr><td id="L1469" class="css-a4x74f"><span>1469</span></td><td id="LC1469" class="css-1dcdqdg"><code>          volume: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.inputs.volume)
</code></td></tr><tr><td id="L1470" class="css-a4x74f"><span>1470</span></td><td id="LC1470" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L1471" class="css-a4x74f"><span>1471</span></td><td id="LC1471" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1472" class="css-a4x74f"><span>1472</span></td><td id="LC1472" class="css-1dcdqdg"><code>        <span class="code-comment">// Display</span>
</code></td></tr><tr><td id="L1473" class="css-a4x74f"><span>1473</span></td><td id="LC1473" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.display = {
</code></td></tr><tr><td id="L1474" class="css-a4x74f"><span>1474</span></td><td id="LC1474" class="css-1dcdqdg"><code>          buffer: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.display.buffer),
</code></td></tr><tr><td id="L1475" class="css-a4x74f"><span>1475</span></td><td id="LC1475" class="css-1dcdqdg"><code>          currentTime: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.display.currentTime),
</code></td></tr><tr><td id="L1476" class="css-a4x74f"><span>1476</span></td><td id="LC1476" class="css-1dcdqdg"><code>          duration: getElement.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.config.selectors.display.duration)
</code></td></tr><tr><td id="L1477" class="css-a4x74f"><span>1477</span></td><td id="LC1477" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L1478" class="css-a4x74f"><span>1478</span></td><td id="LC1478" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1479" class="css-a4x74f"><span>1479</span></td><td id="LC1479" class="css-1dcdqdg"><code>        <span class="code-comment">// Seek tooltip</span>
</code></td></tr><tr><td id="L1480" class="css-a4x74f"><span>1480</span></td><td id="LC1480" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.elements.progress)) {
</code></td></tr><tr><td id="L1481" class="css-a4x74f"><span>1481</span></td><td id="LC1481" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.display.seekTooltip = <span class="code-keyword">this</span>.elements.progress.querySelector(<span class="code-string">`.<span class="code-subst">${<span class="code-keyword">this</span>.config.classNames.tooltip}</span>`</span>);
</code></td></tr><tr><td id="L1482" class="css-a4x74f"><span>1482</span></td><td id="LC1482" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1483" class="css-a4x74f"><span>1483</span></td><td id="LC1483" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1484" class="css-a4x74f"><span>1484</span></td><td id="LC1484" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (error) {
</code></td></tr><tr><td id="L1485" class="css-a4x74f"><span>1485</span></td><td id="LC1485" class="css-1dcdqdg"><code>        <span class="code-comment">// Log it</span>
</code></td></tr><tr><td id="L1486" class="css-a4x74f"><span>1486</span></td><td id="LC1486" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'It looks like there is a problem with your custom controls HTML'</span>, error);
</code></td></tr><tr><td id="L1487" class="css-a4x74f"><span>1487</span></td><td id="LC1487" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1488" class="css-a4x74f"><span>1488</span></td><td id="LC1488" class="css-1dcdqdg"><code>        <span class="code-comment">// Restore native video controls</span>
</code></td></tr><tr><td id="L1489" class="css-a4x74f"><span>1489</span></td><td id="LC1489" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.toggleNativeControls(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L1490" class="css-a4x74f"><span>1490</span></td><td id="LC1490" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L1491" class="css-a4x74f"><span>1491</span></td><td id="LC1491" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1492" class="css-a4x74f"><span>1492</span></td><td id="LC1492" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1493" class="css-a4x74f"><span>1493</span></td><td id="LC1493" class="css-1dcdqdg"><code>    <span class="code-comment">// Create &lt;svg&gt; icon</span>
</code></td></tr><tr><td id="L1494" class="css-a4x74f"><span>1494</span></td><td id="LC1494" class="css-1dcdqdg"><code>    createIcon(type, attributes) {
</code></td></tr><tr><td id="L1495" class="css-a4x74f"><span>1495</span></td><td id="LC1495" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> namespace = <span class="code-string">'http://www.w3.org/2000/svg'</span>;
</code></td></tr><tr><td id="L1496" class="css-a4x74f"><span>1496</span></td><td id="LC1496" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> iconUrl = controls.getIconUrl.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L1497" class="css-a4x74f"><span>1497</span></td><td id="LC1497" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> iconPath = <span class="code-string">`<span class="code-subst">${!iconUrl.cors ? iconUrl.url : <span class="code-string">''</span>}</span>#<span class="code-subst">${<span class="code-keyword">this</span>.config.iconPrefix}</span>`</span>;
</code></td></tr><tr><td id="L1498" class="css-a4x74f"><span>1498</span></td><td id="LC1498" class="css-1dcdqdg"><code>      <span class="code-comment">// Create &lt;svg&gt;</span>
</code></td></tr><tr><td id="L1499" class="css-a4x74f"><span>1499</span></td><td id="LC1499" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> icon = <span class="code-built_in">document</span>.createElementNS(namespace, <span class="code-string">'svg'</span>);
</code></td></tr><tr><td id="L1500" class="css-a4x74f"><span>1500</span></td><td id="LC1500" class="css-1dcdqdg"><code>      setAttributes(icon, extend(attributes, {
</code></td></tr><tr><td id="L1501" class="css-a4x74f"><span>1501</span></td><td id="LC1501" class="css-1dcdqdg"><code>        <span class="code-string">'aria-hidden'</span>: <span class="code-string">'true'</span>,
</code></td></tr><tr><td id="L1502" class="css-a4x74f"><span>1502</span></td><td id="LC1502" class="css-1dcdqdg"><code>        focusable: <span class="code-string">'false'</span>
</code></td></tr><tr><td id="L1503" class="css-a4x74f"><span>1503</span></td><td id="LC1503" class="css-1dcdqdg"><code>      }));
</code></td></tr><tr><td id="L1504" class="css-a4x74f"><span>1504</span></td><td id="LC1504" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1505" class="css-a4x74f"><span>1505</span></td><td id="LC1505" class="css-1dcdqdg"><code>      <span class="code-comment">// Create the &lt;use&gt; to reference sprite</span>
</code></td></tr><tr><td id="L1506" class="css-a4x74f"><span>1506</span></td><td id="LC1506" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> use = <span class="code-built_in">document</span>.createElementNS(namespace, <span class="code-string">'use'</span>);
</code></td></tr><tr><td id="L1507" class="css-a4x74f"><span>1507</span></td><td id="LC1507" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> path = <span class="code-string">`<span class="code-subst">${iconPath}</span>-<span class="code-subst">${type}</span>`</span>;
</code></td></tr><tr><td id="L1508" class="css-a4x74f"><span>1508</span></td><td id="LC1508" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1509" class="css-a4x74f"><span>1509</span></td><td id="LC1509" class="css-1dcdqdg"><code>      <span class="code-comment">// Set `href` attributes</span>
</code></td></tr><tr><td id="L1510" class="css-a4x74f"><span>1510</span></td><td id="LC1510" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/sampotts/plyr/issues/460</span>
</code></td></tr><tr><td id="L1511" class="css-a4x74f"><span>1511</span></td><td id="LC1511" class="css-1dcdqdg"><code>      <span class="code-comment">// https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/xlink:href</span>
</code></td></tr><tr><td id="L1512" class="css-a4x74f"><span>1512</span></td><td id="LC1512" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-string">'href'</span> <span class="code-keyword">in</span> use) {
</code></td></tr><tr><td id="L1513" class="css-a4x74f"><span>1513</span></td><td id="LC1513" class="css-1dcdqdg"><code>        use.setAttributeNS(<span class="code-string">'http://www.w3.org/1999/xlink'</span>, <span class="code-string">'href'</span>, path);
</code></td></tr><tr><td id="L1514" class="css-a4x74f"><span>1514</span></td><td id="LC1514" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1515" class="css-a4x74f"><span>1515</span></td><td id="LC1515" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1516" class="css-a4x74f"><span>1516</span></td><td id="LC1516" class="css-1dcdqdg"><code>      <span class="code-comment">// Always set the older attribute even though it's "deprecated" (it'll be around for ages)</span>
</code></td></tr><tr><td id="L1517" class="css-a4x74f"><span>1517</span></td><td id="LC1517" class="css-1dcdqdg"><code>      use.setAttributeNS(<span class="code-string">'http://www.w3.org/1999/xlink'</span>, <span class="code-string">'xlink:href'</span>, path);
</code></td></tr><tr><td id="L1518" class="css-a4x74f"><span>1518</span></td><td id="LC1518" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1519" class="css-a4x74f"><span>1519</span></td><td id="LC1519" class="css-1dcdqdg"><code>      <span class="code-comment">// Add &lt;use&gt; to &lt;svg&gt;</span>
</code></td></tr><tr><td id="L1520" class="css-a4x74f"><span>1520</span></td><td id="LC1520" class="css-1dcdqdg"><code>      icon.appendChild(use);
</code></td></tr><tr><td id="L1521" class="css-a4x74f"><span>1521</span></td><td id="LC1521" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> icon;
</code></td></tr><tr><td id="L1522" class="css-a4x74f"><span>1522</span></td><td id="LC1522" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1523" class="css-a4x74f"><span>1523</span></td><td id="LC1523" class="css-1dcdqdg"><code>    <span class="code-comment">// Create hidden text label</span>
</code></td></tr><tr><td id="L1524" class="css-a4x74f"><span>1524</span></td><td id="LC1524" class="css-1dcdqdg"><code>    createLabel(key, attr = {}) {
</code></td></tr><tr><td id="L1525" class="css-a4x74f"><span>1525</span></td><td id="LC1525" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> text = i18n.get(key, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L1526" class="css-a4x74f"><span>1526</span></td><td id="LC1526" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> attributes = {
</code></td></tr><tr><td id="L1527" class="css-a4x74f"><span>1527</span></td><td id="LC1527" class="css-1dcdqdg"><code>        ...attr,
</code></td></tr><tr><td id="L1528" class="css-a4x74f"><span>1528</span></td><td id="LC1528" class="css-1dcdqdg"><code>        class: [attr.class, this.config.classNames.hidden].filter(Boolean).join(' ')
</code></td></tr><tr><td id="L1529" class="css-a4x74f"><span>1529</span></td><td id="LC1529" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L1530" class="css-a4x74f"><span>1530</span></td><td id="LC1530" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> createElement(<span class="code-string">'span'</span>, attributes, text);
</code></td></tr><tr><td id="L1531" class="css-a4x74f"><span>1531</span></td><td id="LC1531" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1532" class="css-a4x74f"><span>1532</span></td><td id="LC1532" class="css-1dcdqdg"><code>    <span class="code-comment">// Create a badge</span>
</code></td></tr><tr><td id="L1533" class="css-a4x74f"><span>1533</span></td><td id="LC1533" class="css-1dcdqdg"><code>    createBadge(text) {
</code></td></tr><tr><td id="L1534" class="css-a4x74f"><span>1534</span></td><td id="LC1534" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(text)) {
</code></td></tr><tr><td id="L1535" class="css-a4x74f"><span>1535</span></td><td id="LC1535" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L1536" class="css-a4x74f"><span>1536</span></td><td id="LC1536" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1537" class="css-a4x74f"><span>1537</span></td><td id="LC1537" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> badge = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L1538" class="css-a4x74f"><span>1538</span></td><td id="LC1538" class="css-1dcdqdg"><code>        class: this.config.classNames.menu.value
</code></td></tr><tr><td id="L1539" class="css-a4x74f"><span>1539</span></td><td id="LC1539" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1540" class="css-a4x74f"><span>1540</span></td><td id="LC1540" class="css-1dcdqdg"><code>      badge.appendChild(createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L1541" class="css-a4x74f"><span>1541</span></td><td id="LC1541" class="css-1dcdqdg"><code>        class: this.config.classNames.menu.badge
</code></td></tr><tr><td id="L1542" class="css-a4x74f"><span>1542</span></td><td id="LC1542" class="css-1dcdqdg"><code>      }, text));
</code></td></tr><tr><td id="L1543" class="css-a4x74f"><span>1543</span></td><td id="LC1543" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> badge;
</code></td></tr><tr><td id="L1544" class="css-a4x74f"><span>1544</span></td><td id="LC1544" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1545" class="css-a4x74f"><span>1545</span></td><td id="LC1545" class="css-1dcdqdg"><code>    <span class="code-comment">// Create a &lt;button&gt;</span>
</code></td></tr><tr><td id="L1546" class="css-a4x74f"><span>1546</span></td><td id="LC1546" class="css-1dcdqdg"><code>    createButton(buttonType, attr) {
</code></td></tr><tr><td id="L1547" class="css-a4x74f"><span>1547</span></td><td id="LC1547" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> attributes = extend({}, attr);
</code></td></tr><tr><td id="L1548" class="css-a4x74f"><span>1548</span></td><td id="LC1548" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> type = toCamelCase(buttonType);
</code></td></tr><tr><td id="L1549" class="css-a4x74f"><span>1549</span></td><td id="LC1549" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> props = {
</code></td></tr><tr><td id="L1550" class="css-a4x74f"><span>1550</span></td><td id="LC1550" class="css-1dcdqdg"><code>        element: <span class="code-string">'button'</span>,
</code></td></tr><tr><td id="L1551" class="css-a4x74f"><span>1551</span></td><td id="LC1551" class="css-1dcdqdg"><code>        toggle: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L1552" class="css-a4x74f"><span>1552</span></td><td id="LC1552" class="css-1dcdqdg"><code>        label: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L1553" class="css-a4x74f"><span>1553</span></td><td id="LC1553" class="css-1dcdqdg"><code>        icon: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L1554" class="css-a4x74f"><span>1554</span></td><td id="LC1554" class="css-1dcdqdg"><code>        labelPressed: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L1555" class="css-a4x74f"><span>1555</span></td><td id="LC1555" class="css-1dcdqdg"><code>        iconPressed: <span class="code-literal">null</span>
</code></td></tr><tr><td id="L1556" class="css-a4x74f"><span>1556</span></td><td id="LC1556" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L1557" class="css-a4x74f"><span>1557</span></td><td id="LC1557" class="css-1dcdqdg"><code>      [<span class="code-string">'element'</span>, <span class="code-string">'icon'</span>, <span class="code-string">'label'</span>].forEach(<span class="code-function"><span class="code-params">key</span> =&gt;</span> {
</code></td></tr><tr><td id="L1558" class="css-a4x74f"><span>1558</span></td><td id="LC1558" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(attributes).includes(key)) {
</code></td></tr><tr><td id="L1559" class="css-a4x74f"><span>1559</span></td><td id="LC1559" class="css-1dcdqdg"><code>          props[key] = attributes[key];
</code></td></tr><tr><td id="L1560" class="css-a4x74f"><span>1560</span></td><td id="LC1560" class="css-1dcdqdg"><code>          <span class="code-keyword">delete</span> attributes[key];
</code></td></tr><tr><td id="L1561" class="css-a4x74f"><span>1561</span></td><td id="LC1561" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1562" class="css-a4x74f"><span>1562</span></td><td id="LC1562" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1563" class="css-a4x74f"><span>1563</span></td><td id="LC1563" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1564" class="css-a4x74f"><span>1564</span></td><td id="LC1564" class="css-1dcdqdg"><code>      <span class="code-comment">// Default to 'button' type to prevent form submission</span>
</code></td></tr><tr><td id="L1565" class="css-a4x74f"><span>1565</span></td><td id="LC1565" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (props.element === <span class="code-string">'button'</span> &amp;&amp; !<span class="code-built_in">Object</span>.keys(attributes).includes(<span class="code-string">'type'</span>)) {
</code></td></tr><tr><td id="L1566" class="css-a4x74f"><span>1566</span></td><td id="LC1566" class="css-1dcdqdg"><code>        attributes.type = <span class="code-string">'button'</span>;
</code></td></tr><tr><td id="L1567" class="css-a4x74f"><span>1567</span></td><td id="LC1567" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1568" class="css-a4x74f"><span>1568</span></td><td id="LC1568" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1569" class="css-a4x74f"><span>1569</span></td><td id="LC1569" class="css-1dcdqdg"><code>      <span class="code-comment">// Set class name</span>
</code></td></tr><tr><td id="L1570" class="css-a4x74f"><span>1570</span></td><td id="LC1570" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(attributes).includes(<span class="code-string">'class'</span>)) {
</code></td></tr><tr><td id="L1571" class="css-a4x74f"><span>1571</span></td><td id="LC1571" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!attributes.class.split(<span class="code-string">' '</span>).some(<span class="code-function"><span class="code-params">c</span> =&gt;</span> c === <span class="code-keyword">this</span>.config.classNames.control)) {
</code></td></tr><tr><td id="L1572" class="css-a4x74f"><span>1572</span></td><td id="LC1572" class="css-1dcdqdg"><code>          extend(attributes, {
</code></td></tr><tr><td id="L1573" class="css-a4x74f"><span>1573</span></td><td id="LC1573" class="css-1dcdqdg"><code>            class: `${attributes.class} ${this.config.classNames.control}`
</code></td></tr><tr><td id="L1574" class="css-a4x74f"><span>1574</span></td><td id="LC1574" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L1575" class="css-a4x74f"><span>1575</span></td><td id="LC1575" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1576" class="css-a4x74f"><span>1576</span></td><td id="LC1576" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1577" class="css-a4x74f"><span>1577</span></td><td id="LC1577" class="css-1dcdqdg"><code>        attributes.class = <span class="code-keyword">this</span>.config.classNames.control;
</code></td></tr><tr><td id="L1578" class="css-a4x74f"><span>1578</span></td><td id="LC1578" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1579" class="css-a4x74f"><span>1579</span></td><td id="LC1579" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1580" class="css-a4x74f"><span>1580</span></td><td id="LC1580" class="css-1dcdqdg"><code>      <span class="code-comment">// Large play button</span>
</code></td></tr><tr><td id="L1581" class="css-a4x74f"><span>1581</span></td><td id="LC1581" class="css-1dcdqdg"><code>      <span class="code-keyword">switch</span> (buttonType) {
</code></td></tr><tr><td id="L1582" class="css-a4x74f"><span>1582</span></td><td id="LC1582" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'play'</span>:
</code></td></tr><tr><td id="L1583" class="css-a4x74f"><span>1583</span></td><td id="LC1583" class="css-1dcdqdg"><code>          props.toggle = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1584" class="css-a4x74f"><span>1584</span></td><td id="LC1584" class="css-1dcdqdg"><code>          props.label = <span class="code-string">'play'</span>;
</code></td></tr><tr><td id="L1585" class="css-a4x74f"><span>1585</span></td><td id="LC1585" class="css-1dcdqdg"><code>          props.labelPressed = <span class="code-string">'pause'</span>;
</code></td></tr><tr><td id="L1586" class="css-a4x74f"><span>1586</span></td><td id="LC1586" class="css-1dcdqdg"><code>          props.icon = <span class="code-string">'play'</span>;
</code></td></tr><tr><td id="L1587" class="css-a4x74f"><span>1587</span></td><td id="LC1587" class="css-1dcdqdg"><code>          props.iconPressed = <span class="code-string">'pause'</span>;
</code></td></tr><tr><td id="L1588" class="css-a4x74f"><span>1588</span></td><td id="LC1588" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1589" class="css-a4x74f"><span>1589</span></td><td id="LC1589" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'mute'</span>:
</code></td></tr><tr><td id="L1590" class="css-a4x74f"><span>1590</span></td><td id="LC1590" class="css-1dcdqdg"><code>          props.toggle = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1591" class="css-a4x74f"><span>1591</span></td><td id="LC1591" class="css-1dcdqdg"><code>          props.label = <span class="code-string">'mute'</span>;
</code></td></tr><tr><td id="L1592" class="css-a4x74f"><span>1592</span></td><td id="LC1592" class="css-1dcdqdg"><code>          props.labelPressed = <span class="code-string">'unmute'</span>;
</code></td></tr><tr><td id="L1593" class="css-a4x74f"><span>1593</span></td><td id="LC1593" class="css-1dcdqdg"><code>          props.icon = <span class="code-string">'volume'</span>;
</code></td></tr><tr><td id="L1594" class="css-a4x74f"><span>1594</span></td><td id="LC1594" class="css-1dcdqdg"><code>          props.iconPressed = <span class="code-string">'muted'</span>;
</code></td></tr><tr><td id="L1595" class="css-a4x74f"><span>1595</span></td><td id="LC1595" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1596" class="css-a4x74f"><span>1596</span></td><td id="LC1596" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'captions'</span>:
</code></td></tr><tr><td id="L1597" class="css-a4x74f"><span>1597</span></td><td id="LC1597" class="css-1dcdqdg"><code>          props.toggle = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1598" class="css-a4x74f"><span>1598</span></td><td id="LC1598" class="css-1dcdqdg"><code>          props.label = <span class="code-string">'enableCaptions'</span>;
</code></td></tr><tr><td id="L1599" class="css-a4x74f"><span>1599</span></td><td id="LC1599" class="css-1dcdqdg"><code>          props.labelPressed = <span class="code-string">'disableCaptions'</span>;
</code></td></tr><tr><td id="L1600" class="css-a4x74f"><span>1600</span></td><td id="LC1600" class="css-1dcdqdg"><code>          props.icon = <span class="code-string">'captions-off'</span>;
</code></td></tr><tr><td id="L1601" class="css-a4x74f"><span>1601</span></td><td id="LC1601" class="css-1dcdqdg"><code>          props.iconPressed = <span class="code-string">'captions-on'</span>;
</code></td></tr><tr><td id="L1602" class="css-a4x74f"><span>1602</span></td><td id="LC1602" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1603" class="css-a4x74f"><span>1603</span></td><td id="LC1603" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'fullscreen'</span>:
</code></td></tr><tr><td id="L1604" class="css-a4x74f"><span>1604</span></td><td id="LC1604" class="css-1dcdqdg"><code>          props.toggle = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1605" class="css-a4x74f"><span>1605</span></td><td id="LC1605" class="css-1dcdqdg"><code>          props.label = <span class="code-string">'enterFullscreen'</span>;
</code></td></tr><tr><td id="L1606" class="css-a4x74f"><span>1606</span></td><td id="LC1606" class="css-1dcdqdg"><code>          props.labelPressed = <span class="code-string">'exitFullscreen'</span>;
</code></td></tr><tr><td id="L1607" class="css-a4x74f"><span>1607</span></td><td id="LC1607" class="css-1dcdqdg"><code>          props.icon = <span class="code-string">'enter-fullscreen'</span>;
</code></td></tr><tr><td id="L1608" class="css-a4x74f"><span>1608</span></td><td id="LC1608" class="css-1dcdqdg"><code>          props.iconPressed = <span class="code-string">'exit-fullscreen'</span>;
</code></td></tr><tr><td id="L1609" class="css-a4x74f"><span>1609</span></td><td id="LC1609" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1610" class="css-a4x74f"><span>1610</span></td><td id="LC1610" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'play-large'</span>:
</code></td></tr><tr><td id="L1611" class="css-a4x74f"><span>1611</span></td><td id="LC1611" class="css-1dcdqdg"><code>          attributes.class += <span class="code-string">` <span class="code-subst">${<span class="code-keyword">this</span>.config.classNames.control}</span>--overlaid`</span>;
</code></td></tr><tr><td id="L1612" class="css-a4x74f"><span>1612</span></td><td id="LC1612" class="css-1dcdqdg"><code>          type = <span class="code-string">'play'</span>;
</code></td></tr><tr><td id="L1613" class="css-a4x74f"><span>1613</span></td><td id="LC1613" class="css-1dcdqdg"><code>          props.label = <span class="code-string">'play'</span>;
</code></td></tr><tr><td id="L1614" class="css-a4x74f"><span>1614</span></td><td id="LC1614" class="css-1dcdqdg"><code>          props.icon = <span class="code-string">'play'</span>;
</code></td></tr><tr><td id="L1615" class="css-a4x74f"><span>1615</span></td><td id="LC1615" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1616" class="css-a4x74f"><span>1616</span></td><td id="LC1616" class="css-1dcdqdg"><code>        <span class="code-keyword">default</span>:
</code></td></tr><tr><td id="L1617" class="css-a4x74f"><span>1617</span></td><td id="LC1617" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(props.label)) {
</code></td></tr><tr><td id="L1618" class="css-a4x74f"><span>1618</span></td><td id="LC1618" class="css-1dcdqdg"><code>            props.label = type;
</code></td></tr><tr><td id="L1619" class="css-a4x74f"><span>1619</span></td><td id="LC1619" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1620" class="css-a4x74f"><span>1620</span></td><td id="LC1620" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(props.icon)) {
</code></td></tr><tr><td id="L1621" class="css-a4x74f"><span>1621</span></td><td id="LC1621" class="css-1dcdqdg"><code>            props.icon = buttonType;
</code></td></tr><tr><td id="L1622" class="css-a4x74f"><span>1622</span></td><td id="LC1622" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1623" class="css-a4x74f"><span>1623</span></td><td id="LC1623" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1624" class="css-a4x74f"><span>1624</span></td><td id="LC1624" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> button = createElement(props.element);
</code></td></tr><tr><td id="L1625" class="css-a4x74f"><span>1625</span></td><td id="LC1625" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1626" class="css-a4x74f"><span>1626</span></td><td id="LC1626" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup toggle icon and labels</span>
</code></td></tr><tr><td id="L1627" class="css-a4x74f"><span>1627</span></td><td id="LC1627" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (props.toggle) {
</code></td></tr><tr><td id="L1628" class="css-a4x74f"><span>1628</span></td><td id="LC1628" class="css-1dcdqdg"><code>        <span class="code-comment">// Icon</span>
</code></td></tr><tr><td id="L1629" class="css-a4x74f"><span>1629</span></td><td id="LC1629" class="css-1dcdqdg"><code>        button.appendChild(controls.createIcon.call(<span class="code-keyword">this</span>, props.iconPressed, {
</code></td></tr><tr><td id="L1630" class="css-a4x74f"><span>1630</span></td><td id="LC1630" class="css-1dcdqdg"><code>          class: 'icon--pressed'
</code></td></tr><tr><td id="L1631" class="css-a4x74f"><span>1631</span></td><td id="LC1631" class="css-1dcdqdg"><code>        }));
</code></td></tr><tr><td id="L1632" class="css-a4x74f"><span>1632</span></td><td id="LC1632" class="css-1dcdqdg"><code>        button.appendChild(controls.createIcon.call(<span class="code-keyword">this</span>, props.icon, {
</code></td></tr><tr><td id="L1633" class="css-a4x74f"><span>1633</span></td><td id="LC1633" class="css-1dcdqdg"><code>          class: 'icon--not-pressed'
</code></td></tr><tr><td id="L1634" class="css-a4x74f"><span>1634</span></td><td id="LC1634" class="css-1dcdqdg"><code>        }));
</code></td></tr><tr><td id="L1635" class="css-a4x74f"><span>1635</span></td><td id="LC1635" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1636" class="css-a4x74f"><span>1636</span></td><td id="LC1636" class="css-1dcdqdg"><code>        <span class="code-comment">// Label/Tooltip</span>
</code></td></tr><tr><td id="L1637" class="css-a4x74f"><span>1637</span></td><td id="LC1637" class="css-1dcdqdg"><code>        button.appendChild(controls.createLabel.call(<span class="code-keyword">this</span>, props.labelPressed, {
</code></td></tr><tr><td id="L1638" class="css-a4x74f"><span>1638</span></td><td id="LC1638" class="css-1dcdqdg"><code>          class: 'label--pressed'
</code></td></tr><tr><td id="L1639" class="css-a4x74f"><span>1639</span></td><td id="LC1639" class="css-1dcdqdg"><code>        }));
</code></td></tr><tr><td id="L1640" class="css-a4x74f"><span>1640</span></td><td id="LC1640" class="css-1dcdqdg"><code>        button.appendChild(controls.createLabel.call(<span class="code-keyword">this</span>, props.label, {
</code></td></tr><tr><td id="L1641" class="css-a4x74f"><span>1641</span></td><td id="LC1641" class="css-1dcdqdg"><code>          class: 'label--not-pressed'
</code></td></tr><tr><td id="L1642" class="css-a4x74f"><span>1642</span></td><td id="LC1642" class="css-1dcdqdg"><code>        }));
</code></td></tr><tr><td id="L1643" class="css-a4x74f"><span>1643</span></td><td id="LC1643" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1644" class="css-a4x74f"><span>1644</span></td><td id="LC1644" class="css-1dcdqdg"><code>        button.appendChild(controls.createIcon.call(<span class="code-keyword">this</span>, props.icon));
</code></td></tr><tr><td id="L1645" class="css-a4x74f"><span>1645</span></td><td id="LC1645" class="css-1dcdqdg"><code>        button.appendChild(controls.createLabel.call(<span class="code-keyword">this</span>, props.label));
</code></td></tr><tr><td id="L1646" class="css-a4x74f"><span>1646</span></td><td id="LC1646" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1647" class="css-a4x74f"><span>1647</span></td><td id="LC1647" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1648" class="css-a4x74f"><span>1648</span></td><td id="LC1648" class="css-1dcdqdg"><code>      <span class="code-comment">// Merge and set attributes</span>
</code></td></tr><tr><td id="L1649" class="css-a4x74f"><span>1649</span></td><td id="LC1649" class="css-1dcdqdg"><code>      extend(attributes, getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.buttons[type], attributes));
</code></td></tr><tr><td id="L1650" class="css-a4x74f"><span>1650</span></td><td id="LC1650" class="css-1dcdqdg"><code>      setAttributes(button, attributes);
</code></td></tr><tr><td id="L1651" class="css-a4x74f"><span>1651</span></td><td id="LC1651" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1652" class="css-a4x74f"><span>1652</span></td><td id="LC1652" class="css-1dcdqdg"><code>      <span class="code-comment">// We have multiple play buttons</span>
</code></td></tr><tr><td id="L1653" class="css-a4x74f"><span>1653</span></td><td id="LC1653" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (type === <span class="code-string">'play'</span>) {
</code></td></tr><tr><td id="L1654" class="css-a4x74f"><span>1654</span></td><td id="LC1654" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.array(<span class="code-keyword">this</span>.elements.buttons[type])) {
</code></td></tr><tr><td id="L1655" class="css-a4x74f"><span>1655</span></td><td id="LC1655" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.buttons[type] = [];
</code></td></tr><tr><td id="L1656" class="css-a4x74f"><span>1656</span></td><td id="LC1656" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1657" class="css-a4x74f"><span>1657</span></td><td id="LC1657" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.buttons[type].push(button);
</code></td></tr><tr><td id="L1658" class="css-a4x74f"><span>1658</span></td><td id="LC1658" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1659" class="css-a4x74f"><span>1659</span></td><td id="LC1659" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.buttons[type] = button;
</code></td></tr><tr><td id="L1660" class="css-a4x74f"><span>1660</span></td><td id="LC1660" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1661" class="css-a4x74f"><span>1661</span></td><td id="LC1661" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> button;
</code></td></tr><tr><td id="L1662" class="css-a4x74f"><span>1662</span></td><td id="LC1662" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1663" class="css-a4x74f"><span>1663</span></td><td id="LC1663" class="css-1dcdqdg"><code>    <span class="code-comment">// Create an &lt;input type='range'&gt;</span>
</code></td></tr><tr><td id="L1664" class="css-a4x74f"><span>1664</span></td><td id="LC1664" class="css-1dcdqdg"><code>    createRange(type, attributes) {
</code></td></tr><tr><td id="L1665" class="css-a4x74f"><span>1665</span></td><td id="LC1665" class="css-1dcdqdg"><code>      <span class="code-comment">// Seek input</span>
</code></td></tr><tr><td id="L1666" class="css-a4x74f"><span>1666</span></td><td id="LC1666" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> input = createElement(<span class="code-string">'input'</span>, extend(getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.inputs[type]), {
</code></td></tr><tr><td id="L1667" class="css-a4x74f"><span>1667</span></td><td id="LC1667" class="css-1dcdqdg"><code>        type: <span class="code-string">'range'</span>,
</code></td></tr><tr><td id="L1668" class="css-a4x74f"><span>1668</span></td><td id="LC1668" class="css-1dcdqdg"><code>        min: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L1669" class="css-a4x74f"><span>1669</span></td><td id="LC1669" class="css-1dcdqdg"><code>        max: <span class="code-number">100</span>,
</code></td></tr><tr><td id="L1670" class="css-a4x74f"><span>1670</span></td><td id="LC1670" class="css-1dcdqdg"><code>        step: <span class="code-number">0.01</span>,
</code></td></tr><tr><td id="L1671" class="css-a4x74f"><span>1671</span></td><td id="LC1671" class="css-1dcdqdg"><code>        value: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L1672" class="css-a4x74f"><span>1672</span></td><td id="LC1672" class="css-1dcdqdg"><code>        autocomplete: <span class="code-string">'off'</span>,
</code></td></tr><tr><td id="L1673" class="css-a4x74f"><span>1673</span></td><td id="LC1673" class="css-1dcdqdg"><code>        <span class="code-comment">// A11y fixes for https://github.com/sampotts/plyr/issues/905</span>
</code></td></tr><tr><td id="L1674" class="css-a4x74f"><span>1674</span></td><td id="LC1674" class="css-1dcdqdg"><code>        role: <span class="code-string">'slider'</span>,
</code></td></tr><tr><td id="L1675" class="css-a4x74f"><span>1675</span></td><td id="LC1675" class="css-1dcdqdg"><code>        <span class="code-string">'aria-label'</span>: i18n.get(type, <span class="code-keyword">this</span>.config),
</code></td></tr><tr><td id="L1676" class="css-a4x74f"><span>1676</span></td><td id="LC1676" class="css-1dcdqdg"><code>        <span class="code-string">'aria-valuemin'</span>: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L1677" class="css-a4x74f"><span>1677</span></td><td id="LC1677" class="css-1dcdqdg"><code>        <span class="code-string">'aria-valuemax'</span>: <span class="code-number">100</span>,
</code></td></tr><tr><td id="L1678" class="css-a4x74f"><span>1678</span></td><td id="LC1678" class="css-1dcdqdg"><code>        <span class="code-string">'aria-valuenow'</span>: <span class="code-number">0</span>
</code></td></tr><tr><td id="L1679" class="css-a4x74f"><span>1679</span></td><td id="LC1679" class="css-1dcdqdg"><code>      }, attributes));
</code></td></tr><tr><td id="L1680" class="css-a4x74f"><span>1680</span></td><td id="LC1680" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.inputs[type] = input;
</code></td></tr><tr><td id="L1681" class="css-a4x74f"><span>1681</span></td><td id="LC1681" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1682" class="css-a4x74f"><span>1682</span></td><td id="LC1682" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the fill for webkit now</span>
</code></td></tr><tr><td id="L1683" class="css-a4x74f"><span>1683</span></td><td id="LC1683" class="css-1dcdqdg"><code>      controls.updateRangeFill.call(<span class="code-keyword">this</span>, input);
</code></td></tr><tr><td id="L1684" class="css-a4x74f"><span>1684</span></td><td id="LC1684" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1685" class="css-a4x74f"><span>1685</span></td><td id="LC1685" class="css-1dcdqdg"><code>      <span class="code-comment">// Improve support on touch devices</span>
</code></td></tr><tr><td id="L1686" class="css-a4x74f"><span>1686</span></td><td id="LC1686" class="css-1dcdqdg"><code>      RangeTouch.setup(input);
</code></td></tr><tr><td id="L1687" class="css-a4x74f"><span>1687</span></td><td id="LC1687" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> input;
</code></td></tr><tr><td id="L1688" class="css-a4x74f"><span>1688</span></td><td id="LC1688" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1689" class="css-a4x74f"><span>1689</span></td><td id="LC1689" class="css-1dcdqdg"><code>    <span class="code-comment">// Create a &lt;progress&gt;</span>
</code></td></tr><tr><td id="L1690" class="css-a4x74f"><span>1690</span></td><td id="LC1690" class="css-1dcdqdg"><code>    createProgress(type, attributes) {
</code></td></tr><tr><td id="L1691" class="css-a4x74f"><span>1691</span></td><td id="LC1691" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> progress = createElement(<span class="code-string">'progress'</span>, extend(getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.display[type]), {
</code></td></tr><tr><td id="L1692" class="css-a4x74f"><span>1692</span></td><td id="LC1692" class="css-1dcdqdg"><code>        min: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L1693" class="css-a4x74f"><span>1693</span></td><td id="LC1693" class="css-1dcdqdg"><code>        max: <span class="code-number">100</span>,
</code></td></tr><tr><td id="L1694" class="css-a4x74f"><span>1694</span></td><td id="LC1694" class="css-1dcdqdg"><code>        value: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L1695" class="css-a4x74f"><span>1695</span></td><td id="LC1695" class="css-1dcdqdg"><code>        role: <span class="code-string">'progressbar'</span>,
</code></td></tr><tr><td id="L1696" class="css-a4x74f"><span>1696</span></td><td id="LC1696" class="css-1dcdqdg"><code>        <span class="code-string">'aria-hidden'</span>: <span class="code-literal">true</span>
</code></td></tr><tr><td id="L1697" class="css-a4x74f"><span>1697</span></td><td id="LC1697" class="css-1dcdqdg"><code>      }, attributes));
</code></td></tr><tr><td id="L1698" class="css-a4x74f"><span>1698</span></td><td id="LC1698" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1699" class="css-a4x74f"><span>1699</span></td><td id="LC1699" class="css-1dcdqdg"><code>      <span class="code-comment">// Create the label inside</span>
</code></td></tr><tr><td id="L1700" class="css-a4x74f"><span>1700</span></td><td id="LC1700" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (type !== <span class="code-string">'volume'</span>) {
</code></td></tr><tr><td id="L1701" class="css-a4x74f"><span>1701</span></td><td id="LC1701" class="css-1dcdqdg"><code>        progress.appendChild(createElement(<span class="code-string">'span'</span>, <span class="code-literal">null</span>, <span class="code-string">'0'</span>));
</code></td></tr><tr><td id="L1702" class="css-a4x74f"><span>1702</span></td><td id="LC1702" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> suffixKey = {
</code></td></tr><tr><td id="L1703" class="css-a4x74f"><span>1703</span></td><td id="LC1703" class="css-1dcdqdg"><code>          played: <span class="code-string">'played'</span>,
</code></td></tr><tr><td id="L1704" class="css-a4x74f"><span>1704</span></td><td id="LC1704" class="css-1dcdqdg"><code>          buffer: <span class="code-string">'buffered'</span>
</code></td></tr><tr><td id="L1705" class="css-a4x74f"><span>1705</span></td><td id="LC1705" class="css-1dcdqdg"><code>        }[type];
</code></td></tr><tr><td id="L1706" class="css-a4x74f"><span>1706</span></td><td id="LC1706" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> suffix = suffixKey ? i18n.get(suffixKey, <span class="code-keyword">this</span>.config) : <span class="code-string">''</span>;
</code></td></tr><tr><td id="L1707" class="css-a4x74f"><span>1707</span></td><td id="LC1707" class="css-1dcdqdg"><code>        progress.innerText = <span class="code-string">`% <span class="code-subst">${suffix.toLowerCase()}</span>`</span>;
</code></td></tr><tr><td id="L1708" class="css-a4x74f"><span>1708</span></td><td id="LC1708" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1709" class="css-a4x74f"><span>1709</span></td><td id="LC1709" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.display[type] = progress;
</code></td></tr><tr><td id="L1710" class="css-a4x74f"><span>1710</span></td><td id="LC1710" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> progress;
</code></td></tr><tr><td id="L1711" class="css-a4x74f"><span>1711</span></td><td id="LC1711" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1712" class="css-a4x74f"><span>1712</span></td><td id="LC1712" class="css-1dcdqdg"><code>    <span class="code-comment">// Create time display</span>
</code></td></tr><tr><td id="L1713" class="css-a4x74f"><span>1713</span></td><td id="LC1713" class="css-1dcdqdg"><code>    createTime(type, attrs) {
</code></td></tr><tr><td id="L1714" class="css-a4x74f"><span>1714</span></td><td id="LC1714" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> attributes = getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.display[type], attrs);
</code></td></tr><tr><td id="L1715" class="css-a4x74f"><span>1715</span></td><td id="LC1715" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> container = createElement(<span class="code-string">'div'</span>, extend(attributes, {
</code></td></tr><tr><td id="L1716" class="css-a4x74f"><span>1716</span></td><td id="LC1716" class="css-1dcdqdg"><code>        class: `${attributes.class ? attributes.class : ''} ${this.config.classNames.display.time} `.trim(),
</code></td></tr><tr><td id="L1717" class="css-a4x74f"><span>1717</span></td><td id="LC1717" class="css-1dcdqdg"><code>        <span class="code-string">'aria-label'</span>: i18n.get(type, <span class="code-keyword">this</span>.config),
</code></td></tr><tr><td id="L1718" class="css-a4x74f"><span>1718</span></td><td id="LC1718" class="css-1dcdqdg"><code>        role: <span class="code-string">'timer'</span>
</code></td></tr><tr><td id="L1719" class="css-a4x74f"><span>1719</span></td><td id="LC1719" class="css-1dcdqdg"><code>      }), <span class="code-string">'00:00'</span>);
</code></td></tr><tr><td id="L1720" class="css-a4x74f"><span>1720</span></td><td id="LC1720" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1721" class="css-a4x74f"><span>1721</span></td><td id="LC1721" class="css-1dcdqdg"><code>      <span class="code-comment">// Reference for updates</span>
</code></td></tr><tr><td id="L1722" class="css-a4x74f"><span>1722</span></td><td id="LC1722" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.display[type] = container;
</code></td></tr><tr><td id="L1723" class="css-a4x74f"><span>1723</span></td><td id="LC1723" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> container;
</code></td></tr><tr><td id="L1724" class="css-a4x74f"><span>1724</span></td><td id="LC1724" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1725" class="css-a4x74f"><span>1725</span></td><td id="LC1725" class="css-1dcdqdg"><code>    <span class="code-comment">// Bind keyboard shortcuts for a menu item</span>
</code></td></tr><tr><td id="L1726" class="css-a4x74f"><span>1726</span></td><td id="LC1726" class="css-1dcdqdg"><code>    <span class="code-comment">// We have to bind to keyup otherwise Firefox triggers a click when a keydown event handler shifts focus</span>
</code></td></tr><tr><td id="L1727" class="css-a4x74f"><span>1727</span></td><td id="LC1727" class="css-1dcdqdg"><code>    <span class="code-comment">// https://bugzilla.mozilla.org/show_bug.cgi?id=1220143</span>
</code></td></tr><tr><td id="L1728" class="css-a4x74f"><span>1728</span></td><td id="LC1728" class="css-1dcdqdg"><code>    bindMenuItemShortcuts(menuItem, type) {
</code></td></tr><tr><td id="L1729" class="css-a4x74f"><span>1729</span></td><td id="LC1729" class="css-1dcdqdg"><code>      <span class="code-comment">// Navigate through menus via arrow keys and space</span>
</code></td></tr><tr><td id="L1730" class="css-a4x74f"><span>1730</span></td><td id="LC1730" class="css-1dcdqdg"><code>      on.call(<span class="code-keyword">this</span>, menuItem, <span class="code-string">'keydown keyup'</span>, event =&gt; {
</code></td></tr><tr><td id="L1731" class="css-a4x74f"><span>1731</span></td><td id="LC1731" class="css-1dcdqdg"><code>        <span class="code-comment">// We only care about space and ⬆️ ⬇️️ ➡️</span>
</code></td></tr><tr><td id="L1732" class="css-a4x74f"><span>1732</span></td><td id="LC1732" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (![<span class="code-string">' '</span>, <span class="code-string">'ArrowUp'</span>, <span class="code-string">'ArrowDown'</span>, <span class="code-string">'ArrowRight'</span>].includes(event.key)) {
</code></td></tr><tr><td id="L1733" class="css-a4x74f"><span>1733</span></td><td id="LC1733" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1734" class="css-a4x74f"><span>1734</span></td><td id="LC1734" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1735" class="css-a4x74f"><span>1735</span></td><td id="LC1735" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1736" class="css-a4x74f"><span>1736</span></td><td id="LC1736" class="css-1dcdqdg"><code>        <span class="code-comment">// Prevent play / seek</span>
</code></td></tr><tr><td id="L1737" class="css-a4x74f"><span>1737</span></td><td id="LC1737" class="css-1dcdqdg"><code>        event.preventDefault();
</code></td></tr><tr><td id="L1738" class="css-a4x74f"><span>1738</span></td><td id="LC1738" class="css-1dcdqdg"><code>        event.stopPropagation();
</code></td></tr><tr><td id="L1739" class="css-a4x74f"><span>1739</span></td><td id="LC1739" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1740" class="css-a4x74f"><span>1740</span></td><td id="LC1740" class="css-1dcdqdg"><code>        <span class="code-comment">// We're just here to prevent the keydown bubbling</span>
</code></td></tr><tr><td id="L1741" class="css-a4x74f"><span>1741</span></td><td id="LC1741" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (event.type === <span class="code-string">'keydown'</span>) {
</code></td></tr><tr><td id="L1742" class="css-a4x74f"><span>1742</span></td><td id="LC1742" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1743" class="css-a4x74f"><span>1743</span></td><td id="LC1743" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1744" class="css-a4x74f"><span>1744</span></td><td id="LC1744" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> isRadioButton = matches(menuItem, <span class="code-string">'[role="menuitemradio"]'</span>);
</code></td></tr><tr><td id="L1745" class="css-a4x74f"><span>1745</span></td><td id="LC1745" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1746" class="css-a4x74f"><span>1746</span></td><td id="LC1746" class="css-1dcdqdg"><code>        <span class="code-comment">// Show the respective menu</span>
</code></td></tr><tr><td id="L1747" class="css-a4x74f"><span>1747</span></td><td id="LC1747" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!isRadioButton &amp;&amp; [<span class="code-string">' '</span>, <span class="code-string">'ArrowRight'</span>].includes(event.key)) {
</code></td></tr><tr><td id="L1748" class="css-a4x74f"><span>1748</span></td><td id="LC1748" class="css-1dcdqdg"><code>          controls.showMenuPanel.call(<span class="code-keyword">this</span>, type, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L1749" class="css-a4x74f"><span>1749</span></td><td id="LC1749" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1750" class="css-a4x74f"><span>1750</span></td><td id="LC1750" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> target;
</code></td></tr><tr><td id="L1751" class="css-a4x74f"><span>1751</span></td><td id="LC1751" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.key !== <span class="code-string">' '</span>) {
</code></td></tr><tr><td id="L1752" class="css-a4x74f"><span>1752</span></td><td id="LC1752" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (event.key === <span class="code-string">'ArrowDown'</span> || isRadioButton &amp;&amp; event.key === <span class="code-string">'ArrowRight'</span>) {
</code></td></tr><tr><td id="L1753" class="css-a4x74f"><span>1753</span></td><td id="LC1753" class="css-1dcdqdg"><code>              target = menuItem.nextElementSibling;
</code></td></tr><tr><td id="L1754" class="css-a4x74f"><span>1754</span></td><td id="LC1754" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L1755" class="css-a4x74f"><span>1755</span></td><td id="LC1755" class="css-1dcdqdg"><code>                target = menuItem.parentNode.firstElementChild;
</code></td></tr><tr><td id="L1756" class="css-a4x74f"><span>1756</span></td><td id="LC1756" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L1757" class="css-a4x74f"><span>1757</span></td><td id="LC1757" class="css-1dcdqdg"><code>            } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1758" class="css-a4x74f"><span>1758</span></td><td id="LC1758" class="css-1dcdqdg"><code>              target = menuItem.previousElementSibling;
</code></td></tr><tr><td id="L1759" class="css-a4x74f"><span>1759</span></td><td id="LC1759" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L1760" class="css-a4x74f"><span>1760</span></td><td id="LC1760" class="css-1dcdqdg"><code>                target = menuItem.parentNode.lastElementChild;
</code></td></tr><tr><td id="L1761" class="css-a4x74f"><span>1761</span></td><td id="LC1761" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L1762" class="css-a4x74f"><span>1762</span></td><td id="LC1762" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L1763" class="css-a4x74f"><span>1763</span></td><td id="LC1763" class="css-1dcdqdg"><code>            setFocus.call(<span class="code-keyword">this</span>, target, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L1764" class="css-a4x74f"><span>1764</span></td><td id="LC1764" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1765" class="css-a4x74f"><span>1765</span></td><td id="LC1765" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1766" class="css-a4x74f"><span>1766</span></td><td id="LC1766" class="css-1dcdqdg"><code>      }, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L1767" class="css-a4x74f"><span>1767</span></td><td id="LC1767" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1768" class="css-a4x74f"><span>1768</span></td><td id="LC1768" class="css-1dcdqdg"><code>      <span class="code-comment">// Enter will fire a `click` event but we still need to manage focus</span>
</code></td></tr><tr><td id="L1769" class="css-a4x74f"><span>1769</span></td><td id="LC1769" class="css-1dcdqdg"><code>      <span class="code-comment">// So we bind to keyup which fires after and set focus here</span>
</code></td></tr><tr><td id="L1770" class="css-a4x74f"><span>1770</span></td><td id="LC1770" class="css-1dcdqdg"><code>      on.call(<span class="code-keyword">this</span>, menuItem, <span class="code-string">'keyup'</span>, event =&gt; {
</code></td></tr><tr><td id="L1771" class="css-a4x74f"><span>1771</span></td><td id="LC1771" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (event.key !== <span class="code-string">'Return'</span>) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1772" class="css-a4x74f"><span>1772</span></td><td id="LC1772" class="css-1dcdqdg"><code>        controls.focusFirstMenuItem.call(<span class="code-keyword">this</span>, <span class="code-literal">null</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L1773" class="css-a4x74f"><span>1773</span></td><td id="LC1773" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1774" class="css-a4x74f"><span>1774</span></td><td id="LC1774" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1775" class="css-a4x74f"><span>1775</span></td><td id="LC1775" class="css-1dcdqdg"><code>    <span class="code-comment">// Create a settings menu item</span>
</code></td></tr><tr><td id="L1776" class="css-a4x74f"><span>1776</span></td><td id="LC1776" class="css-1dcdqdg"><code>    createMenuItem({
</code></td></tr><tr><td id="L1777" class="css-a4x74f"><span>1777</span></td><td id="LC1777" class="css-1dcdqdg"><code>      value,
</code></td></tr><tr><td id="L1778" class="css-a4x74f"><span>1778</span></td><td id="LC1778" class="css-1dcdqdg"><code>      list,
</code></td></tr><tr><td id="L1779" class="css-a4x74f"><span>1779</span></td><td id="LC1779" class="css-1dcdqdg"><code>      type,
</code></td></tr><tr><td id="L1780" class="css-a4x74f"><span>1780</span></td><td id="LC1780" class="css-1dcdqdg"><code>      title,
</code></td></tr><tr><td id="L1781" class="css-a4x74f"><span>1781</span></td><td id="LC1781" class="css-1dcdqdg"><code>      badge = <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L1782" class="css-a4x74f"><span>1782</span></td><td id="LC1782" class="css-1dcdqdg"><code>      checked = <span class="code-literal">false</span>
</code></td></tr><tr><td id="L1783" class="css-a4x74f"><span>1783</span></td><td id="LC1783" class="css-1dcdqdg"><code>    }) {
</code></td></tr><tr><td id="L1784" class="css-a4x74f"><span>1784</span></td><td id="LC1784" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> attributes = getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.inputs[type]);
</code></td></tr><tr><td id="L1785" class="css-a4x74f"><span>1785</span></td><td id="LC1785" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> menuItem = createElement(<span class="code-string">'button'</span>, extend(attributes, {
</code></td></tr><tr><td id="L1786" class="css-a4x74f"><span>1786</span></td><td id="LC1786" class="css-1dcdqdg"><code>        type: <span class="code-string">'button'</span>,
</code></td></tr><tr><td id="L1787" class="css-a4x74f"><span>1787</span></td><td id="LC1787" class="css-1dcdqdg"><code>        role: <span class="code-string">'menuitemradio'</span>,
</code></td></tr><tr><td id="L1788" class="css-a4x74f"><span>1788</span></td><td id="LC1788" class="css-1dcdqdg"><code>        class: `${this.config.classNames.control} ${attributes.class ? attributes.class : ''}`.trim(),
</code></td></tr><tr><td id="L1789" class="css-a4x74f"><span>1789</span></td><td id="LC1789" class="css-1dcdqdg"><code>        <span class="code-string">'aria-checked'</span>: checked,
</code></td></tr><tr><td id="L1790" class="css-a4x74f"><span>1790</span></td><td id="LC1790" class="css-1dcdqdg"><code>        value
</code></td></tr><tr><td id="L1791" class="css-a4x74f"><span>1791</span></td><td id="LC1791" class="css-1dcdqdg"><code>      }));
</code></td></tr><tr><td id="L1792" class="css-a4x74f"><span>1792</span></td><td id="LC1792" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> flex = createElement(<span class="code-string">'span'</span>);
</code></td></tr><tr><td id="L1793" class="css-a4x74f"><span>1793</span></td><td id="LC1793" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1794" class="css-a4x74f"><span>1794</span></td><td id="LC1794" class="css-1dcdqdg"><code>      <span class="code-comment">// We have to set as HTML incase of special characters</span>
</code></td></tr><tr><td id="L1795" class="css-a4x74f"><span>1795</span></td><td id="LC1795" class="css-1dcdqdg"><code>      flex.innerHTML = title;
</code></td></tr><tr><td id="L1796" class="css-a4x74f"><span>1796</span></td><td id="LC1796" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(badge)) {
</code></td></tr><tr><td id="L1797" class="css-a4x74f"><span>1797</span></td><td id="LC1797" class="css-1dcdqdg"><code>        flex.appendChild(badge);
</code></td></tr><tr><td id="L1798" class="css-a4x74f"><span>1798</span></td><td id="LC1798" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1799" class="css-a4x74f"><span>1799</span></td><td id="LC1799" class="css-1dcdqdg"><code>      menuItem.appendChild(flex);
</code></td></tr><tr><td id="L1800" class="css-a4x74f"><span>1800</span></td><td id="LC1800" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1801" class="css-a4x74f"><span>1801</span></td><td id="LC1801" class="css-1dcdqdg"><code>      <span class="code-comment">// Replicate radio button behavior</span>
</code></td></tr><tr><td id="L1802" class="css-a4x74f"><span>1802</span></td><td id="LC1802" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(menuItem, <span class="code-string">'checked'</span>, {
</code></td></tr><tr><td id="L1803" class="css-a4x74f"><span>1803</span></td><td id="LC1803" class="css-1dcdqdg"><code>        enumerable: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L1804" class="css-a4x74f"><span>1804</span></td><td id="LC1804" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L1805" class="css-a4x74f"><span>1805</span></td><td id="LC1805" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> menuItem.getAttribute(<span class="code-string">'aria-checked'</span>) === <span class="code-string">'true'</span>;
</code></td></tr><tr><td id="L1806" class="css-a4x74f"><span>1806</span></td><td id="LC1806" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L1807" class="css-a4x74f"><span>1807</span></td><td id="LC1807" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(check) {
</code></td></tr><tr><td id="L1808" class="css-a4x74f"><span>1808</span></td><td id="LC1808" class="css-1dcdqdg"><code>          <span class="code-comment">// Ensure exclusivity</span>
</code></td></tr><tr><td id="L1809" class="css-a4x74f"><span>1809</span></td><td id="LC1809" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (check) {
</code></td></tr><tr><td id="L1810" class="css-a4x74f"><span>1810</span></td><td id="LC1810" class="css-1dcdqdg"><code>            <span class="code-built_in">Array</span>.from(menuItem.parentNode.children).filter(<span class="code-function"><span class="code-params">node</span> =&gt;</span> matches(node, <span class="code-string">'[role="menuitemradio"]'</span>)).forEach(<span class="code-function"><span class="code-params">node</span> =&gt;</span> node.setAttribute(<span class="code-string">'aria-checked'</span>, <span class="code-string">'false'</span>));
</code></td></tr><tr><td id="L1811" class="css-a4x74f"><span>1811</span></td><td id="LC1811" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1812" class="css-a4x74f"><span>1812</span></td><td id="LC1812" class="css-1dcdqdg"><code>          menuItem.setAttribute(<span class="code-string">'aria-checked'</span>, check ? <span class="code-string">'true'</span> : <span class="code-string">'false'</span>);
</code></td></tr><tr><td id="L1813" class="css-a4x74f"><span>1813</span></td><td id="LC1813" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1814" class="css-a4x74f"><span>1814</span></td><td id="LC1814" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L1815" class="css-a4x74f"><span>1815</span></td><td id="LC1815" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.listeners.bind(menuItem, <span class="code-string">'click keyup'</span>, event =&gt; {
</code></td></tr><tr><td id="L1816" class="css-a4x74f"><span>1816</span></td><td id="LC1816" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.keyboardEvent(event) &amp;&amp; event.key !== <span class="code-string">' '</span>) {
</code></td></tr><tr><td id="L1817" class="css-a4x74f"><span>1817</span></td><td id="LC1817" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1818" class="css-a4x74f"><span>1818</span></td><td id="LC1818" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1819" class="css-a4x74f"><span>1819</span></td><td id="LC1819" class="css-1dcdqdg"><code>        event.preventDefault();
</code></td></tr><tr><td id="L1820" class="css-a4x74f"><span>1820</span></td><td id="LC1820" class="css-1dcdqdg"><code>        event.stopPropagation();
</code></td></tr><tr><td id="L1821" class="css-a4x74f"><span>1821</span></td><td id="LC1821" class="css-1dcdqdg"><code>        menuItem.checked = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L1822" class="css-a4x74f"><span>1822</span></td><td id="LC1822" class="css-1dcdqdg"><code>        <span class="code-keyword">switch</span> (type) {
</code></td></tr><tr><td id="L1823" class="css-a4x74f"><span>1823</span></td><td id="LC1823" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'language'</span>:
</code></td></tr><tr><td id="L1824" class="css-a4x74f"><span>1824</span></td><td id="LC1824" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.currentTrack = <span class="code-built_in">Number</span>(value);
</code></td></tr><tr><td id="L1825" class="css-a4x74f"><span>1825</span></td><td id="LC1825" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1826" class="css-a4x74f"><span>1826</span></td><td id="LC1826" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'quality'</span>:
</code></td></tr><tr><td id="L1827" class="css-a4x74f"><span>1827</span></td><td id="LC1827" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.quality = value;
</code></td></tr><tr><td id="L1828" class="css-a4x74f"><span>1828</span></td><td id="LC1828" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1829" class="css-a4x74f"><span>1829</span></td><td id="LC1829" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'speed'</span>:
</code></td></tr><tr><td id="L1830" class="css-a4x74f"><span>1830</span></td><td id="LC1830" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.speed = <span class="code-built_in">parseFloat</span>(value);
</code></td></tr><tr><td id="L1831" class="css-a4x74f"><span>1831</span></td><td id="LC1831" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1832" class="css-a4x74f"><span>1832</span></td><td id="LC1832" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1833" class="css-a4x74f"><span>1833</span></td><td id="LC1833" class="css-1dcdqdg"><code>        controls.showMenuPanel.call(<span class="code-keyword">this</span>, <span class="code-string">'home'</span>, is.keyboardEvent(event));
</code></td></tr><tr><td id="L1834" class="css-a4x74f"><span>1834</span></td><td id="LC1834" class="css-1dcdqdg"><code>      }, type, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L1835" class="css-a4x74f"><span>1835</span></td><td id="LC1835" class="css-1dcdqdg"><code>      controls.bindMenuItemShortcuts.call(<span class="code-keyword">this</span>, menuItem, type);
</code></td></tr><tr><td id="L1836" class="css-a4x74f"><span>1836</span></td><td id="LC1836" class="css-1dcdqdg"><code>      list.appendChild(menuItem);
</code></td></tr><tr><td id="L1837" class="css-a4x74f"><span>1837</span></td><td id="LC1837" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1838" class="css-a4x74f"><span>1838</span></td><td id="LC1838" class="css-1dcdqdg"><code>    <span class="code-comment">// Format a time for display</span>
</code></td></tr><tr><td id="L1839" class="css-a4x74f"><span>1839</span></td><td id="LC1839" class="css-1dcdqdg"><code>    formatTime(time = <span class="code-number">0</span>, inverted = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L1840" class="css-a4x74f"><span>1840</span></td><td id="LC1840" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if the value isn't a number</span>
</code></td></tr><tr><td id="L1841" class="css-a4x74f"><span>1841</span></td><td id="LC1841" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(time)) {
</code></td></tr><tr><td id="L1842" class="css-a4x74f"><span>1842</span></td><td id="LC1842" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> time;
</code></td></tr><tr><td id="L1843" class="css-a4x74f"><span>1843</span></td><td id="LC1843" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1844" class="css-a4x74f"><span>1844</span></td><td id="LC1844" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1845" class="css-a4x74f"><span>1845</span></td><td id="LC1845" class="css-1dcdqdg"><code>      <span class="code-comment">// Always display hours if duration is over an hour</span>
</code></td></tr><tr><td id="L1846" class="css-a4x74f"><span>1846</span></td><td id="LC1846" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> forceHours = getHours(<span class="code-keyword">this</span>.duration) &gt; <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1847" class="css-a4x74f"><span>1847</span></td><td id="LC1847" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> formatTime(time, forceHours, inverted);
</code></td></tr><tr><td id="L1848" class="css-a4x74f"><span>1848</span></td><td id="LC1848" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1849" class="css-a4x74f"><span>1849</span></td><td id="LC1849" class="css-1dcdqdg"><code>    <span class="code-comment">// Update the displayed time</span>
</code></td></tr><tr><td id="L1850" class="css-a4x74f"><span>1850</span></td><td id="LC1850" class="css-1dcdqdg"><code>    updateTimeDisplay(target = <span class="code-literal">null</span>, time = <span class="code-number">0</span>, inverted = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L1851" class="css-a4x74f"><span>1851</span></td><td id="LC1851" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if there's no element to display or the value isn't a number</span>
</code></td></tr><tr><td id="L1852" class="css-a4x74f"><span>1852</span></td><td id="LC1852" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(target) || !is.number(time)) {
</code></td></tr><tr><td id="L1853" class="css-a4x74f"><span>1853</span></td><td id="LC1853" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1854" class="css-a4x74f"><span>1854</span></td><td id="LC1854" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1855" class="css-a4x74f"><span>1855</span></td><td id="LC1855" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1856" class="css-a4x74f"><span>1856</span></td><td id="LC1856" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L1857" class="css-a4x74f"><span>1857</span></td><td id="LC1857" class="css-1dcdqdg"><code>      target.innerText = controls.formatTime(time, inverted);
</code></td></tr><tr><td id="L1858" class="css-a4x74f"><span>1858</span></td><td id="LC1858" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1859" class="css-a4x74f"><span>1859</span></td><td id="LC1859" class="css-1dcdqdg"><code>    <span class="code-comment">// Update volume UI and storage</span>
</code></td></tr><tr><td id="L1860" class="css-a4x74f"><span>1860</span></td><td id="LC1860" class="css-1dcdqdg"><code>    updateVolume() {
</code></td></tr><tr><td id="L1861" class="css-a4x74f"><span>1861</span></td><td id="LC1861" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L1862" class="css-a4x74f"><span>1862</span></td><td id="LC1862" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1863" class="css-a4x74f"><span>1863</span></td><td id="LC1863" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1864" class="css-a4x74f"><span>1864</span></td><td id="LC1864" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1865" class="css-a4x74f"><span>1865</span></td><td id="LC1865" class="css-1dcdqdg"><code>      <span class="code-comment">// Update range</span>
</code></td></tr><tr><td id="L1866" class="css-a4x74f"><span>1866</span></td><td id="LC1866" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.elements.inputs.volume)) {
</code></td></tr><tr><td id="L1867" class="css-a4x74f"><span>1867</span></td><td id="LC1867" class="css-1dcdqdg"><code>        controls.setRange.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.inputs.volume, <span class="code-keyword">this</span>.muted ? <span class="code-number">0</span> : <span class="code-keyword">this</span>.volume);
</code></td></tr><tr><td id="L1868" class="css-a4x74f"><span>1868</span></td><td id="LC1868" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1869" class="css-a4x74f"><span>1869</span></td><td id="LC1869" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1870" class="css-a4x74f"><span>1870</span></td><td id="LC1870" class="css-1dcdqdg"><code>      <span class="code-comment">// Update mute state</span>
</code></td></tr><tr><td id="L1871" class="css-a4x74f"><span>1871</span></td><td id="LC1871" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.elements.buttons.mute)) {
</code></td></tr><tr><td id="L1872" class="css-a4x74f"><span>1872</span></td><td id="LC1872" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.buttons.mute.pressed = <span class="code-keyword">this</span>.muted || <span class="code-keyword">this</span>.volume === <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1873" class="css-a4x74f"><span>1873</span></td><td id="LC1873" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1874" class="css-a4x74f"><span>1874</span></td><td id="LC1874" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1875" class="css-a4x74f"><span>1875</span></td><td id="LC1875" class="css-1dcdqdg"><code>    <span class="code-comment">// Update seek value and lower fill</span>
</code></td></tr><tr><td id="L1876" class="css-a4x74f"><span>1876</span></td><td id="LC1876" class="css-1dcdqdg"><code>    setRange(target, value = <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L1877" class="css-a4x74f"><span>1877</span></td><td id="LC1877" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L1878" class="css-a4x74f"><span>1878</span></td><td id="LC1878" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1879" class="css-a4x74f"><span>1879</span></td><td id="LC1879" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1880" class="css-a4x74f"><span>1880</span></td><td id="LC1880" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1881" class="css-a4x74f"><span>1881</span></td><td id="LC1881" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line</span>
</code></td></tr><tr><td id="L1882" class="css-a4x74f"><span>1882</span></td><td id="LC1882" class="css-1dcdqdg"><code>      target.value = value;
</code></td></tr><tr><td id="L1883" class="css-a4x74f"><span>1883</span></td><td id="LC1883" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1884" class="css-a4x74f"><span>1884</span></td><td id="LC1884" class="css-1dcdqdg"><code>      <span class="code-comment">// Webkit range fill</span>
</code></td></tr><tr><td id="L1885" class="css-a4x74f"><span>1885</span></td><td id="LC1885" class="css-1dcdqdg"><code>      controls.updateRangeFill.call(<span class="code-keyword">this</span>, target);
</code></td></tr><tr><td id="L1886" class="css-a4x74f"><span>1886</span></td><td id="LC1886" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1887" class="css-a4x74f"><span>1887</span></td><td id="LC1887" class="css-1dcdqdg"><code>    <span class="code-comment">// Update &lt;progress&gt; elements</span>
</code></td></tr><tr><td id="L1888" class="css-a4x74f"><span>1888</span></td><td id="LC1888" class="css-1dcdqdg"><code>    updateProgress(event) {
</code></td></tr><tr><td id="L1889" class="css-a4x74f"><span>1889</span></td><td id="LC1889" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui || !is.event(event)) {
</code></td></tr><tr><td id="L1890" class="css-a4x74f"><span>1890</span></td><td id="LC1890" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1891" class="css-a4x74f"><span>1891</span></td><td id="LC1891" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1892" class="css-a4x74f"><span>1892</span></td><td id="LC1892" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> value = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1893" class="css-a4x74f"><span>1893</span></td><td id="LC1893" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> setProgress = <span class="code-function">(<span class="code-params">target, input</span>) =&gt;</span> {
</code></td></tr><tr><td id="L1894" class="css-a4x74f"><span>1894</span></td><td id="LC1894" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> val = is.number(input) ? input : <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1895" class="css-a4x74f"><span>1895</span></td><td id="LC1895" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> progress = is.element(target) ? target : <span class="code-keyword">this</span>.elements.display.buffer;
</code></td></tr><tr><td id="L1896" class="css-a4x74f"><span>1896</span></td><td id="LC1896" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1897" class="css-a4x74f"><span>1897</span></td><td id="LC1897" class="css-1dcdqdg"><code>        <span class="code-comment">// Update value and label</span>
</code></td></tr><tr><td id="L1898" class="css-a4x74f"><span>1898</span></td><td id="LC1898" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(progress)) {
</code></td></tr><tr><td id="L1899" class="css-a4x74f"><span>1899</span></td><td id="LC1899" class="css-1dcdqdg"><code>          progress.value = val;
</code></td></tr><tr><td id="L1900" class="css-a4x74f"><span>1900</span></td><td id="LC1900" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1901" class="css-a4x74f"><span>1901</span></td><td id="LC1901" class="css-1dcdqdg"><code>          <span class="code-comment">// Update text label inside</span>
</code></td></tr><tr><td id="L1902" class="css-a4x74f"><span>1902</span></td><td id="LC1902" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> label = progress.getElementsByTagName(<span class="code-string">'span'</span>)[<span class="code-number">0</span>];
</code></td></tr><tr><td id="L1903" class="css-a4x74f"><span>1903</span></td><td id="LC1903" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.element(label)) {
</code></td></tr><tr><td id="L1904" class="css-a4x74f"><span>1904</span></td><td id="LC1904" class="css-1dcdqdg"><code>            label.childNodes[<span class="code-number">0</span>].nodeValue = val;
</code></td></tr><tr><td id="L1905" class="css-a4x74f"><span>1905</span></td><td id="LC1905" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L1906" class="css-a4x74f"><span>1906</span></td><td id="LC1906" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1907" class="css-a4x74f"><span>1907</span></td><td id="LC1907" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L1908" class="css-a4x74f"><span>1908</span></td><td id="LC1908" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (event) {
</code></td></tr><tr><td id="L1909" class="css-a4x74f"><span>1909</span></td><td id="LC1909" class="css-1dcdqdg"><code>        <span class="code-keyword">switch</span> (event.type) {
</code></td></tr><tr><td id="L1910" class="css-a4x74f"><span>1910</span></td><td id="LC1910" class="css-1dcdqdg"><code>          <span class="code-comment">// Video playing</span>
</code></td></tr><tr><td id="L1911" class="css-a4x74f"><span>1911</span></td><td id="LC1911" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'timeupdate'</span>:
</code></td></tr><tr><td id="L1912" class="css-a4x74f"><span>1912</span></td><td id="LC1912" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'seeking'</span>:
</code></td></tr><tr><td id="L1913" class="css-a4x74f"><span>1913</span></td><td id="LC1913" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'seeked'</span>:
</code></td></tr><tr><td id="L1914" class="css-a4x74f"><span>1914</span></td><td id="LC1914" class="css-1dcdqdg"><code>            value = getPercentage(<span class="code-keyword">this</span>.currentTime, <span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L1915" class="css-a4x74f"><span>1915</span></td><td id="LC1915" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1916" class="css-a4x74f"><span>1916</span></td><td id="LC1916" class="css-1dcdqdg"><code>            <span class="code-comment">// Set seek range value only if it's a 'natural' time event</span>
</code></td></tr><tr><td id="L1917" class="css-a4x74f"><span>1917</span></td><td id="LC1917" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (event.type === <span class="code-string">'timeupdate'</span>) {
</code></td></tr><tr><td id="L1918" class="css-a4x74f"><span>1918</span></td><td id="LC1918" class="css-1dcdqdg"><code>              controls.setRange.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.inputs.seek, value);
</code></td></tr><tr><td id="L1919" class="css-a4x74f"><span>1919</span></td><td id="LC1919" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L1920" class="css-a4x74f"><span>1920</span></td><td id="LC1920" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1921" class="css-a4x74f"><span>1921</span></td><td id="LC1921" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1922" class="css-a4x74f"><span>1922</span></td><td id="LC1922" class="css-1dcdqdg"><code>          <span class="code-comment">// Check buffer status</span>
</code></td></tr><tr><td id="L1923" class="css-a4x74f"><span>1923</span></td><td id="LC1923" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'playing'</span>:
</code></td></tr><tr><td id="L1924" class="css-a4x74f"><span>1924</span></td><td id="LC1924" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'progress'</span>:
</code></td></tr><tr><td id="L1925" class="css-a4x74f"><span>1925</span></td><td id="LC1925" class="css-1dcdqdg"><code>            setProgress(<span class="code-keyword">this</span>.elements.display.buffer, <span class="code-keyword">this</span>.buffered * <span class="code-number">100</span>);
</code></td></tr><tr><td id="L1926" class="css-a4x74f"><span>1926</span></td><td id="LC1926" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L1927" class="css-a4x74f"><span>1927</span></td><td id="LC1927" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L1928" class="css-a4x74f"><span>1928</span></td><td id="LC1928" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1929" class="css-a4x74f"><span>1929</span></td><td id="LC1929" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1930" class="css-a4x74f"><span>1930</span></td><td id="LC1930" class="css-1dcdqdg"><code>    <span class="code-comment">// Webkit polyfill for lower fill range</span>
</code></td></tr><tr><td id="L1931" class="css-a4x74f"><span>1931</span></td><td id="LC1931" class="css-1dcdqdg"><code>    updateRangeFill(target) {
</code></td></tr><tr><td id="L1932" class="css-a4x74f"><span>1932</span></td><td id="LC1932" class="css-1dcdqdg"><code>      <span class="code-comment">// Get range from event if event passed</span>
</code></td></tr><tr><td id="L1933" class="css-a4x74f"><span>1933</span></td><td id="LC1933" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> range = is.event(target) ? target.target : target;
</code></td></tr><tr><td id="L1934" class="css-a4x74f"><span>1934</span></td><td id="LC1934" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1935" class="css-a4x74f"><span>1935</span></td><td id="LC1935" class="css-1dcdqdg"><code>      <span class="code-comment">// Needs to be a valid &lt;input type='range'&gt;</span>
</code></td></tr><tr><td id="L1936" class="css-a4x74f"><span>1936</span></td><td id="LC1936" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(range) || range.getAttribute(<span class="code-string">'type'</span>) !== <span class="code-string">'range'</span>) {
</code></td></tr><tr><td id="L1937" class="css-a4x74f"><span>1937</span></td><td id="LC1937" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1938" class="css-a4x74f"><span>1938</span></td><td id="LC1938" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1939" class="css-a4x74f"><span>1939</span></td><td id="LC1939" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1940" class="css-a4x74f"><span>1940</span></td><td id="LC1940" class="css-1dcdqdg"><code>      <span class="code-comment">// Set aria values for https://github.com/sampotts/plyr/issues/905</span>
</code></td></tr><tr><td id="L1941" class="css-a4x74f"><span>1941</span></td><td id="LC1941" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (matches(range, <span class="code-keyword">this</span>.config.selectors.inputs.seek)) {
</code></td></tr><tr><td id="L1942" class="css-a4x74f"><span>1942</span></td><td id="LC1942" class="css-1dcdqdg"><code>        range.setAttribute(<span class="code-string">'aria-valuenow'</span>, <span class="code-keyword">this</span>.currentTime);
</code></td></tr><tr><td id="L1943" class="css-a4x74f"><span>1943</span></td><td id="LC1943" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> currentTime = controls.formatTime(<span class="code-keyword">this</span>.currentTime);
</code></td></tr><tr><td id="L1944" class="css-a4x74f"><span>1944</span></td><td id="LC1944" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> duration = controls.formatTime(<span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L1945" class="css-a4x74f"><span>1945</span></td><td id="LC1945" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> format = i18n.get(<span class="code-string">'seekLabel'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L1946" class="css-a4x74f"><span>1946</span></td><td id="LC1946" class="css-1dcdqdg"><code>        range.setAttribute(<span class="code-string">'aria-valuetext'</span>, format.replace(<span class="code-string">'{currentTime}'</span>, currentTime).replace(<span class="code-string">'{duration}'</span>, duration));
</code></td></tr><tr><td id="L1947" class="css-a4x74f"><span>1947</span></td><td id="LC1947" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (matches(range, <span class="code-keyword">this</span>.config.selectors.inputs.volume)) {
</code></td></tr><tr><td id="L1948" class="css-a4x74f"><span>1948</span></td><td id="LC1948" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> percent = range.value * <span class="code-number">100</span>;
</code></td></tr><tr><td id="L1949" class="css-a4x74f"><span>1949</span></td><td id="LC1949" class="css-1dcdqdg"><code>        range.setAttribute(<span class="code-string">'aria-valuenow'</span>, percent);
</code></td></tr><tr><td id="L1950" class="css-a4x74f"><span>1950</span></td><td id="LC1950" class="css-1dcdqdg"><code>        range.setAttribute(<span class="code-string">'aria-valuetext'</span>, <span class="code-string">`<span class="code-subst">${percent.toFixed(<span class="code-number">1</span>)}</span>%`</span>);
</code></td></tr><tr><td id="L1951" class="css-a4x74f"><span>1951</span></td><td id="LC1951" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1952" class="css-a4x74f"><span>1952</span></td><td id="LC1952" class="css-1dcdqdg"><code>        range.setAttribute(<span class="code-string">'aria-valuenow'</span>, range.value);
</code></td></tr><tr><td id="L1953" class="css-a4x74f"><span>1953</span></td><td id="LC1953" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1954" class="css-a4x74f"><span>1954</span></td><td id="LC1954" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1955" class="css-a4x74f"><span>1955</span></td><td id="LC1955" class="css-1dcdqdg"><code>      <span class="code-comment">// WebKit only</span>
</code></td></tr><tr><td id="L1956" class="css-a4x74f"><span>1956</span></td><td id="LC1956" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!browser.isWebKit &amp;&amp; !browser.isIPadOS) {
</code></td></tr><tr><td id="L1957" class="css-a4x74f"><span>1957</span></td><td id="LC1957" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1958" class="css-a4x74f"><span>1958</span></td><td id="LC1958" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1959" class="css-a4x74f"><span>1959</span></td><td id="LC1959" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1960" class="css-a4x74f"><span>1960</span></td><td id="LC1960" class="css-1dcdqdg"><code>      <span class="code-comment">// Set CSS custom property</span>
</code></td></tr><tr><td id="L1961" class="css-a4x74f"><span>1961</span></td><td id="LC1961" class="css-1dcdqdg"><code>      range.style.setProperty('--value', `${range.value / range.max * 100}%`);
</code></td></tr><tr><td id="L1962" class="css-a4x74f"><span>1962</span></td><td id="LC1962" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L1963" class="css-a4x74f"><span>1963</span></td><td id="LC1963" class="css-1dcdqdg"><code>    <span class="code-comment">// Update hover tooltip for seeking</span>
</code></td></tr><tr><td id="L1964" class="css-a4x74f"><span>1964</span></td><td id="LC1964" class="css-1dcdqdg"><code>    updateSeekTooltip(event) {
</code></td></tr><tr><td id="L1965" class="css-a4x74f"><span>1965</span></td><td id="LC1965" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> _this$config$markers, _this$config$markers$;
</code></td></tr><tr><td id="L1966" class="css-a4x74f"><span>1966</span></td><td id="LC1966" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if setting not true</span>
</code></td></tr><tr><td id="L1967" class="css-a4x74f"><span>1967</span></td><td id="LC1967" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.config.tooltips.seek || !is.element(<span class="code-keyword">this</span>.elements.inputs.seek) || !is.element(<span class="code-keyword">this</span>.elements.display.seekTooltip) || <span class="code-keyword">this</span>.duration === <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L1968" class="css-a4x74f"><span>1968</span></td><td id="LC1968" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1969" class="css-a4x74f"><span>1969</span></td><td id="LC1969" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1970" class="css-a4x74f"><span>1970</span></td><td id="LC1970" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tipElement = <span class="code-keyword">this</span>.elements.display.seekTooltip;
</code></td></tr><tr><td id="L1971" class="css-a4x74f"><span>1971</span></td><td id="LC1971" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> visible = <span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.config.classNames.tooltip}</span>--visible`</span>;
</code></td></tr><tr><td id="L1972" class="css-a4x74f"><span>1972</span></td><td id="LC1972" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = <span class="code-function"><span class="code-params">show</span> =&gt;</span> toggleClass(tipElement, visible, show);
</code></td></tr><tr><td id="L1973" class="css-a4x74f"><span>1973</span></td><td id="LC1973" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1974" class="css-a4x74f"><span>1974</span></td><td id="LC1974" class="css-1dcdqdg"><code>      <span class="code-comment">// Hide on touch</span>
</code></td></tr><tr><td id="L1975" class="css-a4x74f"><span>1975</span></td><td id="LC1975" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.touch) {
</code></td></tr><tr><td id="L1976" class="css-a4x74f"><span>1976</span></td><td id="LC1976" class="css-1dcdqdg"><code>        toggle(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L1977" class="css-a4x74f"><span>1977</span></td><td id="LC1977" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1978" class="css-a4x74f"><span>1978</span></td><td id="LC1978" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1979" class="css-a4x74f"><span>1979</span></td><td id="LC1979" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1980" class="css-a4x74f"><span>1980</span></td><td id="LC1980" class="css-1dcdqdg"><code>      <span class="code-comment">// Determine percentage, if already visible</span>
</code></td></tr><tr><td id="L1981" class="css-a4x74f"><span>1981</span></td><td id="LC1981" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> percent = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1982" class="css-a4x74f"><span>1982</span></td><td id="LC1982" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> clientRect = <span class="code-keyword">this</span>.elements.progress.getBoundingClientRect();
</code></td></tr><tr><td id="L1983" class="css-a4x74f"><span>1983</span></td><td id="LC1983" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.event(event)) {
</code></td></tr><tr><td id="L1984" class="css-a4x74f"><span>1984</span></td><td id="LC1984" class="css-1dcdqdg"><code>        percent = <span class="code-number">100</span> / clientRect.width * (event.pageX - clientRect.left);
</code></td></tr><tr><td id="L1985" class="css-a4x74f"><span>1985</span></td><td id="LC1985" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (hasClass(tipElement, visible)) {
</code></td></tr><tr><td id="L1986" class="css-a4x74f"><span>1986</span></td><td id="LC1986" class="css-1dcdqdg"><code>        percent = <span class="code-built_in">parseFloat</span>(tipElement.style.left, <span class="code-number">10</span>);
</code></td></tr><tr><td id="L1987" class="css-a4x74f"><span>1987</span></td><td id="LC1987" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L1988" class="css-a4x74f"><span>1988</span></td><td id="LC1988" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L1989" class="css-a4x74f"><span>1989</span></td><td id="LC1989" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1990" class="css-a4x74f"><span>1990</span></td><td id="LC1990" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1991" class="css-a4x74f"><span>1991</span></td><td id="LC1991" class="css-1dcdqdg"><code>      <span class="code-comment">// Set bounds</span>
</code></td></tr><tr><td id="L1992" class="css-a4x74f"><span>1992</span></td><td id="LC1992" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (percent &lt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L1993" class="css-a4x74f"><span>1993</span></td><td id="LC1993" class="css-1dcdqdg"><code>        percent = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L1994" class="css-a4x74f"><span>1994</span></td><td id="LC1994" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (percent &gt; <span class="code-number">100</span>) {
</code></td></tr><tr><td id="L1995" class="css-a4x74f"><span>1995</span></td><td id="LC1995" class="css-1dcdqdg"><code>        percent = <span class="code-number">100</span>;
</code></td></tr><tr><td id="L1996" class="css-a4x74f"><span>1996</span></td><td id="LC1996" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L1997" class="css-a4x74f"><span>1997</span></td><td id="LC1997" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> time = <span class="code-keyword">this</span>.duration / <span class="code-number">100</span> * percent;
</code></td></tr><tr><td id="L1998" class="css-a4x74f"><span>1998</span></td><td id="LC1998" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L1999" class="css-a4x74f"><span>1999</span></td><td id="LC1999" class="css-1dcdqdg"><code>      <span class="code-comment">// Display the time a click would seek to</span>
</code></td></tr><tr><td id="L2000" class="css-a4x74f"><span>2000</span></td><td id="LC2000" class="css-1dcdqdg"><code>      tipElement.innerText = controls.formatTime(time);
</code></td></tr><tr><td id="L2001" class="css-a4x74f"><span>2001</span></td><td id="LC2001" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2002" class="css-a4x74f"><span>2002</span></td><td id="LC2002" class="css-1dcdqdg"><code>      <span class="code-comment">// Get marker point for time</span>
</code></td></tr><tr><td id="L2003" class="css-a4x74f"><span>2003</span></td><td id="LC2003" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> point = (_this$config$markers = <span class="code-keyword">this</span>.config.markers) === <span class="code-literal">null</span> || _this$config$markers === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : (_this$config$markers$ = _this$config$markers.points) === <span class="code-literal">null</span> || _this$config$markers$ === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : _this$config$markers$.find(({
</code></td></tr><tr><td id="L2004" class="css-a4x74f"><span>2004</span></td><td id="LC2004" class="css-1dcdqdg"><code>        time: t
</code></td></tr><tr><td id="L2005" class="css-a4x74f"><span>2005</span></td><td id="LC2005" class="css-1dcdqdg"><code>      }) =&gt; t === <span class="code-built_in">Math</span>.round(time));
</code></td></tr><tr><td id="L2006" class="css-a4x74f"><span>2006</span></td><td id="LC2006" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2007" class="css-a4x74f"><span>2007</span></td><td id="LC2007" class="css-1dcdqdg"><code>      <span class="code-comment">// Append the point label to the tooltip</span>
</code></td></tr><tr><td id="L2008" class="css-a4x74f"><span>2008</span></td><td id="LC2008" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (point) {
</code></td></tr><tr><td id="L2009" class="css-a4x74f"><span>2009</span></td><td id="LC2009" class="css-1dcdqdg"><code>        tipElement.insertAdjacentHTML(<span class="code-string">'afterbegin'</span>, <span class="code-string">`<span class="code-subst">${point.label}</span>&lt;br&gt;`</span>);
</code></td></tr><tr><td id="L2010" class="css-a4x74f"><span>2010</span></td><td id="LC2010" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2011" class="css-a4x74f"><span>2011</span></td><td id="LC2011" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2012" class="css-a4x74f"><span>2012</span></td><td id="LC2012" class="css-1dcdqdg"><code>      <span class="code-comment">// Set position</span>
</code></td></tr><tr><td id="L2013" class="css-a4x74f"><span>2013</span></td><td id="LC2013" class="css-1dcdqdg"><code>      tipElement.style.left = <span class="code-string">`<span class="code-subst">${percent}</span>%`</span>;
</code></td></tr><tr><td id="L2014" class="css-a4x74f"><span>2014</span></td><td id="LC2014" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2015" class="css-a4x74f"><span>2015</span></td><td id="LC2015" class="css-1dcdqdg"><code>      <span class="code-comment">// Show/hide the tooltip</span>
</code></td></tr><tr><td id="L2016" class="css-a4x74f"><span>2016</span></td><td id="LC2016" class="css-1dcdqdg"><code>      <span class="code-comment">// If the event is a moues in/out and percentage is inside bounds</span>
</code></td></tr><tr><td id="L2017" class="css-a4x74f"><span>2017</span></td><td id="LC2017" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.event(event) &amp;&amp; [<span class="code-string">'mouseenter'</span>, <span class="code-string">'mouseleave'</span>].includes(event.type)) {
</code></td></tr><tr><td id="L2018" class="css-a4x74f"><span>2018</span></td><td id="LC2018" class="css-1dcdqdg"><code>        toggle(event.type === <span class="code-string">'mouseenter'</span>);
</code></td></tr><tr><td id="L2019" class="css-a4x74f"><span>2019</span></td><td id="LC2019" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2020" class="css-a4x74f"><span>2020</span></td><td id="LC2020" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2021" class="css-a4x74f"><span>2021</span></td><td id="LC2021" class="css-1dcdqdg"><code>    <span class="code-comment">// Handle time change event</span>
</code></td></tr><tr><td id="L2022" class="css-a4x74f"><span>2022</span></td><td id="LC2022" class="css-1dcdqdg"><code>    timeUpdate(event) {
</code></td></tr><tr><td id="L2023" class="css-a4x74f"><span>2023</span></td><td id="LC2023" class="css-1dcdqdg"><code>      <span class="code-comment">// Only invert if only one time element is displayed and used for both duration and currentTime</span>
</code></td></tr><tr><td id="L2024" class="css-a4x74f"><span>2024</span></td><td id="LC2024" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> invert = !is.element(<span class="code-keyword">this</span>.elements.display.duration) &amp;&amp; <span class="code-keyword">this</span>.config.invertTime;
</code></td></tr><tr><td id="L2025" class="css-a4x74f"><span>2025</span></td><td id="LC2025" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2026" class="css-a4x74f"><span>2026</span></td><td id="LC2026" class="css-1dcdqdg"><code>      <span class="code-comment">// Duration</span>
</code></td></tr><tr><td id="L2027" class="css-a4x74f"><span>2027</span></td><td id="LC2027" class="css-1dcdqdg"><code>      controls.updateTimeDisplay.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.display.currentTime, invert ? <span class="code-keyword">this</span>.duration - <span class="code-keyword">this</span>.currentTime : <span class="code-keyword">this</span>.currentTime, invert);
</code></td></tr><tr><td id="L2028" class="css-a4x74f"><span>2028</span></td><td id="LC2028" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2029" class="css-a4x74f"><span>2029</span></td><td id="LC2029" class="css-1dcdqdg"><code>      <span class="code-comment">// Ignore updates while seeking</span>
</code></td></tr><tr><td id="L2030" class="css-a4x74f"><span>2030</span></td><td id="LC2030" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (event &amp;&amp; event.type === <span class="code-string">'timeupdate'</span> &amp;&amp; <span class="code-keyword">this</span>.media.seeking) {
</code></td></tr><tr><td id="L2031" class="css-a4x74f"><span>2031</span></td><td id="LC2031" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2032" class="css-a4x74f"><span>2032</span></td><td id="LC2032" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2033" class="css-a4x74f"><span>2033</span></td><td id="LC2033" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2034" class="css-a4x74f"><span>2034</span></td><td id="LC2034" class="css-1dcdqdg"><code>      <span class="code-comment">// Playing progress</span>
</code></td></tr><tr><td id="L2035" class="css-a4x74f"><span>2035</span></td><td id="LC2035" class="css-1dcdqdg"><code>      controls.updateProgress.call(<span class="code-keyword">this</span>, event);
</code></td></tr><tr><td id="L2036" class="css-a4x74f"><span>2036</span></td><td id="LC2036" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2037" class="css-a4x74f"><span>2037</span></td><td id="LC2037" class="css-1dcdqdg"><code>    <span class="code-comment">// Show the duration on metadataloaded or durationchange events</span>
</code></td></tr><tr><td id="L2038" class="css-a4x74f"><span>2038</span></td><td id="LC2038" class="css-1dcdqdg"><code>    durationUpdate() {
</code></td></tr><tr><td id="L2039" class="css-a4x74f"><span>2039</span></td><td id="LC2039" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if no UI or durationchange event triggered after playing/seek when invertTime is false</span>
</code></td></tr><tr><td id="L2040" class="css-a4x74f"><span>2040</span></td><td id="LC2040" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui || !<span class="code-keyword">this</span>.config.invertTime &amp;&amp; <span class="code-keyword">this</span>.currentTime) {
</code></td></tr><tr><td id="L2041" class="css-a4x74f"><span>2041</span></td><td id="LC2041" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2042" class="css-a4x74f"><span>2042</span></td><td id="LC2042" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2043" class="css-a4x74f"><span>2043</span></td><td id="LC2043" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2044" class="css-a4x74f"><span>2044</span></td><td id="LC2044" class="css-1dcdqdg"><code>      <span class="code-comment">// If duration is the 2**32 (shaka), Infinity (HLS), DASH-IF (Number.MAX_SAFE_INTEGER || Number.MAX_VALUE) indicating live we hide the currentTime and progressbar.</span>
</code></td></tr><tr><td id="L2045" class="css-a4x74f"><span>2045</span></td><td id="LC2045" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/video-dev/hls.js/blob/5820d29d3c4c8a46e8b75f1e3afa3e68c1a9a2db/src/controller/buffer-controller.js#L415</span>
</code></td></tr><tr><td id="L2046" class="css-a4x74f"><span>2046</span></td><td id="LC2046" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/google/shaka-player/blob/4d889054631f4e1cf0fbd80ddd2b71887c02e232/lib/media/streaming_engine.js#L1062</span>
</code></td></tr><tr><td id="L2047" class="css-a4x74f"><span>2047</span></td><td id="LC2047" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/Dash-Industry-Forum/dash.js/blob/69859f51b969645b234666800d4cb596d89c602d/src/dash/models/DashManifestModel.js#L338</span>
</code></td></tr><tr><td id="L2048" class="css-a4x74f"><span>2048</span></td><td id="LC2048" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.duration &gt;= <span class="code-number">2</span> ** <span class="code-number">32</span>) {
</code></td></tr><tr><td id="L2049" class="css-a4x74f"><span>2049</span></td><td id="LC2049" class="css-1dcdqdg"><code>        toggleHidden(<span class="code-keyword">this</span>.elements.display.currentTime, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2050" class="css-a4x74f"><span>2050</span></td><td id="LC2050" class="css-1dcdqdg"><code>        toggleHidden(<span class="code-keyword">this</span>.elements.progress, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2051" class="css-a4x74f"><span>2051</span></td><td id="LC2051" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2052" class="css-a4x74f"><span>2052</span></td><td id="LC2052" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2053" class="css-a4x74f"><span>2053</span></td><td id="LC2053" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2054" class="css-a4x74f"><span>2054</span></td><td id="LC2054" class="css-1dcdqdg"><code>      <span class="code-comment">// Update ARIA values</span>
</code></td></tr><tr><td id="L2055" class="css-a4x74f"><span>2055</span></td><td id="LC2055" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.elements.inputs.seek)) {
</code></td></tr><tr><td id="L2056" class="css-a4x74f"><span>2056</span></td><td id="LC2056" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.inputs.seek.setAttribute(<span class="code-string">'aria-valuemax'</span>, <span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L2057" class="css-a4x74f"><span>2057</span></td><td id="LC2057" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2058" class="css-a4x74f"><span>2058</span></td><td id="LC2058" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2059" class="css-a4x74f"><span>2059</span></td><td id="LC2059" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's a spot to display duration</span>
</code></td></tr><tr><td id="L2060" class="css-a4x74f"><span>2060</span></td><td id="LC2060" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> hasDuration = is.element(<span class="code-keyword">this</span>.elements.display.duration);
</code></td></tr><tr><td id="L2061" class="css-a4x74f"><span>2061</span></td><td id="LC2061" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2062" class="css-a4x74f"><span>2062</span></td><td id="LC2062" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's only one time display, display duration there</span>
</code></td></tr><tr><td id="L2063" class="css-a4x74f"><span>2063</span></td><td id="LC2063" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!hasDuration &amp;&amp; <span class="code-keyword">this</span>.config.displayDuration &amp;&amp; <span class="code-keyword">this</span>.paused) {
</code></td></tr><tr><td id="L2064" class="css-a4x74f"><span>2064</span></td><td id="LC2064" class="css-1dcdqdg"><code>        controls.updateTimeDisplay.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.display.currentTime, <span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L2065" class="css-a4x74f"><span>2065</span></td><td id="LC2065" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2066" class="css-a4x74f"><span>2066</span></td><td id="LC2066" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2067" class="css-a4x74f"><span>2067</span></td><td id="LC2067" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's a duration element, update content</span>
</code></td></tr><tr><td id="L2068" class="css-a4x74f"><span>2068</span></td><td id="LC2068" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (hasDuration) {
</code></td></tr><tr><td id="L2069" class="css-a4x74f"><span>2069</span></td><td id="LC2069" class="css-1dcdqdg"><code>        controls.updateTimeDisplay.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.display.duration, <span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L2070" class="css-a4x74f"><span>2070</span></td><td id="LC2070" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2071" class="css-a4x74f"><span>2071</span></td><td id="LC2071" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.markers.enabled) {
</code></td></tr><tr><td id="L2072" class="css-a4x74f"><span>2072</span></td><td id="LC2072" class="css-1dcdqdg"><code>        controls.setMarkers.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2073" class="css-a4x74f"><span>2073</span></td><td id="LC2073" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2074" class="css-a4x74f"><span>2074</span></td><td id="LC2074" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2075" class="css-a4x74f"><span>2075</span></td><td id="LC2075" class="css-1dcdqdg"><code>      <span class="code-comment">// Update the tooltip (if visible)</span>
</code></td></tr><tr><td id="L2076" class="css-a4x74f"><span>2076</span></td><td id="LC2076" class="css-1dcdqdg"><code>      controls.updateSeekTooltip.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2077" class="css-a4x74f"><span>2077</span></td><td id="LC2077" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2078" class="css-a4x74f"><span>2078</span></td><td id="LC2078" class="css-1dcdqdg"><code>    <span class="code-comment">// Hide/show a tab</span>
</code></td></tr><tr><td id="L2079" class="css-a4x74f"><span>2079</span></td><td id="LC2079" class="css-1dcdqdg"><code>    toggleMenuButton(setting, toggle) {
</code></td></tr><tr><td id="L2080" class="css-a4x74f"><span>2080</span></td><td id="LC2080" class="css-1dcdqdg"><code>      toggleHidden(<span class="code-keyword">this</span>.elements.settings.buttons[setting], !toggle);
</code></td></tr><tr><td id="L2081" class="css-a4x74f"><span>2081</span></td><td id="LC2081" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2082" class="css-a4x74f"><span>2082</span></td><td id="LC2082" class="css-1dcdqdg"><code>    <span class="code-comment">// Update the selected setting</span>
</code></td></tr><tr><td id="L2083" class="css-a4x74f"><span>2083</span></td><td id="LC2083" class="css-1dcdqdg"><code>    updateSetting(setting, container, input) {
</code></td></tr><tr><td id="L2084" class="css-a4x74f"><span>2084</span></td><td id="LC2084" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> pane = <span class="code-keyword">this</span>.elements.settings.panels[setting];
</code></td></tr><tr><td id="L2085" class="css-a4x74f"><span>2085</span></td><td id="LC2085" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> value = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2086" class="css-a4x74f"><span>2086</span></td><td id="LC2086" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> list = container;
</code></td></tr><tr><td id="L2087" class="css-a4x74f"><span>2087</span></td><td id="LC2087" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (setting === <span class="code-string">'captions'</span>) {
</code></td></tr><tr><td id="L2088" class="css-a4x74f"><span>2088</span></td><td id="LC2088" class="css-1dcdqdg"><code>        value = <span class="code-keyword">this</span>.currentTrack;
</code></td></tr><tr><td id="L2089" class="css-a4x74f"><span>2089</span></td><td id="LC2089" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L2090" class="css-a4x74f"><span>2090</span></td><td id="LC2090" class="css-1dcdqdg"><code>        value = !is.empty(input) ? input : <span class="code-keyword">this</span>[setting];
</code></td></tr><tr><td id="L2091" class="css-a4x74f"><span>2091</span></td><td id="LC2091" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2092" class="css-a4x74f"><span>2092</span></td><td id="LC2092" class="css-1dcdqdg"><code>        <span class="code-comment">// Get default</span>
</code></td></tr><tr><td id="L2093" class="css-a4x74f"><span>2093</span></td><td id="LC2093" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.empty(value)) {
</code></td></tr><tr><td id="L2094" class="css-a4x74f"><span>2094</span></td><td id="LC2094" class="css-1dcdqdg"><code>          value = <span class="code-keyword">this</span>.config[setting].default;
</code></td></tr><tr><td id="L2095" class="css-a4x74f"><span>2095</span></td><td id="LC2095" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2096" class="css-a4x74f"><span>2096</span></td><td id="LC2096" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2097" class="css-a4x74f"><span>2097</span></td><td id="LC2097" class="css-1dcdqdg"><code>        <span class="code-comment">// Unsupported value</span>
</code></td></tr><tr><td id="L2098" class="css-a4x74f"><span>2098</span></td><td id="LC2098" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.options[setting]) &amp;&amp; !<span class="code-keyword">this</span>.options[setting].includes(value)) {
</code></td></tr><tr><td id="L2099" class="css-a4x74f"><span>2099</span></td><td id="LC2099" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.warn(<span class="code-string">`Unsupported value of '<span class="code-subst">${value}</span>' for <span class="code-subst">${setting}</span>`</span>);
</code></td></tr><tr><td id="L2100" class="css-a4x74f"><span>2100</span></td><td id="LC2100" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2101" class="css-a4x74f"><span>2101</span></td><td id="LC2101" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2102" class="css-a4x74f"><span>2102</span></td><td id="LC2102" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2103" class="css-a4x74f"><span>2103</span></td><td id="LC2103" class="css-1dcdqdg"><code>        <span class="code-comment">// Disabled value</span>
</code></td></tr><tr><td id="L2104" class="css-a4x74f"><span>2104</span></td><td id="LC2104" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.config[setting].options.includes(value)) {
</code></td></tr><tr><td id="L2105" class="css-a4x74f"><span>2105</span></td><td id="LC2105" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.warn(<span class="code-string">`Disabled value of '<span class="code-subst">${value}</span>' for <span class="code-subst">${setting}</span>`</span>);
</code></td></tr><tr><td id="L2106" class="css-a4x74f"><span>2106</span></td><td id="LC2106" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2107" class="css-a4x74f"><span>2107</span></td><td id="LC2107" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2108" class="css-a4x74f"><span>2108</span></td><td id="LC2108" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2109" class="css-a4x74f"><span>2109</span></td><td id="LC2109" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2110" class="css-a4x74f"><span>2110</span></td><td id="LC2110" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the list if we need to</span>
</code></td></tr><tr><td id="L2111" class="css-a4x74f"><span>2111</span></td><td id="LC2111" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(list)) {
</code></td></tr><tr><td id="L2112" class="css-a4x74f"><span>2112</span></td><td id="LC2112" class="css-1dcdqdg"><code>        list = pane &amp;&amp; pane.querySelector(<span class="code-string">'[role="menu"]'</span>);
</code></td></tr><tr><td id="L2113" class="css-a4x74f"><span>2113</span></td><td id="LC2113" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2114" class="css-a4x74f"><span>2114</span></td><td id="LC2114" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2115" class="css-a4x74f"><span>2115</span></td><td id="LC2115" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's no list it means it's not been rendered...</span>
</code></td></tr><tr><td id="L2116" class="css-a4x74f"><span>2116</span></td><td id="LC2116" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(list)) {
</code></td></tr><tr><td id="L2117" class="css-a4x74f"><span>2117</span></td><td id="LC2117" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2118" class="css-a4x74f"><span>2118</span></td><td id="LC2118" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2119" class="css-a4x74f"><span>2119</span></td><td id="LC2119" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2120" class="css-a4x74f"><span>2120</span></td><td id="LC2120" class="css-1dcdqdg"><code>      <span class="code-comment">// Update the label</span>
</code></td></tr><tr><td id="L2121" class="css-a4x74f"><span>2121</span></td><td id="LC2121" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> label = <span class="code-keyword">this</span>.elements.settings.buttons[setting].querySelector(<span class="code-string">`.<span class="code-subst">${<span class="code-keyword">this</span>.config.classNames.menu.value}</span>`</span>);
</code></td></tr><tr><td id="L2122" class="css-a4x74f"><span>2122</span></td><td id="LC2122" class="css-1dcdqdg"><code>      label.innerHTML = controls.getLabel.call(<span class="code-keyword">this</span>, setting, value);
</code></td></tr><tr><td id="L2123" class="css-a4x74f"><span>2123</span></td><td id="LC2123" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2124" class="css-a4x74f"><span>2124</span></td><td id="LC2124" class="css-1dcdqdg"><code>      <span class="code-comment">// Find the radio option and check it</span>
</code></td></tr><tr><td id="L2125" class="css-a4x74f"><span>2125</span></td><td id="LC2125" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> target = list &amp;&amp; list.querySelector(<span class="code-string">`[value="<span class="code-subst">${value}</span>"]`</span>);
</code></td></tr><tr><td id="L2126" class="css-a4x74f"><span>2126</span></td><td id="LC2126" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(target)) {
</code></td></tr><tr><td id="L2127" class="css-a4x74f"><span>2127</span></td><td id="LC2127" class="css-1dcdqdg"><code>        target.checked = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L2128" class="css-a4x74f"><span>2128</span></td><td id="LC2128" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2129" class="css-a4x74f"><span>2129</span></td><td id="LC2129" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2130" class="css-a4x74f"><span>2130</span></td><td id="LC2130" class="css-1dcdqdg"><code>    <span class="code-comment">// Translate a value into a nice label</span>
</code></td></tr><tr><td id="L2131" class="css-a4x74f"><span>2131</span></td><td id="LC2131" class="css-1dcdqdg"><code>    getLabel(setting, value) {
</code></td></tr><tr><td id="L2132" class="css-a4x74f"><span>2132</span></td><td id="LC2132" class="css-1dcdqdg"><code>      <span class="code-keyword">switch</span> (setting) {
</code></td></tr><tr><td id="L2133" class="css-a4x74f"><span>2133</span></td><td id="LC2133" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'speed'</span>:
</code></td></tr><tr><td id="L2134" class="css-a4x74f"><span>2134</span></td><td id="LC2134" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> value === <span class="code-number">1</span> ? i18n.get(<span class="code-string">'normal'</span>, <span class="code-keyword">this</span>.config) : <span class="code-string">`<span class="code-subst">${value}</span>&amp;times;`</span>;
</code></td></tr><tr><td id="L2135" class="css-a4x74f"><span>2135</span></td><td id="LC2135" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'quality'</span>:
</code></td></tr><tr><td id="L2136" class="css-a4x74f"><span>2136</span></td><td id="LC2136" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.number(value)) {
</code></td></tr><tr><td id="L2137" class="css-a4x74f"><span>2137</span></td><td id="LC2137" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> label = i18n.get(<span class="code-string">`qualityLabel.<span class="code-subst">${value}</span>`</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L2138" class="css-a4x74f"><span>2138</span></td><td id="LC2138" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!label.length) {
</code></td></tr><tr><td id="L2139" class="css-a4x74f"><span>2139</span></td><td id="LC2139" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span> <span class="code-string">`<span class="code-subst">${value}</span>p`</span>;
</code></td></tr><tr><td id="L2140" class="css-a4x74f"><span>2140</span></td><td id="LC2140" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L2141" class="css-a4x74f"><span>2141</span></td><td id="LC2141" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span> label;
</code></td></tr><tr><td id="L2142" class="css-a4x74f"><span>2142</span></td><td id="LC2142" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2143" class="css-a4x74f"><span>2143</span></td><td id="LC2143" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> toTitleCase(value);
</code></td></tr><tr><td id="L2144" class="css-a4x74f"><span>2144</span></td><td id="LC2144" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'captions'</span>:
</code></td></tr><tr><td id="L2145" class="css-a4x74f"><span>2145</span></td><td id="LC2145" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> captions.getLabel.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2146" class="css-a4x74f"><span>2146</span></td><td id="LC2146" class="css-1dcdqdg"><code>        <span class="code-keyword">default</span>:
</code></td></tr><tr><td id="L2147" class="css-a4x74f"><span>2147</span></td><td id="LC2147" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2148" class="css-a4x74f"><span>2148</span></td><td id="LC2148" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2149" class="css-a4x74f"><span>2149</span></td><td id="LC2149" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2150" class="css-a4x74f"><span>2150</span></td><td id="LC2150" class="css-1dcdqdg"><code>    <span class="code-comment">// Set the quality menu</span>
</code></td></tr><tr><td id="L2151" class="css-a4x74f"><span>2151</span></td><td id="LC2151" class="css-1dcdqdg"><code>    setQualityMenu(options) {
</code></td></tr><tr><td id="L2152" class="css-a4x74f"><span>2152</span></td><td id="LC2152" class="css-1dcdqdg"><code>      <span class="code-comment">// Menu required</span>
</code></td></tr><tr><td id="L2153" class="css-a4x74f"><span>2153</span></td><td id="LC2153" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.settings.panels.quality)) {
</code></td></tr><tr><td id="L2154" class="css-a4x74f"><span>2154</span></td><td id="LC2154" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2155" class="css-a4x74f"><span>2155</span></td><td id="LC2155" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2156" class="css-a4x74f"><span>2156</span></td><td id="LC2156" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> type = <span class="code-string">'quality'</span>;
</code></td></tr><tr><td id="L2157" class="css-a4x74f"><span>2157</span></td><td id="LC2157" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> list = <span class="code-keyword">this</span>.elements.settings.panels.quality.querySelector(<span class="code-string">'[role="menu"]'</span>);
</code></td></tr><tr><td id="L2158" class="css-a4x74f"><span>2158</span></td><td id="LC2158" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2159" class="css-a4x74f"><span>2159</span></td><td id="LC2159" class="css-1dcdqdg"><code>      <span class="code-comment">// Set options if passed and filter based on uniqueness and config</span>
</code></td></tr><tr><td id="L2160" class="css-a4x74f"><span>2160</span></td><td id="LC2160" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.array(options)) {
</code></td></tr><tr><td id="L2161" class="css-a4x74f"><span>2161</span></td><td id="LC2161" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.options.quality = dedupe(options).filter(<span class="code-function"><span class="code-params">quality</span> =&gt;</span> <span class="code-keyword">this</span>.config.quality.options.includes(quality));
</code></td></tr><tr><td id="L2162" class="css-a4x74f"><span>2162</span></td><td id="LC2162" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2163" class="css-a4x74f"><span>2163</span></td><td id="LC2163" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2164" class="css-a4x74f"><span>2164</span></td><td id="LC2164" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle the pane and tab</span>
</code></td></tr><tr><td id="L2165" class="css-a4x74f"><span>2165</span></td><td id="LC2165" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = !is.empty(<span class="code-keyword">this</span>.options.quality) &amp;&amp; <span class="code-keyword">this</span>.options.quality.length &gt; <span class="code-number">1</span>;
</code></td></tr><tr><td id="L2166" class="css-a4x74f"><span>2166</span></td><td id="LC2166" class="css-1dcdqdg"><code>      controls.toggleMenuButton.call(<span class="code-keyword">this</span>, type, toggle);
</code></td></tr><tr><td id="L2167" class="css-a4x74f"><span>2167</span></td><td id="LC2167" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2168" class="css-a4x74f"><span>2168</span></td><td id="LC2168" class="css-1dcdqdg"><code>      <span class="code-comment">// Empty the menu</span>
</code></td></tr><tr><td id="L2169" class="css-a4x74f"><span>2169</span></td><td id="LC2169" class="css-1dcdqdg"><code>      emptyElement(list);
</code></td></tr><tr><td id="L2170" class="css-a4x74f"><span>2170</span></td><td id="LC2170" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2171" class="css-a4x74f"><span>2171</span></td><td id="LC2171" class="css-1dcdqdg"><code>      <span class="code-comment">// Check if we need to toggle the parent</span>
</code></td></tr><tr><td id="L2172" class="css-a4x74f"><span>2172</span></td><td id="LC2172" class="css-1dcdqdg"><code>      controls.checkMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2173" class="css-a4x74f"><span>2173</span></td><td id="LC2173" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2174" class="css-a4x74f"><span>2174</span></td><td id="LC2174" class="css-1dcdqdg"><code>      <span class="code-comment">// If we're hiding, nothing more to do</span>
</code></td></tr><tr><td id="L2175" class="css-a4x74f"><span>2175</span></td><td id="LC2175" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!toggle) {
</code></td></tr><tr><td id="L2176" class="css-a4x74f"><span>2176</span></td><td id="LC2176" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2177" class="css-a4x74f"><span>2177</span></td><td id="LC2177" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2178" class="css-a4x74f"><span>2178</span></td><td id="LC2178" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2179" class="css-a4x74f"><span>2179</span></td><td id="LC2179" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the badge HTML for HD, 4K etc</span>
</code></td></tr><tr><td id="L2180" class="css-a4x74f"><span>2180</span></td><td id="LC2180" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> getBadge = <span class="code-function"><span class="code-params">quality</span> =&gt;</span> {
</code></td></tr><tr><td id="L2181" class="css-a4x74f"><span>2181</span></td><td id="LC2181" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> label = i18n.get(<span class="code-string">`qualityBadge.<span class="code-subst">${quality}</span>`</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L2182" class="css-a4x74f"><span>2182</span></td><td id="LC2182" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!label.length) {
</code></td></tr><tr><td id="L2183" class="css-a4x74f"><span>2183</span></td><td id="LC2183" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2184" class="css-a4x74f"><span>2184</span></td><td id="LC2184" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2185" class="css-a4x74f"><span>2185</span></td><td id="LC2185" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> controls.createBadge.call(<span class="code-keyword">this</span>, label);
</code></td></tr><tr><td id="L2186" class="css-a4x74f"><span>2186</span></td><td id="LC2186" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2187" class="css-a4x74f"><span>2187</span></td><td id="LC2187" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2188" class="css-a4x74f"><span>2188</span></td><td id="LC2188" class="css-1dcdqdg"><code>      <span class="code-comment">// Sort options by the config and then render options</span>
</code></td></tr><tr><td id="L2189" class="css-a4x74f"><span>2189</span></td><td id="LC2189" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.options.quality.sort(<span class="code-function">(<span class="code-params">a, b</span>) =&gt;</span> {
</code></td></tr><tr><td id="L2190" class="css-a4x74f"><span>2190</span></td><td id="LC2190" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> sorting = <span class="code-keyword">this</span>.config.quality.options;
</code></td></tr><tr><td id="L2191" class="css-a4x74f"><span>2191</span></td><td id="LC2191" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> sorting.indexOf(a) &gt; sorting.indexOf(b) ? <span class="code-number">1</span> : <span class="code-number">-1</span>;
</code></td></tr><tr><td id="L2192" class="css-a4x74f"><span>2192</span></td><td id="LC2192" class="css-1dcdqdg"><code>      }).forEach(<span class="code-function"><span class="code-params">quality</span> =&gt;</span> {
</code></td></tr><tr><td id="L2193" class="css-a4x74f"><span>2193</span></td><td id="LC2193" class="css-1dcdqdg"><code>        controls.createMenuItem.call(<span class="code-keyword">this</span>, {
</code></td></tr><tr><td id="L2194" class="css-a4x74f"><span>2194</span></td><td id="LC2194" class="css-1dcdqdg"><code>          value: quality,
</code></td></tr><tr><td id="L2195" class="css-a4x74f"><span>2195</span></td><td id="LC2195" class="css-1dcdqdg"><code>          list,
</code></td></tr><tr><td id="L2196" class="css-a4x74f"><span>2196</span></td><td id="LC2196" class="css-1dcdqdg"><code>          type,
</code></td></tr><tr><td id="L2197" class="css-a4x74f"><span>2197</span></td><td id="LC2197" class="css-1dcdqdg"><code>          title: controls.getLabel.call(<span class="code-keyword">this</span>, <span class="code-string">'quality'</span>, quality),
</code></td></tr><tr><td id="L2198" class="css-a4x74f"><span>2198</span></td><td id="LC2198" class="css-1dcdqdg"><code>          badge: getBadge(quality)
</code></td></tr><tr><td id="L2199" class="css-a4x74f"><span>2199</span></td><td id="LC2199" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2200" class="css-a4x74f"><span>2200</span></td><td id="LC2200" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L2201" class="css-a4x74f"><span>2201</span></td><td id="LC2201" class="css-1dcdqdg"><code>      controls.updateSetting.call(<span class="code-keyword">this</span>, type, list);
</code></td></tr><tr><td id="L2202" class="css-a4x74f"><span>2202</span></td><td id="LC2202" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2203" class="css-a4x74f"><span>2203</span></td><td id="LC2203" class="css-1dcdqdg"><code>    <span class="code-comment">// Set the looping options</span>
</code></td></tr><tr><td id="L2204" class="css-a4x74f"><span>2204</span></td><td id="LC2204" class="css-1dcdqdg"><code>    <span class="code-comment">/* setLoopMenu() {
</span></code></td></tr><tr><td id="L2205" class="css-a4x74f"><span>2205</span></td><td id="LC2205" class="css-1dcdqdg"><code><span class="code-comment">          // Menu required
</span></code></td></tr><tr><td id="L2206" class="css-a4x74f"><span>2206</span></td><td id="LC2206" class="css-1dcdqdg"><code><span class="code-comment">          if (!is.element(this.elements.settings.panels.loop)) {
</span></code></td></tr><tr><td id="L2207" class="css-a4x74f"><span>2207</span></td><td id="LC2207" class="css-1dcdqdg"><code><span class="code-comment">              return;
</span></code></td></tr><tr><td id="L2208" class="css-a4x74f"><span>2208</span></td><td id="LC2208" class="css-1dcdqdg"><code><span class="code-comment">          }
</span></code></td></tr><tr><td id="L2209" class="css-a4x74f"><span>2209</span></td><td id="LC2209" class="css-1dcdqdg"><code><span class="code-comment">           const options = ['start', 'end', 'all', 'reset'];
</span></code></td></tr><tr><td id="L2210" class="css-a4x74f"><span>2210</span></td><td id="LC2210" class="css-1dcdqdg"><code><span class="code-comment">          const list = this.elements.settings.panels.loop.querySelector('[role="menu"]');
</span></code></td></tr><tr><td id="L2211" class="css-a4x74f"><span>2211</span></td><td id="LC2211" class="css-1dcdqdg"><code><span class="code-comment">           // Show the pane and tab
</span></code></td></tr><tr><td id="L2212" class="css-a4x74f"><span>2212</span></td><td id="LC2212" class="css-1dcdqdg"><code><span class="code-comment">          toggleHidden(this.elements.settings.buttons.loop, false);
</span></code></td></tr><tr><td id="L2213" class="css-a4x74f"><span>2213</span></td><td id="LC2213" class="css-1dcdqdg"><code><span class="code-comment">          toggleHidden(this.elements.settings.panels.loop, false);
</span></code></td></tr><tr><td id="L2214" class="css-a4x74f"><span>2214</span></td><td id="LC2214" class="css-1dcdqdg"><code><span class="code-comment">           // Toggle the pane and tab
</span></code></td></tr><tr><td id="L2215" class="css-a4x74f"><span>2215</span></td><td id="LC2215" class="css-1dcdqdg"><code><span class="code-comment">          const toggle = !is.empty(this.loop.options);
</span></code></td></tr><tr><td id="L2216" class="css-a4x74f"><span>2216</span></td><td id="LC2216" class="css-1dcdqdg"><code><span class="code-comment">          controls.toggleMenuButton.call(this, 'loop', toggle);
</span></code></td></tr><tr><td id="L2217" class="css-a4x74f"><span>2217</span></td><td id="LC2217" class="css-1dcdqdg"><code><span class="code-comment">           // Empty the menu
</span></code></td></tr><tr><td id="L2218" class="css-a4x74f"><span>2218</span></td><td id="LC2218" class="css-1dcdqdg"><code><span class="code-comment">          emptyElement(list);
</span></code></td></tr><tr><td id="L2219" class="css-a4x74f"><span>2219</span></td><td id="LC2219" class="css-1dcdqdg"><code><span class="code-comment">           options.forEach(option =&gt; {
</span></code></td></tr><tr><td id="L2220" class="css-a4x74f"><span>2220</span></td><td id="LC2220" class="css-1dcdqdg"><code><span class="code-comment">              const item = createElement('li');
</span></code></td></tr><tr><td id="L2221" class="css-a4x74f"><span>2221</span></td><td id="LC2221" class="css-1dcdqdg"><code><span class="code-comment">               const button = createElement(
</span></code></td></tr><tr><td id="L2222" class="css-a4x74f"><span>2222</span></td><td id="LC2222" class="css-1dcdqdg"><code><span class="code-comment">                  'button',
</span></code></td></tr><tr><td id="L2223" class="css-a4x74f"><span>2223</span></td><td id="LC2223" class="css-1dcdqdg"><code><span class="code-comment">                  extend(getAttributesFromSelector(this.config.selectors.buttons.loop), {
</span></code></td></tr><tr><td id="L2224" class="css-a4x74f"><span>2224</span></td><td id="LC2224" class="css-1dcdqdg"><code><span class="code-comment">                      type: 'button',
</span></code></td></tr><tr><td id="L2225" class="css-a4x74f"><span>2225</span></td><td id="LC2225" class="css-1dcdqdg"><code><span class="code-comment">                      class: this.config.classNames.control,
</span></code></td></tr><tr><td id="L2226" class="css-a4x74f"><span>2226</span></td><td id="LC2226" class="css-1dcdqdg"><code><span class="code-comment">                      'data-plyr-loop-action': option,
</span></code></td></tr><tr><td id="L2227" class="css-a4x74f"><span>2227</span></td><td id="LC2227" class="css-1dcdqdg"><code><span class="code-comment">                  }),
</span></code></td></tr><tr><td id="L2228" class="css-a4x74f"><span>2228</span></td><td id="LC2228" class="css-1dcdqdg"><code><span class="code-comment">                  i18n.get(option, this.config)
</span></code></td></tr><tr><td id="L2229" class="css-a4x74f"><span>2229</span></td><td id="LC2229" class="css-1dcdqdg"><code><span class="code-comment">              );
</span></code></td></tr><tr><td id="L2230" class="css-a4x74f"><span>2230</span></td><td id="LC2230" class="css-1dcdqdg"><code><span class="code-comment">               if (['start', 'end'].includes(option)) {
</span></code></td></tr><tr><td id="L2231" class="css-a4x74f"><span>2231</span></td><td id="LC2231" class="css-1dcdqdg"><code><span class="code-comment">                  const badge = controls.createBadge.call(this, '00:00');
</span></code></td></tr><tr><td id="L2232" class="css-a4x74f"><span>2232</span></td><td id="LC2232" class="css-1dcdqdg"><code><span class="code-comment">                  button.appendChild(badge);
</span></code></td></tr><tr><td id="L2233" class="css-a4x74f"><span>2233</span></td><td id="LC2233" class="css-1dcdqdg"><code><span class="code-comment">              }
</span></code></td></tr><tr><td id="L2234" class="css-a4x74f"><span>2234</span></td><td id="LC2234" class="css-1dcdqdg"><code><span class="code-comment">               item.appendChild(button);
</span></code></td></tr><tr><td id="L2235" class="css-a4x74f"><span>2235</span></td><td id="LC2235" class="css-1dcdqdg"><code><span class="code-comment">              list.appendChild(item);
</span></code></td></tr><tr><td id="L2236" class="css-a4x74f"><span>2236</span></td><td id="LC2236" class="css-1dcdqdg"><code><span class="code-comment">          });
</span></code></td></tr><tr><td id="L2237" class="css-a4x74f"><span>2237</span></td><td id="LC2237" class="css-1dcdqdg"><code><span class="code-comment">      }, */</span>
</code></td></tr><tr><td id="L2238" class="css-a4x74f"><span>2238</span></td><td id="LC2238" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2239" class="css-a4x74f"><span>2239</span></td><td id="LC2239" class="css-1dcdqdg"><code>    <span class="code-comment">// Get current selected caption language</span>
</code></td></tr><tr><td id="L2240" class="css-a4x74f"><span>2240</span></td><td id="LC2240" class="css-1dcdqdg"><code>    <span class="code-comment">// <span class="code-doctag">TODO:</span> rework this to user the getter in the API?</span>
</code></td></tr><tr><td id="L2241" class="css-a4x74f"><span>2241</span></td><td id="LC2241" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2242" class="css-a4x74f"><span>2242</span></td><td id="LC2242" class="css-1dcdqdg"><code>    <span class="code-comment">// Set a list of available captions languages</span>
</code></td></tr><tr><td id="L2243" class="css-a4x74f"><span>2243</span></td><td id="LC2243" class="css-1dcdqdg"><code>    setCaptionsMenu() {
</code></td></tr><tr><td id="L2244" class="css-a4x74f"><span>2244</span></td><td id="LC2244" class="css-1dcdqdg"><code>      <span class="code-comment">// Menu required</span>
</code></td></tr><tr><td id="L2245" class="css-a4x74f"><span>2245</span></td><td id="LC2245" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.settings.panels.captions)) {
</code></td></tr><tr><td id="L2246" class="css-a4x74f"><span>2246</span></td><td id="LC2246" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2247" class="css-a4x74f"><span>2247</span></td><td id="LC2247" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2248" class="css-a4x74f"><span>2248</span></td><td id="LC2248" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2249" class="css-a4x74f"><span>2249</span></td><td id="LC2249" class="css-1dcdqdg"><code>      <span class="code-comment">// <span class="code-doctag">TODO:</span> Captions or language? Currently it's mixed</span>
</code></td></tr><tr><td id="L2250" class="css-a4x74f"><span>2250</span></td><td id="LC2250" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> type = <span class="code-string">'captions'</span>;
</code></td></tr><tr><td id="L2251" class="css-a4x74f"><span>2251</span></td><td id="LC2251" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> list = <span class="code-keyword">this</span>.elements.settings.panels.captions.querySelector(<span class="code-string">'[role="menu"]'</span>);
</code></td></tr><tr><td id="L2252" class="css-a4x74f"><span>2252</span></td><td id="LC2252" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2253" class="css-a4x74f"><span>2253</span></td><td id="LC2253" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = <span class="code-built_in">Boolean</span>(tracks.length);
</code></td></tr><tr><td id="L2254" class="css-a4x74f"><span>2254</span></td><td id="LC2254" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2255" class="css-a4x74f"><span>2255</span></td><td id="LC2255" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle the pane and tab</span>
</code></td></tr><tr><td id="L2256" class="css-a4x74f"><span>2256</span></td><td id="LC2256" class="css-1dcdqdg"><code>      controls.toggleMenuButton.call(<span class="code-keyword">this</span>, type, toggle);
</code></td></tr><tr><td id="L2257" class="css-a4x74f"><span>2257</span></td><td id="LC2257" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2258" class="css-a4x74f"><span>2258</span></td><td id="LC2258" class="css-1dcdqdg"><code>      <span class="code-comment">// Empty the menu</span>
</code></td></tr><tr><td id="L2259" class="css-a4x74f"><span>2259</span></td><td id="LC2259" class="css-1dcdqdg"><code>      emptyElement(list);
</code></td></tr><tr><td id="L2260" class="css-a4x74f"><span>2260</span></td><td id="LC2260" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2261" class="css-a4x74f"><span>2261</span></td><td id="LC2261" class="css-1dcdqdg"><code>      <span class="code-comment">// Check if we need to toggle the parent</span>
</code></td></tr><tr><td id="L2262" class="css-a4x74f"><span>2262</span></td><td id="LC2262" class="css-1dcdqdg"><code>      controls.checkMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2263" class="css-a4x74f"><span>2263</span></td><td id="LC2263" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2264" class="css-a4x74f"><span>2264</span></td><td id="LC2264" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's no captions, bail</span>
</code></td></tr><tr><td id="L2265" class="css-a4x74f"><span>2265</span></td><td id="LC2265" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!toggle) {
</code></td></tr><tr><td id="L2266" class="css-a4x74f"><span>2266</span></td><td id="LC2266" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2267" class="css-a4x74f"><span>2267</span></td><td id="LC2267" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2268" class="css-a4x74f"><span>2268</span></td><td id="LC2268" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2269" class="css-a4x74f"><span>2269</span></td><td id="LC2269" class="css-1dcdqdg"><code>      <span class="code-comment">// Generate options data</span>
</code></td></tr><tr><td id="L2270" class="css-a4x74f"><span>2270</span></td><td id="LC2270" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> options = tracks.map(<span class="code-function">(<span class="code-params">track, value</span>) =&gt;</span> ({
</code></td></tr><tr><td id="L2271" class="css-a4x74f"><span>2271</span></td><td id="LC2271" class="css-1dcdqdg"><code>        value,
</code></td></tr><tr><td id="L2272" class="css-a4x74f"><span>2272</span></td><td id="LC2272" class="css-1dcdqdg"><code>        checked: <span class="code-keyword">this</span>.captions.toggled &amp;&amp; <span class="code-keyword">this</span>.currentTrack === value,
</code></td></tr><tr><td id="L2273" class="css-a4x74f"><span>2273</span></td><td id="LC2273" class="css-1dcdqdg"><code>        title: captions.getLabel.call(<span class="code-keyword">this</span>, track),
</code></td></tr><tr><td id="L2274" class="css-a4x74f"><span>2274</span></td><td id="LC2274" class="css-1dcdqdg"><code>        badge: track.language &amp;&amp; controls.createBadge.call(<span class="code-keyword">this</span>, track.language.toUpperCase()),
</code></td></tr><tr><td id="L2275" class="css-a4x74f"><span>2275</span></td><td id="LC2275" class="css-1dcdqdg"><code>        list,
</code></td></tr><tr><td id="L2276" class="css-a4x74f"><span>2276</span></td><td id="LC2276" class="css-1dcdqdg"><code>        type: <span class="code-string">'language'</span>
</code></td></tr><tr><td id="L2277" class="css-a4x74f"><span>2277</span></td><td id="LC2277" class="css-1dcdqdg"><code>      }));
</code></td></tr><tr><td id="L2278" class="css-a4x74f"><span>2278</span></td><td id="LC2278" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2279" class="css-a4x74f"><span>2279</span></td><td id="LC2279" class="css-1dcdqdg"><code>      <span class="code-comment">// Add the "Disabled" option to turn off captions</span>
</code></td></tr><tr><td id="L2280" class="css-a4x74f"><span>2280</span></td><td id="LC2280" class="css-1dcdqdg"><code>      options.unshift({
</code></td></tr><tr><td id="L2281" class="css-a4x74f"><span>2281</span></td><td id="LC2281" class="css-1dcdqdg"><code>        value: <span class="code-number">-1</span>,
</code></td></tr><tr><td id="L2282" class="css-a4x74f"><span>2282</span></td><td id="LC2282" class="css-1dcdqdg"><code>        checked: !<span class="code-keyword">this</span>.captions.toggled,
</code></td></tr><tr><td id="L2283" class="css-a4x74f"><span>2283</span></td><td id="LC2283" class="css-1dcdqdg"><code>        title: i18n.get(<span class="code-string">'disabled'</span>, <span class="code-keyword">this</span>.config),
</code></td></tr><tr><td id="L2284" class="css-a4x74f"><span>2284</span></td><td id="LC2284" class="css-1dcdqdg"><code>        list,
</code></td></tr><tr><td id="L2285" class="css-a4x74f"><span>2285</span></td><td id="LC2285" class="css-1dcdqdg"><code>        type: <span class="code-string">'language'</span>
</code></td></tr><tr><td id="L2286" class="css-a4x74f"><span>2286</span></td><td id="LC2286" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L2287" class="css-a4x74f"><span>2287</span></td><td id="LC2287" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2288" class="css-a4x74f"><span>2288</span></td><td id="LC2288" class="css-1dcdqdg"><code>      <span class="code-comment">// Generate options</span>
</code></td></tr><tr><td id="L2289" class="css-a4x74f"><span>2289</span></td><td id="LC2289" class="css-1dcdqdg"><code>      options.forEach(controls.createMenuItem.bind(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L2290" class="css-a4x74f"><span>2290</span></td><td id="LC2290" class="css-1dcdqdg"><code>      controls.updateSetting.call(<span class="code-keyword">this</span>, type, list);
</code></td></tr><tr><td id="L2291" class="css-a4x74f"><span>2291</span></td><td id="LC2291" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2292" class="css-a4x74f"><span>2292</span></td><td id="LC2292" class="css-1dcdqdg"><code>    <span class="code-comment">// Set a list of available captions languages</span>
</code></td></tr><tr><td id="L2293" class="css-a4x74f"><span>2293</span></td><td id="LC2293" class="css-1dcdqdg"><code>    setSpeedMenu() {
</code></td></tr><tr><td id="L2294" class="css-a4x74f"><span>2294</span></td><td id="LC2294" class="css-1dcdqdg"><code>      <span class="code-comment">// Menu required</span>
</code></td></tr><tr><td id="L2295" class="css-a4x74f"><span>2295</span></td><td id="LC2295" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.settings.panels.speed)) {
</code></td></tr><tr><td id="L2296" class="css-a4x74f"><span>2296</span></td><td id="LC2296" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2297" class="css-a4x74f"><span>2297</span></td><td id="LC2297" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2298" class="css-a4x74f"><span>2298</span></td><td id="LC2298" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> type = <span class="code-string">'speed'</span>;
</code></td></tr><tr><td id="L2299" class="css-a4x74f"><span>2299</span></td><td id="LC2299" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> list = <span class="code-keyword">this</span>.elements.settings.panels.speed.querySelector(<span class="code-string">'[role="menu"]'</span>);
</code></td></tr><tr><td id="L2300" class="css-a4x74f"><span>2300</span></td><td id="LC2300" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2301" class="css-a4x74f"><span>2301</span></td><td id="LC2301" class="css-1dcdqdg"><code>      <span class="code-comment">// Filter out invalid speeds</span>
</code></td></tr><tr><td id="L2302" class="css-a4x74f"><span>2302</span></td><td id="LC2302" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.options.speed = <span class="code-keyword">this</span>.options.speed.filter(<span class="code-function"><span class="code-params">o</span> =&gt;</span> o &gt;= <span class="code-keyword">this</span>.minimumSpeed &amp;&amp; o &lt;= <span class="code-keyword">this</span>.maximumSpeed);
</code></td></tr><tr><td id="L2303" class="css-a4x74f"><span>2303</span></td><td id="LC2303" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2304" class="css-a4x74f"><span>2304</span></td><td id="LC2304" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle the pane and tab</span>
</code></td></tr><tr><td id="L2305" class="css-a4x74f"><span>2305</span></td><td id="LC2305" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = !is.empty(<span class="code-keyword">this</span>.options.speed) &amp;&amp; <span class="code-keyword">this</span>.options.speed.length &gt; <span class="code-number">1</span>;
</code></td></tr><tr><td id="L2306" class="css-a4x74f"><span>2306</span></td><td id="LC2306" class="css-1dcdqdg"><code>      controls.toggleMenuButton.call(<span class="code-keyword">this</span>, type, toggle);
</code></td></tr><tr><td id="L2307" class="css-a4x74f"><span>2307</span></td><td id="LC2307" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2308" class="css-a4x74f"><span>2308</span></td><td id="LC2308" class="css-1dcdqdg"><code>      <span class="code-comment">// Empty the menu</span>
</code></td></tr><tr><td id="L2309" class="css-a4x74f"><span>2309</span></td><td id="LC2309" class="css-1dcdqdg"><code>      emptyElement(list);
</code></td></tr><tr><td id="L2310" class="css-a4x74f"><span>2310</span></td><td id="LC2310" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2311" class="css-a4x74f"><span>2311</span></td><td id="LC2311" class="css-1dcdqdg"><code>      <span class="code-comment">// Check if we need to toggle the parent</span>
</code></td></tr><tr><td id="L2312" class="css-a4x74f"><span>2312</span></td><td id="LC2312" class="css-1dcdqdg"><code>      controls.checkMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2313" class="css-a4x74f"><span>2313</span></td><td id="LC2313" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2314" class="css-a4x74f"><span>2314</span></td><td id="LC2314" class="css-1dcdqdg"><code>      <span class="code-comment">// If we're hiding, nothing more to do</span>
</code></td></tr><tr><td id="L2315" class="css-a4x74f"><span>2315</span></td><td id="LC2315" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!toggle) {
</code></td></tr><tr><td id="L2316" class="css-a4x74f"><span>2316</span></td><td id="LC2316" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2317" class="css-a4x74f"><span>2317</span></td><td id="LC2317" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2318" class="css-a4x74f"><span>2318</span></td><td id="LC2318" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2319" class="css-a4x74f"><span>2319</span></td><td id="LC2319" class="css-1dcdqdg"><code>      <span class="code-comment">// Create items</span>
</code></td></tr><tr><td id="L2320" class="css-a4x74f"><span>2320</span></td><td id="LC2320" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.options.speed.forEach(<span class="code-function"><span class="code-params">speed</span> =&gt;</span> {
</code></td></tr><tr><td id="L2321" class="css-a4x74f"><span>2321</span></td><td id="LC2321" class="css-1dcdqdg"><code>        controls.createMenuItem.call(<span class="code-keyword">this</span>, {
</code></td></tr><tr><td id="L2322" class="css-a4x74f"><span>2322</span></td><td id="LC2322" class="css-1dcdqdg"><code>          value: speed,
</code></td></tr><tr><td id="L2323" class="css-a4x74f"><span>2323</span></td><td id="LC2323" class="css-1dcdqdg"><code>          list,
</code></td></tr><tr><td id="L2324" class="css-a4x74f"><span>2324</span></td><td id="LC2324" class="css-1dcdqdg"><code>          type,
</code></td></tr><tr><td id="L2325" class="css-a4x74f"><span>2325</span></td><td id="LC2325" class="css-1dcdqdg"><code>          title: controls.getLabel.call(<span class="code-keyword">this</span>, <span class="code-string">'speed'</span>, speed)
</code></td></tr><tr><td id="L2326" class="css-a4x74f"><span>2326</span></td><td id="LC2326" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2327" class="css-a4x74f"><span>2327</span></td><td id="LC2327" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L2328" class="css-a4x74f"><span>2328</span></td><td id="LC2328" class="css-1dcdqdg"><code>      controls.updateSetting.call(<span class="code-keyword">this</span>, type, list);
</code></td></tr><tr><td id="L2329" class="css-a4x74f"><span>2329</span></td><td id="LC2329" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2330" class="css-a4x74f"><span>2330</span></td><td id="LC2330" class="css-1dcdqdg"><code>    <span class="code-comment">// Check if we need to hide/show the settings menu</span>
</code></td></tr><tr><td id="L2331" class="css-a4x74f"><span>2331</span></td><td id="LC2331" class="css-1dcdqdg"><code>    checkMenu() {
</code></td></tr><tr><td id="L2332" class="css-a4x74f"><span>2332</span></td><td id="LC2332" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2333" class="css-a4x74f"><span>2333</span></td><td id="LC2333" class="css-1dcdqdg"><code>        buttons
</code></td></tr><tr><td id="L2334" class="css-a4x74f"><span>2334</span></td><td id="LC2334" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.elements.settings;
</code></td></tr><tr><td id="L2335" class="css-a4x74f"><span>2335</span></td><td id="LC2335" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> visible = !is.empty(buttons) &amp;&amp; <span class="code-built_in">Object</span>.values(buttons).some(<span class="code-function"><span class="code-params">button</span> =&gt;</span> !button.hidden);
</code></td></tr><tr><td id="L2336" class="css-a4x74f"><span>2336</span></td><td id="LC2336" class="css-1dcdqdg"><code>      toggleHidden(<span class="code-keyword">this</span>.elements.settings.menu, !visible);
</code></td></tr><tr><td id="L2337" class="css-a4x74f"><span>2337</span></td><td id="LC2337" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2338" class="css-a4x74f"><span>2338</span></td><td id="LC2338" class="css-1dcdqdg"><code>    <span class="code-comment">// Focus the first menu item in a given (or visible) menu</span>
</code></td></tr><tr><td id="L2339" class="css-a4x74f"><span>2339</span></td><td id="LC2339" class="css-1dcdqdg"><code>    focusFirstMenuItem(pane, focusVisible = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L2340" class="css-a4x74f"><span>2340</span></td><td id="LC2340" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements.settings.popup.hidden) {
</code></td></tr><tr><td id="L2341" class="css-a4x74f"><span>2341</span></td><td id="LC2341" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2342" class="css-a4x74f"><span>2342</span></td><td id="LC2342" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2343" class="css-a4x74f"><span>2343</span></td><td id="LC2343" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> target = pane;
</code></td></tr><tr><td id="L2344" class="css-a4x74f"><span>2344</span></td><td id="LC2344" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L2345" class="css-a4x74f"><span>2345</span></td><td id="LC2345" class="css-1dcdqdg"><code>        target = <span class="code-built_in">Object</span>.values(<span class="code-keyword">this</span>.elements.settings.panels).find(<span class="code-function"><span class="code-params">p</span> =&gt;</span> !p.hidden);
</code></td></tr><tr><td id="L2346" class="css-a4x74f"><span>2346</span></td><td id="LC2346" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2347" class="css-a4x74f"><span>2347</span></td><td id="LC2347" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> firstItem = target.querySelector(<span class="code-string">'[role^="menuitem"]'</span>);
</code></td></tr><tr><td id="L2348" class="css-a4x74f"><span>2348</span></td><td id="LC2348" class="css-1dcdqdg"><code>      setFocus.call(<span class="code-keyword">this</span>, firstItem, focusVisible);
</code></td></tr><tr><td id="L2349" class="css-a4x74f"><span>2349</span></td><td id="LC2349" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2350" class="css-a4x74f"><span>2350</span></td><td id="LC2350" class="css-1dcdqdg"><code>    <span class="code-comment">// Show/hide menu</span>
</code></td></tr><tr><td id="L2351" class="css-a4x74f"><span>2351</span></td><td id="LC2351" class="css-1dcdqdg"><code>    toggleMenu(input) {
</code></td></tr><tr><td id="L2352" class="css-a4x74f"><span>2352</span></td><td id="LC2352" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2353" class="css-a4x74f"><span>2353</span></td><td id="LC2353" class="css-1dcdqdg"><code>        popup
</code></td></tr><tr><td id="L2354" class="css-a4x74f"><span>2354</span></td><td id="LC2354" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.elements.settings;
</code></td></tr><tr><td id="L2355" class="css-a4x74f"><span>2355</span></td><td id="LC2355" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> button = <span class="code-keyword">this</span>.elements.buttons.settings;
</code></td></tr><tr><td id="L2356" class="css-a4x74f"><span>2356</span></td><td id="LC2356" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2357" class="css-a4x74f"><span>2357</span></td><td id="LC2357" class="css-1dcdqdg"><code>      <span class="code-comment">// Menu and button are required</span>
</code></td></tr><tr><td id="L2358" class="css-a4x74f"><span>2358</span></td><td id="LC2358" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(popup) || !is.element(button)) {
</code></td></tr><tr><td id="L2359" class="css-a4x74f"><span>2359</span></td><td id="LC2359" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2360" class="css-a4x74f"><span>2360</span></td><td id="LC2360" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2361" class="css-a4x74f"><span>2361</span></td><td id="LC2361" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2362" class="css-a4x74f"><span>2362</span></td><td id="LC2362" class="css-1dcdqdg"><code>      <span class="code-comment">// True toggle by default</span>
</code></td></tr><tr><td id="L2363" class="css-a4x74f"><span>2363</span></td><td id="LC2363" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2364" class="css-a4x74f"><span>2364</span></td><td id="LC2364" class="css-1dcdqdg"><code>        hidden
</code></td></tr><tr><td id="L2365" class="css-a4x74f"><span>2365</span></td><td id="LC2365" class="css-1dcdqdg"><code>      } = popup;
</code></td></tr><tr><td id="L2366" class="css-a4x74f"><span>2366</span></td><td id="LC2366" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> show = hidden;
</code></td></tr><tr><td id="L2367" class="css-a4x74f"><span>2367</span></td><td id="LC2367" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.boolean(input)) {
</code></td></tr><tr><td id="L2368" class="css-a4x74f"><span>2368</span></td><td id="LC2368" class="css-1dcdqdg"><code>        show = input;
</code></td></tr><tr><td id="L2369" class="css-a4x74f"><span>2369</span></td><td id="LC2369" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.keyboardEvent(input) &amp;&amp; input.key === <span class="code-string">'Escape'</span>) {
</code></td></tr><tr><td id="L2370" class="css-a4x74f"><span>2370</span></td><td id="LC2370" class="css-1dcdqdg"><code>        show = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L2371" class="css-a4x74f"><span>2371</span></td><td id="LC2371" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.event(input)) {
</code></td></tr><tr><td id="L2372" class="css-a4x74f"><span>2372</span></td><td id="LC2372" class="css-1dcdqdg"><code>        <span class="code-comment">// If Plyr is in a shadowDOM, the event target is set to the component, instead of the</span>
</code></td></tr><tr><td id="L2373" class="css-a4x74f"><span>2373</span></td><td id="LC2373" class="css-1dcdqdg"><code>        <span class="code-comment">// Element in the shadowDOM. The path, if available, is complete.</span>
</code></td></tr><tr><td id="L2374" class="css-a4x74f"><span>2374</span></td><td id="LC2374" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> target = is.function(input.composedPath) ? input.composedPath()[<span class="code-number">0</span>] : input.target;
</code></td></tr><tr><td id="L2375" class="css-a4x74f"><span>2375</span></td><td id="LC2375" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> isMenuItem = popup.contains(target);
</code></td></tr><tr><td id="L2376" class="css-a4x74f"><span>2376</span></td><td id="LC2376" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2377" class="css-a4x74f"><span>2377</span></td><td id="LC2377" class="css-1dcdqdg"><code>        <span class="code-comment">// If the click was inside the menu or if the click</span>
</code></td></tr><tr><td id="L2378" class="css-a4x74f"><span>2378</span></td><td id="LC2378" class="css-1dcdqdg"><code>        <span class="code-comment">// wasn't the button or menu item and we're trying to</span>
</code></td></tr><tr><td id="L2379" class="css-a4x74f"><span>2379</span></td><td id="LC2379" class="css-1dcdqdg"><code>        <span class="code-comment">// show the menu (a doc click shouldn't show the menu)</span>
</code></td></tr><tr><td id="L2380" class="css-a4x74f"><span>2380</span></td><td id="LC2380" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (isMenuItem || !isMenuItem &amp;&amp; input.target !== button &amp;&amp; show) {
</code></td></tr><tr><td id="L2381" class="css-a4x74f"><span>2381</span></td><td id="LC2381" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2382" class="css-a4x74f"><span>2382</span></td><td id="LC2382" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2383" class="css-a4x74f"><span>2383</span></td><td id="LC2383" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2384" class="css-a4x74f"><span>2384</span></td><td id="LC2384" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2385" class="css-a4x74f"><span>2385</span></td><td id="LC2385" class="css-1dcdqdg"><code>      <span class="code-comment">// Set button attributes</span>
</code></td></tr><tr><td id="L2386" class="css-a4x74f"><span>2386</span></td><td id="LC2386" class="css-1dcdqdg"><code>      button.setAttribute(<span class="code-string">'aria-expanded'</span>, show);
</code></td></tr><tr><td id="L2387" class="css-a4x74f"><span>2387</span></td><td id="LC2387" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2388" class="css-a4x74f"><span>2388</span></td><td id="LC2388" class="css-1dcdqdg"><code>      <span class="code-comment">// Show the actual popup</span>
</code></td></tr><tr><td id="L2389" class="css-a4x74f"><span>2389</span></td><td id="LC2389" class="css-1dcdqdg"><code>      toggleHidden(popup, !show);
</code></td></tr><tr><td id="L2390" class="css-a4x74f"><span>2390</span></td><td id="LC2390" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2391" class="css-a4x74f"><span>2391</span></td><td id="LC2391" class="css-1dcdqdg"><code>      <span class="code-comment">// Add class hook</span>
</code></td></tr><tr><td id="L2392" class="css-a4x74f"><span>2392</span></td><td id="LC2392" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.menu.open, show);
</code></td></tr><tr><td id="L2393" class="css-a4x74f"><span>2393</span></td><td id="LC2393" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2394" class="css-a4x74f"><span>2394</span></td><td id="LC2394" class="css-1dcdqdg"><code>      <span class="code-comment">// Focus the first item if key interaction</span>
</code></td></tr><tr><td id="L2395" class="css-a4x74f"><span>2395</span></td><td id="LC2395" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (show &amp;&amp; is.keyboardEvent(input)) {
</code></td></tr><tr><td id="L2396" class="css-a4x74f"><span>2396</span></td><td id="LC2396" class="css-1dcdqdg"><code>        controls.focusFirstMenuItem.call(<span class="code-keyword">this</span>, <span class="code-literal">null</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2397" class="css-a4x74f"><span>2397</span></td><td id="LC2397" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!show &amp;&amp; !hidden) {
</code></td></tr><tr><td id="L2398" class="css-a4x74f"><span>2398</span></td><td id="LC2398" class="css-1dcdqdg"><code>        <span class="code-comment">// If closing, re-focus the button</span>
</code></td></tr><tr><td id="L2399" class="css-a4x74f"><span>2399</span></td><td id="LC2399" class="css-1dcdqdg"><code>        setFocus.call(<span class="code-keyword">this</span>, button, is.keyboardEvent(input));
</code></td></tr><tr><td id="L2400" class="css-a4x74f"><span>2400</span></td><td id="LC2400" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2401" class="css-a4x74f"><span>2401</span></td><td id="LC2401" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2402" class="css-a4x74f"><span>2402</span></td><td id="LC2402" class="css-1dcdqdg"><code>    <span class="code-comment">// Get the natural size of a menu panel</span>
</code></td></tr><tr><td id="L2403" class="css-a4x74f"><span>2403</span></td><td id="LC2403" class="css-1dcdqdg"><code>    getMenuSize(tab) {
</code></td></tr><tr><td id="L2404" class="css-a4x74f"><span>2404</span></td><td id="LC2404" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> clone = tab.cloneNode(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2405" class="css-a4x74f"><span>2405</span></td><td id="LC2405" class="css-1dcdqdg"><code>      clone.style.position = <span class="code-string">'absolute'</span>;
</code></td></tr><tr><td id="L2406" class="css-a4x74f"><span>2406</span></td><td id="LC2406" class="css-1dcdqdg"><code>      clone.style.opacity = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L2407" class="css-a4x74f"><span>2407</span></td><td id="LC2407" class="css-1dcdqdg"><code>      clone.removeAttribute(<span class="code-string">'hidden'</span>);
</code></td></tr><tr><td id="L2408" class="css-a4x74f"><span>2408</span></td><td id="LC2408" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2409" class="css-a4x74f"><span>2409</span></td><td id="LC2409" class="css-1dcdqdg"><code>      <span class="code-comment">// Append to parent so we get the "real" size</span>
</code></td></tr><tr><td id="L2410" class="css-a4x74f"><span>2410</span></td><td id="LC2410" class="css-1dcdqdg"><code>      tab.parentNode.appendChild(clone);
</code></td></tr><tr><td id="L2411" class="css-a4x74f"><span>2411</span></td><td id="LC2411" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2412" class="css-a4x74f"><span>2412</span></td><td id="LC2412" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the sizes before we remove</span>
</code></td></tr><tr><td id="L2413" class="css-a4x74f"><span>2413</span></td><td id="LC2413" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> width = clone.scrollWidth;
</code></td></tr><tr><td id="L2414" class="css-a4x74f"><span>2414</span></td><td id="LC2414" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> height = clone.scrollHeight;
</code></td></tr><tr><td id="L2415" class="css-a4x74f"><span>2415</span></td><td id="LC2415" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2416" class="css-a4x74f"><span>2416</span></td><td id="LC2416" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove from the DOM</span>
</code></td></tr><tr><td id="L2417" class="css-a4x74f"><span>2417</span></td><td id="LC2417" class="css-1dcdqdg"><code>      removeElement(clone);
</code></td></tr><tr><td id="L2418" class="css-a4x74f"><span>2418</span></td><td id="LC2418" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> {
</code></td></tr><tr><td id="L2419" class="css-a4x74f"><span>2419</span></td><td id="LC2419" class="css-1dcdqdg"><code>        width,
</code></td></tr><tr><td id="L2420" class="css-a4x74f"><span>2420</span></td><td id="LC2420" class="css-1dcdqdg"><code>        height
</code></td></tr><tr><td id="L2421" class="css-a4x74f"><span>2421</span></td><td id="LC2421" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2422" class="css-a4x74f"><span>2422</span></td><td id="LC2422" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2423" class="css-a4x74f"><span>2423</span></td><td id="LC2423" class="css-1dcdqdg"><code>    <span class="code-comment">// Show a panel in the menu</span>
</code></td></tr><tr><td id="L2424" class="css-a4x74f"><span>2424</span></td><td id="LC2424" class="css-1dcdqdg"><code>    showMenuPanel(type = <span class="code-string">''</span>, focusVisible = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L2425" class="css-a4x74f"><span>2425</span></td><td id="LC2425" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> target = <span class="code-keyword">this</span>.elements.container.querySelector(<span class="code-string">`#plyr-settings-<span class="code-subst">${<span class="code-keyword">this</span>.id}</span>-<span class="code-subst">${type}</span>`</span>);
</code></td></tr><tr><td id="L2426" class="css-a4x74f"><span>2426</span></td><td id="LC2426" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2427" class="css-a4x74f"><span>2427</span></td><td id="LC2427" class="css-1dcdqdg"><code>      <span class="code-comment">// Nothing to show, bail</span>
</code></td></tr><tr><td id="L2428" class="css-a4x74f"><span>2428</span></td><td id="LC2428" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L2429" class="css-a4x74f"><span>2429</span></td><td id="LC2429" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2430" class="css-a4x74f"><span>2430</span></td><td id="LC2430" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2431" class="css-a4x74f"><span>2431</span></td><td id="LC2431" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2432" class="css-a4x74f"><span>2432</span></td><td id="LC2432" class="css-1dcdqdg"><code>      <span class="code-comment">// Hide all other panels</span>
</code></td></tr><tr><td id="L2433" class="css-a4x74f"><span>2433</span></td><td id="LC2433" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> container = target.parentNode;
</code></td></tr><tr><td id="L2434" class="css-a4x74f"><span>2434</span></td><td id="LC2434" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> current = <span class="code-built_in">Array</span>.from(container.children).find(<span class="code-function"><span class="code-params">node</span> =&gt;</span> !node.hidden);
</code></td></tr><tr><td id="L2435" class="css-a4x74f"><span>2435</span></td><td id="LC2435" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2436" class="css-a4x74f"><span>2436</span></td><td id="LC2436" class="css-1dcdqdg"><code>      <span class="code-comment">// If we can do fancy animations, we'll animate the height/width</span>
</code></td></tr><tr><td id="L2437" class="css-a4x74f"><span>2437</span></td><td id="LC2437" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (support.transitions &amp;&amp; !support.reducedMotion) {
</code></td></tr><tr><td id="L2438" class="css-a4x74f"><span>2438</span></td><td id="LC2438" class="css-1dcdqdg"><code>        <span class="code-comment">// Set the current width as a base</span>
</code></td></tr><tr><td id="L2439" class="css-a4x74f"><span>2439</span></td><td id="LC2439" class="css-1dcdqdg"><code>        container.style.width = <span class="code-string">`<span class="code-subst">${current.scrollWidth}</span>px`</span>;
</code></td></tr><tr><td id="L2440" class="css-a4x74f"><span>2440</span></td><td id="LC2440" class="css-1dcdqdg"><code>        container.style.height = <span class="code-string">`<span class="code-subst">${current.scrollHeight}</span>px`</span>;
</code></td></tr><tr><td id="L2441" class="css-a4x74f"><span>2441</span></td><td id="LC2441" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2442" class="css-a4x74f"><span>2442</span></td><td id="LC2442" class="css-1dcdqdg"><code>        <span class="code-comment">// Get potential sizes</span>
</code></td></tr><tr><td id="L2443" class="css-a4x74f"><span>2443</span></td><td id="LC2443" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> size = controls.getMenuSize.call(<span class="code-keyword">this</span>, target);
</code></td></tr><tr><td id="L2444" class="css-a4x74f"><span>2444</span></td><td id="LC2444" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2445" class="css-a4x74f"><span>2445</span></td><td id="LC2445" class="css-1dcdqdg"><code>        <span class="code-comment">// Restore auto height/width</span>
</code></td></tr><tr><td id="L2446" class="css-a4x74f"><span>2446</span></td><td id="LC2446" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> restore = <span class="code-function"><span class="code-params">event</span> =&gt;</span> {
</code></td></tr><tr><td id="L2447" class="css-a4x74f"><span>2447</span></td><td id="LC2447" class="css-1dcdqdg"><code>          <span class="code-comment">// We're only bothered about height and width on the container</span>
</code></td></tr><tr><td id="L2448" class="css-a4x74f"><span>2448</span></td><td id="LC2448" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.target !== container || ![<span class="code-string">'width'</span>, <span class="code-string">'height'</span>].includes(event.propertyName)) {
</code></td></tr><tr><td id="L2449" class="css-a4x74f"><span>2449</span></td><td id="LC2449" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2450" class="css-a4x74f"><span>2450</span></td><td id="LC2450" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2451" class="css-a4x74f"><span>2451</span></td><td id="LC2451" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2452" class="css-a4x74f"><span>2452</span></td><td id="LC2452" class="css-1dcdqdg"><code>          <span class="code-comment">// Revert back to auto</span>
</code></td></tr><tr><td id="L2453" class="css-a4x74f"><span>2453</span></td><td id="LC2453" class="css-1dcdqdg"><code>          container.style.width = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L2454" class="css-a4x74f"><span>2454</span></td><td id="LC2454" class="css-1dcdqdg"><code>          container.style.height = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L2455" class="css-a4x74f"><span>2455</span></td><td id="LC2455" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2456" class="css-a4x74f"><span>2456</span></td><td id="LC2456" class="css-1dcdqdg"><code>          <span class="code-comment">// Only listen once</span>
</code></td></tr><tr><td id="L2457" class="css-a4x74f"><span>2457</span></td><td id="LC2457" class="css-1dcdqdg"><code>          off.call(<span class="code-keyword">this</span>, container, transitionEndEvent, restore);
</code></td></tr><tr><td id="L2458" class="css-a4x74f"><span>2458</span></td><td id="LC2458" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L2459" class="css-a4x74f"><span>2459</span></td><td id="LC2459" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2460" class="css-a4x74f"><span>2460</span></td><td id="LC2460" class="css-1dcdqdg"><code>        <span class="code-comment">// Listen for the transition finishing and restore auto height/width</span>
</code></td></tr><tr><td id="L2461" class="css-a4x74f"><span>2461</span></td><td id="LC2461" class="css-1dcdqdg"><code>        on.call(<span class="code-keyword">this</span>, container, transitionEndEvent, restore);
</code></td></tr><tr><td id="L2462" class="css-a4x74f"><span>2462</span></td><td id="LC2462" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2463" class="css-a4x74f"><span>2463</span></td><td id="LC2463" class="css-1dcdqdg"><code>        <span class="code-comment">// Set dimensions to target</span>
</code></td></tr><tr><td id="L2464" class="css-a4x74f"><span>2464</span></td><td id="LC2464" class="css-1dcdqdg"><code>        container.style.width = <span class="code-string">`<span class="code-subst">${size.width}</span>px`</span>;
</code></td></tr><tr><td id="L2465" class="css-a4x74f"><span>2465</span></td><td id="LC2465" class="css-1dcdqdg"><code>        container.style.height = <span class="code-string">`<span class="code-subst">${size.height}</span>px`</span>;
</code></td></tr><tr><td id="L2466" class="css-a4x74f"><span>2466</span></td><td id="LC2466" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2467" class="css-a4x74f"><span>2467</span></td><td id="LC2467" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2468" class="css-a4x74f"><span>2468</span></td><td id="LC2468" class="css-1dcdqdg"><code>      <span class="code-comment">// Set attributes on current tab</span>
</code></td></tr><tr><td id="L2469" class="css-a4x74f"><span>2469</span></td><td id="LC2469" class="css-1dcdqdg"><code>      toggleHidden(current, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2470" class="css-a4x74f"><span>2470</span></td><td id="LC2470" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2471" class="css-a4x74f"><span>2471</span></td><td id="LC2471" class="css-1dcdqdg"><code>      <span class="code-comment">// Set attributes on target</span>
</code></td></tr><tr><td id="L2472" class="css-a4x74f"><span>2472</span></td><td id="LC2472" class="css-1dcdqdg"><code>      toggleHidden(target, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2473" class="css-a4x74f"><span>2473</span></td><td id="LC2473" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2474" class="css-a4x74f"><span>2474</span></td><td id="LC2474" class="css-1dcdqdg"><code>      <span class="code-comment">// Focus the first item</span>
</code></td></tr><tr><td id="L2475" class="css-a4x74f"><span>2475</span></td><td id="LC2475" class="css-1dcdqdg"><code>      controls.focusFirstMenuItem.call(<span class="code-keyword">this</span>, target, focusVisible);
</code></td></tr><tr><td id="L2476" class="css-a4x74f"><span>2476</span></td><td id="LC2476" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2477" class="css-a4x74f"><span>2477</span></td><td id="LC2477" class="css-1dcdqdg"><code>    <span class="code-comment">// Set the download URL</span>
</code></td></tr><tr><td id="L2478" class="css-a4x74f"><span>2478</span></td><td id="LC2478" class="css-1dcdqdg"><code>    setDownloadUrl() {
</code></td></tr><tr><td id="L2479" class="css-a4x74f"><span>2479</span></td><td id="LC2479" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> button = <span class="code-keyword">this</span>.elements.buttons.download;
</code></td></tr><tr><td id="L2480" class="css-a4x74f"><span>2480</span></td><td id="LC2480" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2481" class="css-a4x74f"><span>2481</span></td><td id="LC2481" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if no button</span>
</code></td></tr><tr><td id="L2482" class="css-a4x74f"><span>2482</span></td><td id="LC2482" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(button)) {
</code></td></tr><tr><td id="L2483" class="css-a4x74f"><span>2483</span></td><td id="LC2483" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2484" class="css-a4x74f"><span>2484</span></td><td id="LC2484" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2485" class="css-a4x74f"><span>2485</span></td><td id="LC2485" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2486" class="css-a4x74f"><span>2486</span></td><td id="LC2486" class="css-1dcdqdg"><code>      <span class="code-comment">// Set attribute</span>
</code></td></tr><tr><td id="L2487" class="css-a4x74f"><span>2487</span></td><td id="LC2487" class="css-1dcdqdg"><code>      button.setAttribute(<span class="code-string">'href'</span>, <span class="code-keyword">this</span>.download);
</code></td></tr><tr><td id="L2488" class="css-a4x74f"><span>2488</span></td><td id="LC2488" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2489" class="css-a4x74f"><span>2489</span></td><td id="LC2489" class="css-1dcdqdg"><code>    <span class="code-comment">// Build the default HTML</span>
</code></td></tr><tr><td id="L2490" class="css-a4x74f"><span>2490</span></td><td id="LC2490" class="css-1dcdqdg"><code>    create(data) {
</code></td></tr><tr><td id="L2491" class="css-a4x74f"><span>2491</span></td><td id="LC2491" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2492" class="css-a4x74f"><span>2492</span></td><td id="LC2492" class="css-1dcdqdg"><code>        bindMenuItemShortcuts,
</code></td></tr><tr><td id="L2493" class="css-a4x74f"><span>2493</span></td><td id="LC2493" class="css-1dcdqdg"><code>        createButton,
</code></td></tr><tr><td id="L2494" class="css-a4x74f"><span>2494</span></td><td id="LC2494" class="css-1dcdqdg"><code>        createProgress,
</code></td></tr><tr><td id="L2495" class="css-a4x74f"><span>2495</span></td><td id="LC2495" class="css-1dcdqdg"><code>        createRange,
</code></td></tr><tr><td id="L2496" class="css-a4x74f"><span>2496</span></td><td id="LC2496" class="css-1dcdqdg"><code>        createTime,
</code></td></tr><tr><td id="L2497" class="css-a4x74f"><span>2497</span></td><td id="LC2497" class="css-1dcdqdg"><code>        setQualityMenu,
</code></td></tr><tr><td id="L2498" class="css-a4x74f"><span>2498</span></td><td id="LC2498" class="css-1dcdqdg"><code>        setSpeedMenu,
</code></td></tr><tr><td id="L2499" class="css-a4x74f"><span>2499</span></td><td id="LC2499" class="css-1dcdqdg"><code>        showMenuPanel
</code></td></tr><tr><td id="L2500" class="css-a4x74f"><span>2500</span></td><td id="LC2500" class="css-1dcdqdg"><code>      } = controls;
</code></td></tr><tr><td id="L2501" class="css-a4x74f"><span>2501</span></td><td id="LC2501" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.controls = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2502" class="css-a4x74f"><span>2502</span></td><td id="LC2502" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2503" class="css-a4x74f"><span>2503</span></td><td id="LC2503" class="css-1dcdqdg"><code>      <span class="code-comment">// Larger overlaid play button</span>
</code></td></tr><tr><td id="L2504" class="css-a4x74f"><span>2504</span></td><td id="LC2504" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.array(<span class="code-keyword">this</span>.config.controls) &amp;&amp; <span class="code-keyword">this</span>.config.controls.includes(<span class="code-string">'play-large'</span>)) {
</code></td></tr><tr><td id="L2505" class="css-a4x74f"><span>2505</span></td><td id="LC2505" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'play-large'</span>));
</code></td></tr><tr><td id="L2506" class="css-a4x74f"><span>2506</span></td><td id="LC2506" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2507" class="css-a4x74f"><span>2507</span></td><td id="LC2507" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2508" class="css-a4x74f"><span>2508</span></td><td id="LC2508" class="css-1dcdqdg"><code>      <span class="code-comment">// Create the container</span>
</code></td></tr><tr><td id="L2509" class="css-a4x74f"><span>2509</span></td><td id="LC2509" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> container = createElement(<span class="code-string">'div'</span>, getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.controls.wrapper));
</code></td></tr><tr><td id="L2510" class="css-a4x74f"><span>2510</span></td><td id="LC2510" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.controls = container;
</code></td></tr><tr><td id="L2511" class="css-a4x74f"><span>2511</span></td><td id="LC2511" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2512" class="css-a4x74f"><span>2512</span></td><td id="LC2512" class="css-1dcdqdg"><code>      <span class="code-comment">// Default item attributes</span>
</code></td></tr><tr><td id="L2513" class="css-a4x74f"><span>2513</span></td><td id="LC2513" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> defaultAttributes = {
</code></td></tr><tr><td id="L2514" class="css-a4x74f"><span>2514</span></td><td id="LC2514" class="css-1dcdqdg"><code>        class: 'plyr__controls__item'
</code></td></tr><tr><td id="L2515" class="css-a4x74f"><span>2515</span></td><td id="LC2515" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2516" class="css-a4x74f"><span>2516</span></td><td id="LC2516" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2517" class="css-a4x74f"><span>2517</span></td><td id="LC2517" class="css-1dcdqdg"><code>      <span class="code-comment">// Loop through controls in order</span>
</code></td></tr><tr><td id="L2518" class="css-a4x74f"><span>2518</span></td><td id="LC2518" class="css-1dcdqdg"><code>      dedupe(is.array(<span class="code-keyword">this</span>.config.controls) ? <span class="code-keyword">this</span>.config.controls : []).forEach(<span class="code-function"><span class="code-params">control</span> =&gt;</span> {
</code></td></tr><tr><td id="L2519" class="css-a4x74f"><span>2519</span></td><td id="LC2519" class="css-1dcdqdg"><code>        <span class="code-comment">// Restart button</span>
</code></td></tr><tr><td id="L2520" class="css-a4x74f"><span>2520</span></td><td id="LC2520" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'restart'</span>) {
</code></td></tr><tr><td id="L2521" class="css-a4x74f"><span>2521</span></td><td id="LC2521" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'restart'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2522" class="css-a4x74f"><span>2522</span></td><td id="LC2522" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2523" class="css-a4x74f"><span>2523</span></td><td id="LC2523" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2524" class="css-a4x74f"><span>2524</span></td><td id="LC2524" class="css-1dcdqdg"><code>        <span class="code-comment">// Rewind button</span>
</code></td></tr><tr><td id="L2525" class="css-a4x74f"><span>2525</span></td><td id="LC2525" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'rewind'</span>) {
</code></td></tr><tr><td id="L2526" class="css-a4x74f"><span>2526</span></td><td id="LC2526" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'rewind'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2527" class="css-a4x74f"><span>2527</span></td><td id="LC2527" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2528" class="css-a4x74f"><span>2528</span></td><td id="LC2528" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2529" class="css-a4x74f"><span>2529</span></td><td id="LC2529" class="css-1dcdqdg"><code>        <span class="code-comment">// Play/Pause button</span>
</code></td></tr><tr><td id="L2530" class="css-a4x74f"><span>2530</span></td><td id="LC2530" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'play'</span>) {
</code></td></tr><tr><td id="L2531" class="css-a4x74f"><span>2531</span></td><td id="LC2531" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'play'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2532" class="css-a4x74f"><span>2532</span></td><td id="LC2532" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2533" class="css-a4x74f"><span>2533</span></td><td id="LC2533" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2534" class="css-a4x74f"><span>2534</span></td><td id="LC2534" class="css-1dcdqdg"><code>        <span class="code-comment">// Fast forward button</span>
</code></td></tr><tr><td id="L2535" class="css-a4x74f"><span>2535</span></td><td id="LC2535" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'fast-forward'</span>) {
</code></td></tr><tr><td id="L2536" class="css-a4x74f"><span>2536</span></td><td id="LC2536" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'fast-forward'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2537" class="css-a4x74f"><span>2537</span></td><td id="LC2537" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2538" class="css-a4x74f"><span>2538</span></td><td id="LC2538" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2539" class="css-a4x74f"><span>2539</span></td><td id="LC2539" class="css-1dcdqdg"><code>        <span class="code-comment">// Progress</span>
</code></td></tr><tr><td id="L2540" class="css-a4x74f"><span>2540</span></td><td id="LC2540" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'progress'</span>) {
</code></td></tr><tr><td id="L2541" class="css-a4x74f"><span>2541</span></td><td id="LC2541" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> progressContainer = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2542" class="css-a4x74f"><span>2542</span></td><td id="LC2542" class="css-1dcdqdg"><code>            class: `${defaultAttributes.class} plyr__progress__container`
</code></td></tr><tr><td id="L2543" class="css-a4x74f"><span>2543</span></td><td id="LC2543" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2544" class="css-a4x74f"><span>2544</span></td><td id="LC2544" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> progress = createElement(<span class="code-string">'div'</span>, getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.progress));
</code></td></tr><tr><td id="L2545" class="css-a4x74f"><span>2545</span></td><td id="LC2545" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2546" class="css-a4x74f"><span>2546</span></td><td id="LC2546" class="css-1dcdqdg"><code>          <span class="code-comment">// Seek range slider</span>
</code></td></tr><tr><td id="L2547" class="css-a4x74f"><span>2547</span></td><td id="LC2547" class="css-1dcdqdg"><code>          progress.appendChild(createRange.call(<span class="code-keyword">this</span>, <span class="code-string">'seek'</span>, {
</code></td></tr><tr><td id="L2548" class="css-a4x74f"><span>2548</span></td><td id="LC2548" class="css-1dcdqdg"><code>            id: <span class="code-string">`plyr-seek-<span class="code-subst">${data.id}</span>`</span>
</code></td></tr><tr><td id="L2549" class="css-a4x74f"><span>2549</span></td><td id="LC2549" class="css-1dcdqdg"><code>          }));
</code></td></tr><tr><td id="L2550" class="css-a4x74f"><span>2550</span></td><td id="LC2550" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2551" class="css-a4x74f"><span>2551</span></td><td id="LC2551" class="css-1dcdqdg"><code>          <span class="code-comment">// Buffer progress</span>
</code></td></tr><tr><td id="L2552" class="css-a4x74f"><span>2552</span></td><td id="LC2552" class="css-1dcdqdg"><code>          progress.appendChild(createProgress.call(<span class="code-keyword">this</span>, <span class="code-string">'buffer'</span>));
</code></td></tr><tr><td id="L2553" class="css-a4x74f"><span>2553</span></td><td id="LC2553" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2554" class="css-a4x74f"><span>2554</span></td><td id="LC2554" class="css-1dcdqdg"><code>          <span class="code-comment">// <span class="code-doctag">TODO:</span> Add loop display indicator</span>
</code></td></tr><tr><td id="L2555" class="css-a4x74f"><span>2555</span></td><td id="LC2555" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2556" class="css-a4x74f"><span>2556</span></td><td id="LC2556" class="css-1dcdqdg"><code>          <span class="code-comment">// Seek tooltip</span>
</code></td></tr><tr><td id="L2557" class="css-a4x74f"><span>2557</span></td><td id="LC2557" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.tooltips.seek) {
</code></td></tr><tr><td id="L2558" class="css-a4x74f"><span>2558</span></td><td id="LC2558" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> tooltip = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2559" class="css-a4x74f"><span>2559</span></td><td id="LC2559" class="css-1dcdqdg"><code>              class: this.config.classNames.tooltip
</code></td></tr><tr><td id="L2560" class="css-a4x74f"><span>2560</span></td><td id="LC2560" class="css-1dcdqdg"><code>            }, <span class="code-string">'00:00'</span>);
</code></td></tr><tr><td id="L2561" class="css-a4x74f"><span>2561</span></td><td id="LC2561" class="css-1dcdqdg"><code>            progress.appendChild(tooltip);
</code></td></tr><tr><td id="L2562" class="css-a4x74f"><span>2562</span></td><td id="LC2562" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.display.seekTooltip = tooltip;
</code></td></tr><tr><td id="L2563" class="css-a4x74f"><span>2563</span></td><td id="LC2563" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2564" class="css-a4x74f"><span>2564</span></td><td id="LC2564" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.progress = progress;
</code></td></tr><tr><td id="L2565" class="css-a4x74f"><span>2565</span></td><td id="LC2565" class="css-1dcdqdg"><code>          progressContainer.appendChild(<span class="code-keyword">this</span>.elements.progress);
</code></td></tr><tr><td id="L2566" class="css-a4x74f"><span>2566</span></td><td id="LC2566" class="css-1dcdqdg"><code>          container.appendChild(progressContainer);
</code></td></tr><tr><td id="L2567" class="css-a4x74f"><span>2567</span></td><td id="LC2567" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2568" class="css-a4x74f"><span>2568</span></td><td id="LC2568" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2569" class="css-a4x74f"><span>2569</span></td><td id="LC2569" class="css-1dcdqdg"><code>        <span class="code-comment">// Media current time display</span>
</code></td></tr><tr><td id="L2570" class="css-a4x74f"><span>2570</span></td><td id="LC2570" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'current-time'</span>) {
</code></td></tr><tr><td id="L2571" class="css-a4x74f"><span>2571</span></td><td id="LC2571" class="css-1dcdqdg"><code>          container.appendChild(createTime.call(<span class="code-keyword">this</span>, <span class="code-string">'currentTime'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2572" class="css-a4x74f"><span>2572</span></td><td id="LC2572" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2573" class="css-a4x74f"><span>2573</span></td><td id="LC2573" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2574" class="css-a4x74f"><span>2574</span></td><td id="LC2574" class="css-1dcdqdg"><code>        <span class="code-comment">// Media duration display</span>
</code></td></tr><tr><td id="L2575" class="css-a4x74f"><span>2575</span></td><td id="LC2575" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'duration'</span>) {
</code></td></tr><tr><td id="L2576" class="css-a4x74f"><span>2576</span></td><td id="LC2576" class="css-1dcdqdg"><code>          container.appendChild(createTime.call(<span class="code-keyword">this</span>, <span class="code-string">'duration'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2577" class="css-a4x74f"><span>2577</span></td><td id="LC2577" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2578" class="css-a4x74f"><span>2578</span></td><td id="LC2578" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2579" class="css-a4x74f"><span>2579</span></td><td id="LC2579" class="css-1dcdqdg"><code>        <span class="code-comment">// Volume controls</span>
</code></td></tr><tr><td id="L2580" class="css-a4x74f"><span>2580</span></td><td id="LC2580" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'mute'</span> || control === <span class="code-string">'volume'</span>) {
</code></td></tr><tr><td id="L2581" class="css-a4x74f"><span>2581</span></td><td id="LC2581" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L2582" class="css-a4x74f"><span>2582</span></td><td id="LC2582" class="css-1dcdqdg"><code>            volume
</code></td></tr><tr><td id="L2583" class="css-a4x74f"><span>2583</span></td><td id="LC2583" class="css-1dcdqdg"><code>          } = <span class="code-keyword">this</span>.elements;
</code></td></tr><tr><td id="L2584" class="css-a4x74f"><span>2584</span></td><td id="LC2584" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2585" class="css-a4x74f"><span>2585</span></td><td id="LC2585" class="css-1dcdqdg"><code>          <span class="code-comment">// Create the volume container if needed</span>
</code></td></tr><tr><td id="L2586" class="css-a4x74f"><span>2586</span></td><td id="LC2586" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!is.element(volume) || !container.contains(volume)) {
</code></td></tr><tr><td id="L2587" class="css-a4x74f"><span>2587</span></td><td id="LC2587" class="css-1dcdqdg"><code>            volume = createElement(<span class="code-string">'div'</span>, extend({}, defaultAttributes, {
</code></td></tr><tr><td id="L2588" class="css-a4x74f"><span>2588</span></td><td id="LC2588" class="css-1dcdqdg"><code>              class: `${defaultAttributes.class} plyr__volume`.trim()
</code></td></tr><tr><td id="L2589" class="css-a4x74f"><span>2589</span></td><td id="LC2589" class="css-1dcdqdg"><code>            }));
</code></td></tr><tr><td id="L2590" class="css-a4x74f"><span>2590</span></td><td id="LC2590" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.volume = volume;
</code></td></tr><tr><td id="L2591" class="css-a4x74f"><span>2591</span></td><td id="LC2591" class="css-1dcdqdg"><code>            container.appendChild(volume);
</code></td></tr><tr><td id="L2592" class="css-a4x74f"><span>2592</span></td><td id="LC2592" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2593" class="css-a4x74f"><span>2593</span></td><td id="LC2593" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2594" class="css-a4x74f"><span>2594</span></td><td id="LC2594" class="css-1dcdqdg"><code>          <span class="code-comment">// Toggle mute button</span>
</code></td></tr><tr><td id="L2595" class="css-a4x74f"><span>2595</span></td><td id="LC2595" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (control === <span class="code-string">'mute'</span>) {
</code></td></tr><tr><td id="L2596" class="css-a4x74f"><span>2596</span></td><td id="LC2596" class="css-1dcdqdg"><code>            volume.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'mute'</span>));
</code></td></tr><tr><td id="L2597" class="css-a4x74f"><span>2597</span></td><td id="LC2597" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2598" class="css-a4x74f"><span>2598</span></td><td id="LC2598" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2599" class="css-a4x74f"><span>2599</span></td><td id="LC2599" class="css-1dcdqdg"><code>          <span class="code-comment">// Volume range control</span>
</code></td></tr><tr><td id="L2600" class="css-a4x74f"><span>2600</span></td><td id="LC2600" class="css-1dcdqdg"><code>          <span class="code-comment">// Ignored on iOS as it's handled globally</span>
</code></td></tr><tr><td id="L2601" class="css-a4x74f"><span>2601</span></td><td id="LC2601" class="css-1dcdqdg"><code>          <span class="code-comment">// https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html</span>
</code></td></tr><tr><td id="L2602" class="css-a4x74f"><span>2602</span></td><td id="LC2602" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (control === <span class="code-string">'volume'</span> &amp;&amp; !browser.isIos &amp;&amp; !browser.isIPadOS) {
</code></td></tr><tr><td id="L2603" class="css-a4x74f"><span>2603</span></td><td id="LC2603" class="css-1dcdqdg"><code>            <span class="code-comment">// Set the attributes</span>
</code></td></tr><tr><td id="L2604" class="css-a4x74f"><span>2604</span></td><td id="LC2604" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> attributes = {
</code></td></tr><tr><td id="L2605" class="css-a4x74f"><span>2605</span></td><td id="LC2605" class="css-1dcdqdg"><code>              max: <span class="code-number">1</span>,
</code></td></tr><tr><td id="L2606" class="css-a4x74f"><span>2606</span></td><td id="LC2606" class="css-1dcdqdg"><code>              step: <span class="code-number">0.05</span>,
</code></td></tr><tr><td id="L2607" class="css-a4x74f"><span>2607</span></td><td id="LC2607" class="css-1dcdqdg"><code>              value: <span class="code-keyword">this</span>.config.volume
</code></td></tr><tr><td id="L2608" class="css-a4x74f"><span>2608</span></td><td id="LC2608" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L2609" class="css-a4x74f"><span>2609</span></td><td id="LC2609" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2610" class="css-a4x74f"><span>2610</span></td><td id="LC2610" class="css-1dcdqdg"><code>            <span class="code-comment">// Create the volume range slider</span>
</code></td></tr><tr><td id="L2611" class="css-a4x74f"><span>2611</span></td><td id="LC2611" class="css-1dcdqdg"><code>            volume.appendChild(createRange.call(<span class="code-keyword">this</span>, <span class="code-string">'volume'</span>, extend(attributes, {
</code></td></tr><tr><td id="L2612" class="css-a4x74f"><span>2612</span></td><td id="LC2612" class="css-1dcdqdg"><code>              id: <span class="code-string">`plyr-volume-<span class="code-subst">${data.id}</span>`</span>
</code></td></tr><tr><td id="L2613" class="css-a4x74f"><span>2613</span></td><td id="LC2613" class="css-1dcdqdg"><code>            })));
</code></td></tr><tr><td id="L2614" class="css-a4x74f"><span>2614</span></td><td id="LC2614" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2615" class="css-a4x74f"><span>2615</span></td><td id="LC2615" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2616" class="css-a4x74f"><span>2616</span></td><td id="LC2616" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2617" class="css-a4x74f"><span>2617</span></td><td id="LC2617" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle captions button</span>
</code></td></tr><tr><td id="L2618" class="css-a4x74f"><span>2618</span></td><td id="LC2618" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'captions'</span>) {
</code></td></tr><tr><td id="L2619" class="css-a4x74f"><span>2619</span></td><td id="LC2619" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'captions'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2620" class="css-a4x74f"><span>2620</span></td><td id="LC2620" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2621" class="css-a4x74f"><span>2621</span></td><td id="LC2621" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2622" class="css-a4x74f"><span>2622</span></td><td id="LC2622" class="css-1dcdqdg"><code>        <span class="code-comment">// Settings button / menu</span>
</code></td></tr><tr><td id="L2623" class="css-a4x74f"><span>2623</span></td><td id="LC2623" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'settings'</span> &amp;&amp; !is.empty(<span class="code-keyword">this</span>.config.settings)) {
</code></td></tr><tr><td id="L2624" class="css-a4x74f"><span>2624</span></td><td id="LC2624" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> wrapper = createElement(<span class="code-string">'div'</span>, extend({}, defaultAttributes, {
</code></td></tr><tr><td id="L2625" class="css-a4x74f"><span>2625</span></td><td id="LC2625" class="css-1dcdqdg"><code>            class: `${defaultAttributes.class} plyr__menu`.trim(),
</code></td></tr><tr><td id="L2626" class="css-a4x74f"><span>2626</span></td><td id="LC2626" class="css-1dcdqdg"><code>            hidden: <span class="code-string">''</span>
</code></td></tr><tr><td id="L2627" class="css-a4x74f"><span>2627</span></td><td id="LC2627" class="css-1dcdqdg"><code>          }));
</code></td></tr><tr><td id="L2628" class="css-a4x74f"><span>2628</span></td><td id="LC2628" class="css-1dcdqdg"><code>          wrapper.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'settings'</span>, {
</code></td></tr><tr><td id="L2629" class="css-a4x74f"><span>2629</span></td><td id="LC2629" class="css-1dcdqdg"><code>            <span class="code-string">'aria-haspopup'</span>: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L2630" class="css-a4x74f"><span>2630</span></td><td id="LC2630" class="css-1dcdqdg"><code>            <span class="code-string">'aria-controls'</span>: <span class="code-string">`plyr-settings-<span class="code-subst">${data.id}</span>`</span>,
</code></td></tr><tr><td id="L2631" class="css-a4x74f"><span>2631</span></td><td id="LC2631" class="css-1dcdqdg"><code>            <span class="code-string">'aria-expanded'</span>: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L2632" class="css-a4x74f"><span>2632</span></td><td id="LC2632" class="css-1dcdqdg"><code>          }));
</code></td></tr><tr><td id="L2633" class="css-a4x74f"><span>2633</span></td><td id="LC2633" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> popup = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2634" class="css-a4x74f"><span>2634</span></td><td id="LC2634" class="css-1dcdqdg"><code>            class: 'plyr__menu__container',
</code></td></tr><tr><td id="L2635" class="css-a4x74f"><span>2635</span></td><td id="LC2635" class="css-1dcdqdg"><code>            id: <span class="code-string">`plyr-settings-<span class="code-subst">${data.id}</span>`</span>,
</code></td></tr><tr><td id="L2636" class="css-a4x74f"><span>2636</span></td><td id="LC2636" class="css-1dcdqdg"><code>            hidden: <span class="code-string">''</span>
</code></td></tr><tr><td id="L2637" class="css-a4x74f"><span>2637</span></td><td id="LC2637" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2638" class="css-a4x74f"><span>2638</span></td><td id="LC2638" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> inner = createElement(<span class="code-string">'div'</span>);
</code></td></tr><tr><td id="L2639" class="css-a4x74f"><span>2639</span></td><td id="LC2639" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> home = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2640" class="css-a4x74f"><span>2640</span></td><td id="LC2640" class="css-1dcdqdg"><code>            id: <span class="code-string">`plyr-settings-<span class="code-subst">${data.id}</span>-home`</span>
</code></td></tr><tr><td id="L2641" class="css-a4x74f"><span>2641</span></td><td id="LC2641" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2642" class="css-a4x74f"><span>2642</span></td><td id="LC2642" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2643" class="css-a4x74f"><span>2643</span></td><td id="LC2643" class="css-1dcdqdg"><code>          <span class="code-comment">// Create the menu</span>
</code></td></tr><tr><td id="L2644" class="css-a4x74f"><span>2644</span></td><td id="LC2644" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> menu = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2645" class="css-a4x74f"><span>2645</span></td><td id="LC2645" class="css-1dcdqdg"><code>            role: <span class="code-string">'menu'</span>
</code></td></tr><tr><td id="L2646" class="css-a4x74f"><span>2646</span></td><td id="LC2646" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2647" class="css-a4x74f"><span>2647</span></td><td id="LC2647" class="css-1dcdqdg"><code>          home.appendChild(menu);
</code></td></tr><tr><td id="L2648" class="css-a4x74f"><span>2648</span></td><td id="LC2648" class="css-1dcdqdg"><code>          inner.appendChild(home);
</code></td></tr><tr><td id="L2649" class="css-a4x74f"><span>2649</span></td><td id="LC2649" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.settings.panels.home = home;
</code></td></tr><tr><td id="L2650" class="css-a4x74f"><span>2650</span></td><td id="LC2650" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2651" class="css-a4x74f"><span>2651</span></td><td id="LC2651" class="css-1dcdqdg"><code>          <span class="code-comment">// Build the menu items</span>
</code></td></tr><tr><td id="L2652" class="css-a4x74f"><span>2652</span></td><td id="LC2652" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.config.settings.forEach(<span class="code-function"><span class="code-params">type</span> =&gt;</span> {
</code></td></tr><tr><td id="L2653" class="css-a4x74f"><span>2653</span></td><td id="LC2653" class="css-1dcdqdg"><code>            <span class="code-comment">// <span class="code-doctag">TODO:</span> bundle this with the createMenuItem helper and bindings</span>
</code></td></tr><tr><td id="L2654" class="css-a4x74f"><span>2654</span></td><td id="LC2654" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> menuItem = createElement(<span class="code-string">'button'</span>, extend(getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.buttons.settings), {
</code></td></tr><tr><td id="L2655" class="css-a4x74f"><span>2655</span></td><td id="LC2655" class="css-1dcdqdg"><code>              type: <span class="code-string">'button'</span>,
</code></td></tr><tr><td id="L2656" class="css-a4x74f"><span>2656</span></td><td id="LC2656" class="css-1dcdqdg"><code>              class: `${this.config.classNames.control} ${this.config.classNames.control}--forward`,
</code></td></tr><tr><td id="L2657" class="css-a4x74f"><span>2657</span></td><td id="LC2657" class="css-1dcdqdg"><code>              role: <span class="code-string">'menuitem'</span>,
</code></td></tr><tr><td id="L2658" class="css-a4x74f"><span>2658</span></td><td id="LC2658" class="css-1dcdqdg"><code>              <span class="code-string">'aria-haspopup'</span>: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L2659" class="css-a4x74f"><span>2659</span></td><td id="LC2659" class="css-1dcdqdg"><code>              hidden: <span class="code-string">''</span>
</code></td></tr><tr><td id="L2660" class="css-a4x74f"><span>2660</span></td><td id="LC2660" class="css-1dcdqdg"><code>            }));
</code></td></tr><tr><td id="L2661" class="css-a4x74f"><span>2661</span></td><td id="LC2661" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2662" class="css-a4x74f"><span>2662</span></td><td id="LC2662" class="css-1dcdqdg"><code>            <span class="code-comment">// Bind menu shortcuts for keyboard users</span>
</code></td></tr><tr><td id="L2663" class="css-a4x74f"><span>2663</span></td><td id="LC2663" class="css-1dcdqdg"><code>            bindMenuItemShortcuts.call(<span class="code-keyword">this</span>, menuItem, type);
</code></td></tr><tr><td id="L2664" class="css-a4x74f"><span>2664</span></td><td id="LC2664" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2665" class="css-a4x74f"><span>2665</span></td><td id="LC2665" class="css-1dcdqdg"><code>            <span class="code-comment">// Show menu on click</span>
</code></td></tr><tr><td id="L2666" class="css-a4x74f"><span>2666</span></td><td id="LC2666" class="css-1dcdqdg"><code>            on.call(<span class="code-keyword">this</span>, menuItem, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L2667" class="css-a4x74f"><span>2667</span></td><td id="LC2667" class="css-1dcdqdg"><code>              showMenuPanel.call(<span class="code-keyword">this</span>, type, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2668" class="css-a4x74f"><span>2668</span></td><td id="LC2668" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2669" class="css-a4x74f"><span>2669</span></td><td id="LC2669" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> flex = createElement(<span class="code-string">'span'</span>, <span class="code-literal">null</span>, i18n.get(type, <span class="code-keyword">this</span>.config));
</code></td></tr><tr><td id="L2670" class="css-a4x74f"><span>2670</span></td><td id="LC2670" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> value = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2671" class="css-a4x74f"><span>2671</span></td><td id="LC2671" class="css-1dcdqdg"><code>              class: this.config.classNames.menu.value
</code></td></tr><tr><td id="L2672" class="css-a4x74f"><span>2672</span></td><td id="LC2672" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2673" class="css-a4x74f"><span>2673</span></td><td id="LC2673" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2674" class="css-a4x74f"><span>2674</span></td><td id="LC2674" class="css-1dcdqdg"><code>            <span class="code-comment">// Speed contains HTML entities</span>
</code></td></tr><tr><td id="L2675" class="css-a4x74f"><span>2675</span></td><td id="LC2675" class="css-1dcdqdg"><code>            value.innerHTML = data[type];
</code></td></tr><tr><td id="L2676" class="css-a4x74f"><span>2676</span></td><td id="LC2676" class="css-1dcdqdg"><code>            flex.appendChild(value);
</code></td></tr><tr><td id="L2677" class="css-a4x74f"><span>2677</span></td><td id="LC2677" class="css-1dcdqdg"><code>            menuItem.appendChild(flex);
</code></td></tr><tr><td id="L2678" class="css-a4x74f"><span>2678</span></td><td id="LC2678" class="css-1dcdqdg"><code>            menu.appendChild(menuItem);
</code></td></tr><tr><td id="L2679" class="css-a4x74f"><span>2679</span></td><td id="LC2679" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2680" class="css-a4x74f"><span>2680</span></td><td id="LC2680" class="css-1dcdqdg"><code>            <span class="code-comment">// Build the panes</span>
</code></td></tr><tr><td id="L2681" class="css-a4x74f"><span>2681</span></td><td id="LC2681" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> pane = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2682" class="css-a4x74f"><span>2682</span></td><td id="LC2682" class="css-1dcdqdg"><code>              id: <span class="code-string">`plyr-settings-<span class="code-subst">${data.id}</span>-<span class="code-subst">${type}</span>`</span>,
</code></td></tr><tr><td id="L2683" class="css-a4x74f"><span>2683</span></td><td id="LC2683" class="css-1dcdqdg"><code>              hidden: <span class="code-string">''</span>
</code></td></tr><tr><td id="L2684" class="css-a4x74f"><span>2684</span></td><td id="LC2684" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2685" class="css-a4x74f"><span>2685</span></td><td id="LC2685" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2686" class="css-a4x74f"><span>2686</span></td><td id="LC2686" class="css-1dcdqdg"><code>            <span class="code-comment">// Back button</span>
</code></td></tr><tr><td id="L2687" class="css-a4x74f"><span>2687</span></td><td id="LC2687" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> backButton = createElement(<span class="code-string">'button'</span>, {
</code></td></tr><tr><td id="L2688" class="css-a4x74f"><span>2688</span></td><td id="LC2688" class="css-1dcdqdg"><code>              type: <span class="code-string">'button'</span>,
</code></td></tr><tr><td id="L2689" class="css-a4x74f"><span>2689</span></td><td id="LC2689" class="css-1dcdqdg"><code>              class: `${this.config.classNames.control} ${this.config.classNames.control}--back`
</code></td></tr><tr><td id="L2690" class="css-a4x74f"><span>2690</span></td><td id="LC2690" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2691" class="css-a4x74f"><span>2691</span></td><td id="LC2691" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2692" class="css-a4x74f"><span>2692</span></td><td id="LC2692" class="css-1dcdqdg"><code>            <span class="code-comment">// Visible label</span>
</code></td></tr><tr><td id="L2693" class="css-a4x74f"><span>2693</span></td><td id="LC2693" class="css-1dcdqdg"><code>            backButton.appendChild(createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2694" class="css-a4x74f"><span>2694</span></td><td id="LC2694" class="css-1dcdqdg"><code>              <span class="code-string">'aria-hidden'</span>: <span class="code-literal">true</span>
</code></td></tr><tr><td id="L2695" class="css-a4x74f"><span>2695</span></td><td id="LC2695" class="css-1dcdqdg"><code>            }, i18n.get(type, <span class="code-keyword">this</span>.config)));
</code></td></tr><tr><td id="L2696" class="css-a4x74f"><span>2696</span></td><td id="LC2696" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2697" class="css-a4x74f"><span>2697</span></td><td id="LC2697" class="css-1dcdqdg"><code>            <span class="code-comment">// Screen reader label</span>
</code></td></tr><tr><td id="L2698" class="css-a4x74f"><span>2698</span></td><td id="LC2698" class="css-1dcdqdg"><code>            backButton.appendChild(createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2699" class="css-a4x74f"><span>2699</span></td><td id="LC2699" class="css-1dcdqdg"><code>              class: this.config.classNames.hidden
</code></td></tr><tr><td id="L2700" class="css-a4x74f"><span>2700</span></td><td id="LC2700" class="css-1dcdqdg"><code>            }, i18n.get(<span class="code-string">'menuBack'</span>, <span class="code-keyword">this</span>.config)));
</code></td></tr><tr><td id="L2701" class="css-a4x74f"><span>2701</span></td><td id="LC2701" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2702" class="css-a4x74f"><span>2702</span></td><td id="LC2702" class="css-1dcdqdg"><code>            <span class="code-comment">// Go back via keyboard</span>
</code></td></tr><tr><td id="L2703" class="css-a4x74f"><span>2703</span></td><td id="LC2703" class="css-1dcdqdg"><code>            on.call(<span class="code-keyword">this</span>, pane, <span class="code-string">'keydown'</span>, event =&gt; {
</code></td></tr><tr><td id="L2704" class="css-a4x74f"><span>2704</span></td><td id="LC2704" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (event.key !== <span class="code-string">'ArrowLeft'</span>) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2705" class="css-a4x74f"><span>2705</span></td><td id="LC2705" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2706" class="css-a4x74f"><span>2706</span></td><td id="LC2706" class="css-1dcdqdg"><code>              <span class="code-comment">// Prevent seek</span>
</code></td></tr><tr><td id="L2707" class="css-a4x74f"><span>2707</span></td><td id="LC2707" class="css-1dcdqdg"><code>              event.preventDefault();
</code></td></tr><tr><td id="L2708" class="css-a4x74f"><span>2708</span></td><td id="LC2708" class="css-1dcdqdg"><code>              event.stopPropagation();
</code></td></tr><tr><td id="L2709" class="css-a4x74f"><span>2709</span></td><td id="LC2709" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2710" class="css-a4x74f"><span>2710</span></td><td id="LC2710" class="css-1dcdqdg"><code>              <span class="code-comment">// Show the respective menu</span>
</code></td></tr><tr><td id="L2711" class="css-a4x74f"><span>2711</span></td><td id="LC2711" class="css-1dcdqdg"><code>              showMenuPanel.call(<span class="code-keyword">this</span>, <span class="code-string">'home'</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2712" class="css-a4x74f"><span>2712</span></td><td id="LC2712" class="css-1dcdqdg"><code>            }, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2713" class="css-a4x74f"><span>2713</span></td><td id="LC2713" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2714" class="css-a4x74f"><span>2714</span></td><td id="LC2714" class="css-1dcdqdg"><code>            <span class="code-comment">// Go back via button click</span>
</code></td></tr><tr><td id="L2715" class="css-a4x74f"><span>2715</span></td><td id="LC2715" class="css-1dcdqdg"><code>            on.call(<span class="code-keyword">this</span>, backButton, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L2716" class="css-a4x74f"><span>2716</span></td><td id="LC2716" class="css-1dcdqdg"><code>              showMenuPanel.call(<span class="code-keyword">this</span>, <span class="code-string">'home'</span>, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2717" class="css-a4x74f"><span>2717</span></td><td id="LC2717" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2718" class="css-a4x74f"><span>2718</span></td><td id="LC2718" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2719" class="css-a4x74f"><span>2719</span></td><td id="LC2719" class="css-1dcdqdg"><code>            <span class="code-comment">// Add to pane</span>
</code></td></tr><tr><td id="L2720" class="css-a4x74f"><span>2720</span></td><td id="LC2720" class="css-1dcdqdg"><code>            pane.appendChild(backButton);
</code></td></tr><tr><td id="L2721" class="css-a4x74f"><span>2721</span></td><td id="LC2721" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2722" class="css-a4x74f"><span>2722</span></td><td id="LC2722" class="css-1dcdqdg"><code>            <span class="code-comment">// Menu</span>
</code></td></tr><tr><td id="L2723" class="css-a4x74f"><span>2723</span></td><td id="LC2723" class="css-1dcdqdg"><code>            pane.appendChild(createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L2724" class="css-a4x74f"><span>2724</span></td><td id="LC2724" class="css-1dcdqdg"><code>              role: <span class="code-string">'menu'</span>
</code></td></tr><tr><td id="L2725" class="css-a4x74f"><span>2725</span></td><td id="LC2725" class="css-1dcdqdg"><code>            }));
</code></td></tr><tr><td id="L2726" class="css-a4x74f"><span>2726</span></td><td id="LC2726" class="css-1dcdqdg"><code>            inner.appendChild(pane);
</code></td></tr><tr><td id="L2727" class="css-a4x74f"><span>2727</span></td><td id="LC2727" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.settings.buttons[type] = menuItem;
</code></td></tr><tr><td id="L2728" class="css-a4x74f"><span>2728</span></td><td id="LC2728" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.settings.panels[type] = pane;
</code></td></tr><tr><td id="L2729" class="css-a4x74f"><span>2729</span></td><td id="LC2729" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2730" class="css-a4x74f"><span>2730</span></td><td id="LC2730" class="css-1dcdqdg"><code>          popup.appendChild(inner);
</code></td></tr><tr><td id="L2731" class="css-a4x74f"><span>2731</span></td><td id="LC2731" class="css-1dcdqdg"><code>          wrapper.appendChild(popup);
</code></td></tr><tr><td id="L2732" class="css-a4x74f"><span>2732</span></td><td id="LC2732" class="css-1dcdqdg"><code>          container.appendChild(wrapper);
</code></td></tr><tr><td id="L2733" class="css-a4x74f"><span>2733</span></td><td id="LC2733" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.settings.popup = popup;
</code></td></tr><tr><td id="L2734" class="css-a4x74f"><span>2734</span></td><td id="LC2734" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.settings.menu = wrapper;
</code></td></tr><tr><td id="L2735" class="css-a4x74f"><span>2735</span></td><td id="LC2735" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2736" class="css-a4x74f"><span>2736</span></td><td id="LC2736" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2737" class="css-a4x74f"><span>2737</span></td><td id="LC2737" class="css-1dcdqdg"><code>        <span class="code-comment">// Picture in picture button</span>
</code></td></tr><tr><td id="L2738" class="css-a4x74f"><span>2738</span></td><td id="LC2738" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'pip'</span> &amp;&amp; support.pip) {
</code></td></tr><tr><td id="L2739" class="css-a4x74f"><span>2739</span></td><td id="LC2739" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'pip'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2740" class="css-a4x74f"><span>2740</span></td><td id="LC2740" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2741" class="css-a4x74f"><span>2741</span></td><td id="LC2741" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2742" class="css-a4x74f"><span>2742</span></td><td id="LC2742" class="css-1dcdqdg"><code>        <span class="code-comment">// Airplay button</span>
</code></td></tr><tr><td id="L2743" class="css-a4x74f"><span>2743</span></td><td id="LC2743" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'airplay'</span> &amp;&amp; support.airplay) {
</code></td></tr><tr><td id="L2744" class="css-a4x74f"><span>2744</span></td><td id="LC2744" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'airplay'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2745" class="css-a4x74f"><span>2745</span></td><td id="LC2745" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2746" class="css-a4x74f"><span>2746</span></td><td id="LC2746" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2747" class="css-a4x74f"><span>2747</span></td><td id="LC2747" class="css-1dcdqdg"><code>        <span class="code-comment">// Download button</span>
</code></td></tr><tr><td id="L2748" class="css-a4x74f"><span>2748</span></td><td id="LC2748" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'download'</span>) {
</code></td></tr><tr><td id="L2749" class="css-a4x74f"><span>2749</span></td><td id="LC2749" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> attributes = extend({}, defaultAttributes, {
</code></td></tr><tr><td id="L2750" class="css-a4x74f"><span>2750</span></td><td id="LC2750" class="css-1dcdqdg"><code>            element: <span class="code-string">'a'</span>,
</code></td></tr><tr><td id="L2751" class="css-a4x74f"><span>2751</span></td><td id="LC2751" class="css-1dcdqdg"><code>            href: <span class="code-keyword">this</span>.download,
</code></td></tr><tr><td id="L2752" class="css-a4x74f"><span>2752</span></td><td id="LC2752" class="css-1dcdqdg"><code>            target: <span class="code-string">'_blank'</span>
</code></td></tr><tr><td id="L2753" class="css-a4x74f"><span>2753</span></td><td id="LC2753" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2754" class="css-a4x74f"><span>2754</span></td><td id="LC2754" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2755" class="css-a4x74f"><span>2755</span></td><td id="LC2755" class="css-1dcdqdg"><code>          <span class="code-comment">// Set download attribute for HTML5 only</span>
</code></td></tr><tr><td id="L2756" class="css-a4x74f"><span>2756</span></td><td id="LC2756" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L2757" class="css-a4x74f"><span>2757</span></td><td id="LC2757" class="css-1dcdqdg"><code>            attributes.download = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L2758" class="css-a4x74f"><span>2758</span></td><td id="LC2758" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2759" class="css-a4x74f"><span>2759</span></td><td id="LC2759" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2760" class="css-a4x74f"><span>2760</span></td><td id="LC2760" class="css-1dcdqdg"><code>            download
</code></td></tr><tr><td id="L2761" class="css-a4x74f"><span>2761</span></td><td id="LC2761" class="css-1dcdqdg"><code>          } = <span class="code-keyword">this</span>.config.urls;
</code></td></tr><tr><td id="L2762" class="css-a4x74f"><span>2762</span></td><td id="LC2762" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!is.url(download) &amp;&amp; <span class="code-keyword">this</span>.isEmbed) {
</code></td></tr><tr><td id="L2763" class="css-a4x74f"><span>2763</span></td><td id="LC2763" class="css-1dcdqdg"><code>            extend(attributes, {
</code></td></tr><tr><td id="L2764" class="css-a4x74f"><span>2764</span></td><td id="LC2764" class="css-1dcdqdg"><code>              icon: <span class="code-string">`logo-<span class="code-subst">${<span class="code-keyword">this</span>.provider}</span>`</span>,
</code></td></tr><tr><td id="L2765" class="css-a4x74f"><span>2765</span></td><td id="LC2765" class="css-1dcdqdg"><code>              label: <span class="code-keyword">this</span>.provider
</code></td></tr><tr><td id="L2766" class="css-a4x74f"><span>2766</span></td><td id="LC2766" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L2767" class="css-a4x74f"><span>2767</span></td><td id="LC2767" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2768" class="css-a4x74f"><span>2768</span></td><td id="LC2768" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'download'</span>, attributes));
</code></td></tr><tr><td id="L2769" class="css-a4x74f"><span>2769</span></td><td id="LC2769" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2770" class="css-a4x74f"><span>2770</span></td><td id="LC2770" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2771" class="css-a4x74f"><span>2771</span></td><td id="LC2771" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle fullscreen button</span>
</code></td></tr><tr><td id="L2772" class="css-a4x74f"><span>2772</span></td><td id="LC2772" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (control === <span class="code-string">'fullscreen'</span>) {
</code></td></tr><tr><td id="L2773" class="css-a4x74f"><span>2773</span></td><td id="LC2773" class="css-1dcdqdg"><code>          container.appendChild(createButton.call(<span class="code-keyword">this</span>, <span class="code-string">'fullscreen'</span>, defaultAttributes));
</code></td></tr><tr><td id="L2774" class="css-a4x74f"><span>2774</span></td><td id="LC2774" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2775" class="css-a4x74f"><span>2775</span></td><td id="LC2775" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L2776" class="css-a4x74f"><span>2776</span></td><td id="LC2776" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2777" class="css-a4x74f"><span>2777</span></td><td id="LC2777" class="css-1dcdqdg"><code>      <span class="code-comment">// Set available quality levels</span>
</code></td></tr><tr><td id="L2778" class="css-a4x74f"><span>2778</span></td><td id="LC2778" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L2779" class="css-a4x74f"><span>2779</span></td><td id="LC2779" class="css-1dcdqdg"><code>        setQualityMenu.call(<span class="code-keyword">this</span>, html5.getQualityOptions.call(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L2780" class="css-a4x74f"><span>2780</span></td><td id="LC2780" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2781" class="css-a4x74f"><span>2781</span></td><td id="LC2781" class="css-1dcdqdg"><code>      setSpeedMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2782" class="css-a4x74f"><span>2782</span></td><td id="LC2782" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> container;
</code></td></tr><tr><td id="L2783" class="css-a4x74f"><span>2783</span></td><td id="LC2783" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2784" class="css-a4x74f"><span>2784</span></td><td id="LC2784" class="css-1dcdqdg"><code>    <span class="code-comment">// Insert controls</span>
</code></td></tr><tr><td id="L2785" class="css-a4x74f"><span>2785</span></td><td id="LC2785" class="css-1dcdqdg"><code>    inject() {
</code></td></tr><tr><td id="L2786" class="css-a4x74f"><span>2786</span></td><td id="LC2786" class="css-1dcdqdg"><code>      <span class="code-comment">// Sprite</span>
</code></td></tr><tr><td id="L2787" class="css-a4x74f"><span>2787</span></td><td id="LC2787" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.loadSprite) {
</code></td></tr><tr><td id="L2788" class="css-a4x74f"><span>2788</span></td><td id="LC2788" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> icon = controls.getIconUrl.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2789" class="css-a4x74f"><span>2789</span></td><td id="LC2789" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2790" class="css-a4x74f"><span>2790</span></td><td id="LC2790" class="css-1dcdqdg"><code>        <span class="code-comment">// Only load external sprite using AJAX</span>
</code></td></tr><tr><td id="L2791" class="css-a4x74f"><span>2791</span></td><td id="LC2791" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (icon.cors) {
</code></td></tr><tr><td id="L2792" class="css-a4x74f"><span>2792</span></td><td id="LC2792" class="css-1dcdqdg"><code>          loadSprite(icon.url, <span class="code-string">'sprite-plyr'</span>);
</code></td></tr><tr><td id="L2793" class="css-a4x74f"><span>2793</span></td><td id="LC2793" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2794" class="css-a4x74f"><span>2794</span></td><td id="LC2794" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2795" class="css-a4x74f"><span>2795</span></td><td id="LC2795" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2796" class="css-a4x74f"><span>2796</span></td><td id="LC2796" class="css-1dcdqdg"><code>      <span class="code-comment">// Create a unique ID</span>
</code></td></tr><tr><td id="L2797" class="css-a4x74f"><span>2797</span></td><td id="LC2797" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.id = <span class="code-built_in">Math</span>.floor(<span class="code-built_in">Math</span>.random() * <span class="code-number">10000</span>);
</code></td></tr><tr><td id="L2798" class="css-a4x74f"><span>2798</span></td><td id="LC2798" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2799" class="css-a4x74f"><span>2799</span></td><td id="LC2799" class="css-1dcdqdg"><code>      <span class="code-comment">// Null by default</span>
</code></td></tr><tr><td id="L2800" class="css-a4x74f"><span>2800</span></td><td id="LC2800" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> container = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2801" class="css-a4x74f"><span>2801</span></td><td id="LC2801" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.controls = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2802" class="css-a4x74f"><span>2802</span></td><td id="LC2802" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2803" class="css-a4x74f"><span>2803</span></td><td id="LC2803" class="css-1dcdqdg"><code>      <span class="code-comment">// Set template properties</span>
</code></td></tr><tr><td id="L2804" class="css-a4x74f"><span>2804</span></td><td id="LC2804" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> props = {
</code></td></tr><tr><td id="L2805" class="css-a4x74f"><span>2805</span></td><td id="LC2805" class="css-1dcdqdg"><code>        id: <span class="code-keyword">this</span>.id,
</code></td></tr><tr><td id="L2806" class="css-a4x74f"><span>2806</span></td><td id="LC2806" class="css-1dcdqdg"><code>        seektime: <span class="code-keyword">this</span>.config.seekTime,
</code></td></tr><tr><td id="L2807" class="css-a4x74f"><span>2807</span></td><td id="LC2807" class="css-1dcdqdg"><code>        title: <span class="code-keyword">this</span>.config.title
</code></td></tr><tr><td id="L2808" class="css-a4x74f"><span>2808</span></td><td id="LC2808" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2809" class="css-a4x74f"><span>2809</span></td><td id="LC2809" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> update = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L2810" class="css-a4x74f"><span>2810</span></td><td id="LC2810" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2811" class="css-a4x74f"><span>2811</span></td><td id="LC2811" class="css-1dcdqdg"><code>      <span class="code-comment">// If function, run it and use output</span>
</code></td></tr><tr><td id="L2812" class="css-a4x74f"><span>2812</span></td><td id="LC2812" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.function(<span class="code-keyword">this</span>.config.controls)) {
</code></td></tr><tr><td id="L2813" class="css-a4x74f"><span>2813</span></td><td id="LC2813" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.config.controls = <span class="code-keyword">this</span>.config.controls.call(<span class="code-keyword">this</span>, props);
</code></td></tr><tr><td id="L2814" class="css-a4x74f"><span>2814</span></td><td id="LC2814" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2815" class="css-a4x74f"><span>2815</span></td><td id="LC2815" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2816" class="css-a4x74f"><span>2816</span></td><td id="LC2816" class="css-1dcdqdg"><code>      <span class="code-comment">// Convert falsy controls to empty array (primarily for empty strings)</span>
</code></td></tr><tr><td id="L2817" class="css-a4x74f"><span>2817</span></td><td id="LC2817" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.config.controls) {
</code></td></tr><tr><td id="L2818" class="css-a4x74f"><span>2818</span></td><td id="LC2818" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.config.controls = [];
</code></td></tr><tr><td id="L2819" class="css-a4x74f"><span>2819</span></td><td id="LC2819" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2820" class="css-a4x74f"><span>2820</span></td><td id="LC2820" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.config.controls) || is.string(<span class="code-keyword">this</span>.config.controls)) {
</code></td></tr><tr><td id="L2821" class="css-a4x74f"><span>2821</span></td><td id="LC2821" class="css-1dcdqdg"><code>        <span class="code-comment">// HTMLElement or Non-empty string passed as the option</span>
</code></td></tr><tr><td id="L2822" class="css-a4x74f"><span>2822</span></td><td id="LC2822" class="css-1dcdqdg"><code>        container = <span class="code-keyword">this</span>.config.controls;
</code></td></tr><tr><td id="L2823" class="css-a4x74f"><span>2823</span></td><td id="LC2823" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L2824" class="css-a4x74f"><span>2824</span></td><td id="LC2824" class="css-1dcdqdg"><code>        <span class="code-comment">// Create controls</span>
</code></td></tr><tr><td id="L2825" class="css-a4x74f"><span>2825</span></td><td id="LC2825" class="css-1dcdqdg"><code>        container = controls.create.call(<span class="code-keyword">this</span>, {
</code></td></tr><tr><td id="L2826" class="css-a4x74f"><span>2826</span></td><td id="LC2826" class="css-1dcdqdg"><code>          id: <span class="code-keyword">this</span>.id,
</code></td></tr><tr><td id="L2827" class="css-a4x74f"><span>2827</span></td><td id="LC2827" class="css-1dcdqdg"><code>          seektime: <span class="code-keyword">this</span>.config.seekTime,
</code></td></tr><tr><td id="L2828" class="css-a4x74f"><span>2828</span></td><td id="LC2828" class="css-1dcdqdg"><code>          speed: <span class="code-keyword">this</span>.speed,
</code></td></tr><tr><td id="L2829" class="css-a4x74f"><span>2829</span></td><td id="LC2829" class="css-1dcdqdg"><code>          quality: <span class="code-keyword">this</span>.quality,
</code></td></tr><tr><td id="L2830" class="css-a4x74f"><span>2830</span></td><td id="LC2830" class="css-1dcdqdg"><code>          captions: captions.getLabel.call(<span class="code-keyword">this</span>)
</code></td></tr><tr><td id="L2831" class="css-a4x74f"><span>2831</span></td><td id="LC2831" class="css-1dcdqdg"><code>          <span class="code-comment">// <span class="code-doctag">TODO:</span> Looping</span>
</code></td></tr><tr><td id="L2832" class="css-a4x74f"><span>2832</span></td><td id="LC2832" class="css-1dcdqdg"><code>          <span class="code-comment">// loop: 'None',</span>
</code></td></tr><tr><td id="L2833" class="css-a4x74f"><span>2833</span></td><td id="LC2833" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2834" class="css-a4x74f"><span>2834</span></td><td id="LC2834" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2835" class="css-a4x74f"><span>2835</span></td><td id="LC2835" class="css-1dcdqdg"><code>        update = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L2836" class="css-a4x74f"><span>2836</span></td><td id="LC2836" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2837" class="css-a4x74f"><span>2837</span></td><td id="LC2837" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2838" class="css-a4x74f"><span>2838</span></td><td id="LC2838" class="css-1dcdqdg"><code>      <span class="code-comment">// Replace props with their value</span>
</code></td></tr><tr><td id="L2839" class="css-a4x74f"><span>2839</span></td><td id="LC2839" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> replace = <span class="code-function"><span class="code-params">input</span> =&gt;</span> {
</code></td></tr><tr><td id="L2840" class="css-a4x74f"><span>2840</span></td><td id="LC2840" class="css-1dcdqdg"><code>        <span class="code-keyword">let</span> result = input;
</code></td></tr><tr><td id="L2841" class="css-a4x74f"><span>2841</span></td><td id="LC2841" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.entries(props).forEach(<span class="code-function">(<span class="code-params">[key, value]</span>) =&gt;</span> {
</code></td></tr><tr><td id="L2842" class="css-a4x74f"><span>2842</span></td><td id="LC2842" class="css-1dcdqdg"><code>          result = replaceAll(result, <span class="code-string">`{<span class="code-subst">${key}</span>}`</span>, value);
</code></td></tr><tr><td id="L2843" class="css-a4x74f"><span>2843</span></td><td id="LC2843" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2844" class="css-a4x74f"><span>2844</span></td><td id="LC2844" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> result;
</code></td></tr><tr><td id="L2845" class="css-a4x74f"><span>2845</span></td><td id="LC2845" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2846" class="css-a4x74f"><span>2846</span></td><td id="LC2846" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2847" class="css-a4x74f"><span>2847</span></td><td id="LC2847" class="css-1dcdqdg"><code>      <span class="code-comment">// Update markup</span>
</code></td></tr><tr><td id="L2848" class="css-a4x74f"><span>2848</span></td><td id="LC2848" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (update) {
</code></td></tr><tr><td id="L2849" class="css-a4x74f"><span>2849</span></td><td id="LC2849" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.string(<span class="code-keyword">this</span>.config.controls)) {
</code></td></tr><tr><td id="L2850" class="css-a4x74f"><span>2850</span></td><td id="LC2850" class="css-1dcdqdg"><code>          container = replace(container);
</code></td></tr><tr><td id="L2851" class="css-a4x74f"><span>2851</span></td><td id="LC2851" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2852" class="css-a4x74f"><span>2852</span></td><td id="LC2852" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2853" class="css-a4x74f"><span>2853</span></td><td id="LC2853" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2854" class="css-a4x74f"><span>2854</span></td><td id="LC2854" class="css-1dcdqdg"><code>      <span class="code-comment">// Controls container</span>
</code></td></tr><tr><td id="L2855" class="css-a4x74f"><span>2855</span></td><td id="LC2855" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> target;
</code></td></tr><tr><td id="L2856" class="css-a4x74f"><span>2856</span></td><td id="LC2856" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2857" class="css-a4x74f"><span>2857</span></td><td id="LC2857" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject to custom location</span>
</code></td></tr><tr><td id="L2858" class="css-a4x74f"><span>2858</span></td><td id="LC2858" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(<span class="code-keyword">this</span>.config.selectors.controls.container)) {
</code></td></tr><tr><td id="L2859" class="css-a4x74f"><span>2859</span></td><td id="LC2859" class="css-1dcdqdg"><code>        target = <span class="code-built_in">document</span>.querySelector(<span class="code-keyword">this</span>.config.selectors.controls.container);
</code></td></tr><tr><td id="L2860" class="css-a4x74f"><span>2860</span></td><td id="LC2860" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2861" class="css-a4x74f"><span>2861</span></td><td id="LC2861" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2862" class="css-a4x74f"><span>2862</span></td><td id="LC2862" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject into the container by default</span>
</code></td></tr><tr><td id="L2863" class="css-a4x74f"><span>2863</span></td><td id="LC2863" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(target)) {
</code></td></tr><tr><td id="L2864" class="css-a4x74f"><span>2864</span></td><td id="LC2864" class="css-1dcdqdg"><code>        target = <span class="code-keyword">this</span>.elements.container;
</code></td></tr><tr><td id="L2865" class="css-a4x74f"><span>2865</span></td><td id="LC2865" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2866" class="css-a4x74f"><span>2866</span></td><td id="LC2866" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2867" class="css-a4x74f"><span>2867</span></td><td id="LC2867" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject controls HTML (needs to be before captions, hence "afterbegin")</span>
</code></td></tr><tr><td id="L2868" class="css-a4x74f"><span>2868</span></td><td id="LC2868" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> insertMethod = is.element(container) ? <span class="code-string">'insertAdjacentElement'</span> : <span class="code-string">'insertAdjacentHTML'</span>;
</code></td></tr><tr><td id="L2869" class="css-a4x74f"><span>2869</span></td><td id="LC2869" class="css-1dcdqdg"><code>      target[insertMethod](<span class="code-string">'afterbegin'</span>, container);
</code></td></tr><tr><td id="L2870" class="css-a4x74f"><span>2870</span></td><td id="LC2870" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2871" class="css-a4x74f"><span>2871</span></td><td id="LC2871" class="css-1dcdqdg"><code>      <span class="code-comment">// Find the elements if need be</span>
</code></td></tr><tr><td id="L2872" class="css-a4x74f"><span>2872</span></td><td id="LC2872" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.controls)) {
</code></td></tr><tr><td id="L2873" class="css-a4x74f"><span>2873</span></td><td id="LC2873" class="css-1dcdqdg"><code>        controls.findElements.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L2874" class="css-a4x74f"><span>2874</span></td><td id="LC2874" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2875" class="css-a4x74f"><span>2875</span></td><td id="LC2875" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2876" class="css-a4x74f"><span>2876</span></td><td id="LC2876" class="css-1dcdqdg"><code>      <span class="code-comment">// Add pressed property to buttons</span>
</code></td></tr><tr><td id="L2877" class="css-a4x74f"><span>2877</span></td><td id="LC2877" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.elements.buttons)) {
</code></td></tr><tr><td id="L2878" class="css-a4x74f"><span>2878</span></td><td id="LC2878" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> addProperty = <span class="code-function"><span class="code-params">button</span> =&gt;</span> {
</code></td></tr><tr><td id="L2879" class="css-a4x74f"><span>2879</span></td><td id="LC2879" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> className = <span class="code-keyword">this</span>.config.classNames.controlPressed;
</code></td></tr><tr><td id="L2880" class="css-a4x74f"><span>2880</span></td><td id="LC2880" class="css-1dcdqdg"><code>          button.setAttribute(<span class="code-string">'aria-pressed'</span>, <span class="code-string">'false'</span>);
</code></td></tr><tr><td id="L2881" class="css-a4x74f"><span>2881</span></td><td id="LC2881" class="css-1dcdqdg"><code>          <span class="code-built_in">Object</span>.defineProperty(button, <span class="code-string">'pressed'</span>, {
</code></td></tr><tr><td id="L2882" class="css-a4x74f"><span>2882</span></td><td id="LC2882" class="css-1dcdqdg"><code>            configurable: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L2883" class="css-a4x74f"><span>2883</span></td><td id="LC2883" class="css-1dcdqdg"><code>            enumerable: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L2884" class="css-a4x74f"><span>2884</span></td><td id="LC2884" class="css-1dcdqdg"><code>            <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L2885" class="css-a4x74f"><span>2885</span></td><td id="LC2885" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span> hasClass(button, className);
</code></td></tr><tr><td id="L2886" class="css-a4x74f"><span>2886</span></td><td id="LC2886" class="css-1dcdqdg"><code>            },
</code></td></tr><tr><td id="L2887" class="css-a4x74f"><span>2887</span></td><td id="LC2887" class="css-1dcdqdg"><code>            <span class="code-keyword">set</span>(pressed = false) {
</code></td></tr><tr><td id="L2888" class="css-a4x74f"><span>2888</span></td><td id="LC2888" class="css-1dcdqdg"><code>              toggleClass(button, className, pressed);
</code></td></tr><tr><td id="L2889" class="css-a4x74f"><span>2889</span></td><td id="LC2889" class="css-1dcdqdg"><code>              button.setAttribute(<span class="code-string">'aria-pressed'</span>, pressed ? <span class="code-string">'true'</span> : <span class="code-string">'false'</span>);
</code></td></tr><tr><td id="L2890" class="css-a4x74f"><span>2890</span></td><td id="LC2890" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L2891" class="css-a4x74f"><span>2891</span></td><td id="LC2891" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2892" class="css-a4x74f"><span>2892</span></td><td id="LC2892" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L2893" class="css-a4x74f"><span>2893</span></td><td id="LC2893" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2894" class="css-a4x74f"><span>2894</span></td><td id="LC2894" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle classname when pressed property is set</span>
</code></td></tr><tr><td id="L2895" class="css-a4x74f"><span>2895</span></td><td id="LC2895" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.values(<span class="code-keyword">this</span>.elements.buttons).filter(<span class="code-built_in">Boolean</span>).forEach(<span class="code-function"><span class="code-params">button</span> =&gt;</span> {
</code></td></tr><tr><td id="L2896" class="css-a4x74f"><span>2896</span></td><td id="LC2896" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.array(button) || is.nodeList(button)) {
</code></td></tr><tr><td id="L2897" class="css-a4x74f"><span>2897</span></td><td id="LC2897" class="css-1dcdqdg"><code>            <span class="code-built_in">Array</span>.from(button).filter(<span class="code-built_in">Boolean</span>).forEach(addProperty);
</code></td></tr><tr><td id="L2898" class="css-a4x74f"><span>2898</span></td><td id="LC2898" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L2899" class="css-a4x74f"><span>2899</span></td><td id="LC2899" class="css-1dcdqdg"><code>            addProperty(button);
</code></td></tr><tr><td id="L2900" class="css-a4x74f"><span>2900</span></td><td id="LC2900" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L2901" class="css-a4x74f"><span>2901</span></td><td id="LC2901" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2902" class="css-a4x74f"><span>2902</span></td><td id="LC2902" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2903" class="css-a4x74f"><span>2903</span></td><td id="LC2903" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2904" class="css-a4x74f"><span>2904</span></td><td id="LC2904" class="css-1dcdqdg"><code>      <span class="code-comment">// Edge sometimes doesn't finish the paint so force a repaint</span>
</code></td></tr><tr><td id="L2905" class="css-a4x74f"><span>2905</span></td><td id="LC2905" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (browser.isEdge) {
</code></td></tr><tr><td id="L2906" class="css-a4x74f"><span>2906</span></td><td id="LC2906" class="css-1dcdqdg"><code>        repaint(target);
</code></td></tr><tr><td id="L2907" class="css-a4x74f"><span>2907</span></td><td id="LC2907" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2908" class="css-a4x74f"><span>2908</span></td><td id="LC2908" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2909" class="css-a4x74f"><span>2909</span></td><td id="LC2909" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup tooltips</span>
</code></td></tr><tr><td id="L2910" class="css-a4x74f"><span>2910</span></td><td id="LC2910" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.tooltips.controls) {
</code></td></tr><tr><td id="L2911" class="css-a4x74f"><span>2911</span></td><td id="LC2911" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L2912" class="css-a4x74f"><span>2912</span></td><td id="LC2912" class="css-1dcdqdg"><code>          classNames,
</code></td></tr><tr><td id="L2913" class="css-a4x74f"><span>2913</span></td><td id="LC2913" class="css-1dcdqdg"><code>          selectors
</code></td></tr><tr><td id="L2914" class="css-a4x74f"><span>2914</span></td><td id="LC2914" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.config;
</code></td></tr><tr><td id="L2915" class="css-a4x74f"><span>2915</span></td><td id="LC2915" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> selector = <span class="code-string">`<span class="code-subst">${selectors.controls.wrapper}</span> <span class="code-subst">${selectors.labels}</span> .<span class="code-subst">${classNames.hidden}</span>`</span>;
</code></td></tr><tr><td id="L2916" class="css-a4x74f"><span>2916</span></td><td id="LC2916" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> labels = getElements.call(<span class="code-keyword">this</span>, selector);
</code></td></tr><tr><td id="L2917" class="css-a4x74f"><span>2917</span></td><td id="LC2917" class="css-1dcdqdg"><code>        <span class="code-built_in">Array</span>.from(labels).forEach(<span class="code-function"><span class="code-params">label</span> =&gt;</span> {
</code></td></tr><tr><td id="L2918" class="css-a4x74f"><span>2918</span></td><td id="LC2918" class="css-1dcdqdg"><code>          toggleClass(label, <span class="code-keyword">this</span>.config.classNames.hidden, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2919" class="css-a4x74f"><span>2919</span></td><td id="LC2919" class="css-1dcdqdg"><code>          toggleClass(label, <span class="code-keyword">this</span>.config.classNames.tooltip, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2920" class="css-a4x74f"><span>2920</span></td><td id="LC2920" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2921" class="css-a4x74f"><span>2921</span></td><td id="LC2921" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2922" class="css-a4x74f"><span>2922</span></td><td id="LC2922" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2923" class="css-a4x74f"><span>2923</span></td><td id="LC2923" class="css-1dcdqdg"><code>    <span class="code-comment">// Set media metadata</span>
</code></td></tr><tr><td id="L2924" class="css-a4x74f"><span>2924</span></td><td id="LC2924" class="css-1dcdqdg"><code>    setMediaMetadata() {
</code></td></tr><tr><td id="L2925" class="css-a4x74f"><span>2925</span></td><td id="LC2925" class="css-1dcdqdg"><code>      <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L2926" class="css-a4x74f"><span>2926</span></td><td id="LC2926" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-string">'mediaSession'</span> <span class="code-keyword">in</span> navigator) {
</code></td></tr><tr><td id="L2927" class="css-a4x74f"><span>2927</span></td><td id="LC2927" class="css-1dcdqdg"><code>          navigator.mediaSession.metadata = <span class="code-keyword">new</span> <span class="code-built_in">window</span>.MediaMetadata({
</code></td></tr><tr><td id="L2928" class="css-a4x74f"><span>2928</span></td><td id="LC2928" class="css-1dcdqdg"><code>            title: <span class="code-keyword">this</span>.config.mediaMetadata.title,
</code></td></tr><tr><td id="L2929" class="css-a4x74f"><span>2929</span></td><td id="LC2929" class="css-1dcdqdg"><code>            artist: <span class="code-keyword">this</span>.config.mediaMetadata.artist,
</code></td></tr><tr><td id="L2930" class="css-a4x74f"><span>2930</span></td><td id="LC2930" class="css-1dcdqdg"><code>            album: <span class="code-keyword">this</span>.config.mediaMetadata.album,
</code></td></tr><tr><td id="L2931" class="css-a4x74f"><span>2931</span></td><td id="LC2931" class="css-1dcdqdg"><code>            artwork: <span class="code-keyword">this</span>.config.mediaMetadata.artwork
</code></td></tr><tr><td id="L2932" class="css-a4x74f"><span>2932</span></td><td id="LC2932" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2933" class="css-a4x74f"><span>2933</span></td><td id="LC2933" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2934" class="css-a4x74f"><span>2934</span></td><td id="LC2934" class="css-1dcdqdg"><code>      } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L2935" class="css-a4x74f"><span>2935</span></td><td id="LC2935" class="css-1dcdqdg"><code>        <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L2936" class="css-a4x74f"><span>2936</span></td><td id="LC2936" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2937" class="css-a4x74f"><span>2937</span></td><td id="LC2937" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L2938" class="css-a4x74f"><span>2938</span></td><td id="LC2938" class="css-1dcdqdg"><code>    <span class="code-comment">// Add markers</span>
</code></td></tr><tr><td id="L2939" class="css-a4x74f"><span>2939</span></td><td id="LC2939" class="css-1dcdqdg"><code>    setMarkers() {
</code></td></tr><tr><td id="L2940" class="css-a4x74f"><span>2940</span></td><td id="LC2940" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> _this$config$markers2, _this$config$markers3;
</code></td></tr><tr><td id="L2941" class="css-a4x74f"><span>2941</span></td><td id="LC2941" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.duration || <span class="code-keyword">this</span>.elements.markers) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2942" class="css-a4x74f"><span>2942</span></td><td id="LC2942" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2943" class="css-a4x74f"><span>2943</span></td><td id="LC2943" class="css-1dcdqdg"><code>      <span class="code-comment">// Get valid points</span>
</code></td></tr><tr><td id="L2944" class="css-a4x74f"><span>2944</span></td><td id="LC2944" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> points = (_this$config$markers2 = <span class="code-keyword">this</span>.config.markers) === <span class="code-literal">null</span> || _this$config$markers2 === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : (_this$config$markers3 = _this$config$markers2.points) === <span class="code-literal">null</span> || _this$config$markers3 === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : _this$config$markers3.filter(({
</code></td></tr><tr><td id="L2945" class="css-a4x74f"><span>2945</span></td><td id="LC2945" class="css-1dcdqdg"><code>        time
</code></td></tr><tr><td id="L2946" class="css-a4x74f"><span>2946</span></td><td id="LC2946" class="css-1dcdqdg"><code>      }) =&gt; time &gt; <span class="code-number">0</span> &amp;&amp; time &lt; <span class="code-keyword">this</span>.duration);
</code></td></tr><tr><td id="L2947" class="css-a4x74f"><span>2947</span></td><td id="LC2947" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!(points !== <span class="code-literal">null</span> &amp;&amp; points !== <span class="code-keyword">void</span> <span class="code-number">0</span> &amp;&amp; points.length)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2948" class="css-a4x74f"><span>2948</span></td><td id="LC2948" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> containerFragment = <span class="code-built_in">document</span>.createDocumentFragment();
</code></td></tr><tr><td id="L2949" class="css-a4x74f"><span>2949</span></td><td id="LC2949" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> pointsFragment = <span class="code-built_in">document</span>.createDocumentFragment();
</code></td></tr><tr><td id="L2950" class="css-a4x74f"><span>2950</span></td><td id="LC2950" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> tipElement = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L2951" class="css-a4x74f"><span>2951</span></td><td id="LC2951" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tipVisible = <span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.config.classNames.tooltip}</span>--visible`</span>;
</code></td></tr><tr><td id="L2952" class="css-a4x74f"><span>2952</span></td><td id="LC2952" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggleTip = <span class="code-function"><span class="code-params">show</span> =&gt;</span> toggleClass(tipElement, tipVisible, show);
</code></td></tr><tr><td id="L2953" class="css-a4x74f"><span>2953</span></td><td id="LC2953" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2954" class="css-a4x74f"><span>2954</span></td><td id="LC2954" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject markers to progress container</span>
</code></td></tr><tr><td id="L2955" class="css-a4x74f"><span>2955</span></td><td id="LC2955" class="css-1dcdqdg"><code>      points.forEach(<span class="code-function"><span class="code-params">point</span> =&gt;</span> {
</code></td></tr><tr><td id="L2956" class="css-a4x74f"><span>2956</span></td><td id="LC2956" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> markerElement = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2957" class="css-a4x74f"><span>2957</span></td><td id="LC2957" class="css-1dcdqdg"><code>          class: this.config.classNames.marker
</code></td></tr><tr><td id="L2958" class="css-a4x74f"><span>2958</span></td><td id="LC2958" class="css-1dcdqdg"><code>        }, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L2959" class="css-a4x74f"><span>2959</span></td><td id="LC2959" class="css-1dcdqdg"><code>        const left = `${point.time / this.duration * 100}%`;
</code></td></tr><tr><td id="L2960" class="css-a4x74f"><span>2960</span></td><td id="LC2960" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (tipElement) {
</code></td></tr><tr><td id="L2961" class="css-a4x74f"><span>2961</span></td><td id="LC2961" class="css-1dcdqdg"><code>          <span class="code-comment">// Show on hover</span>
</code></td></tr><tr><td id="L2962" class="css-a4x74f"><span>2962</span></td><td id="LC2962" class="css-1dcdqdg"><code>          markerElement.addEventListener(<span class="code-string">'mouseenter'</span>, () =&gt; {
</code></td></tr><tr><td id="L2963" class="css-a4x74f"><span>2963</span></td><td id="LC2963" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (point.label) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L2964" class="css-a4x74f"><span>2964</span></td><td id="LC2964" class="css-1dcdqdg"><code>            tipElement.style.left = left;
</code></td></tr><tr><td id="L2965" class="css-a4x74f"><span>2965</span></td><td id="LC2965" class="css-1dcdqdg"><code>            tipElement.innerHTML = point.label;
</code></td></tr><tr><td id="L2966" class="css-a4x74f"><span>2966</span></td><td id="LC2966" class="css-1dcdqdg"><code>            toggleTip(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L2967" class="css-a4x74f"><span>2967</span></td><td id="LC2967" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2968" class="css-a4x74f"><span>2968</span></td><td id="LC2968" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2969" class="css-a4x74f"><span>2969</span></td><td id="LC2969" class="css-1dcdqdg"><code>          <span class="code-comment">// Hide on leave</span>
</code></td></tr><tr><td id="L2970" class="css-a4x74f"><span>2970</span></td><td id="LC2970" class="css-1dcdqdg"><code>          markerElement.addEventListener(<span class="code-string">'mouseleave'</span>, () =&gt; {
</code></td></tr><tr><td id="L2971" class="css-a4x74f"><span>2971</span></td><td id="LC2971" class="css-1dcdqdg"><code>            toggleTip(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L2972" class="css-a4x74f"><span>2972</span></td><td id="LC2972" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L2973" class="css-a4x74f"><span>2973</span></td><td id="LC2973" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L2974" class="css-a4x74f"><span>2974</span></td><td id="LC2974" class="css-1dcdqdg"><code>        markerElement.addEventListener(<span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L2975" class="css-a4x74f"><span>2975</span></td><td id="LC2975" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.currentTime = point.time;
</code></td></tr><tr><td id="L2976" class="css-a4x74f"><span>2976</span></td><td id="LC2976" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L2977" class="css-a4x74f"><span>2977</span></td><td id="LC2977" class="css-1dcdqdg"><code>        markerElement.style.left = left;
</code></td></tr><tr><td id="L2978" class="css-a4x74f"><span>2978</span></td><td id="LC2978" class="css-1dcdqdg"><code>        pointsFragment.appendChild(markerElement);
</code></td></tr><tr><td id="L2979" class="css-a4x74f"><span>2979</span></td><td id="LC2979" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L2980" class="css-a4x74f"><span>2980</span></td><td id="LC2980" class="css-1dcdqdg"><code>      containerFragment.appendChild(pointsFragment);
</code></td></tr><tr><td id="L2981" class="css-a4x74f"><span>2981</span></td><td id="LC2981" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2982" class="css-a4x74f"><span>2982</span></td><td id="LC2982" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject a tooltip if needed</span>
</code></td></tr><tr><td id="L2983" class="css-a4x74f"><span>2983</span></td><td id="LC2983" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.config.tooltips.seek) {
</code></td></tr><tr><td id="L2984" class="css-a4x74f"><span>2984</span></td><td id="LC2984" class="css-1dcdqdg"><code>        tipElement = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L2985" class="css-a4x74f"><span>2985</span></td><td id="LC2985" class="css-1dcdqdg"><code>          class: this.config.classNames.tooltip
</code></td></tr><tr><td id="L2986" class="css-a4x74f"><span>2986</span></td><td id="LC2986" class="css-1dcdqdg"><code>        }, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L2987" class="css-a4x74f"><span>2987</span></td><td id="LC2987" class="css-1dcdqdg"><code>        containerFragment.appendChild(tipElement);
</code></td></tr><tr><td id="L2988" class="css-a4x74f"><span>2988</span></td><td id="LC2988" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L2989" class="css-a4x74f"><span>2989</span></td><td id="LC2989" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.markers = {
</code></td></tr><tr><td id="L2990" class="css-a4x74f"><span>2990</span></td><td id="LC2990" class="css-1dcdqdg"><code>        points: pointsFragment,
</code></td></tr><tr><td id="L2991" class="css-a4x74f"><span>2991</span></td><td id="LC2991" class="css-1dcdqdg"><code>        tip: tipElement
</code></td></tr><tr><td id="L2992" class="css-a4x74f"><span>2992</span></td><td id="LC2992" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L2993" class="css-a4x74f"><span>2993</span></td><td id="LC2993" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.progress.appendChild(containerFragment);
</code></td></tr><tr><td id="L2994" class="css-a4x74f"><span>2994</span></td><td id="LC2994" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L2995" class="css-a4x74f"><span>2995</span></td><td id="LC2995" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L2996" class="css-a4x74f"><span>2996</span></td><td id="LC2996" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2997" class="css-a4x74f"><span>2997</span></td><td id="LC2997" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L2998" class="css-a4x74f"><span>2998</span></td><td id="LC2998" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L2999" class="css-a4x74f"><span>2999</span></td><td id="LC2999" class="css-1dcdqdg"><code>  <span class="code-comment">/**
</span></code></td></tr><tr><td id="L3000" class="css-a4x74f"><span>3000</span></td><td id="LC3000" class="css-1dcdqdg"><code><span class="code-comment">   * Parse a string to a URL object
</span></code></td></tr><tr><td id="L3001" class="css-a4x74f"><span>3001</span></td><td id="LC3001" class="css-1dcdqdg"><code><span class="code-comment">   * @param {String} input - the URL to be parsed
</span></code></td></tr><tr><td id="L3002" class="css-a4x74f"><span>3002</span></td><td id="LC3002" class="css-1dcdqdg"><code><span class="code-comment">   * @param {Boolean} safe - failsafe parsing
</span></code></td></tr><tr><td id="L3003" class="css-a4x74f"><span>3003</span></td><td id="LC3003" class="css-1dcdqdg"><code><span class="code-comment">   */</span>
</code></td></tr><tr><td id="L3004" class="css-a4x74f"><span>3004</span></td><td id="LC3004" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">parseUrl</span>(<span class="code-params">input, safe = true</span>) </span>{
</code></td></tr><tr><td id="L3005" class="css-a4x74f"><span>3005</span></td><td id="LC3005" class="css-1dcdqdg"><code>    <span class="code-keyword">let</span> url = input;
</code></td></tr><tr><td id="L3006" class="css-a4x74f"><span>3006</span></td><td id="LC3006" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (safe) {
</code></td></tr><tr><td id="L3007" class="css-a4x74f"><span>3007</span></td><td id="LC3007" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> parser = <span class="code-built_in">document</span>.createElement(<span class="code-string">'a'</span>);
</code></td></tr><tr><td id="L3008" class="css-a4x74f"><span>3008</span></td><td id="LC3008" class="css-1dcdqdg"><code>      parser.href = url;
</code></td></tr><tr><td id="L3009" class="css-a4x74f"><span>3009</span></td><td id="LC3009" class="css-1dcdqdg"><code>      url = parser.href;
</code></td></tr><tr><td id="L3010" class="css-a4x74f"><span>3010</span></td><td id="LC3010" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3011" class="css-a4x74f"><span>3011</span></td><td id="LC3011" class="css-1dcdqdg"><code>    <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L3012" class="css-a4x74f"><span>3012</span></td><td id="LC3012" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">new</span> URL(url);
</code></td></tr><tr><td id="L3013" class="css-a4x74f"><span>3013</span></td><td id="LC3013" class="css-1dcdqdg"><code>    } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L3014" class="css-a4x74f"><span>3014</span></td><td id="LC3014" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L3015" class="css-a4x74f"><span>3015</span></td><td id="LC3015" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3016" class="css-a4x74f"><span>3016</span></td><td id="LC3016" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L3017" class="css-a4x74f"><span>3017</span></td><td id="LC3017" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3018" class="css-a4x74f"><span>3018</span></td><td id="LC3018" class="css-1dcdqdg"><code>  <span class="code-comment">// Convert object to URLSearchParams</span>
</code></td></tr><tr><td id="L3019" class="css-a4x74f"><span>3019</span></td><td id="LC3019" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">buildUrlParams</span>(<span class="code-params">input</span>) </span>{
</code></td></tr><tr><td id="L3020" class="css-a4x74f"><span>3020</span></td><td id="LC3020" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> params = <span class="code-keyword">new</span> URLSearchParams();
</code></td></tr><tr><td id="L3021" class="css-a4x74f"><span>3021</span></td><td id="LC3021" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.object(input)) {
</code></td></tr><tr><td id="L3022" class="css-a4x74f"><span>3022</span></td><td id="LC3022" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.entries(input).forEach(<span class="code-function">(<span class="code-params">[key, value]</span>) =&gt;</span> {
</code></td></tr><tr><td id="L3023" class="css-a4x74f"><span>3023</span></td><td id="LC3023" class="css-1dcdqdg"><code>        params.set(key, value);
</code></td></tr><tr><td id="L3024" class="css-a4x74f"><span>3024</span></td><td id="LC3024" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3025" class="css-a4x74f"><span>3025</span></td><td id="LC3025" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3026" class="css-a4x74f"><span>3026</span></td><td id="LC3026" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> params;
</code></td></tr><tr><td id="L3027" class="css-a4x74f"><span>3027</span></td><td id="LC3027" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L3028" class="css-a4x74f"><span>3028</span></td><td id="LC3028" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3029" class="css-a4x74f"><span>3029</span></td><td id="LC3029" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3030" class="css-a4x74f"><span>3030</span></td><td id="LC3030" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> captions = {
</code></td></tr><tr><td id="L3031" class="css-a4x74f"><span>3031</span></td><td id="LC3031" class="css-1dcdqdg"><code>    <span class="code-comment">// Setup captions</span>
</code></td></tr><tr><td id="L3032" class="css-a4x74f"><span>3032</span></td><td id="LC3032" class="css-1dcdqdg"><code>    setup() {
</code></td></tr><tr><td id="L3033" class="css-a4x74f"><span>3033</span></td><td id="LC3033" class="css-1dcdqdg"><code>      <span class="code-comment">// Requires UI support</span>
</code></td></tr><tr><td id="L3034" class="css-a4x74f"><span>3034</span></td><td id="LC3034" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L3035" class="css-a4x74f"><span>3035</span></td><td id="LC3035" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3036" class="css-a4x74f"><span>3036</span></td><td id="LC3036" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3037" class="css-a4x74f"><span>3037</span></td><td id="LC3037" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3038" class="css-a4x74f"><span>3038</span></td><td id="LC3038" class="css-1dcdqdg"><code>      <span class="code-comment">// Only Vimeo and HTML5 video supported at this point</span>
</code></td></tr><tr><td id="L3039" class="css-a4x74f"><span>3039</span></td><td id="LC3039" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo || <span class="code-keyword">this</span>.isYouTube || <span class="code-keyword">this</span>.isHTML5 &amp;&amp; !support.textTracks) {
</code></td></tr><tr><td id="L3040" class="css-a4x74f"><span>3040</span></td><td id="LC3040" class="css-1dcdqdg"><code>        <span class="code-comment">// Clear menu and hide</span>
</code></td></tr><tr><td id="L3041" class="css-a4x74f"><span>3041</span></td><td id="LC3041" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.array(<span class="code-keyword">this</span>.config.controls) &amp;&amp; <span class="code-keyword">this</span>.config.controls.includes(<span class="code-string">'settings'</span>) &amp;&amp; <span class="code-keyword">this</span>.config.settings.includes(<span class="code-string">'captions'</span>)) {
</code></td></tr><tr><td id="L3042" class="css-a4x74f"><span>3042</span></td><td id="LC3042" class="css-1dcdqdg"><code>          controls.setCaptionsMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3043" class="css-a4x74f"><span>3043</span></td><td id="LC3043" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3044" class="css-a4x74f"><span>3044</span></td><td id="LC3044" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3045" class="css-a4x74f"><span>3045</span></td><td id="LC3045" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3046" class="css-a4x74f"><span>3046</span></td><td id="LC3046" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3047" class="css-a4x74f"><span>3047</span></td><td id="LC3047" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject the container</span>
</code></td></tr><tr><td id="L3048" class="css-a4x74f"><span>3048</span></td><td id="LC3048" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.captions)) {
</code></td></tr><tr><td id="L3049" class="css-a4x74f"><span>3049</span></td><td id="LC3049" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.captions = createElement(<span class="code-string">'div'</span>, getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.captions));
</code></td></tr><tr><td id="L3050" class="css-a4x74f"><span>3050</span></td><td id="LC3050" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.captions.setAttribute(<span class="code-string">'dir'</span>, <span class="code-string">'auto'</span>);
</code></td></tr><tr><td id="L3051" class="css-a4x74f"><span>3051</span></td><td id="LC3051" class="css-1dcdqdg"><code>        insertAfter(<span class="code-keyword">this</span>.elements.captions, <span class="code-keyword">this</span>.elements.wrapper);
</code></td></tr><tr><td id="L3052" class="css-a4x74f"><span>3052</span></td><td id="LC3052" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3053" class="css-a4x74f"><span>3053</span></td><td id="LC3053" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3054" class="css-a4x74f"><span>3054</span></td><td id="LC3054" class="css-1dcdqdg"><code>      <span class="code-comment">// Fix IE captions if CORS is used</span>
</code></td></tr><tr><td id="L3055" class="css-a4x74f"><span>3055</span></td><td id="LC3055" class="css-1dcdqdg"><code>      <span class="code-comment">// Fetch captions and inject as blobs instead (data URIs not supported!)</span>
</code></td></tr><tr><td id="L3056" class="css-a4x74f"><span>3056</span></td><td id="LC3056" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (browser.isIE &amp;&amp; <span class="code-built_in">window</span>.URL) {
</code></td></tr><tr><td id="L3057" class="css-a4x74f"><span>3057</span></td><td id="LC3057" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> elements = <span class="code-keyword">this</span>.media.querySelectorAll(<span class="code-string">'track'</span>);
</code></td></tr><tr><td id="L3058" class="css-a4x74f"><span>3058</span></td><td id="LC3058" class="css-1dcdqdg"><code>        <span class="code-built_in">Array</span>.from(elements).forEach(<span class="code-function"><span class="code-params">track</span> =&gt;</span> {
</code></td></tr><tr><td id="L3059" class="css-a4x74f"><span>3059</span></td><td id="LC3059" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> src = track.getAttribute(<span class="code-string">'src'</span>);
</code></td></tr><tr><td id="L3060" class="css-a4x74f"><span>3060</span></td><td id="LC3060" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> url = parseUrl(src);
</code></td></tr><tr><td id="L3061" class="css-a4x74f"><span>3061</span></td><td id="LC3061" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (url !== <span class="code-literal">null</span> &amp;&amp; url.hostname !== <span class="code-built_in">window</span>.location.href.hostname &amp;&amp; [<span class="code-string">'http:'</span>, <span class="code-string">'https:'</span>].includes(url.protocol)) {
</code></td></tr><tr><td id="L3062" class="css-a4x74f"><span>3062</span></td><td id="LC3062" class="css-1dcdqdg"><code>            fetch(src, <span class="code-string">'blob'</span>).then(<span class="code-function"><span class="code-params">blob</span> =&gt;</span> {
</code></td></tr><tr><td id="L3063" class="css-a4x74f"><span>3063</span></td><td id="LC3063" class="css-1dcdqdg"><code>              track.setAttribute(<span class="code-string">'src'</span>, <span class="code-built_in">window</span>.URL.createObjectURL(blob));
</code></td></tr><tr><td id="L3064" class="css-a4x74f"><span>3064</span></td><td id="LC3064" class="css-1dcdqdg"><code>            }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L3065" class="css-a4x74f"><span>3065</span></td><td id="LC3065" class="css-1dcdqdg"><code>              removeElement(track);
</code></td></tr><tr><td id="L3066" class="css-a4x74f"><span>3066</span></td><td id="LC3066" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L3067" class="css-a4x74f"><span>3067</span></td><td id="LC3067" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3068" class="css-a4x74f"><span>3068</span></td><td id="LC3068" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L3069" class="css-a4x74f"><span>3069</span></td><td id="LC3069" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3070" class="css-a4x74f"><span>3070</span></td><td id="LC3070" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3071" class="css-a4x74f"><span>3071</span></td><td id="LC3071" class="css-1dcdqdg"><code>      <span class="code-comment">// Get and set initial data</span>
</code></td></tr><tr><td id="L3072" class="css-a4x74f"><span>3072</span></td><td id="LC3072" class="css-1dcdqdg"><code>      <span class="code-comment">// The "preferred" options are not realized unless / until the wanted language has a match</span>
</code></td></tr><tr><td id="L3073" class="css-a4x74f"><span>3073</span></td><td id="LC3073" class="css-1dcdqdg"><code>      <span class="code-comment">// * languages: Array of user's browser languages.</span>
</code></td></tr><tr><td id="L3074" class="css-a4x74f"><span>3074</span></td><td id="LC3074" class="css-1dcdqdg"><code>      <span class="code-comment">// * language:  The language preferred by user settings or config</span>
</code></td></tr><tr><td id="L3075" class="css-a4x74f"><span>3075</span></td><td id="LC3075" class="css-1dcdqdg"><code>      <span class="code-comment">// * active:    The state preferred by user settings or config</span>
</code></td></tr><tr><td id="L3076" class="css-a4x74f"><span>3076</span></td><td id="LC3076" class="css-1dcdqdg"><code>      <span class="code-comment">// * toggled:   The real captions state</span>
</code></td></tr><tr><td id="L3077" class="css-a4x74f"><span>3077</span></td><td id="LC3077" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3078" class="css-a4x74f"><span>3078</span></td><td id="LC3078" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> browserLanguages = navigator.languages || [navigator.language || navigator.userLanguage || <span class="code-string">'en'</span>];
</code></td></tr><tr><td id="L3079" class="css-a4x74f"><span>3079</span></td><td id="LC3079" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> languages = dedupe(browserLanguages.map(<span class="code-function"><span class="code-params">language</span> =&gt;</span> language.split(<span class="code-string">'-'</span>)[<span class="code-number">0</span>]));
</code></td></tr><tr><td id="L3080" class="css-a4x74f"><span>3080</span></td><td id="LC3080" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> language = (<span class="code-keyword">this</span>.storage.get(<span class="code-string">'language'</span>) || <span class="code-keyword">this</span>.config.captions.language || <span class="code-string">'auto'</span>).toLowerCase();
</code></td></tr><tr><td id="L3081" class="css-a4x74f"><span>3081</span></td><td id="LC3081" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3082" class="css-a4x74f"><span>3082</span></td><td id="LC3082" class="css-1dcdqdg"><code>      <span class="code-comment">// Use first browser language when language is 'auto'</span>
</code></td></tr><tr><td id="L3083" class="css-a4x74f"><span>3083</span></td><td id="LC3083" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (language === <span class="code-string">'auto'</span>) {
</code></td></tr><tr><td id="L3084" class="css-a4x74f"><span>3084</span></td><td id="LC3084" class="css-1dcdqdg"><code>        [language] = languages;
</code></td></tr><tr><td id="L3085" class="css-a4x74f"><span>3085</span></td><td id="LC3085" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3086" class="css-a4x74f"><span>3086</span></td><td id="LC3086" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> active = <span class="code-keyword">this</span>.storage.get(<span class="code-string">'captions'</span>);
</code></td></tr><tr><td id="L3087" class="css-a4x74f"><span>3087</span></td><td id="LC3087" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.boolean(active)) {
</code></td></tr><tr><td id="L3088" class="css-a4x74f"><span>3088</span></td><td id="LC3088" class="css-1dcdqdg"><code>        ({
</code></td></tr><tr><td id="L3089" class="css-a4x74f"><span>3089</span></td><td id="LC3089" class="css-1dcdqdg"><code>          active
</code></td></tr><tr><td id="L3090" class="css-a4x74f"><span>3090</span></td><td id="LC3090" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.config.captions);
</code></td></tr><tr><td id="L3091" class="css-a4x74f"><span>3091</span></td><td id="LC3091" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3092" class="css-a4x74f"><span>3092</span></td><td id="LC3092" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.assign(<span class="code-keyword">this</span>.captions, {
</code></td></tr><tr><td id="L3093" class="css-a4x74f"><span>3093</span></td><td id="LC3093" class="css-1dcdqdg"><code>        toggled: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3094" class="css-a4x74f"><span>3094</span></td><td id="LC3094" class="css-1dcdqdg"><code>        active,
</code></td></tr><tr><td id="L3095" class="css-a4x74f"><span>3095</span></td><td id="LC3095" class="css-1dcdqdg"><code>        language,
</code></td></tr><tr><td id="L3096" class="css-a4x74f"><span>3096</span></td><td id="LC3096" class="css-1dcdqdg"><code>        languages
</code></td></tr><tr><td id="L3097" class="css-a4x74f"><span>3097</span></td><td id="LC3097" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3098" class="css-a4x74f"><span>3098</span></td><td id="LC3098" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3099" class="css-a4x74f"><span>3099</span></td><td id="LC3099" class="css-1dcdqdg"><code>      <span class="code-comment">// Watch changes to textTracks and update captions menu</span>
</code></td></tr><tr><td id="L3100" class="css-a4x74f"><span>3100</span></td><td id="LC3100" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L3101" class="css-a4x74f"><span>3101</span></td><td id="LC3101" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> trackEvents = <span class="code-keyword">this</span>.config.captions.update ? <span class="code-string">'addtrack removetrack'</span> : <span class="code-string">'removetrack'</span>;
</code></td></tr><tr><td id="L3102" class="css-a4x74f"><span>3102</span></td><td id="LC3102" class="css-1dcdqdg"><code>        on.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media.textTracks, trackEvents, captions.update.bind(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L3103" class="css-a4x74f"><span>3103</span></td><td id="LC3103" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3104" class="css-a4x74f"><span>3104</span></td><td id="LC3104" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3105" class="css-a4x74f"><span>3105</span></td><td id="LC3105" class="css-1dcdqdg"><code>      <span class="code-comment">// Update available languages in list next tick (the event must not be triggered before the listeners)</span>
</code></td></tr><tr><td id="L3106" class="css-a4x74f"><span>3106</span></td><td id="LC3106" class="css-1dcdqdg"><code>      setTimeout(captions.update.bind(<span class="code-keyword">this</span>), <span class="code-number">0</span>);
</code></td></tr><tr><td id="L3107" class="css-a4x74f"><span>3107</span></td><td id="LC3107" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3108" class="css-a4x74f"><span>3108</span></td><td id="LC3108" class="css-1dcdqdg"><code>    <span class="code-comment">// Update available language options in settings based on tracks</span>
</code></td></tr><tr><td id="L3109" class="css-a4x74f"><span>3109</span></td><td id="LC3109" class="css-1dcdqdg"><code>    update() {
</code></td></tr><tr><td id="L3110" class="css-a4x74f"><span>3110</span></td><td id="LC3110" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L3111" class="css-a4x74f"><span>3111</span></td><td id="LC3111" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the wanted language</span>
</code></td></tr><tr><td id="L3112" class="css-a4x74f"><span>3112</span></td><td id="LC3112" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L3113" class="css-a4x74f"><span>3113</span></td><td id="LC3113" class="css-1dcdqdg"><code>        active,
</code></td></tr><tr><td id="L3114" class="css-a4x74f"><span>3114</span></td><td id="LC3114" class="css-1dcdqdg"><code>        language,
</code></td></tr><tr><td id="L3115" class="css-a4x74f"><span>3115</span></td><td id="LC3115" class="css-1dcdqdg"><code>        meta,
</code></td></tr><tr><td id="L3116" class="css-a4x74f"><span>3116</span></td><td id="LC3116" class="css-1dcdqdg"><code>        currentTrackNode
</code></td></tr><tr><td id="L3117" class="css-a4x74f"><span>3117</span></td><td id="LC3117" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.captions;
</code></td></tr><tr><td id="L3118" class="css-a4x74f"><span>3118</span></td><td id="LC3118" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> languageExists = <span class="code-built_in">Boolean</span>(tracks.find(<span class="code-function"><span class="code-params">track</span> =&gt;</span> track.language === language));
</code></td></tr><tr><td id="L3119" class="css-a4x74f"><span>3119</span></td><td id="LC3119" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3120" class="css-a4x74f"><span>3120</span></td><td id="LC3120" class="css-1dcdqdg"><code>      <span class="code-comment">// Handle tracks (add event listener and "pseudo"-default)</span>
</code></td></tr><tr><td id="L3121" class="css-a4x74f"><span>3121</span></td><td id="LC3121" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L3122" class="css-a4x74f"><span>3122</span></td><td id="LC3122" class="css-1dcdqdg"><code>        tracks.filter(<span class="code-function"><span class="code-params">track</span> =&gt;</span> !meta.get(track)).forEach(<span class="code-function"><span class="code-params">track</span> =&gt;</span> {
</code></td></tr><tr><td id="L3123" class="css-a4x74f"><span>3123</span></td><td id="LC3123" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.log(<span class="code-string">'Track added'</span>, track);
</code></td></tr><tr><td id="L3124" class="css-a4x74f"><span>3124</span></td><td id="LC3124" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3125" class="css-a4x74f"><span>3125</span></td><td id="LC3125" class="css-1dcdqdg"><code>          <span class="code-comment">// Attempt to store if the original dom element was "default"</span>
</code></td></tr><tr><td id="L3126" class="css-a4x74f"><span>3126</span></td><td id="LC3126" class="css-1dcdqdg"><code>          meta.set(track, {
</code></td></tr><tr><td id="L3127" class="css-a4x74f"><span>3127</span></td><td id="LC3127" class="css-1dcdqdg"><code>            <span class="code-keyword">default</span>: track.mode === <span class="code-string">'showing'</span>
</code></td></tr><tr><td id="L3128" class="css-a4x74f"><span>3128</span></td><td id="LC3128" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L3129" class="css-a4x74f"><span>3129</span></td><td id="LC3129" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3130" class="css-a4x74f"><span>3130</span></td><td id="LC3130" class="css-1dcdqdg"><code>          <span class="code-comment">// Turn off native caption rendering to avoid double captions</span>
</code></td></tr><tr><td id="L3131" class="css-a4x74f"><span>3131</span></td><td id="LC3131" class="css-1dcdqdg"><code>          <span class="code-comment">// Note: mode='hidden' forces a track to download. To ensure every track</span>
</code></td></tr><tr><td id="L3132" class="css-a4x74f"><span>3132</span></td><td id="LC3132" class="css-1dcdqdg"><code>          <span class="code-comment">// isn't downloaded at once, only 'showing' tracks should be reassigned</span>
</code></td></tr><tr><td id="L3133" class="css-a4x74f"><span>3133</span></td><td id="LC3133" class="css-1dcdqdg"><code>          <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L3134" class="css-a4x74f"><span>3134</span></td><td id="LC3134" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (track.mode === <span class="code-string">'showing'</span>) {
</code></td></tr><tr><td id="L3135" class="css-a4x74f"><span>3135</span></td><td id="LC3135" class="css-1dcdqdg"><code>            <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L3136" class="css-a4x74f"><span>3136</span></td><td id="LC3136" class="css-1dcdqdg"><code>            track.mode = <span class="code-string">'hidden'</span>;
</code></td></tr><tr><td id="L3137" class="css-a4x74f"><span>3137</span></td><td id="LC3137" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3138" class="css-a4x74f"><span>3138</span></td><td id="LC3138" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3139" class="css-a4x74f"><span>3139</span></td><td id="LC3139" class="css-1dcdqdg"><code>          <span class="code-comment">// Add event listener for cue changes</span>
</code></td></tr><tr><td id="L3140" class="css-a4x74f"><span>3140</span></td><td id="LC3140" class="css-1dcdqdg"><code>          on.call(<span class="code-keyword">this</span>, track, <span class="code-string">'cuechange'</span>, () =&gt; captions.updateCues.call(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L3141" class="css-a4x74f"><span>3141</span></td><td id="LC3141" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L3142" class="css-a4x74f"><span>3142</span></td><td id="LC3142" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3143" class="css-a4x74f"><span>3143</span></td><td id="LC3143" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3144" class="css-a4x74f"><span>3144</span></td><td id="LC3144" class="css-1dcdqdg"><code>      <span class="code-comment">// Update language first time it matches, or if the previous matching track was removed</span>
</code></td></tr><tr><td id="L3145" class="css-a4x74f"><span>3145</span></td><td id="LC3145" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (languageExists &amp;&amp; <span class="code-keyword">this</span>.language !== language || !tracks.includes(currentTrackNode)) {
</code></td></tr><tr><td id="L3146" class="css-a4x74f"><span>3146</span></td><td id="LC3146" class="css-1dcdqdg"><code>        captions.setLanguage.call(<span class="code-keyword">this</span>, language);
</code></td></tr><tr><td id="L3147" class="css-a4x74f"><span>3147</span></td><td id="LC3147" class="css-1dcdqdg"><code>        captions.toggle.call(<span class="code-keyword">this</span>, active &amp;&amp; languageExists);
</code></td></tr><tr><td id="L3148" class="css-a4x74f"><span>3148</span></td><td id="LC3148" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3149" class="css-a4x74f"><span>3149</span></td><td id="LC3149" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3150" class="css-a4x74f"><span>3150</span></td><td id="LC3150" class="css-1dcdqdg"><code>      <span class="code-comment">// Enable or disable captions based on track length</span>
</code></td></tr><tr><td id="L3151" class="css-a4x74f"><span>3151</span></td><td id="LC3151" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements) {
</code></td></tr><tr><td id="L3152" class="css-a4x74f"><span>3152</span></td><td id="LC3152" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.captions.enabled, !is.empty(tracks));
</code></td></tr><tr><td id="L3153" class="css-a4x74f"><span>3153</span></td><td id="LC3153" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3154" class="css-a4x74f"><span>3154</span></td><td id="LC3154" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3155" class="css-a4x74f"><span>3155</span></td><td id="LC3155" class="css-1dcdqdg"><code>      <span class="code-comment">// Update available languages in list</span>
</code></td></tr><tr><td id="L3156" class="css-a4x74f"><span>3156</span></td><td id="LC3156" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.array(<span class="code-keyword">this</span>.config.controls) &amp;&amp; <span class="code-keyword">this</span>.config.controls.includes(<span class="code-string">'settings'</span>) &amp;&amp; <span class="code-keyword">this</span>.config.settings.includes(<span class="code-string">'captions'</span>)) {
</code></td></tr><tr><td id="L3157" class="css-a4x74f"><span>3157</span></td><td id="LC3157" class="css-1dcdqdg"><code>        controls.setCaptionsMenu.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3158" class="css-a4x74f"><span>3158</span></td><td id="LC3158" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3159" class="css-a4x74f"><span>3159</span></td><td id="LC3159" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3160" class="css-a4x74f"><span>3160</span></td><td id="LC3160" class="css-1dcdqdg"><code>    <span class="code-comment">// Toggle captions display</span>
</code></td></tr><tr><td id="L3161" class="css-a4x74f"><span>3161</span></td><td id="LC3161" class="css-1dcdqdg"><code>    <span class="code-comment">// Used internally for the toggleCaptions method, with the passive option forced to false</span>
</code></td></tr><tr><td id="L3162" class="css-a4x74f"><span>3162</span></td><td id="LC3162" class="css-1dcdqdg"><code>    toggle(input, passive = <span class="code-literal">true</span>) {
</code></td></tr><tr><td id="L3163" class="css-a4x74f"><span>3163</span></td><td id="LC3163" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's no full support</span>
</code></td></tr><tr><td id="L3164" class="css-a4x74f"><span>3164</span></td><td id="LC3164" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L3165" class="css-a4x74f"><span>3165</span></td><td id="LC3165" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3166" class="css-a4x74f"><span>3166</span></td><td id="LC3166" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3167" class="css-a4x74f"><span>3167</span></td><td id="LC3167" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L3168" class="css-a4x74f"><span>3168</span></td><td id="LC3168" class="css-1dcdqdg"><code>        toggled
</code></td></tr><tr><td id="L3169" class="css-a4x74f"><span>3169</span></td><td id="LC3169" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.captions; <span class="code-comment">// Current state</span>
</code></td></tr><tr><td id="L3170" class="css-a4x74f"><span>3170</span></td><td id="LC3170" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> activeClass = <span class="code-keyword">this</span>.config.classNames.captions.active;
</code></td></tr><tr><td id="L3171" class="css-a4x74f"><span>3171</span></td><td id="LC3171" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the next state</span>
</code></td></tr><tr><td id="L3172" class="css-a4x74f"><span>3172</span></td><td id="LC3172" class="css-1dcdqdg"><code>      <span class="code-comment">// If the method is called without parameter, toggle based on current value</span>
</code></td></tr><tr><td id="L3173" class="css-a4x74f"><span>3173</span></td><td id="LC3173" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> active = is.nullOrUndefined(input) ? !toggled : input;
</code></td></tr><tr><td id="L3174" class="css-a4x74f"><span>3174</span></td><td id="LC3174" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3175" class="css-a4x74f"><span>3175</span></td><td id="LC3175" class="css-1dcdqdg"><code>      <span class="code-comment">// Update state and trigger event</span>
</code></td></tr><tr><td id="L3176" class="css-a4x74f"><span>3176</span></td><td id="LC3176" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (active !== toggled) {
</code></td></tr><tr><td id="L3177" class="css-a4x74f"><span>3177</span></td><td id="LC3177" class="css-1dcdqdg"><code>        <span class="code-comment">// When passive, don't override user preferences</span>
</code></td></tr><tr><td id="L3178" class="css-a4x74f"><span>3178</span></td><td id="LC3178" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!passive) {
</code></td></tr><tr><td id="L3179" class="css-a4x74f"><span>3179</span></td><td id="LC3179" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.captions.active = active;
</code></td></tr><tr><td id="L3180" class="css-a4x74f"><span>3180</span></td><td id="LC3180" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.storage.set({
</code></td></tr><tr><td id="L3181" class="css-a4x74f"><span>3181</span></td><td id="LC3181" class="css-1dcdqdg"><code>            captions: active
</code></td></tr><tr><td id="L3182" class="css-a4x74f"><span>3182</span></td><td id="LC3182" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L3183" class="css-a4x74f"><span>3183</span></td><td id="LC3183" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3184" class="css-a4x74f"><span>3184</span></td><td id="LC3184" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3185" class="css-a4x74f"><span>3185</span></td><td id="LC3185" class="css-1dcdqdg"><code>        <span class="code-comment">// Force language if the call isn't passive and there is no matching language to toggle to</span>
</code></td></tr><tr><td id="L3186" class="css-a4x74f"><span>3186</span></td><td id="LC3186" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.language &amp;&amp; active &amp;&amp; !passive) {
</code></td></tr><tr><td id="L3187" class="css-a4x74f"><span>3187</span></td><td id="LC3187" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3188" class="css-a4x74f"><span>3188</span></td><td id="LC3188" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> track = captions.findTrack.call(<span class="code-keyword">this</span>, [<span class="code-keyword">this</span>.captions.language, ...this.captions.languages], <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L3189" class="css-a4x74f"><span>3189</span></td><td id="LC3189" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3190" class="css-a4x74f"><span>3190</span></td><td id="LC3190" class="css-1dcdqdg"><code>          <span class="code-comment">// Override user preferences to avoid switching languages if a matching track is added</span>
</code></td></tr><tr><td id="L3191" class="css-a4x74f"><span>3191</span></td><td id="LC3191" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.captions.language = track.language;
</code></td></tr><tr><td id="L3192" class="css-a4x74f"><span>3192</span></td><td id="LC3192" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3193" class="css-a4x74f"><span>3193</span></td><td id="LC3193" class="css-1dcdqdg"><code>          <span class="code-comment">// Set caption, but don't store in localStorage as user preference</span>
</code></td></tr><tr><td id="L3194" class="css-a4x74f"><span>3194</span></td><td id="LC3194" class="css-1dcdqdg"><code>          captions.set.call(<span class="code-keyword">this</span>, tracks.indexOf(track));
</code></td></tr><tr><td id="L3195" class="css-a4x74f"><span>3195</span></td><td id="LC3195" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3196" class="css-a4x74f"><span>3196</span></td><td id="LC3196" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3197" class="css-a4x74f"><span>3197</span></td><td id="LC3197" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3198" class="css-a4x74f"><span>3198</span></td><td id="LC3198" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle button if it's enabled</span>
</code></td></tr><tr><td id="L3199" class="css-a4x74f"><span>3199</span></td><td id="LC3199" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements.buttons.captions) {
</code></td></tr><tr><td id="L3200" class="css-a4x74f"><span>3200</span></td><td id="LC3200" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.buttons.captions.pressed = active;
</code></td></tr><tr><td id="L3201" class="css-a4x74f"><span>3201</span></td><td id="LC3201" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3202" class="css-a4x74f"><span>3202</span></td><td id="LC3202" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3203" class="css-a4x74f"><span>3203</span></td><td id="LC3203" class="css-1dcdqdg"><code>        <span class="code-comment">// Add class hook</span>
</code></td></tr><tr><td id="L3204" class="css-a4x74f"><span>3204</span></td><td id="LC3204" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.elements.container, activeClass, active);
</code></td></tr><tr><td id="L3205" class="css-a4x74f"><span>3205</span></td><td id="LC3205" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.captions.toggled = active;
</code></td></tr><tr><td id="L3206" class="css-a4x74f"><span>3206</span></td><td id="LC3206" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3207" class="css-a4x74f"><span>3207</span></td><td id="LC3207" class="css-1dcdqdg"><code>        <span class="code-comment">// Update settings menu</span>
</code></td></tr><tr><td id="L3208" class="css-a4x74f"><span>3208</span></td><td id="LC3208" class="css-1dcdqdg"><code>        controls.updateSetting.call(<span class="code-keyword">this</span>, <span class="code-string">'captions'</span>);
</code></td></tr><tr><td id="L3209" class="css-a4x74f"><span>3209</span></td><td id="LC3209" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3210" class="css-a4x74f"><span>3210</span></td><td id="LC3210" class="css-1dcdqdg"><code>        <span class="code-comment">// Trigger event (not used internally)</span>
</code></td></tr><tr><td id="L3211" class="css-a4x74f"><span>3211</span></td><td id="LC3211" class="css-1dcdqdg"><code>        triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, active ? <span class="code-string">'captionsenabled'</span> : <span class="code-string">'captionsdisabled'</span>);
</code></td></tr><tr><td id="L3212" class="css-a4x74f"><span>3212</span></td><td id="LC3212" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3213" class="css-a4x74f"><span>3213</span></td><td id="LC3213" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3214" class="css-a4x74f"><span>3214</span></td><td id="LC3214" class="css-1dcdqdg"><code>      <span class="code-comment">// Wait for the call stack to clear before setting mode='hidden'</span>
</code></td></tr><tr><td id="L3215" class="css-a4x74f"><span>3215</span></td><td id="LC3215" class="css-1dcdqdg"><code>      <span class="code-comment">// on the active track - forcing the browser to download it</span>
</code></td></tr><tr><td id="L3216" class="css-a4x74f"><span>3216</span></td><td id="LC3216" class="css-1dcdqdg"><code>      setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L3217" class="css-a4x74f"><span>3217</span></td><td id="LC3217" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (active &amp;&amp; <span class="code-keyword">this</span>.captions.toggled) {
</code></td></tr><tr><td id="L3218" class="css-a4x74f"><span>3218</span></td><td id="LC3218" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.captions.currentTrackNode.mode = <span class="code-string">'hidden'</span>;
</code></td></tr><tr><td id="L3219" class="css-a4x74f"><span>3219</span></td><td id="LC3219" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3220" class="css-a4x74f"><span>3220</span></td><td id="LC3220" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3221" class="css-a4x74f"><span>3221</span></td><td id="LC3221" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3222" class="css-a4x74f"><span>3222</span></td><td id="LC3222" class="css-1dcdqdg"><code>    <span class="code-comment">// Set captions by track index</span>
</code></td></tr><tr><td id="L3223" class="css-a4x74f"><span>3223</span></td><td id="LC3223" class="css-1dcdqdg"><code>    <span class="code-comment">// Used internally for the currentTrack setter with the passive option forced to false</span>
</code></td></tr><tr><td id="L3224" class="css-a4x74f"><span>3224</span></td><td id="LC3224" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span>(index, passive = true) {
</code></td></tr><tr><td id="L3225" class="css-a4x74f"><span>3225</span></td><td id="LC3225" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3226" class="css-a4x74f"><span>3226</span></td><td id="LC3226" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3227" class="css-a4x74f"><span>3227</span></td><td id="LC3227" class="css-1dcdqdg"><code>      <span class="code-comment">// Disable captions if setting to -1</span>
</code></td></tr><tr><td id="L3228" class="css-a4x74f"><span>3228</span></td><td id="LC3228" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (index === <span class="code-number">-1</span>) {
</code></td></tr><tr><td id="L3229" class="css-a4x74f"><span>3229</span></td><td id="LC3229" class="css-1dcdqdg"><code>        captions.toggle.call(<span class="code-keyword">this</span>, <span class="code-literal">false</span>, passive);
</code></td></tr><tr><td id="L3230" class="css-a4x74f"><span>3230</span></td><td id="LC3230" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3231" class="css-a4x74f"><span>3231</span></td><td id="LC3231" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3232" class="css-a4x74f"><span>3232</span></td><td id="LC3232" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(index)) {
</code></td></tr><tr><td id="L3233" class="css-a4x74f"><span>3233</span></td><td id="LC3233" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Invalid caption argument'</span>, index);
</code></td></tr><tr><td id="L3234" class="css-a4x74f"><span>3234</span></td><td id="LC3234" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3235" class="css-a4x74f"><span>3235</span></td><td id="LC3235" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3236" class="css-a4x74f"><span>3236</span></td><td id="LC3236" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!(index <span class="code-keyword">in</span> tracks)) {
</code></td></tr><tr><td id="L3237" class="css-a4x74f"><span>3237</span></td><td id="LC3237" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Track not found'</span>, index);
</code></td></tr><tr><td id="L3238" class="css-a4x74f"><span>3238</span></td><td id="LC3238" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3239" class="css-a4x74f"><span>3239</span></td><td id="LC3239" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3240" class="css-a4x74f"><span>3240</span></td><td id="LC3240" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.captions.currentTrack !== index) {
</code></td></tr><tr><td id="L3241" class="css-a4x74f"><span>3241</span></td><td id="LC3241" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.captions.currentTrack = index;
</code></td></tr><tr><td id="L3242" class="css-a4x74f"><span>3242</span></td><td id="LC3242" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> track = tracks[index];
</code></td></tr><tr><td id="L3243" class="css-a4x74f"><span>3243</span></td><td id="LC3243" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L3244" class="css-a4x74f"><span>3244</span></td><td id="LC3244" class="css-1dcdqdg"><code>          language
</code></td></tr><tr><td id="L3245" class="css-a4x74f"><span>3245</span></td><td id="LC3245" class="css-1dcdqdg"><code>        } = track || {};
</code></td></tr><tr><td id="L3246" class="css-a4x74f"><span>3246</span></td><td id="LC3246" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3247" class="css-a4x74f"><span>3247</span></td><td id="LC3247" class="css-1dcdqdg"><code>        <span class="code-comment">// Store reference to node for invalidation on remove</span>
</code></td></tr><tr><td id="L3248" class="css-a4x74f"><span>3248</span></td><td id="LC3248" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.captions.currentTrackNode = track;
</code></td></tr><tr><td id="L3249" class="css-a4x74f"><span>3249</span></td><td id="LC3249" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3250" class="css-a4x74f"><span>3250</span></td><td id="LC3250" class="css-1dcdqdg"><code>        <span class="code-comment">// Update settings menu</span>
</code></td></tr><tr><td id="L3251" class="css-a4x74f"><span>3251</span></td><td id="LC3251" class="css-1dcdqdg"><code>        controls.updateSetting.call(<span class="code-keyword">this</span>, <span class="code-string">'captions'</span>);
</code></td></tr><tr><td id="L3252" class="css-a4x74f"><span>3252</span></td><td id="LC3252" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3253" class="css-a4x74f"><span>3253</span></td><td id="LC3253" class="css-1dcdqdg"><code>        <span class="code-comment">// When passive, don't override user preferences</span>
</code></td></tr><tr><td id="L3254" class="css-a4x74f"><span>3254</span></td><td id="LC3254" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!passive) {
</code></td></tr><tr><td id="L3255" class="css-a4x74f"><span>3255</span></td><td id="LC3255" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.captions.language = language;
</code></td></tr><tr><td id="L3256" class="css-a4x74f"><span>3256</span></td><td id="LC3256" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.storage.set({
</code></td></tr><tr><td id="L3257" class="css-a4x74f"><span>3257</span></td><td id="LC3257" class="css-1dcdqdg"><code>            language
</code></td></tr><tr><td id="L3258" class="css-a4x74f"><span>3258</span></td><td id="LC3258" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L3259" class="css-a4x74f"><span>3259</span></td><td id="LC3259" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3260" class="css-a4x74f"><span>3260</span></td><td id="LC3260" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3261" class="css-a4x74f"><span>3261</span></td><td id="LC3261" class="css-1dcdqdg"><code>        <span class="code-comment">// Handle Vimeo captions</span>
</code></td></tr><tr><td id="L3262" class="css-a4x74f"><span>3262</span></td><td id="LC3262" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo) {
</code></td></tr><tr><td id="L3263" class="css-a4x74f"><span>3263</span></td><td id="LC3263" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.embed.enableTextTrack(language);
</code></td></tr><tr><td id="L3264" class="css-a4x74f"><span>3264</span></td><td id="LC3264" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3265" class="css-a4x74f"><span>3265</span></td><td id="LC3265" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3266" class="css-a4x74f"><span>3266</span></td><td id="LC3266" class="css-1dcdqdg"><code>        <span class="code-comment">// Trigger event</span>
</code></td></tr><tr><td id="L3267" class="css-a4x74f"><span>3267</span></td><td id="LC3267" class="css-1dcdqdg"><code>        triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, <span class="code-string">'languagechange'</span>);
</code></td></tr><tr><td id="L3268" class="css-a4x74f"><span>3268</span></td><td id="LC3268" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3269" class="css-a4x74f"><span>3269</span></td><td id="LC3269" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3270" class="css-a4x74f"><span>3270</span></td><td id="LC3270" class="css-1dcdqdg"><code>      <span class="code-comment">// Show captions</span>
</code></td></tr><tr><td id="L3271" class="css-a4x74f"><span>3271</span></td><td id="LC3271" class="css-1dcdqdg"><code>      captions.toggle.call(<span class="code-keyword">this</span>, <span class="code-literal">true</span>, passive);
</code></td></tr><tr><td id="L3272" class="css-a4x74f"><span>3272</span></td><td id="LC3272" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L3273" class="css-a4x74f"><span>3273</span></td><td id="LC3273" class="css-1dcdqdg"><code>        <span class="code-comment">// If we change the active track while a cue is already displayed we need to update it</span>
</code></td></tr><tr><td id="L3274" class="css-a4x74f"><span>3274</span></td><td id="LC3274" class="css-1dcdqdg"><code>        captions.updateCues.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3275" class="css-a4x74f"><span>3275</span></td><td id="LC3275" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3276" class="css-a4x74f"><span>3276</span></td><td id="LC3276" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3277" class="css-a4x74f"><span>3277</span></td><td id="LC3277" class="css-1dcdqdg"><code>    <span class="code-comment">// Set captions by language</span>
</code></td></tr><tr><td id="L3278" class="css-a4x74f"><span>3278</span></td><td id="LC3278" class="css-1dcdqdg"><code>    <span class="code-comment">// Used internally for the language setter with the passive option forced to false</span>
</code></td></tr><tr><td id="L3279" class="css-a4x74f"><span>3279</span></td><td id="LC3279" class="css-1dcdqdg"><code>    setLanguage(input, passive = <span class="code-literal">true</span>) {
</code></td></tr><tr><td id="L3280" class="css-a4x74f"><span>3280</span></td><td id="LC3280" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.string(input)) {
</code></td></tr><tr><td id="L3281" class="css-a4x74f"><span>3281</span></td><td id="LC3281" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Invalid language argument'</span>, input);
</code></td></tr><tr><td id="L3282" class="css-a4x74f"><span>3282</span></td><td id="LC3282" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3283" class="css-a4x74f"><span>3283</span></td><td id="LC3283" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3284" class="css-a4x74f"><span>3284</span></td><td id="LC3284" class="css-1dcdqdg"><code>      <span class="code-comment">// Normalize</span>
</code></td></tr><tr><td id="L3285" class="css-a4x74f"><span>3285</span></td><td id="LC3285" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> language = input.toLowerCase();
</code></td></tr><tr><td id="L3286" class="css-a4x74f"><span>3286</span></td><td id="LC3286" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.captions.language = language;
</code></td></tr><tr><td id="L3287" class="css-a4x74f"><span>3287</span></td><td id="LC3287" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3288" class="css-a4x74f"><span>3288</span></td><td id="LC3288" class="css-1dcdqdg"><code>      <span class="code-comment">// Set currentTrack</span>
</code></td></tr><tr><td id="L3289" class="css-a4x74f"><span>3289</span></td><td id="LC3289" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3290" class="css-a4x74f"><span>3290</span></td><td id="LC3290" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> track = captions.findTrack.call(<span class="code-keyword">this</span>, [language]);
</code></td></tr><tr><td id="L3291" class="css-a4x74f"><span>3291</span></td><td id="LC3291" class="css-1dcdqdg"><code>      captions.set.call(<span class="code-keyword">this</span>, tracks.indexOf(track), passive);
</code></td></tr><tr><td id="L3292" class="css-a4x74f"><span>3292</span></td><td id="LC3292" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3293" class="css-a4x74f"><span>3293</span></td><td id="LC3293" class="css-1dcdqdg"><code>    <span class="code-comment">// Get current valid caption tracks</span>
</code></td></tr><tr><td id="L3294" class="css-a4x74f"><span>3294</span></td><td id="LC3294" class="css-1dcdqdg"><code>    <span class="code-comment">// If update is false it will also ignore tracks without metadata</span>
</code></td></tr><tr><td id="L3295" class="css-a4x74f"><span>3295</span></td><td id="LC3295" class="css-1dcdqdg"><code>    <span class="code-comment">// This is used to "freeze" the language options when captions.update is false</span>
</code></td></tr><tr><td id="L3296" class="css-a4x74f"><span>3296</span></td><td id="LC3296" class="css-1dcdqdg"><code>    getTracks(update = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L3297" class="css-a4x74f"><span>3297</span></td><td id="LC3297" class="css-1dcdqdg"><code>      <span class="code-comment">// Handle media or textTracks missing or null</span>
</code></td></tr><tr><td id="L3298" class="css-a4x74f"><span>3298</span></td><td id="LC3298" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = <span class="code-built_in">Array</span>.from((<span class="code-keyword">this</span>.media || {}).textTracks || []);
</code></td></tr><tr><td id="L3299" class="css-a4x74f"><span>3299</span></td><td id="LC3299" class="css-1dcdqdg"><code>      <span class="code-comment">// For HTML5, use cache instead of current tracks when it exists (if captions.update is false)</span>
</code></td></tr><tr><td id="L3300" class="css-a4x74f"><span>3300</span></td><td id="LC3300" class="css-1dcdqdg"><code>      <span class="code-comment">// Filter out removed tracks and tracks that aren't captions/subtitles (for example metadata)</span>
</code></td></tr><tr><td id="L3301" class="css-a4x74f"><span>3301</span></td><td id="LC3301" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> tracks.filter(<span class="code-function"><span class="code-params">track</span> =&gt;</span> !<span class="code-keyword">this</span>.isHTML5 || update || <span class="code-keyword">this</span>.captions.meta.has(track)).filter(<span class="code-function"><span class="code-params">track</span> =&gt;</span> [<span class="code-string">'captions'</span>, <span class="code-string">'subtitles'</span>].includes(track.kind));
</code></td></tr><tr><td id="L3302" class="css-a4x74f"><span>3302</span></td><td id="LC3302" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3303" class="css-a4x74f"><span>3303</span></td><td id="LC3303" class="css-1dcdqdg"><code>    <span class="code-comment">// Match tracks based on languages and get the first</span>
</code></td></tr><tr><td id="L3304" class="css-a4x74f"><span>3304</span></td><td id="LC3304" class="css-1dcdqdg"><code>    findTrack(languages, force = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L3305" class="css-a4x74f"><span>3305</span></td><td id="LC3305" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> tracks = captions.getTracks.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3306" class="css-a4x74f"><span>3306</span></td><td id="LC3306" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> sortIsDefault = <span class="code-function"><span class="code-params">track</span> =&gt;</span> <span class="code-built_in">Number</span>((<span class="code-keyword">this</span>.captions.meta.get(track) || {}).default);
</code></td></tr><tr><td id="L3307" class="css-a4x74f"><span>3307</span></td><td id="LC3307" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> sorted = <span class="code-built_in">Array</span>.from(tracks).sort(<span class="code-function">(<span class="code-params">a, b</span>) =&gt;</span> sortIsDefault(b) - sortIsDefault(a));
</code></td></tr><tr><td id="L3308" class="css-a4x74f"><span>3308</span></td><td id="LC3308" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> track;
</code></td></tr><tr><td id="L3309" class="css-a4x74f"><span>3309</span></td><td id="LC3309" class="css-1dcdqdg"><code>      languages.every(<span class="code-function"><span class="code-params">language</span> =&gt;</span> {
</code></td></tr><tr><td id="L3310" class="css-a4x74f"><span>3310</span></td><td id="LC3310" class="css-1dcdqdg"><code>        track = sorted.find(<span class="code-function"><span class="code-params">t</span> =&gt;</span> t.language === language);
</code></td></tr><tr><td id="L3311" class="css-a4x74f"><span>3311</span></td><td id="LC3311" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> !track; <span class="code-comment">// Break iteration if there is a match</span>
</code></td></tr><tr><td id="L3312" class="css-a4x74f"><span>3312</span></td><td id="LC3312" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3313" class="css-a4x74f"><span>3313</span></td><td id="LC3313" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3314" class="css-a4x74f"><span>3314</span></td><td id="LC3314" class="css-1dcdqdg"><code>      <span class="code-comment">// If no match is found but is required, get first</span>
</code></td></tr><tr><td id="L3315" class="css-a4x74f"><span>3315</span></td><td id="LC3315" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> track || (force ? sorted[<span class="code-number">0</span>] : <span class="code-literal">undefined</span>);
</code></td></tr><tr><td id="L3316" class="css-a4x74f"><span>3316</span></td><td id="LC3316" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3317" class="css-a4x74f"><span>3317</span></td><td id="LC3317" class="css-1dcdqdg"><code>    <span class="code-comment">// Get the current track</span>
</code></td></tr><tr><td id="L3318" class="css-a4x74f"><span>3318</span></td><td id="LC3318" class="css-1dcdqdg"><code>    getCurrentTrack() {
</code></td></tr><tr><td id="L3319" class="css-a4x74f"><span>3319</span></td><td id="LC3319" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> captions.getTracks.call(<span class="code-keyword">this</span>)[<span class="code-keyword">this</span>.currentTrack];
</code></td></tr><tr><td id="L3320" class="css-a4x74f"><span>3320</span></td><td id="LC3320" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3321" class="css-a4x74f"><span>3321</span></td><td id="LC3321" class="css-1dcdqdg"><code>    <span class="code-comment">// Get UI label for track</span>
</code></td></tr><tr><td id="L3322" class="css-a4x74f"><span>3322</span></td><td id="LC3322" class="css-1dcdqdg"><code>    getLabel(track) {
</code></td></tr><tr><td id="L3323" class="css-a4x74f"><span>3323</span></td><td id="LC3323" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> currentTrack = track;
</code></td></tr><tr><td id="L3324" class="css-a4x74f"><span>3324</span></td><td id="LC3324" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.track(currentTrack) &amp;&amp; support.textTracks &amp;&amp; <span class="code-keyword">this</span>.captions.toggled) {
</code></td></tr><tr><td id="L3325" class="css-a4x74f"><span>3325</span></td><td id="LC3325" class="css-1dcdqdg"><code>        currentTrack = captions.getCurrentTrack.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3326" class="css-a4x74f"><span>3326</span></td><td id="LC3326" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3327" class="css-a4x74f"><span>3327</span></td><td id="LC3327" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.track(currentTrack)) {
</code></td></tr><tr><td id="L3328" class="css-a4x74f"><span>3328</span></td><td id="LC3328" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.empty(currentTrack.label)) {
</code></td></tr><tr><td id="L3329" class="css-a4x74f"><span>3329</span></td><td id="LC3329" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> currentTrack.label;
</code></td></tr><tr><td id="L3330" class="css-a4x74f"><span>3330</span></td><td id="LC3330" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3331" class="css-a4x74f"><span>3331</span></td><td id="LC3331" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.empty(currentTrack.language)) {
</code></td></tr><tr><td id="L3332" class="css-a4x74f"><span>3332</span></td><td id="LC3332" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> track.language.toUpperCase();
</code></td></tr><tr><td id="L3333" class="css-a4x74f"><span>3333</span></td><td id="LC3333" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3334" class="css-a4x74f"><span>3334</span></td><td id="LC3334" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> i18n.get(<span class="code-string">'enabled'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L3335" class="css-a4x74f"><span>3335</span></td><td id="LC3335" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3336" class="css-a4x74f"><span>3336</span></td><td id="LC3336" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> i18n.get(<span class="code-string">'disabled'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L3337" class="css-a4x74f"><span>3337</span></td><td id="LC3337" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3338" class="css-a4x74f"><span>3338</span></td><td id="LC3338" class="css-1dcdqdg"><code>    <span class="code-comment">// Update captions using current track's active cues</span>
</code></td></tr><tr><td id="L3339" class="css-a4x74f"><span>3339</span></td><td id="LC3339" class="css-1dcdqdg"><code>    <span class="code-comment">// Also optional array argument in case there isn't any track (ex: vimeo)</span>
</code></td></tr><tr><td id="L3340" class="css-a4x74f"><span>3340</span></td><td id="LC3340" class="css-1dcdqdg"><code>    updateCues(input) {
</code></td></tr><tr><td id="L3341" class="css-a4x74f"><span>3341</span></td><td id="LC3341" class="css-1dcdqdg"><code>      <span class="code-comment">// Requires UI</span>
</code></td></tr><tr><td id="L3342" class="css-a4x74f"><span>3342</span></td><td id="LC3342" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L3343" class="css-a4x74f"><span>3343</span></td><td id="LC3343" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3344" class="css-a4x74f"><span>3344</span></td><td id="LC3344" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3345" class="css-a4x74f"><span>3345</span></td><td id="LC3345" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.captions)) {
</code></td></tr><tr><td id="L3346" class="css-a4x74f"><span>3346</span></td><td id="LC3346" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'No captions element to render to'</span>);
</code></td></tr><tr><td id="L3347" class="css-a4x74f"><span>3347</span></td><td id="LC3347" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3348" class="css-a4x74f"><span>3348</span></td><td id="LC3348" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3349" class="css-a4x74f"><span>3349</span></td><td id="LC3349" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3350" class="css-a4x74f"><span>3350</span></td><td id="LC3350" class="css-1dcdqdg"><code>      <span class="code-comment">// Only accept array or empty input</span>
</code></td></tr><tr><td id="L3351" class="css-a4x74f"><span>3351</span></td><td id="LC3351" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.nullOrUndefined(input) &amp;&amp; !<span class="code-built_in">Array</span>.isArray(input)) {
</code></td></tr><tr><td id="L3352" class="css-a4x74f"><span>3352</span></td><td id="LC3352" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'updateCues: Invalid input'</span>, input);
</code></td></tr><tr><td id="L3353" class="css-a4x74f"><span>3353</span></td><td id="LC3353" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3354" class="css-a4x74f"><span>3354</span></td><td id="LC3354" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3355" class="css-a4x74f"><span>3355</span></td><td id="LC3355" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> cues = input;
</code></td></tr><tr><td id="L3356" class="css-a4x74f"><span>3356</span></td><td id="LC3356" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3357" class="css-a4x74f"><span>3357</span></td><td id="LC3357" class="css-1dcdqdg"><code>      <span class="code-comment">// Get cues from track</span>
</code></td></tr><tr><td id="L3358" class="css-a4x74f"><span>3358</span></td><td id="LC3358" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!cues) {
</code></td></tr><tr><td id="L3359" class="css-a4x74f"><span>3359</span></td><td id="LC3359" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> track = captions.getCurrentTrack.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L3360" class="css-a4x74f"><span>3360</span></td><td id="LC3360" class="css-1dcdqdg"><code>        cues = <span class="code-built_in">Array</span>.from((track || {}).activeCues || []).map(<span class="code-function"><span class="code-params">cue</span> =&gt;</span> cue.getCueAsHTML()).map(getHTML);
</code></td></tr><tr><td id="L3361" class="css-a4x74f"><span>3361</span></td><td id="LC3361" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3362" class="css-a4x74f"><span>3362</span></td><td id="LC3362" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3363" class="css-a4x74f"><span>3363</span></td><td id="LC3363" class="css-1dcdqdg"><code>      <span class="code-comment">// Set new caption text</span>
</code></td></tr><tr><td id="L3364" class="css-a4x74f"><span>3364</span></td><td id="LC3364" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> content = cues.map(<span class="code-function"><span class="code-params">cueText</span> =&gt;</span> cueText.trim()).join(<span class="code-string">'\n'</span>);
</code></td></tr><tr><td id="L3365" class="css-a4x74f"><span>3365</span></td><td id="LC3365" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> changed = content !== <span class="code-keyword">this</span>.elements.captions.innerHTML;
</code></td></tr><tr><td id="L3366" class="css-a4x74f"><span>3366</span></td><td id="LC3366" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (changed) {
</code></td></tr><tr><td id="L3367" class="css-a4x74f"><span>3367</span></td><td id="LC3367" class="css-1dcdqdg"><code>        <span class="code-comment">// Empty the container and create a new child element</span>
</code></td></tr><tr><td id="L3368" class="css-a4x74f"><span>3368</span></td><td id="LC3368" class="css-1dcdqdg"><code>        emptyElement(<span class="code-keyword">this</span>.elements.captions);
</code></td></tr><tr><td id="L3369" class="css-a4x74f"><span>3369</span></td><td id="LC3369" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> caption = createElement(<span class="code-string">'span'</span>, getAttributesFromSelector(<span class="code-keyword">this</span>.config.selectors.caption));
</code></td></tr><tr><td id="L3370" class="css-a4x74f"><span>3370</span></td><td id="LC3370" class="css-1dcdqdg"><code>        caption.innerHTML = content;
</code></td></tr><tr><td id="L3371" class="css-a4x74f"><span>3371</span></td><td id="LC3371" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.captions.appendChild(caption);
</code></td></tr><tr><td id="L3372" class="css-a4x74f"><span>3372</span></td><td id="LC3372" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3373" class="css-a4x74f"><span>3373</span></td><td id="LC3373" class="css-1dcdqdg"><code>        <span class="code-comment">// Trigger event</span>
</code></td></tr><tr><td id="L3374" class="css-a4x74f"><span>3374</span></td><td id="LC3374" class="css-1dcdqdg"><code>        triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, <span class="code-string">'cuechange'</span>);
</code></td></tr><tr><td id="L3375" class="css-a4x74f"><span>3375</span></td><td id="LC3375" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3376" class="css-a4x74f"><span>3376</span></td><td id="LC3376" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3377" class="css-a4x74f"><span>3377</span></td><td id="LC3377" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L3378" class="css-a4x74f"><span>3378</span></td><td id="LC3378" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3379" class="css-a4x74f"><span>3379</span></td><td id="LC3379" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3380" class="css-a4x74f"><span>3380</span></td><td id="LC3380" class="css-1dcdqdg"><code>  <span class="code-comment">// Plyr default config</span>
</code></td></tr><tr><td id="L3381" class="css-a4x74f"><span>3381</span></td><td id="LC3381" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3382" class="css-a4x74f"><span>3382</span></td><td id="LC3382" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3383" class="css-a4x74f"><span>3383</span></td><td id="LC3383" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> defaults = {
</code></td></tr><tr><td id="L3384" class="css-a4x74f"><span>3384</span></td><td id="LC3384" class="css-1dcdqdg"><code>    <span class="code-comment">// Disable</span>
</code></td></tr><tr><td id="L3385" class="css-a4x74f"><span>3385</span></td><td id="LC3385" class="css-1dcdqdg"><code>    enabled: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3386" class="css-a4x74f"><span>3386</span></td><td id="LC3386" class="css-1dcdqdg"><code>    <span class="code-comment">// Custom media title</span>
</code></td></tr><tr><td id="L3387" class="css-a4x74f"><span>3387</span></td><td id="LC3387" class="css-1dcdqdg"><code>    title: <span class="code-string">''</span>,
</code></td></tr><tr><td id="L3388" class="css-a4x74f"><span>3388</span></td><td id="LC3388" class="css-1dcdqdg"><code>    <span class="code-comment">// Logging to console</span>
</code></td></tr><tr><td id="L3389" class="css-a4x74f"><span>3389</span></td><td id="LC3389" class="css-1dcdqdg"><code>    debug: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3390" class="css-a4x74f"><span>3390</span></td><td id="LC3390" class="css-1dcdqdg"><code>    <span class="code-comment">// Auto play (if supported)</span>
</code></td></tr><tr><td id="L3391" class="css-a4x74f"><span>3391</span></td><td id="LC3391" class="css-1dcdqdg"><code>    autoplay: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3392" class="css-a4x74f"><span>3392</span></td><td id="LC3392" class="css-1dcdqdg"><code>    <span class="code-comment">// Only allow one media playing at once (vimeo only)</span>
</code></td></tr><tr><td id="L3393" class="css-a4x74f"><span>3393</span></td><td id="LC3393" class="css-1dcdqdg"><code>    autopause: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3394" class="css-a4x74f"><span>3394</span></td><td id="LC3394" class="css-1dcdqdg"><code>    <span class="code-comment">// Allow inline playback on iOS</span>
</code></td></tr><tr><td id="L3395" class="css-a4x74f"><span>3395</span></td><td id="LC3395" class="css-1dcdqdg"><code>    playsinline: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3396" class="css-a4x74f"><span>3396</span></td><td id="LC3396" class="css-1dcdqdg"><code>    <span class="code-comment">// Default time to skip when rewind/fast forward</span>
</code></td></tr><tr><td id="L3397" class="css-a4x74f"><span>3397</span></td><td id="LC3397" class="css-1dcdqdg"><code>    seekTime: <span class="code-number">10</span>,
</code></td></tr><tr><td id="L3398" class="css-a4x74f"><span>3398</span></td><td id="LC3398" class="css-1dcdqdg"><code>    <span class="code-comment">// Default volume</span>
</code></td></tr><tr><td id="L3399" class="css-a4x74f"><span>3399</span></td><td id="LC3399" class="css-1dcdqdg"><code>    volume: <span class="code-number">1</span>,
</code></td></tr><tr><td id="L3400" class="css-a4x74f"><span>3400</span></td><td id="LC3400" class="css-1dcdqdg"><code>    muted: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3401" class="css-a4x74f"><span>3401</span></td><td id="LC3401" class="css-1dcdqdg"><code>    <span class="code-comment">// Pass a custom duration</span>
</code></td></tr><tr><td id="L3402" class="css-a4x74f"><span>3402</span></td><td id="LC3402" class="css-1dcdqdg"><code>    duration: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3403" class="css-a4x74f"><span>3403</span></td><td id="LC3403" class="css-1dcdqdg"><code>    <span class="code-comment">// Display the media duration on load in the current time position</span>
</code></td></tr><tr><td id="L3404" class="css-a4x74f"><span>3404</span></td><td id="LC3404" class="css-1dcdqdg"><code>    <span class="code-comment">// If you have opted to display both duration and currentTime, this is ignored</span>
</code></td></tr><tr><td id="L3405" class="css-a4x74f"><span>3405</span></td><td id="LC3405" class="css-1dcdqdg"><code>    displayDuration: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3406" class="css-a4x74f"><span>3406</span></td><td id="LC3406" class="css-1dcdqdg"><code>    <span class="code-comment">// Invert the current time to be a countdown</span>
</code></td></tr><tr><td id="L3407" class="css-a4x74f"><span>3407</span></td><td id="LC3407" class="css-1dcdqdg"><code>    invertTime: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3408" class="css-a4x74f"><span>3408</span></td><td id="LC3408" class="css-1dcdqdg"><code>    <span class="code-comment">// Clicking the currentTime inverts it's value to show time left rather than elapsed</span>
</code></td></tr><tr><td id="L3409" class="css-a4x74f"><span>3409</span></td><td id="LC3409" class="css-1dcdqdg"><code>    toggleInvert: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3410" class="css-a4x74f"><span>3410</span></td><td id="LC3410" class="css-1dcdqdg"><code>    <span class="code-comment">// Force an aspect ratio</span>
</code></td></tr><tr><td id="L3411" class="css-a4x74f"><span>3411</span></td><td id="LC3411" class="css-1dcdqdg"><code>    <span class="code-comment">// The format must be `'w:h'` (e.g. `'16:9'`)</span>
</code></td></tr><tr><td id="L3412" class="css-a4x74f"><span>3412</span></td><td id="LC3412" class="css-1dcdqdg"><code>    ratio: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3413" class="css-a4x74f"><span>3413</span></td><td id="LC3413" class="css-1dcdqdg"><code>    <span class="code-comment">// Click video container to play/pause</span>
</code></td></tr><tr><td id="L3414" class="css-a4x74f"><span>3414</span></td><td id="LC3414" class="css-1dcdqdg"><code>    clickToPlay: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3415" class="css-a4x74f"><span>3415</span></td><td id="LC3415" class="css-1dcdqdg"><code>    <span class="code-comment">// Auto hide the controls</span>
</code></td></tr><tr><td id="L3416" class="css-a4x74f"><span>3416</span></td><td id="LC3416" class="css-1dcdqdg"><code>    hideControls: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3417" class="css-a4x74f"><span>3417</span></td><td id="LC3417" class="css-1dcdqdg"><code>    <span class="code-comment">// Reset to start when playback ended</span>
</code></td></tr><tr><td id="L3418" class="css-a4x74f"><span>3418</span></td><td id="LC3418" class="css-1dcdqdg"><code>    resetOnEnd: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3419" class="css-a4x74f"><span>3419</span></td><td id="LC3419" class="css-1dcdqdg"><code>    <span class="code-comment">// Disable the standard context menu</span>
</code></td></tr><tr><td id="L3420" class="css-a4x74f"><span>3420</span></td><td id="LC3420" class="css-1dcdqdg"><code>    disableContextMenu: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3421" class="css-a4x74f"><span>3421</span></td><td id="LC3421" class="css-1dcdqdg"><code>    <span class="code-comment">// Sprite (for icons)</span>
</code></td></tr><tr><td id="L3422" class="css-a4x74f"><span>3422</span></td><td id="LC3422" class="css-1dcdqdg"><code>    loadSprite: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3423" class="css-a4x74f"><span>3423</span></td><td id="LC3423" class="css-1dcdqdg"><code>    iconPrefix: <span class="code-string">'plyr'</span>,
</code></td></tr><tr><td id="L3424" class="css-a4x74f"><span>3424</span></td><td id="LC3424" class="css-1dcdqdg"><code>    iconUrl: <span class="code-string">'https://cdn.plyr.io/3.7.8/plyr.svg'</span>,
</code></td></tr><tr><td id="L3425" class="css-a4x74f"><span>3425</span></td><td id="LC3425" class="css-1dcdqdg"><code>    <span class="code-comment">// Blank video (used to prevent errors on source change)</span>
</code></td></tr><tr><td id="L3426" class="css-a4x74f"><span>3426</span></td><td id="LC3426" class="css-1dcdqdg"><code>    blankVideo: <span class="code-string">'https://cdn.plyr.io/static/blank.mp4'</span>,
</code></td></tr><tr><td id="L3427" class="css-a4x74f"><span>3427</span></td><td id="LC3427" class="css-1dcdqdg"><code>    <span class="code-comment">// Quality default</span>
</code></td></tr><tr><td id="L3428" class="css-a4x74f"><span>3428</span></td><td id="LC3428" class="css-1dcdqdg"><code>    quality: {
</code></td></tr><tr><td id="L3429" class="css-a4x74f"><span>3429</span></td><td id="LC3429" class="css-1dcdqdg"><code>      <span class="code-keyword">default</span>: <span class="code-number">576</span>,
</code></td></tr><tr><td id="L3430" class="css-a4x74f"><span>3430</span></td><td id="LC3430" class="css-1dcdqdg"><code>      <span class="code-comment">// The options to display in the UI, if available for the source media</span>
</code></td></tr><tr><td id="L3431" class="css-a4x74f"><span>3431</span></td><td id="LC3431" class="css-1dcdqdg"><code>      options: [<span class="code-number">4320</span>, <span class="code-number">2880</span>, <span class="code-number">2160</span>, <span class="code-number">1440</span>, <span class="code-number">1080</span>, <span class="code-number">720</span>, <span class="code-number">576</span>, <span class="code-number">480</span>, <span class="code-number">360</span>, <span class="code-number">240</span>],
</code></td></tr><tr><td id="L3432" class="css-a4x74f"><span>3432</span></td><td id="LC3432" class="css-1dcdqdg"><code>      forced: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3433" class="css-a4x74f"><span>3433</span></td><td id="LC3433" class="css-1dcdqdg"><code>      onChange: <span class="code-literal">null</span>
</code></td></tr><tr><td id="L3434" class="css-a4x74f"><span>3434</span></td><td id="LC3434" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3435" class="css-a4x74f"><span>3435</span></td><td id="LC3435" class="css-1dcdqdg"><code>    <span class="code-comment">// Set loops</span>
</code></td></tr><tr><td id="L3436" class="css-a4x74f"><span>3436</span></td><td id="LC3436" class="css-1dcdqdg"><code>    loop: {
</code></td></tr><tr><td id="L3437" class="css-a4x74f"><span>3437</span></td><td id="LC3437" class="css-1dcdqdg"><code>      active: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L3438" class="css-a4x74f"><span>3438</span></td><td id="LC3438" class="css-1dcdqdg"><code>      <span class="code-comment">// start: null,</span>
</code></td></tr><tr><td id="L3439" class="css-a4x74f"><span>3439</span></td><td id="LC3439" class="css-1dcdqdg"><code>      <span class="code-comment">// end: null,</span>
</code></td></tr><tr><td id="L3440" class="css-a4x74f"><span>3440</span></td><td id="LC3440" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3441" class="css-a4x74f"><span>3441</span></td><td id="LC3441" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3442" class="css-a4x74f"><span>3442</span></td><td id="LC3442" class="css-1dcdqdg"><code>    <span class="code-comment">// Speed default and options to display</span>
</code></td></tr><tr><td id="L3443" class="css-a4x74f"><span>3443</span></td><td id="LC3443" class="css-1dcdqdg"><code>    speed: {
</code></td></tr><tr><td id="L3444" class="css-a4x74f"><span>3444</span></td><td id="LC3444" class="css-1dcdqdg"><code>      selected: <span class="code-number">1</span>,
</code></td></tr><tr><td id="L3445" class="css-a4x74f"><span>3445</span></td><td id="LC3445" class="css-1dcdqdg"><code>      <span class="code-comment">// The options to display in the UI, if available for the source media (e.g. Vimeo and YouTube only support 0.5x-4x)</span>
</code></td></tr><tr><td id="L3446" class="css-a4x74f"><span>3446</span></td><td id="LC3446" class="css-1dcdqdg"><code>      options: [<span class="code-number">0.5</span>, <span class="code-number">0.75</span>, <span class="code-number">1</span>, <span class="code-number">1.25</span>, <span class="code-number">1.5</span>, <span class="code-number">1.75</span>, <span class="code-number">2</span>, <span class="code-number">4</span>]
</code></td></tr><tr><td id="L3447" class="css-a4x74f"><span>3447</span></td><td id="LC3447" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3448" class="css-a4x74f"><span>3448</span></td><td id="LC3448" class="css-1dcdqdg"><code>    <span class="code-comment">// Keyboard shortcut settings</span>
</code></td></tr><tr><td id="L3449" class="css-a4x74f"><span>3449</span></td><td id="LC3449" class="css-1dcdqdg"><code>    keyboard: {
</code></td></tr><tr><td id="L3450" class="css-a4x74f"><span>3450</span></td><td id="LC3450" class="css-1dcdqdg"><code>      focused: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3451" class="css-a4x74f"><span>3451</span></td><td id="LC3451" class="css-1dcdqdg"><code>      global: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L3452" class="css-a4x74f"><span>3452</span></td><td id="LC3452" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3453" class="css-a4x74f"><span>3453</span></td><td id="LC3453" class="css-1dcdqdg"><code>    <span class="code-comment">// Display tooltips</span>
</code></td></tr><tr><td id="L3454" class="css-a4x74f"><span>3454</span></td><td id="LC3454" class="css-1dcdqdg"><code>    tooltips: {
</code></td></tr><tr><td id="L3455" class="css-a4x74f"><span>3455</span></td><td id="LC3455" class="css-1dcdqdg"><code>      controls: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3456" class="css-a4x74f"><span>3456</span></td><td id="LC3456" class="css-1dcdqdg"><code>      seek: <span class="code-literal">true</span>
</code></td></tr><tr><td id="L3457" class="css-a4x74f"><span>3457</span></td><td id="LC3457" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3458" class="css-a4x74f"><span>3458</span></td><td id="LC3458" class="css-1dcdqdg"><code>    <span class="code-comment">// Captions settings</span>
</code></td></tr><tr><td id="L3459" class="css-a4x74f"><span>3459</span></td><td id="LC3459" class="css-1dcdqdg"><code>    captions: {
</code></td></tr><tr><td id="L3460" class="css-a4x74f"><span>3460</span></td><td id="LC3460" class="css-1dcdqdg"><code>      active: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3461" class="css-a4x74f"><span>3461</span></td><td id="LC3461" class="css-1dcdqdg"><code>      language: <span class="code-string">'auto'</span>,
</code></td></tr><tr><td id="L3462" class="css-a4x74f"><span>3462</span></td><td id="LC3462" class="css-1dcdqdg"><code>      <span class="code-comment">// Listen to new tracks added after Plyr is initialized.</span>
</code></td></tr><tr><td id="L3463" class="css-a4x74f"><span>3463</span></td><td id="LC3463" class="css-1dcdqdg"><code>      <span class="code-comment">// This is needed for streaming captions, but may result in unselectable options</span>
</code></td></tr><tr><td id="L3464" class="css-a4x74f"><span>3464</span></td><td id="LC3464" class="css-1dcdqdg"><code>      update: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L3465" class="css-a4x74f"><span>3465</span></td><td id="LC3465" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3466" class="css-a4x74f"><span>3466</span></td><td id="LC3466" class="css-1dcdqdg"><code>    <span class="code-comment">// Fullscreen settings</span>
</code></td></tr><tr><td id="L3467" class="css-a4x74f"><span>3467</span></td><td id="LC3467" class="css-1dcdqdg"><code>    fullscreen: {
</code></td></tr><tr><td id="L3468" class="css-a4x74f"><span>3468</span></td><td id="LC3468" class="css-1dcdqdg"><code>      enabled: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3469" class="css-a4x74f"><span>3469</span></td><td id="LC3469" class="css-1dcdqdg"><code>      <span class="code-comment">// Allow fullscreen?</span>
</code></td></tr><tr><td id="L3470" class="css-a4x74f"><span>3470</span></td><td id="LC3470" class="css-1dcdqdg"><code>      fallback: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3471" class="css-a4x74f"><span>3471</span></td><td id="LC3471" class="css-1dcdqdg"><code>      <span class="code-comment">// Fallback using full viewport/window</span>
</code></td></tr><tr><td id="L3472" class="css-a4x74f"><span>3472</span></td><td id="LC3472" class="css-1dcdqdg"><code>      iosNative: <span class="code-literal">false</span> <span class="code-comment">// Use the native fullscreen in iOS (disables custom controls)</span>
</code></td></tr><tr><td id="L3473" class="css-a4x74f"><span>3473</span></td><td id="LC3473" class="css-1dcdqdg"><code>      <span class="code-comment">// Selector for the fullscreen container so contextual / non-player content can remain visible in fullscreen mode</span>
</code></td></tr><tr><td id="L3474" class="css-a4x74f"><span>3474</span></td><td id="LC3474" class="css-1dcdqdg"><code>      <span class="code-comment">// Non-ancestors of the player element will be ignored</span>
</code></td></tr><tr><td id="L3475" class="css-a4x74f"><span>3475</span></td><td id="LC3475" class="css-1dcdqdg"><code>      <span class="code-comment">// container: null, // defaults to the player element</span>
</code></td></tr><tr><td id="L3476" class="css-a4x74f"><span>3476</span></td><td id="LC3476" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3477" class="css-a4x74f"><span>3477</span></td><td id="LC3477" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3478" class="css-a4x74f"><span>3478</span></td><td id="LC3478" class="css-1dcdqdg"><code>    <span class="code-comment">// Local storage</span>
</code></td></tr><tr><td id="L3479" class="css-a4x74f"><span>3479</span></td><td id="LC3479" class="css-1dcdqdg"><code>    storage: {
</code></td></tr><tr><td id="L3480" class="css-a4x74f"><span>3480</span></td><td id="LC3480" class="css-1dcdqdg"><code>      enabled: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3481" class="css-a4x74f"><span>3481</span></td><td id="LC3481" class="css-1dcdqdg"><code>      key: <span class="code-string">'plyr'</span>
</code></td></tr><tr><td id="L3482" class="css-a4x74f"><span>3482</span></td><td id="LC3482" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3483" class="css-a4x74f"><span>3483</span></td><td id="LC3483" class="css-1dcdqdg"><code>    <span class="code-comment">// Default controls</span>
</code></td></tr><tr><td id="L3484" class="css-a4x74f"><span>3484</span></td><td id="LC3484" class="css-1dcdqdg"><code>    controls: [<span class="code-string">'play-large'</span>,
</code></td></tr><tr><td id="L3485" class="css-a4x74f"><span>3485</span></td><td id="LC3485" class="css-1dcdqdg"><code>    <span class="code-comment">// 'restart',</span>
</code></td></tr><tr><td id="L3486" class="css-a4x74f"><span>3486</span></td><td id="LC3486" class="css-1dcdqdg"><code>    <span class="code-comment">// 'rewind',</span>
</code></td></tr><tr><td id="L3487" class="css-a4x74f"><span>3487</span></td><td id="LC3487" class="css-1dcdqdg"><code>    <span class="code-string">'play'</span>,
</code></td></tr><tr><td id="L3488" class="css-a4x74f"><span>3488</span></td><td id="LC3488" class="css-1dcdqdg"><code>    <span class="code-comment">// 'fast-forward',</span>
</code></td></tr><tr><td id="L3489" class="css-a4x74f"><span>3489</span></td><td id="LC3489" class="css-1dcdqdg"><code>    <span class="code-string">'progress'</span>, <span class="code-string">'current-time'</span>,
</code></td></tr><tr><td id="L3490" class="css-a4x74f"><span>3490</span></td><td id="LC3490" class="css-1dcdqdg"><code>    <span class="code-comment">// 'duration',</span>
</code></td></tr><tr><td id="L3491" class="css-a4x74f"><span>3491</span></td><td id="LC3491" class="css-1dcdqdg"><code>    <span class="code-string">'mute'</span>, <span class="code-string">'volume'</span>, <span class="code-string">'captions'</span>, <span class="code-string">'settings'</span>, <span class="code-string">'pip'</span>, <span class="code-string">'airplay'</span>,
</code></td></tr><tr><td id="L3492" class="css-a4x74f"><span>3492</span></td><td id="LC3492" class="css-1dcdqdg"><code>    <span class="code-comment">// 'download',</span>
</code></td></tr><tr><td id="L3493" class="css-a4x74f"><span>3493</span></td><td id="LC3493" class="css-1dcdqdg"><code>    <span class="code-string">'fullscreen'</span>],
</code></td></tr><tr><td id="L3494" class="css-a4x74f"><span>3494</span></td><td id="LC3494" class="css-1dcdqdg"><code>    settings: [<span class="code-string">'captions'</span>, <span class="code-string">'quality'</span>, <span class="code-string">'speed'</span>],
</code></td></tr><tr><td id="L3495" class="css-a4x74f"><span>3495</span></td><td id="LC3495" class="css-1dcdqdg"><code>    <span class="code-comment">// Localisation</span>
</code></td></tr><tr><td id="L3496" class="css-a4x74f"><span>3496</span></td><td id="LC3496" class="css-1dcdqdg"><code>    i18n: {
</code></td></tr><tr><td id="L3497" class="css-a4x74f"><span>3497</span></td><td id="LC3497" class="css-1dcdqdg"><code>      restart: <span class="code-string">'Restart'</span>,
</code></td></tr><tr><td id="L3498" class="css-a4x74f"><span>3498</span></td><td id="LC3498" class="css-1dcdqdg"><code>      rewind: <span class="code-string">'Rewind {seektime}s'</span>,
</code></td></tr><tr><td id="L3499" class="css-a4x74f"><span>3499</span></td><td id="LC3499" class="css-1dcdqdg"><code>      play: <span class="code-string">'Play'</span>,
</code></td></tr><tr><td id="L3500" class="css-a4x74f"><span>3500</span></td><td id="LC3500" class="css-1dcdqdg"><code>      pause: <span class="code-string">'Pause'</span>,
</code></td></tr><tr><td id="L3501" class="css-a4x74f"><span>3501</span></td><td id="LC3501" class="css-1dcdqdg"><code>      fastForward: <span class="code-string">'Forward {seektime}s'</span>,
</code></td></tr><tr><td id="L3502" class="css-a4x74f"><span>3502</span></td><td id="LC3502" class="css-1dcdqdg"><code>      seek: <span class="code-string">'Seek'</span>,
</code></td></tr><tr><td id="L3503" class="css-a4x74f"><span>3503</span></td><td id="LC3503" class="css-1dcdqdg"><code>      seekLabel: <span class="code-string">'{currentTime} of {duration}'</span>,
</code></td></tr><tr><td id="L3504" class="css-a4x74f"><span>3504</span></td><td id="LC3504" class="css-1dcdqdg"><code>      played: <span class="code-string">'Played'</span>,
</code></td></tr><tr><td id="L3505" class="css-a4x74f"><span>3505</span></td><td id="LC3505" class="css-1dcdqdg"><code>      buffered: <span class="code-string">'Buffered'</span>,
</code></td></tr><tr><td id="L3506" class="css-a4x74f"><span>3506</span></td><td id="LC3506" class="css-1dcdqdg"><code>      currentTime: <span class="code-string">'Current time'</span>,
</code></td></tr><tr><td id="L3507" class="css-a4x74f"><span>3507</span></td><td id="LC3507" class="css-1dcdqdg"><code>      duration: <span class="code-string">'Duration'</span>,
</code></td></tr><tr><td id="L3508" class="css-a4x74f"><span>3508</span></td><td id="LC3508" class="css-1dcdqdg"><code>      volume: <span class="code-string">'Volume'</span>,
</code></td></tr><tr><td id="L3509" class="css-a4x74f"><span>3509</span></td><td id="LC3509" class="css-1dcdqdg"><code>      mute: <span class="code-string">'Mute'</span>,
</code></td></tr><tr><td id="L3510" class="css-a4x74f"><span>3510</span></td><td id="LC3510" class="css-1dcdqdg"><code>      unmute: <span class="code-string">'Unmute'</span>,
</code></td></tr><tr><td id="L3511" class="css-a4x74f"><span>3511</span></td><td id="LC3511" class="css-1dcdqdg"><code>      enableCaptions: <span class="code-string">'Enable captions'</span>,
</code></td></tr><tr><td id="L3512" class="css-a4x74f"><span>3512</span></td><td id="LC3512" class="css-1dcdqdg"><code>      disableCaptions: <span class="code-string">'Disable captions'</span>,
</code></td></tr><tr><td id="L3513" class="css-a4x74f"><span>3513</span></td><td id="LC3513" class="css-1dcdqdg"><code>      download: <span class="code-string">'Download'</span>,
</code></td></tr><tr><td id="L3514" class="css-a4x74f"><span>3514</span></td><td id="LC3514" class="css-1dcdqdg"><code>      enterFullscreen: <span class="code-string">'Enter fullscreen'</span>,
</code></td></tr><tr><td id="L3515" class="css-a4x74f"><span>3515</span></td><td id="LC3515" class="css-1dcdqdg"><code>      exitFullscreen: <span class="code-string">'Exit fullscreen'</span>,
</code></td></tr><tr><td id="L3516" class="css-a4x74f"><span>3516</span></td><td id="LC3516" class="css-1dcdqdg"><code>      frameTitle: <span class="code-string">'Player for {title}'</span>,
</code></td></tr><tr><td id="L3517" class="css-a4x74f"><span>3517</span></td><td id="LC3517" class="css-1dcdqdg"><code>      captions: <span class="code-string">'Captions'</span>,
</code></td></tr><tr><td id="L3518" class="css-a4x74f"><span>3518</span></td><td id="LC3518" class="css-1dcdqdg"><code>      settings: <span class="code-string">'Settings'</span>,
</code></td></tr><tr><td id="L3519" class="css-a4x74f"><span>3519</span></td><td id="LC3519" class="css-1dcdqdg"><code>      pip: <span class="code-string">'PIP'</span>,
</code></td></tr><tr><td id="L3520" class="css-a4x74f"><span>3520</span></td><td id="LC3520" class="css-1dcdqdg"><code>      menuBack: <span class="code-string">'Go back to previous menu'</span>,
</code></td></tr><tr><td id="L3521" class="css-a4x74f"><span>3521</span></td><td id="LC3521" class="css-1dcdqdg"><code>      speed: <span class="code-string">'Speed'</span>,
</code></td></tr><tr><td id="L3522" class="css-a4x74f"><span>3522</span></td><td id="LC3522" class="css-1dcdqdg"><code>      normal: <span class="code-string">'Normal'</span>,
</code></td></tr><tr><td id="L3523" class="css-a4x74f"><span>3523</span></td><td id="LC3523" class="css-1dcdqdg"><code>      quality: <span class="code-string">'Quality'</span>,
</code></td></tr><tr><td id="L3524" class="css-a4x74f"><span>3524</span></td><td id="LC3524" class="css-1dcdqdg"><code>      loop: <span class="code-string">'Loop'</span>,
</code></td></tr><tr><td id="L3525" class="css-a4x74f"><span>3525</span></td><td id="LC3525" class="css-1dcdqdg"><code>      start: <span class="code-string">'Start'</span>,
</code></td></tr><tr><td id="L3526" class="css-a4x74f"><span>3526</span></td><td id="LC3526" class="css-1dcdqdg"><code>      end: <span class="code-string">'End'</span>,
</code></td></tr><tr><td id="L3527" class="css-a4x74f"><span>3527</span></td><td id="LC3527" class="css-1dcdqdg"><code>      all: <span class="code-string">'All'</span>,
</code></td></tr><tr><td id="L3528" class="css-a4x74f"><span>3528</span></td><td id="LC3528" class="css-1dcdqdg"><code>      reset: <span class="code-string">'Reset'</span>,
</code></td></tr><tr><td id="L3529" class="css-a4x74f"><span>3529</span></td><td id="LC3529" class="css-1dcdqdg"><code>      disabled: <span class="code-string">'Disabled'</span>,
</code></td></tr><tr><td id="L3530" class="css-a4x74f"><span>3530</span></td><td id="LC3530" class="css-1dcdqdg"><code>      enabled: <span class="code-string">'Enabled'</span>,
</code></td></tr><tr><td id="L3531" class="css-a4x74f"><span>3531</span></td><td id="LC3531" class="css-1dcdqdg"><code>      advertisement: <span class="code-string">'Ad'</span>,
</code></td></tr><tr><td id="L3532" class="css-a4x74f"><span>3532</span></td><td id="LC3532" class="css-1dcdqdg"><code>      qualityBadge: {
</code></td></tr><tr><td id="L3533" class="css-a4x74f"><span>3533</span></td><td id="LC3533" class="css-1dcdqdg"><code>        <span class="code-number">2160</span>: <span class="code-string">'4K'</span>,
</code></td></tr><tr><td id="L3534" class="css-a4x74f"><span>3534</span></td><td id="LC3534" class="css-1dcdqdg"><code>        <span class="code-number">1440</span>: <span class="code-string">'HD'</span>,
</code></td></tr><tr><td id="L3535" class="css-a4x74f"><span>3535</span></td><td id="LC3535" class="css-1dcdqdg"><code>        <span class="code-number">1080</span>: <span class="code-string">'HD'</span>,
</code></td></tr><tr><td id="L3536" class="css-a4x74f"><span>3536</span></td><td id="LC3536" class="css-1dcdqdg"><code>        <span class="code-number">720</span>: <span class="code-string">'HD'</span>,
</code></td></tr><tr><td id="L3537" class="css-a4x74f"><span>3537</span></td><td id="LC3537" class="css-1dcdqdg"><code>        <span class="code-number">576</span>: <span class="code-string">'SD'</span>,
</code></td></tr><tr><td id="L3538" class="css-a4x74f"><span>3538</span></td><td id="LC3538" class="css-1dcdqdg"><code>        <span class="code-number">480</span>: <span class="code-string">'SD'</span>
</code></td></tr><tr><td id="L3539" class="css-a4x74f"><span>3539</span></td><td id="LC3539" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3540" class="css-a4x74f"><span>3540</span></td><td id="LC3540" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3541" class="css-a4x74f"><span>3541</span></td><td id="LC3541" class="css-1dcdqdg"><code>    <span class="code-comment">// URLs</span>
</code></td></tr><tr><td id="L3542" class="css-a4x74f"><span>3542</span></td><td id="LC3542" class="css-1dcdqdg"><code>    urls: {
</code></td></tr><tr><td id="L3543" class="css-a4x74f"><span>3543</span></td><td id="LC3543" class="css-1dcdqdg"><code>      download: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3544" class="css-a4x74f"><span>3544</span></td><td id="LC3544" class="css-1dcdqdg"><code>      vimeo: {
</code></td></tr><tr><td id="L3545" class="css-a4x74f"><span>3545</span></td><td id="LC3545" class="css-1dcdqdg"><code>        sdk: <span class="code-string">'https://player.vimeo.com/api/player.js'</span>,
</code></td></tr><tr><td id="L3546" class="css-a4x74f"><span>3546</span></td><td id="LC3546" class="css-1dcdqdg"><code>        iframe: <span class="code-string">'https://player.vimeo.com/video/{0}?{1}'</span>,
</code></td></tr><tr><td id="L3547" class="css-a4x74f"><span>3547</span></td><td id="LC3547" class="css-1dcdqdg"><code>        api: <span class="code-string">'https://vimeo.com/api/oembed.json?url={0}'</span>
</code></td></tr><tr><td id="L3548" class="css-a4x74f"><span>3548</span></td><td id="LC3548" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3549" class="css-a4x74f"><span>3549</span></td><td id="LC3549" class="css-1dcdqdg"><code>      youtube: {
</code></td></tr><tr><td id="L3550" class="css-a4x74f"><span>3550</span></td><td id="LC3550" class="css-1dcdqdg"><code>        sdk: <span class="code-string">'https://www.youtube.com/iframe_api'</span>,
</code></td></tr><tr><td id="L3551" class="css-a4x74f"><span>3551</span></td><td id="LC3551" class="css-1dcdqdg"><code>        api: <span class="code-string">'https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}'</span>
</code></td></tr><tr><td id="L3552" class="css-a4x74f"><span>3552</span></td><td id="LC3552" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3553" class="css-a4x74f"><span>3553</span></td><td id="LC3553" class="css-1dcdqdg"><code>      googleIMA: {
</code></td></tr><tr><td id="L3554" class="css-a4x74f"><span>3554</span></td><td id="LC3554" class="css-1dcdqdg"><code>        sdk: <span class="code-string">'https://imasdk.googleapis.com/js/sdkloader/ima3.js'</span>
</code></td></tr><tr><td id="L3555" class="css-a4x74f"><span>3555</span></td><td id="LC3555" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3556" class="css-a4x74f"><span>3556</span></td><td id="LC3556" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3557" class="css-a4x74f"><span>3557</span></td><td id="LC3557" class="css-1dcdqdg"><code>    <span class="code-comment">// Custom control listeners</span>
</code></td></tr><tr><td id="L3558" class="css-a4x74f"><span>3558</span></td><td id="LC3558" class="css-1dcdqdg"><code>    listeners: {
</code></td></tr><tr><td id="L3559" class="css-a4x74f"><span>3559</span></td><td id="LC3559" class="css-1dcdqdg"><code>      seek: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3560" class="css-a4x74f"><span>3560</span></td><td id="LC3560" class="css-1dcdqdg"><code>      play: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3561" class="css-a4x74f"><span>3561</span></td><td id="LC3561" class="css-1dcdqdg"><code>      pause: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3562" class="css-a4x74f"><span>3562</span></td><td id="LC3562" class="css-1dcdqdg"><code>      restart: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3563" class="css-a4x74f"><span>3563</span></td><td id="LC3563" class="css-1dcdqdg"><code>      rewind: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3564" class="css-a4x74f"><span>3564</span></td><td id="LC3564" class="css-1dcdqdg"><code>      fastForward: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3565" class="css-a4x74f"><span>3565</span></td><td id="LC3565" class="css-1dcdqdg"><code>      mute: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3566" class="css-a4x74f"><span>3566</span></td><td id="LC3566" class="css-1dcdqdg"><code>      volume: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3567" class="css-a4x74f"><span>3567</span></td><td id="LC3567" class="css-1dcdqdg"><code>      captions: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3568" class="css-a4x74f"><span>3568</span></td><td id="LC3568" class="css-1dcdqdg"><code>      download: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3569" class="css-a4x74f"><span>3569</span></td><td id="LC3569" class="css-1dcdqdg"><code>      fullscreen: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3570" class="css-a4x74f"><span>3570</span></td><td id="LC3570" class="css-1dcdqdg"><code>      pip: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3571" class="css-a4x74f"><span>3571</span></td><td id="LC3571" class="css-1dcdqdg"><code>      airplay: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3572" class="css-a4x74f"><span>3572</span></td><td id="LC3572" class="css-1dcdqdg"><code>      speed: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3573" class="css-a4x74f"><span>3573</span></td><td id="LC3573" class="css-1dcdqdg"><code>      quality: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3574" class="css-a4x74f"><span>3574</span></td><td id="LC3574" class="css-1dcdqdg"><code>      loop: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3575" class="css-a4x74f"><span>3575</span></td><td id="LC3575" class="css-1dcdqdg"><code>      language: <span class="code-literal">null</span>
</code></td></tr><tr><td id="L3576" class="css-a4x74f"><span>3576</span></td><td id="LC3576" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3577" class="css-a4x74f"><span>3577</span></td><td id="LC3577" class="css-1dcdqdg"><code>    <span class="code-comment">// Events to watch and bubble</span>
</code></td></tr><tr><td id="L3578" class="css-a4x74f"><span>3578</span></td><td id="LC3578" class="css-1dcdqdg"><code>    events: [
</code></td></tr><tr><td id="L3579" class="css-a4x74f"><span>3579</span></td><td id="LC3579" class="css-1dcdqdg"><code>    <span class="code-comment">// Events to watch on HTML5 media elements and bubble</span>
</code></td></tr><tr><td id="L3580" class="css-a4x74f"><span>3580</span></td><td id="LC3580" class="css-1dcdqdg"><code>    <span class="code-comment">// https://developer.mozilla.org/en/docs/Web/Guide/Events/Media_events</span>
</code></td></tr><tr><td id="L3581" class="css-a4x74f"><span>3581</span></td><td id="LC3581" class="css-1dcdqdg"><code>    <span class="code-string">'ended'</span>, <span class="code-string">'progress'</span>, <span class="code-string">'stalled'</span>, <span class="code-string">'playing'</span>, <span class="code-string">'waiting'</span>, <span class="code-string">'canplay'</span>, <span class="code-string">'canplaythrough'</span>, <span class="code-string">'loadstart'</span>, <span class="code-string">'loadeddata'</span>, <span class="code-string">'loadedmetadata'</span>, <span class="code-string">'timeupdate'</span>, <span class="code-string">'volumechange'</span>, <span class="code-string">'play'</span>, <span class="code-string">'pause'</span>, <span class="code-string">'error'</span>, <span class="code-string">'seeking'</span>, <span class="code-string">'seeked'</span>, <span class="code-string">'emptied'</span>, <span class="code-string">'ratechange'</span>, <span class="code-string">'cuechange'</span>,
</code></td></tr><tr><td id="L3582" class="css-a4x74f"><span>3582</span></td><td id="LC3582" class="css-1dcdqdg"><code>    <span class="code-comment">// Custom events</span>
</code></td></tr><tr><td id="L3583" class="css-a4x74f"><span>3583</span></td><td id="LC3583" class="css-1dcdqdg"><code>    <span class="code-string">'download'</span>, <span class="code-string">'enterfullscreen'</span>, <span class="code-string">'exitfullscreen'</span>, <span class="code-string">'captionsenabled'</span>, <span class="code-string">'captionsdisabled'</span>, <span class="code-string">'languagechange'</span>, <span class="code-string">'controlshidden'</span>, <span class="code-string">'controlsshown'</span>, <span class="code-string">'ready'</span>,
</code></td></tr><tr><td id="L3584" class="css-a4x74f"><span>3584</span></td><td id="LC3584" class="css-1dcdqdg"><code>    <span class="code-comment">// YouTube</span>
</code></td></tr><tr><td id="L3585" class="css-a4x74f"><span>3585</span></td><td id="LC3585" class="css-1dcdqdg"><code>    <span class="code-string">'statechange'</span>,
</code></td></tr><tr><td id="L3586" class="css-a4x74f"><span>3586</span></td><td id="LC3586" class="css-1dcdqdg"><code>    <span class="code-comment">// Quality</span>
</code></td></tr><tr><td id="L3587" class="css-a4x74f"><span>3587</span></td><td id="LC3587" class="css-1dcdqdg"><code>    <span class="code-string">'qualitychange'</span>,
</code></td></tr><tr><td id="L3588" class="css-a4x74f"><span>3588</span></td><td id="LC3588" class="css-1dcdqdg"><code>    <span class="code-comment">// Ads</span>
</code></td></tr><tr><td id="L3589" class="css-a4x74f"><span>3589</span></td><td id="LC3589" class="css-1dcdqdg"><code>    <span class="code-string">'adsloaded'</span>, <span class="code-string">'adscontentpause'</span>, <span class="code-string">'adscontentresume'</span>, <span class="code-string">'adstarted'</span>, <span class="code-string">'adsmidpoint'</span>, <span class="code-string">'adscomplete'</span>, <span class="code-string">'adsallcomplete'</span>, <span class="code-string">'adsimpression'</span>, <span class="code-string">'adsclick'</span>],
</code></td></tr><tr><td id="L3590" class="css-a4x74f"><span>3590</span></td><td id="LC3590" class="css-1dcdqdg"><code>    <span class="code-comment">// Selectors</span>
</code></td></tr><tr><td id="L3591" class="css-a4x74f"><span>3591</span></td><td id="LC3591" class="css-1dcdqdg"><code>    <span class="code-comment">// Change these to match your template if using custom HTML</span>
</code></td></tr><tr><td id="L3592" class="css-a4x74f"><span>3592</span></td><td id="LC3592" class="css-1dcdqdg"><code>    selectors: {
</code></td></tr><tr><td id="L3593" class="css-a4x74f"><span>3593</span></td><td id="LC3593" class="css-1dcdqdg"><code>      editable: <span class="code-string">'input, textarea, select, [contenteditable]'</span>,
</code></td></tr><tr><td id="L3594" class="css-a4x74f"><span>3594</span></td><td id="LC3594" class="css-1dcdqdg"><code>      container: <span class="code-string">'.plyr'</span>,
</code></td></tr><tr><td id="L3595" class="css-a4x74f"><span>3595</span></td><td id="LC3595" class="css-1dcdqdg"><code>      controls: {
</code></td></tr><tr><td id="L3596" class="css-a4x74f"><span>3596</span></td><td id="LC3596" class="css-1dcdqdg"><code>        container: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3597" class="css-a4x74f"><span>3597</span></td><td id="LC3597" class="css-1dcdqdg"><code>        wrapper: <span class="code-string">'.plyr__controls'</span>
</code></td></tr><tr><td id="L3598" class="css-a4x74f"><span>3598</span></td><td id="LC3598" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3599" class="css-a4x74f"><span>3599</span></td><td id="LC3599" class="css-1dcdqdg"><code>      labels: <span class="code-string">'[data-plyr]'</span>,
</code></td></tr><tr><td id="L3600" class="css-a4x74f"><span>3600</span></td><td id="LC3600" class="css-1dcdqdg"><code>      buttons: {
</code></td></tr><tr><td id="L3601" class="css-a4x74f"><span>3601</span></td><td id="LC3601" class="css-1dcdqdg"><code>        play: <span class="code-string">'[data-plyr="play"]'</span>,
</code></td></tr><tr><td id="L3602" class="css-a4x74f"><span>3602</span></td><td id="LC3602" class="css-1dcdqdg"><code>        pause: <span class="code-string">'[data-plyr="pause"]'</span>,
</code></td></tr><tr><td id="L3603" class="css-a4x74f"><span>3603</span></td><td id="LC3603" class="css-1dcdqdg"><code>        restart: <span class="code-string">'[data-plyr="restart"]'</span>,
</code></td></tr><tr><td id="L3604" class="css-a4x74f"><span>3604</span></td><td id="LC3604" class="css-1dcdqdg"><code>        rewind: <span class="code-string">'[data-plyr="rewind"]'</span>,
</code></td></tr><tr><td id="L3605" class="css-a4x74f"><span>3605</span></td><td id="LC3605" class="css-1dcdqdg"><code>        fastForward: <span class="code-string">'[data-plyr="fast-forward"]'</span>,
</code></td></tr><tr><td id="L3606" class="css-a4x74f"><span>3606</span></td><td id="LC3606" class="css-1dcdqdg"><code>        mute: <span class="code-string">'[data-plyr="mute"]'</span>,
</code></td></tr><tr><td id="L3607" class="css-a4x74f"><span>3607</span></td><td id="LC3607" class="css-1dcdqdg"><code>        captions: <span class="code-string">'[data-plyr="captions"]'</span>,
</code></td></tr><tr><td id="L3608" class="css-a4x74f"><span>3608</span></td><td id="LC3608" class="css-1dcdqdg"><code>        download: <span class="code-string">'[data-plyr="download"]'</span>,
</code></td></tr><tr><td id="L3609" class="css-a4x74f"><span>3609</span></td><td id="LC3609" class="css-1dcdqdg"><code>        fullscreen: <span class="code-string">'[data-plyr="fullscreen"]'</span>,
</code></td></tr><tr><td id="L3610" class="css-a4x74f"><span>3610</span></td><td id="LC3610" class="css-1dcdqdg"><code>        pip: <span class="code-string">'[data-plyr="pip"]'</span>,
</code></td></tr><tr><td id="L3611" class="css-a4x74f"><span>3611</span></td><td id="LC3611" class="css-1dcdqdg"><code>        airplay: <span class="code-string">'[data-plyr="airplay"]'</span>,
</code></td></tr><tr><td id="L3612" class="css-a4x74f"><span>3612</span></td><td id="LC3612" class="css-1dcdqdg"><code>        settings: <span class="code-string">'[data-plyr="settings"]'</span>,
</code></td></tr><tr><td id="L3613" class="css-a4x74f"><span>3613</span></td><td id="LC3613" class="css-1dcdqdg"><code>        loop: <span class="code-string">'[data-plyr="loop"]'</span>
</code></td></tr><tr><td id="L3614" class="css-a4x74f"><span>3614</span></td><td id="LC3614" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3615" class="css-a4x74f"><span>3615</span></td><td id="LC3615" class="css-1dcdqdg"><code>      inputs: {
</code></td></tr><tr><td id="L3616" class="css-a4x74f"><span>3616</span></td><td id="LC3616" class="css-1dcdqdg"><code>        seek: <span class="code-string">'[data-plyr="seek"]'</span>,
</code></td></tr><tr><td id="L3617" class="css-a4x74f"><span>3617</span></td><td id="LC3617" class="css-1dcdqdg"><code>        volume: <span class="code-string">'[data-plyr="volume"]'</span>,
</code></td></tr><tr><td id="L3618" class="css-a4x74f"><span>3618</span></td><td id="LC3618" class="css-1dcdqdg"><code>        speed: <span class="code-string">'[data-plyr="speed"]'</span>,
</code></td></tr><tr><td id="L3619" class="css-a4x74f"><span>3619</span></td><td id="LC3619" class="css-1dcdqdg"><code>        language: <span class="code-string">'[data-plyr="language"]'</span>,
</code></td></tr><tr><td id="L3620" class="css-a4x74f"><span>3620</span></td><td id="LC3620" class="css-1dcdqdg"><code>        quality: <span class="code-string">'[data-plyr="quality"]'</span>
</code></td></tr><tr><td id="L3621" class="css-a4x74f"><span>3621</span></td><td id="LC3621" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3622" class="css-a4x74f"><span>3622</span></td><td id="LC3622" class="css-1dcdqdg"><code>      display: {
</code></td></tr><tr><td id="L3623" class="css-a4x74f"><span>3623</span></td><td id="LC3623" class="css-1dcdqdg"><code>        currentTime: <span class="code-string">'.plyr__time--current'</span>,
</code></td></tr><tr><td id="L3624" class="css-a4x74f"><span>3624</span></td><td id="LC3624" class="css-1dcdqdg"><code>        duration: <span class="code-string">'.plyr__time--duration'</span>,
</code></td></tr><tr><td id="L3625" class="css-a4x74f"><span>3625</span></td><td id="LC3625" class="css-1dcdqdg"><code>        buffer: <span class="code-string">'.plyr__progress__buffer'</span>,
</code></td></tr><tr><td id="L3626" class="css-a4x74f"><span>3626</span></td><td id="LC3626" class="css-1dcdqdg"><code>        loop: <span class="code-string">'.plyr__progress__loop'</span>,
</code></td></tr><tr><td id="L3627" class="css-a4x74f"><span>3627</span></td><td id="LC3627" class="css-1dcdqdg"><code>        <span class="code-comment">// Used later</span>
</code></td></tr><tr><td id="L3628" class="css-a4x74f"><span>3628</span></td><td id="LC3628" class="css-1dcdqdg"><code>        volume: <span class="code-string">'.plyr__volume--display'</span>
</code></td></tr><tr><td id="L3629" class="css-a4x74f"><span>3629</span></td><td id="LC3629" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3630" class="css-a4x74f"><span>3630</span></td><td id="LC3630" class="css-1dcdqdg"><code>      progress: <span class="code-string">'.plyr__progress'</span>,
</code></td></tr><tr><td id="L3631" class="css-a4x74f"><span>3631</span></td><td id="LC3631" class="css-1dcdqdg"><code>      captions: <span class="code-string">'.plyr__captions'</span>,
</code></td></tr><tr><td id="L3632" class="css-a4x74f"><span>3632</span></td><td id="LC3632" class="css-1dcdqdg"><code>      caption: <span class="code-string">'.plyr__caption'</span>
</code></td></tr><tr><td id="L3633" class="css-a4x74f"><span>3633</span></td><td id="LC3633" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3634" class="css-a4x74f"><span>3634</span></td><td id="LC3634" class="css-1dcdqdg"><code>    <span class="code-comment">// Class hooks added to the player in different states</span>
</code></td></tr><tr><td id="L3635" class="css-a4x74f"><span>3635</span></td><td id="LC3635" class="css-1dcdqdg"><code>    classNames: {
</code></td></tr><tr><td id="L3636" class="css-a4x74f"><span>3636</span></td><td id="LC3636" class="css-1dcdqdg"><code>      type: <span class="code-string">'plyr--{0}'</span>,
</code></td></tr><tr><td id="L3637" class="css-a4x74f"><span>3637</span></td><td id="LC3637" class="css-1dcdqdg"><code>      provider: <span class="code-string">'plyr--{0}'</span>,
</code></td></tr><tr><td id="L3638" class="css-a4x74f"><span>3638</span></td><td id="LC3638" class="css-1dcdqdg"><code>      video: <span class="code-string">'plyr__video-wrapper'</span>,
</code></td></tr><tr><td id="L3639" class="css-a4x74f"><span>3639</span></td><td id="LC3639" class="css-1dcdqdg"><code>      embed: <span class="code-string">'plyr__video-embed'</span>,
</code></td></tr><tr><td id="L3640" class="css-a4x74f"><span>3640</span></td><td id="LC3640" class="css-1dcdqdg"><code>      videoFixedRatio: <span class="code-string">'plyr__video-wrapper--fixed-ratio'</span>,
</code></td></tr><tr><td id="L3641" class="css-a4x74f"><span>3641</span></td><td id="LC3641" class="css-1dcdqdg"><code>      embedContainer: <span class="code-string">'plyr__video-embed__container'</span>,
</code></td></tr><tr><td id="L3642" class="css-a4x74f"><span>3642</span></td><td id="LC3642" class="css-1dcdqdg"><code>      poster: <span class="code-string">'plyr__poster'</span>,
</code></td></tr><tr><td id="L3643" class="css-a4x74f"><span>3643</span></td><td id="LC3643" class="css-1dcdqdg"><code>      posterEnabled: <span class="code-string">'plyr__poster-enabled'</span>,
</code></td></tr><tr><td id="L3644" class="css-a4x74f"><span>3644</span></td><td id="LC3644" class="css-1dcdqdg"><code>      ads: <span class="code-string">'plyr__ads'</span>,
</code></td></tr><tr><td id="L3645" class="css-a4x74f"><span>3645</span></td><td id="LC3645" class="css-1dcdqdg"><code>      control: <span class="code-string">'plyr__control'</span>,
</code></td></tr><tr><td id="L3646" class="css-a4x74f"><span>3646</span></td><td id="LC3646" class="css-1dcdqdg"><code>      controlPressed: <span class="code-string">'plyr__control--pressed'</span>,
</code></td></tr><tr><td id="L3647" class="css-a4x74f"><span>3647</span></td><td id="LC3647" class="css-1dcdqdg"><code>      playing: <span class="code-string">'plyr--playing'</span>,
</code></td></tr><tr><td id="L3648" class="css-a4x74f"><span>3648</span></td><td id="LC3648" class="css-1dcdqdg"><code>      paused: <span class="code-string">'plyr--paused'</span>,
</code></td></tr><tr><td id="L3649" class="css-a4x74f"><span>3649</span></td><td id="LC3649" class="css-1dcdqdg"><code>      stopped: <span class="code-string">'plyr--stopped'</span>,
</code></td></tr><tr><td id="L3650" class="css-a4x74f"><span>3650</span></td><td id="LC3650" class="css-1dcdqdg"><code>      loading: <span class="code-string">'plyr--loading'</span>,
</code></td></tr><tr><td id="L3651" class="css-a4x74f"><span>3651</span></td><td id="LC3651" class="css-1dcdqdg"><code>      hover: <span class="code-string">'plyr--hover'</span>,
</code></td></tr><tr><td id="L3652" class="css-a4x74f"><span>3652</span></td><td id="LC3652" class="css-1dcdqdg"><code>      tooltip: <span class="code-string">'plyr__tooltip'</span>,
</code></td></tr><tr><td id="L3653" class="css-a4x74f"><span>3653</span></td><td id="LC3653" class="css-1dcdqdg"><code>      cues: <span class="code-string">'plyr__cues'</span>,
</code></td></tr><tr><td id="L3654" class="css-a4x74f"><span>3654</span></td><td id="LC3654" class="css-1dcdqdg"><code>      marker: <span class="code-string">'plyr__progress__marker'</span>,
</code></td></tr><tr><td id="L3655" class="css-a4x74f"><span>3655</span></td><td id="LC3655" class="css-1dcdqdg"><code>      hidden: <span class="code-string">'plyr__sr-only'</span>,
</code></td></tr><tr><td id="L3656" class="css-a4x74f"><span>3656</span></td><td id="LC3656" class="css-1dcdqdg"><code>      hideControls: <span class="code-string">'plyr--hide-controls'</span>,
</code></td></tr><tr><td id="L3657" class="css-a4x74f"><span>3657</span></td><td id="LC3657" class="css-1dcdqdg"><code>      isTouch: <span class="code-string">'plyr--is-touch'</span>,
</code></td></tr><tr><td id="L3658" class="css-a4x74f"><span>3658</span></td><td id="LC3658" class="css-1dcdqdg"><code>      uiSupported: <span class="code-string">'plyr--full-ui'</span>,
</code></td></tr><tr><td id="L3659" class="css-a4x74f"><span>3659</span></td><td id="LC3659" class="css-1dcdqdg"><code>      noTransition: <span class="code-string">'plyr--no-transition'</span>,
</code></td></tr><tr><td id="L3660" class="css-a4x74f"><span>3660</span></td><td id="LC3660" class="css-1dcdqdg"><code>      display: {
</code></td></tr><tr><td id="L3661" class="css-a4x74f"><span>3661</span></td><td id="LC3661" class="css-1dcdqdg"><code>        time: <span class="code-string">'plyr__time'</span>
</code></td></tr><tr><td id="L3662" class="css-a4x74f"><span>3662</span></td><td id="LC3662" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3663" class="css-a4x74f"><span>3663</span></td><td id="LC3663" class="css-1dcdqdg"><code>      menu: {
</code></td></tr><tr><td id="L3664" class="css-a4x74f"><span>3664</span></td><td id="LC3664" class="css-1dcdqdg"><code>        value: <span class="code-string">'plyr__menu__value'</span>,
</code></td></tr><tr><td id="L3665" class="css-a4x74f"><span>3665</span></td><td id="LC3665" class="css-1dcdqdg"><code>        badge: <span class="code-string">'plyr__badge'</span>,
</code></td></tr><tr><td id="L3666" class="css-a4x74f"><span>3666</span></td><td id="LC3666" class="css-1dcdqdg"><code>        open: <span class="code-string">'plyr--menu-open'</span>
</code></td></tr><tr><td id="L3667" class="css-a4x74f"><span>3667</span></td><td id="LC3667" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3668" class="css-a4x74f"><span>3668</span></td><td id="LC3668" class="css-1dcdqdg"><code>      captions: {
</code></td></tr><tr><td id="L3669" class="css-a4x74f"><span>3669</span></td><td id="LC3669" class="css-1dcdqdg"><code>        enabled: <span class="code-string">'plyr--captions-enabled'</span>,
</code></td></tr><tr><td id="L3670" class="css-a4x74f"><span>3670</span></td><td id="LC3670" class="css-1dcdqdg"><code>        active: <span class="code-string">'plyr--captions-active'</span>
</code></td></tr><tr><td id="L3671" class="css-a4x74f"><span>3671</span></td><td id="LC3671" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3672" class="css-a4x74f"><span>3672</span></td><td id="LC3672" class="css-1dcdqdg"><code>      fullscreen: {
</code></td></tr><tr><td id="L3673" class="css-a4x74f"><span>3673</span></td><td id="LC3673" class="css-1dcdqdg"><code>        enabled: <span class="code-string">'plyr--fullscreen-enabled'</span>,
</code></td></tr><tr><td id="L3674" class="css-a4x74f"><span>3674</span></td><td id="LC3674" class="css-1dcdqdg"><code>        fallback: <span class="code-string">'plyr--fullscreen-fallback'</span>
</code></td></tr><tr><td id="L3675" class="css-a4x74f"><span>3675</span></td><td id="LC3675" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3676" class="css-a4x74f"><span>3676</span></td><td id="LC3676" class="css-1dcdqdg"><code>      pip: {
</code></td></tr><tr><td id="L3677" class="css-a4x74f"><span>3677</span></td><td id="LC3677" class="css-1dcdqdg"><code>        supported: <span class="code-string">'plyr--pip-supported'</span>,
</code></td></tr><tr><td id="L3678" class="css-a4x74f"><span>3678</span></td><td id="LC3678" class="css-1dcdqdg"><code>        active: <span class="code-string">'plyr--pip-active'</span>
</code></td></tr><tr><td id="L3679" class="css-a4x74f"><span>3679</span></td><td id="LC3679" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3680" class="css-a4x74f"><span>3680</span></td><td id="LC3680" class="css-1dcdqdg"><code>      airplay: {
</code></td></tr><tr><td id="L3681" class="css-a4x74f"><span>3681</span></td><td id="LC3681" class="css-1dcdqdg"><code>        supported: <span class="code-string">'plyr--airplay-supported'</span>,
</code></td></tr><tr><td id="L3682" class="css-a4x74f"><span>3682</span></td><td id="LC3682" class="css-1dcdqdg"><code>        active: <span class="code-string">'plyr--airplay-active'</span>
</code></td></tr><tr><td id="L3683" class="css-a4x74f"><span>3683</span></td><td id="LC3683" class="css-1dcdqdg"><code>      },
</code></td></tr><tr><td id="L3684" class="css-a4x74f"><span>3684</span></td><td id="LC3684" class="css-1dcdqdg"><code>      previewThumbnails: {
</code></td></tr><tr><td id="L3685" class="css-a4x74f"><span>3685</span></td><td id="LC3685" class="css-1dcdqdg"><code>        <span class="code-comment">// Tooltip thumbs</span>
</code></td></tr><tr><td id="L3686" class="css-a4x74f"><span>3686</span></td><td id="LC3686" class="css-1dcdqdg"><code>        thumbContainer: <span class="code-string">'plyr__preview-thumb'</span>,
</code></td></tr><tr><td id="L3687" class="css-a4x74f"><span>3687</span></td><td id="LC3687" class="css-1dcdqdg"><code>        thumbContainerShown: <span class="code-string">'plyr__preview-thumb--is-shown'</span>,
</code></td></tr><tr><td id="L3688" class="css-a4x74f"><span>3688</span></td><td id="LC3688" class="css-1dcdqdg"><code>        imageContainer: <span class="code-string">'plyr__preview-thumb__image-container'</span>,
</code></td></tr><tr><td id="L3689" class="css-a4x74f"><span>3689</span></td><td id="LC3689" class="css-1dcdqdg"><code>        timeContainer: <span class="code-string">'plyr__preview-thumb__time-container'</span>,
</code></td></tr><tr><td id="L3690" class="css-a4x74f"><span>3690</span></td><td id="LC3690" class="css-1dcdqdg"><code>        <span class="code-comment">// Scrubbing</span>
</code></td></tr><tr><td id="L3691" class="css-a4x74f"><span>3691</span></td><td id="LC3691" class="css-1dcdqdg"><code>        scrubbingContainer: <span class="code-string">'plyr__preview-scrubbing'</span>,
</code></td></tr><tr><td id="L3692" class="css-a4x74f"><span>3692</span></td><td id="LC3692" class="css-1dcdqdg"><code>        scrubbingContainerShown: <span class="code-string">'plyr__preview-scrubbing--is-shown'</span>
</code></td></tr><tr><td id="L3693" class="css-a4x74f"><span>3693</span></td><td id="LC3693" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3694" class="css-a4x74f"><span>3694</span></td><td id="LC3694" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3695" class="css-a4x74f"><span>3695</span></td><td id="LC3695" class="css-1dcdqdg"><code>    <span class="code-comment">// Embed attributes</span>
</code></td></tr><tr><td id="L3696" class="css-a4x74f"><span>3696</span></td><td id="LC3696" class="css-1dcdqdg"><code>    attributes: {
</code></td></tr><tr><td id="L3697" class="css-a4x74f"><span>3697</span></td><td id="LC3697" class="css-1dcdqdg"><code>      embed: {
</code></td></tr><tr><td id="L3698" class="css-a4x74f"><span>3698</span></td><td id="LC3698" class="css-1dcdqdg"><code>        provider: <span class="code-string">'data-plyr-provider'</span>,
</code></td></tr><tr><td id="L3699" class="css-a4x74f"><span>3699</span></td><td id="LC3699" class="css-1dcdqdg"><code>        id: <span class="code-string">'data-plyr-embed-id'</span>,
</code></td></tr><tr><td id="L3700" class="css-a4x74f"><span>3700</span></td><td id="LC3700" class="css-1dcdqdg"><code>        hash: <span class="code-string">'data-plyr-embed-hash'</span>
</code></td></tr><tr><td id="L3701" class="css-a4x74f"><span>3701</span></td><td id="LC3701" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3702" class="css-a4x74f"><span>3702</span></td><td id="LC3702" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3703" class="css-a4x74f"><span>3703</span></td><td id="LC3703" class="css-1dcdqdg"><code>    <span class="code-comment">// Advertisements plugin</span>
</code></td></tr><tr><td id="L3704" class="css-a4x74f"><span>3704</span></td><td id="LC3704" class="css-1dcdqdg"><code>    <span class="code-comment">// Register for an account here: http://vi.ai/publisher-video-monetization/?aid=plyrio</span>
</code></td></tr><tr><td id="L3705" class="css-a4x74f"><span>3705</span></td><td id="LC3705" class="css-1dcdqdg"><code>    ads: {
</code></td></tr><tr><td id="L3706" class="css-a4x74f"><span>3706</span></td><td id="LC3706" class="css-1dcdqdg"><code>      enabled: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3707" class="css-a4x74f"><span>3707</span></td><td id="LC3707" class="css-1dcdqdg"><code>      publisherId: <span class="code-string">''</span>,
</code></td></tr><tr><td id="L3708" class="css-a4x74f"><span>3708</span></td><td id="LC3708" class="css-1dcdqdg"><code>      tagUrl: <span class="code-string">''</span>
</code></td></tr><tr><td id="L3709" class="css-a4x74f"><span>3709</span></td><td id="LC3709" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3710" class="css-a4x74f"><span>3710</span></td><td id="LC3710" class="css-1dcdqdg"><code>    <span class="code-comment">// Preview Thumbnails plugin</span>
</code></td></tr><tr><td id="L3711" class="css-a4x74f"><span>3711</span></td><td id="LC3711" class="css-1dcdqdg"><code>    previewThumbnails: {
</code></td></tr><tr><td id="L3712" class="css-a4x74f"><span>3712</span></td><td id="LC3712" class="css-1dcdqdg"><code>      enabled: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3713" class="css-a4x74f"><span>3713</span></td><td id="LC3713" class="css-1dcdqdg"><code>      src: <span class="code-string">''</span>
</code></td></tr><tr><td id="L3714" class="css-a4x74f"><span>3714</span></td><td id="LC3714" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3715" class="css-a4x74f"><span>3715</span></td><td id="LC3715" class="css-1dcdqdg"><code>    <span class="code-comment">// Vimeo plugin</span>
</code></td></tr><tr><td id="L3716" class="css-a4x74f"><span>3716</span></td><td id="LC3716" class="css-1dcdqdg"><code>    vimeo: {
</code></td></tr><tr><td id="L3717" class="css-a4x74f"><span>3717</span></td><td id="LC3717" class="css-1dcdqdg"><code>      byline: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3718" class="css-a4x74f"><span>3718</span></td><td id="LC3718" class="css-1dcdqdg"><code>      portrait: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3719" class="css-a4x74f"><span>3719</span></td><td id="LC3719" class="css-1dcdqdg"><code>      title: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3720" class="css-a4x74f"><span>3720</span></td><td id="LC3720" class="css-1dcdqdg"><code>      speed: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3721" class="css-a4x74f"><span>3721</span></td><td id="LC3721" class="css-1dcdqdg"><code>      transparent: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3722" class="css-a4x74f"><span>3722</span></td><td id="LC3722" class="css-1dcdqdg"><code>      <span class="code-comment">// Custom settings from Plyr</span>
</code></td></tr><tr><td id="L3723" class="css-a4x74f"><span>3723</span></td><td id="LC3723" class="css-1dcdqdg"><code>      customControls: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3724" class="css-a4x74f"><span>3724</span></td><td id="LC3724" class="css-1dcdqdg"><code>      referrerPolicy: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L3725" class="css-a4x74f"><span>3725</span></td><td id="LC3725" class="css-1dcdqdg"><code>      <span class="code-comment">// https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy</span>
</code></td></tr><tr><td id="L3726" class="css-a4x74f"><span>3726</span></td><td id="LC3726" class="css-1dcdqdg"><code>      <span class="code-comment">// Whether the owner of the video has a Pro or Business account</span>
</code></td></tr><tr><td id="L3727" class="css-a4x74f"><span>3727</span></td><td id="LC3727" class="css-1dcdqdg"><code>      <span class="code-comment">// (which allows us to properly hide controls without CSS hacks, etc)</span>
</code></td></tr><tr><td id="L3728" class="css-a4x74f"><span>3728</span></td><td id="LC3728" class="css-1dcdqdg"><code>      premium: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L3729" class="css-a4x74f"><span>3729</span></td><td id="LC3729" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3730" class="css-a4x74f"><span>3730</span></td><td id="LC3730" class="css-1dcdqdg"><code>    <span class="code-comment">// YouTube plugin</span>
</code></td></tr><tr><td id="L3731" class="css-a4x74f"><span>3731</span></td><td id="LC3731" class="css-1dcdqdg"><code>    youtube: {
</code></td></tr><tr><td id="L3732" class="css-a4x74f"><span>3732</span></td><td id="LC3732" class="css-1dcdqdg"><code>      rel: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L3733" class="css-a4x74f"><span>3733</span></td><td id="LC3733" class="css-1dcdqdg"><code>      <span class="code-comment">// No related vids</span>
</code></td></tr><tr><td id="L3734" class="css-a4x74f"><span>3734</span></td><td id="LC3734" class="css-1dcdqdg"><code>      showinfo: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L3735" class="css-a4x74f"><span>3735</span></td><td id="LC3735" class="css-1dcdqdg"><code>      <span class="code-comment">// Hide info</span>
</code></td></tr><tr><td id="L3736" class="css-a4x74f"><span>3736</span></td><td id="LC3736" class="css-1dcdqdg"><code>      iv_load_policy: <span class="code-number">3</span>,
</code></td></tr><tr><td id="L3737" class="css-a4x74f"><span>3737</span></td><td id="LC3737" class="css-1dcdqdg"><code>      <span class="code-comment">// Hide annotations</span>
</code></td></tr><tr><td id="L3738" class="css-a4x74f"><span>3738</span></td><td id="LC3738" class="css-1dcdqdg"><code>      modestbranding: <span class="code-number">1</span>,
</code></td></tr><tr><td id="L3739" class="css-a4x74f"><span>3739</span></td><td id="LC3739" class="css-1dcdqdg"><code>      <span class="code-comment">// Hide logos as much as possible (they still show one in the corner when paused)</span>
</code></td></tr><tr><td id="L3740" class="css-a4x74f"><span>3740</span></td><td id="LC3740" class="css-1dcdqdg"><code>      <span class="code-comment">// Custom settings from Plyr</span>
</code></td></tr><tr><td id="L3741" class="css-a4x74f"><span>3741</span></td><td id="LC3741" class="css-1dcdqdg"><code>      customControls: <span class="code-literal">true</span>,
</code></td></tr><tr><td id="L3742" class="css-a4x74f"><span>3742</span></td><td id="LC3742" class="css-1dcdqdg"><code>      noCookie: <span class="code-literal">false</span> <span class="code-comment">// Whether to use an alternative version of YouTube without cookies</span>
</code></td></tr><tr><td id="L3743" class="css-a4x74f"><span>3743</span></td><td id="LC3743" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3744" class="css-a4x74f"><span>3744</span></td><td id="LC3744" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3745" class="css-a4x74f"><span>3745</span></td><td id="LC3745" class="css-1dcdqdg"><code>    <span class="code-comment">// Media Metadata</span>
</code></td></tr><tr><td id="L3746" class="css-a4x74f"><span>3746</span></td><td id="LC3746" class="css-1dcdqdg"><code>    mediaMetadata: {
</code></td></tr><tr><td id="L3747" class="css-a4x74f"><span>3747</span></td><td id="LC3747" class="css-1dcdqdg"><code>      title: <span class="code-string">''</span>,
</code></td></tr><tr><td id="L3748" class="css-a4x74f"><span>3748</span></td><td id="LC3748" class="css-1dcdqdg"><code>      artist: <span class="code-string">''</span>,
</code></td></tr><tr><td id="L3749" class="css-a4x74f"><span>3749</span></td><td id="LC3749" class="css-1dcdqdg"><code>      album: <span class="code-string">''</span>,
</code></td></tr><tr><td id="L3750" class="css-a4x74f"><span>3750</span></td><td id="LC3750" class="css-1dcdqdg"><code>      artwork: []
</code></td></tr><tr><td id="L3751" class="css-a4x74f"><span>3751</span></td><td id="LC3751" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L3752" class="css-a4x74f"><span>3752</span></td><td id="LC3752" class="css-1dcdqdg"><code>    <span class="code-comment">// Markers</span>
</code></td></tr><tr><td id="L3753" class="css-a4x74f"><span>3753</span></td><td id="LC3753" class="css-1dcdqdg"><code>    markers: {
</code></td></tr><tr><td id="L3754" class="css-a4x74f"><span>3754</span></td><td id="LC3754" class="css-1dcdqdg"><code>      enabled: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L3755" class="css-a4x74f"><span>3755</span></td><td id="LC3755" class="css-1dcdqdg"><code>      points: []
</code></td></tr><tr><td id="L3756" class="css-a4x74f"><span>3756</span></td><td id="LC3756" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3757" class="css-a4x74f"><span>3757</span></td><td id="LC3757" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L3758" class="css-a4x74f"><span>3758</span></td><td id="LC3758" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3759" class="css-a4x74f"><span>3759</span></td><td id="LC3759" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3760" class="css-a4x74f"><span>3760</span></td><td id="LC3760" class="css-1dcdqdg"><code>  <span class="code-comment">// Plyr states</span>
</code></td></tr><tr><td id="L3761" class="css-a4x74f"><span>3761</span></td><td id="LC3761" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3762" class="css-a4x74f"><span>3762</span></td><td id="LC3762" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3763" class="css-a4x74f"><span>3763</span></td><td id="LC3763" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> pip = {
</code></td></tr><tr><td id="L3764" class="css-a4x74f"><span>3764</span></td><td id="LC3764" class="css-1dcdqdg"><code>    active: <span class="code-string">'picture-in-picture'</span>,
</code></td></tr><tr><td id="L3765" class="css-a4x74f"><span>3765</span></td><td id="LC3765" class="css-1dcdqdg"><code>    inactive: <span class="code-string">'inline'</span>
</code></td></tr><tr><td id="L3766" class="css-a4x74f"><span>3766</span></td><td id="LC3766" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L3767" class="css-a4x74f"><span>3767</span></td><td id="LC3767" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3768" class="css-a4x74f"><span>3768</span></td><td id="LC3768" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3769" class="css-a4x74f"><span>3769</span></td><td id="LC3769" class="css-1dcdqdg"><code>  <span class="code-comment">// Plyr supported types and providers</span>
</code></td></tr><tr><td id="L3770" class="css-a4x74f"><span>3770</span></td><td id="LC3770" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3771" class="css-a4x74f"><span>3771</span></td><td id="LC3771" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3772" class="css-a4x74f"><span>3772</span></td><td id="LC3772" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> providers = {
</code></td></tr><tr><td id="L3773" class="css-a4x74f"><span>3773</span></td><td id="LC3773" class="css-1dcdqdg"><code>    html5: <span class="code-string">'html5'</span>,
</code></td></tr><tr><td id="L3774" class="css-a4x74f"><span>3774</span></td><td id="LC3774" class="css-1dcdqdg"><code>    youtube: <span class="code-string">'youtube'</span>,
</code></td></tr><tr><td id="L3775" class="css-a4x74f"><span>3775</span></td><td id="LC3775" class="css-1dcdqdg"><code>    vimeo: <span class="code-string">'vimeo'</span>
</code></td></tr><tr><td id="L3776" class="css-a4x74f"><span>3776</span></td><td id="LC3776" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L3777" class="css-a4x74f"><span>3777</span></td><td id="LC3777" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> types = {
</code></td></tr><tr><td id="L3778" class="css-a4x74f"><span>3778</span></td><td id="LC3778" class="css-1dcdqdg"><code>    audio: <span class="code-string">'audio'</span>,
</code></td></tr><tr><td id="L3779" class="css-a4x74f"><span>3779</span></td><td id="LC3779" class="css-1dcdqdg"><code>    video: <span class="code-string">'video'</span>
</code></td></tr><tr><td id="L3780" class="css-a4x74f"><span>3780</span></td><td id="LC3780" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L3781" class="css-a4x74f"><span>3781</span></td><td id="LC3781" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3782" class="css-a4x74f"><span>3782</span></td><td id="LC3782" class="css-1dcdqdg"><code>  <span class="code-comment">/**
</span></code></td></tr><tr><td id="L3783" class="css-a4x74f"><span>3783</span></td><td id="LC3783" class="css-1dcdqdg"><code><span class="code-comment">   * Get provider by URL
</span></code></td></tr><tr><td id="L3784" class="css-a4x74f"><span>3784</span></td><td id="LC3784" class="css-1dcdqdg"><code><span class="code-comment">   * @param {String} url
</span></code></td></tr><tr><td id="L3785" class="css-a4x74f"><span>3785</span></td><td id="LC3785" class="css-1dcdqdg"><code><span class="code-comment">   */</span>
</code></td></tr><tr><td id="L3786" class="css-a4x74f"><span>3786</span></td><td id="LC3786" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getProviderByUrl</span>(<span class="code-params">url</span>) </span>{
</code></td></tr><tr><td id="L3787" class="css-a4x74f"><span>3787</span></td><td id="LC3787" class="css-1dcdqdg"><code>    <span class="code-comment">// YouTube</span>
</code></td></tr><tr><td id="L3788" class="css-a4x74f"><span>3788</span></td><td id="LC3788" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-regexp">/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/</span>.test(url)) {
</code></td></tr><tr><td id="L3789" class="css-a4x74f"><span>3789</span></td><td id="LC3789" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> providers.youtube;
</code></td></tr><tr><td id="L3790" class="css-a4x74f"><span>3790</span></td><td id="LC3790" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3791" class="css-a4x74f"><span>3791</span></td><td id="LC3791" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3792" class="css-a4x74f"><span>3792</span></td><td id="LC3792" class="css-1dcdqdg"><code>    <span class="code-comment">// Vimeo</span>
</code></td></tr><tr><td id="L3793" class="css-a4x74f"><span>3793</span></td><td id="LC3793" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-regexp">/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/</span>.test(url)) {
</code></td></tr><tr><td id="L3794" class="css-a4x74f"><span>3794</span></td><td id="LC3794" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> providers.vimeo;
</code></td></tr><tr><td id="L3795" class="css-a4x74f"><span>3795</span></td><td id="LC3795" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3796" class="css-a4x74f"><span>3796</span></td><td id="LC3796" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L3797" class="css-a4x74f"><span>3797</span></td><td id="LC3797" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L3798" class="css-a4x74f"><span>3798</span></td><td id="LC3798" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3799" class="css-a4x74f"><span>3799</span></td><td id="LC3799" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3800" class="css-a4x74f"><span>3800</span></td><td id="LC3800" class="css-1dcdqdg"><code>  <span class="code-comment">// Console wrapper</span>
</code></td></tr><tr><td id="L3801" class="css-a4x74f"><span>3801</span></td><td id="LC3801" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L3802" class="css-a4x74f"><span>3802</span></td><td id="LC3802" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3803" class="css-a4x74f"><span>3803</span></td><td id="LC3803" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> noop = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {};
</code></td></tr><tr><td id="L3804" class="css-a4x74f"><span>3804</span></td><td id="LC3804" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Console</span> </span>{
</code></td></tr><tr><td id="L3805" class="css-a4x74f"><span>3805</span></td><td id="LC3805" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(enabled = false) {
</code></td></tr><tr><td id="L3806" class="css-a4x74f"><span>3806</span></td><td id="LC3806" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.enabled = <span class="code-built_in">window</span>.console &amp;&amp; enabled;
</code></td></tr><tr><td id="L3807" class="css-a4x74f"><span>3807</span></td><td id="LC3807" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L3808" class="css-a4x74f"><span>3808</span></td><td id="LC3808" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.log(<span class="code-string">'Debugging enabled'</span>);
</code></td></tr><tr><td id="L3809" class="css-a4x74f"><span>3809</span></td><td id="LC3809" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L3810" class="css-a4x74f"><span>3810</span></td><td id="LC3810" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3811" class="css-a4x74f"><span>3811</span></td><td id="LC3811" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> log() {
</code></td></tr><tr><td id="L3812" class="css-a4x74f"><span>3812</span></td><td id="LC3812" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line no-console</span>
</code></td></tr><tr><td id="L3813" class="css-a4x74f"><span>3813</span></td><td id="LC3813" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.enabled ? <span class="code-built_in">Function</span>.prototype.bind.call(<span class="code-built_in">console</span>.log, <span class="code-built_in">console</span>) : noop;
</code></td></tr><tr><td id="L3814" class="css-a4x74f"><span>3814</span></td><td id="LC3814" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3815" class="css-a4x74f"><span>3815</span></td><td id="LC3815" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> warn() {
</code></td></tr><tr><td id="L3816" class="css-a4x74f"><span>3816</span></td><td id="LC3816" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line no-console</span>
</code></td></tr><tr><td id="L3817" class="css-a4x74f"><span>3817</span></td><td id="LC3817" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.enabled ? <span class="code-built_in">Function</span>.prototype.bind.call(<span class="code-built_in">console</span>.warn, <span class="code-built_in">console</span>) : noop;
</code></td></tr><tr><td id="L3818" class="css-a4x74f"><span>3818</span></td><td id="LC3818" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3819" class="css-a4x74f"><span>3819</span></td><td id="LC3819" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> error() {
</code></td></tr><tr><td id="L3820" class="css-a4x74f"><span>3820</span></td><td id="LC3820" class="css-1dcdqdg"><code>      <span class="code-comment">// eslint-disable-next-line no-console</span>
</code></td></tr><tr><td id="L3821" class="css-a4x74f"><span>3821</span></td><td id="LC3821" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.enabled ? <span class="code-built_in">Function</span>.prototype.bind.call(<span class="code-built_in">console</span>.error, <span class="code-built_in">console</span>) : noop;
</code></td></tr><tr><td id="L3822" class="css-a4x74f"><span>3822</span></td><td id="LC3822" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L3823" class="css-a4x74f"><span>3823</span></td><td id="LC3823" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L3824" class="css-a4x74f"><span>3824</span></td><td id="LC3824" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3825" class="css-a4x74f"><span>3825</span></td><td id="LC3825" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Fullscreen</span> </span>{
</code></td></tr><tr><td id="L3826" class="css-a4x74f"><span>3826</span></td><td id="LC3826" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(player) {
</code></td></tr><tr><td id="L3827" class="css-a4x74f"><span>3827</span></td><td id="LC3827" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"onChange"</span>, () =&gt; {
</code></td></tr><tr><td id="L3828" class="css-a4x74f"><span>3828</span></td><td id="LC3828" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3829" class="css-a4x74f"><span>3829</span></td><td id="LC3829" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3830" class="css-a4x74f"><span>3830</span></td><td id="LC3830" class="css-1dcdqdg"><code>        <span class="code-comment">// Update toggle button</span>
</code></td></tr><tr><td id="L3831" class="css-a4x74f"><span>3831</span></td><td id="LC3831" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> button = <span class="code-keyword">this</span>.player.elements.buttons.fullscreen;
</code></td></tr><tr><td id="L3832" class="css-a4x74f"><span>3832</span></td><td id="LC3832" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(button)) {
</code></td></tr><tr><td id="L3833" class="css-a4x74f"><span>3833</span></td><td id="LC3833" class="css-1dcdqdg"><code>          button.pressed = <span class="code-keyword">this</span>.active;
</code></td></tr><tr><td id="L3834" class="css-a4x74f"><span>3834</span></td><td id="LC3834" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3835" class="css-a4x74f"><span>3835</span></td><td id="LC3835" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3836" class="css-a4x74f"><span>3836</span></td><td id="LC3836" class="css-1dcdqdg"><code>        <span class="code-comment">// Always trigger events on the plyr / media element (not a fullscreen container) and let them bubble up</span>
</code></td></tr><tr><td id="L3837" class="css-a4x74f"><span>3837</span></td><td id="LC3837" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> target = <span class="code-keyword">this</span>.target === <span class="code-keyword">this</span>.player.media ? <span class="code-keyword">this</span>.target : <span class="code-keyword">this</span>.player.elements.container;
</code></td></tr><tr><td id="L3838" class="css-a4x74f"><span>3838</span></td><td id="LC3838" class="css-1dcdqdg"><code>        <span class="code-comment">// Trigger an event</span>
</code></td></tr><tr><td id="L3839" class="css-a4x74f"><span>3839</span></td><td id="LC3839" class="css-1dcdqdg"><code>        triggerEvent.call(<span class="code-keyword">this</span>.player, target, <span class="code-keyword">this</span>.active ? <span class="code-string">'enterfullscreen'</span> : <span class="code-string">'exitfullscreen'</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L3840" class="css-a4x74f"><span>3840</span></td><td id="LC3840" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3841" class="css-a4x74f"><span>3841</span></td><td id="LC3841" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"toggleFallback"</span>, (toggle = <span class="code-literal">false</span>) =&gt; {
</code></td></tr><tr><td id="L3842" class="css-a4x74f"><span>3842</span></td><td id="LC3842" class="css-1dcdqdg"><code>        <span class="code-comment">// Store or restore scroll position</span>
</code></td></tr><tr><td id="L3843" class="css-a4x74f"><span>3843</span></td><td id="LC3843" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (toggle) {
</code></td></tr><tr><td id="L3844" class="css-a4x74f"><span>3844</span></td><td id="LC3844" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.scrollPosition = {
</code></td></tr><tr><td id="L3845" class="css-a4x74f"><span>3845</span></td><td id="LC3845" class="css-1dcdqdg"><code>            x: <span class="code-built_in">window</span>.scrollX ?? <span class="code-number">0</span>,
</code></td></tr><tr><td id="L3846" class="css-a4x74f"><span>3846</span></td><td id="LC3846" class="css-1dcdqdg"><code>            y: <span class="code-built_in">window</span>.scrollY ?? <span class="code-number">0</span>
</code></td></tr><tr><td id="L3847" class="css-a4x74f"><span>3847</span></td><td id="LC3847" class="css-1dcdqdg"><code>          };
</code></td></tr><tr><td id="L3848" class="css-a4x74f"><span>3848</span></td><td id="LC3848" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L3849" class="css-a4x74f"><span>3849</span></td><td id="LC3849" class="css-1dcdqdg"><code>          <span class="code-built_in">window</span>.scrollTo(<span class="code-keyword">this</span>.scrollPosition.x, <span class="code-keyword">this</span>.scrollPosition.y);
</code></td></tr><tr><td id="L3850" class="css-a4x74f"><span>3850</span></td><td id="LC3850" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3851" class="css-a4x74f"><span>3851</span></td><td id="LC3851" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3852" class="css-a4x74f"><span>3852</span></td><td id="LC3852" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle scroll</span>
</code></td></tr><tr><td id="L3853" class="css-a4x74f"><span>3853</span></td><td id="LC3853" class="css-1dcdqdg"><code>        <span class="code-built_in">document</span>.body.style.overflow = toggle ? <span class="code-string">'hidden'</span> : <span class="code-string">''</span>;
</code></td></tr><tr><td id="L3854" class="css-a4x74f"><span>3854</span></td><td id="LC3854" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3855" class="css-a4x74f"><span>3855</span></td><td id="LC3855" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle class hook</span>
</code></td></tr><tr><td id="L3856" class="css-a4x74f"><span>3856</span></td><td id="LC3856" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.target, <span class="code-keyword">this</span>.player.config.classNames.fullscreen.fallback, toggle);
</code></td></tr><tr><td id="L3857" class="css-a4x74f"><span>3857</span></td><td id="LC3857" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3858" class="css-a4x74f"><span>3858</span></td><td id="LC3858" class="css-1dcdqdg"><code>        <span class="code-comment">// Force full viewport on iPhone X+</span>
</code></td></tr><tr><td id="L3859" class="css-a4x74f"><span>3859</span></td><td id="LC3859" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isIos) {
</code></td></tr><tr><td id="L3860" class="css-a4x74f"><span>3860</span></td><td id="LC3860" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> viewport = <span class="code-built_in">document</span>.head.querySelector(<span class="code-string">'meta[name="viewport"]'</span>);
</code></td></tr><tr><td id="L3861" class="css-a4x74f"><span>3861</span></td><td id="LC3861" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> property = <span class="code-string">'viewport-fit=cover'</span>;
</code></td></tr><tr><td id="L3862" class="css-a4x74f"><span>3862</span></td><td id="LC3862" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3863" class="css-a4x74f"><span>3863</span></td><td id="LC3863" class="css-1dcdqdg"><code>          <span class="code-comment">// Inject the viewport meta if required</span>
</code></td></tr><tr><td id="L3864" class="css-a4x74f"><span>3864</span></td><td id="LC3864" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!viewport) {
</code></td></tr><tr><td id="L3865" class="css-a4x74f"><span>3865</span></td><td id="LC3865" class="css-1dcdqdg"><code>            viewport = <span class="code-built_in">document</span>.createElement(<span class="code-string">'meta'</span>);
</code></td></tr><tr><td id="L3866" class="css-a4x74f"><span>3866</span></td><td id="LC3866" class="css-1dcdqdg"><code>            viewport.setAttribute(<span class="code-string">'name'</span>, <span class="code-string">'viewport'</span>);
</code></td></tr><tr><td id="L3867" class="css-a4x74f"><span>3867</span></td><td id="LC3867" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3868" class="css-a4x74f"><span>3868</span></td><td id="LC3868" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3869" class="css-a4x74f"><span>3869</span></td><td id="LC3869" class="css-1dcdqdg"><code>          <span class="code-comment">// Check if the property already exists</span>
</code></td></tr><tr><td id="L3870" class="css-a4x74f"><span>3870</span></td><td id="LC3870" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> hasProperty = is.string(viewport.content) &amp;&amp; viewport.content.includes(property);
</code></td></tr><tr><td id="L3871" class="css-a4x74f"><span>3871</span></td><td id="LC3871" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (toggle) {
</code></td></tr><tr><td id="L3872" class="css-a4x74f"><span>3872</span></td><td id="LC3872" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.cleanupViewport = !hasProperty;
</code></td></tr><tr><td id="L3873" class="css-a4x74f"><span>3873</span></td><td id="LC3873" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!hasProperty) viewport.content += <span class="code-string">`,<span class="code-subst">${property}</span>`</span>;
</code></td></tr><tr><td id="L3874" class="css-a4x74f"><span>3874</span></td><td id="LC3874" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.cleanupViewport) {
</code></td></tr><tr><td id="L3875" class="css-a4x74f"><span>3875</span></td><td id="LC3875" class="css-1dcdqdg"><code>            viewport.content = viewport.content.split(<span class="code-string">','</span>).filter(<span class="code-function"><span class="code-params">part</span> =&gt;</span> part.trim() !== property).join(<span class="code-string">','</span>);
</code></td></tr><tr><td id="L3876" class="css-a4x74f"><span>3876</span></td><td id="LC3876" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3877" class="css-a4x74f"><span>3877</span></td><td id="LC3877" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3878" class="css-a4x74f"><span>3878</span></td><td id="LC3878" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3879" class="css-a4x74f"><span>3879</span></td><td id="LC3879" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle button and fire events</span>
</code></td></tr><tr><td id="L3880" class="css-a4x74f"><span>3880</span></td><td id="LC3880" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.onChange();
</code></td></tr><tr><td id="L3881" class="css-a4x74f"><span>3881</span></td><td id="LC3881" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3882" class="css-a4x74f"><span>3882</span></td><td id="LC3882" class="css-1dcdqdg"><code>      <span class="code-comment">// Trap focus inside container</span>
</code></td></tr><tr><td id="L3883" class="css-a4x74f"><span>3883</span></td><td id="LC3883" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"trapFocus"</span>, event =&gt; {
</code></td></tr><tr><td id="L3884" class="css-a4x74f"><span>3884</span></td><td id="LC3884" class="css-1dcdqdg"><code>        <span class="code-comment">// Bail if iOS/iPadOS, not active, not the tab key</span>
</code></td></tr><tr><td id="L3885" class="css-a4x74f"><span>3885</span></td><td id="LC3885" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isIos || browser.isIPadOS || !<span class="code-keyword">this</span>.active || event.key !== <span class="code-string">'Tab'</span>) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3886" class="css-a4x74f"><span>3886</span></td><td id="LC3886" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3887" class="css-a4x74f"><span>3887</span></td><td id="LC3887" class="css-1dcdqdg"><code>        <span class="code-comment">// Get the current focused element</span>
</code></td></tr><tr><td id="L3888" class="css-a4x74f"><span>3888</span></td><td id="LC3888" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> focused = <span class="code-built_in">document</span>.activeElement;
</code></td></tr><tr><td id="L3889" class="css-a4x74f"><span>3889</span></td><td id="LC3889" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> focusable = getElements.call(<span class="code-keyword">this</span>.player, <span class="code-string">'a[href], button:not(:disabled), input:not(:disabled), [tabindex]'</span>);
</code></td></tr><tr><td id="L3890" class="css-a4x74f"><span>3890</span></td><td id="LC3890" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> [first] = focusable;
</code></td></tr><tr><td id="L3891" class="css-a4x74f"><span>3891</span></td><td id="LC3891" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> last = focusable[focusable.length - <span class="code-number">1</span>];
</code></td></tr><tr><td id="L3892" class="css-a4x74f"><span>3892</span></td><td id="LC3892" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (focused === last &amp;&amp; !event.shiftKey) {
</code></td></tr><tr><td id="L3893" class="css-a4x74f"><span>3893</span></td><td id="LC3893" class="css-1dcdqdg"><code>          <span class="code-comment">// Move focus to first element that can be tabbed if Shift isn't used</span>
</code></td></tr><tr><td id="L3894" class="css-a4x74f"><span>3894</span></td><td id="LC3894" class="css-1dcdqdg"><code>          first.focus();
</code></td></tr><tr><td id="L3895" class="css-a4x74f"><span>3895</span></td><td id="LC3895" class="css-1dcdqdg"><code>          event.preventDefault();
</code></td></tr><tr><td id="L3896" class="css-a4x74f"><span>3896</span></td><td id="LC3896" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (focused === first &amp;&amp; event.shiftKey) {
</code></td></tr><tr><td id="L3897" class="css-a4x74f"><span>3897</span></td><td id="LC3897" class="css-1dcdqdg"><code>          <span class="code-comment">// Move focus to last element that can be tabbed if Shift is used</span>
</code></td></tr><tr><td id="L3898" class="css-a4x74f"><span>3898</span></td><td id="LC3898" class="css-1dcdqdg"><code>          last.focus();
</code></td></tr><tr><td id="L3899" class="css-a4x74f"><span>3899</span></td><td id="LC3899" class="css-1dcdqdg"><code>          event.preventDefault();
</code></td></tr><tr><td id="L3900" class="css-a4x74f"><span>3900</span></td><td id="LC3900" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3901" class="css-a4x74f"><span>3901</span></td><td id="LC3901" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3902" class="css-a4x74f"><span>3902</span></td><td id="LC3902" class="css-1dcdqdg"><code>      <span class="code-comment">// Update UI</span>
</code></td></tr><tr><td id="L3903" class="css-a4x74f"><span>3903</span></td><td id="LC3903" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"update"</span>, () =&gt; {
</code></td></tr><tr><td id="L3904" class="css-a4x74f"><span>3904</span></td><td id="LC3904" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.supported) {
</code></td></tr><tr><td id="L3905" class="css-a4x74f"><span>3905</span></td><td id="LC3905" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> mode;
</code></td></tr><tr><td id="L3906" class="css-a4x74f"><span>3906</span></td><td id="LC3906" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.forceFallback) mode = <span class="code-string">'Fallback (forced)'</span>;<span class="code-keyword">else</span> <span class="code-keyword">if</span> (Fullscreen.nativeSupported) mode = <span class="code-string">'Native'</span>;<span class="code-keyword">else</span> mode = <span class="code-string">'Fallback'</span>;
</code></td></tr><tr><td id="L3907" class="css-a4x74f"><span>3907</span></td><td id="LC3907" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`<span class="code-subst">${mode}</span> fullscreen enabled`</span>);
</code></td></tr><tr><td id="L3908" class="css-a4x74f"><span>3908</span></td><td id="LC3908" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L3909" class="css-a4x74f"><span>3909</span></td><td id="LC3909" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">'Fullscreen not supported and fallback disabled'</span>);
</code></td></tr><tr><td id="L3910" class="css-a4x74f"><span>3910</span></td><td id="LC3910" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3911" class="css-a4x74f"><span>3911</span></td><td id="LC3911" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3912" class="css-a4x74f"><span>3912</span></td><td id="LC3912" class="css-1dcdqdg"><code>        <span class="code-comment">// Add styling hook to show button</span>
</code></td></tr><tr><td id="L3913" class="css-a4x74f"><span>3913</span></td><td id="LC3913" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.player.elements.container, <span class="code-keyword">this</span>.player.config.classNames.fullscreen.enabled, <span class="code-keyword">this</span>.supported);
</code></td></tr><tr><td id="L3914" class="css-a4x74f"><span>3914</span></td><td id="LC3914" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3915" class="css-a4x74f"><span>3915</span></td><td id="LC3915" class="css-1dcdqdg"><code>      <span class="code-comment">// Make an element fullscreen</span>
</code></td></tr><tr><td id="L3916" class="css-a4x74f"><span>3916</span></td><td id="LC3916" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"enter"</span>, () =&gt; {
</code></td></tr><tr><td id="L3917" class="css-a4x74f"><span>3917</span></td><td id="LC3917" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3918" class="css-a4x74f"><span>3918</span></td><td id="LC3918" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3919" class="css-a4x74f"><span>3919</span></td><td id="LC3919" class="css-1dcdqdg"><code>        <span class="code-comment">// iOS native fullscreen doesn't need the request step</span>
</code></td></tr><tr><td id="L3920" class="css-a4x74f"><span>3920</span></td><td id="LC3920" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isIos &amp;&amp; <span class="code-keyword">this</span>.player.config.fullscreen.iosNative) {
</code></td></tr><tr><td id="L3921" class="css-a4x74f"><span>3921</span></td><td id="LC3921" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.player.isVimeo) {
</code></td></tr><tr><td id="L3922" class="css-a4x74f"><span>3922</span></td><td id="LC3922" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.player.embed.requestFullscreen();
</code></td></tr><tr><td id="L3923" class="css-a4x74f"><span>3923</span></td><td id="LC3923" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L3924" class="css-a4x74f"><span>3924</span></td><td id="LC3924" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.target.webkitEnterFullscreen();
</code></td></tr><tr><td id="L3925" class="css-a4x74f"><span>3925</span></td><td id="LC3925" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3926" class="css-a4x74f"><span>3926</span></td><td id="LC3926" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!Fullscreen.nativeSupported || <span class="code-keyword">this</span>.forceFallback) {
</code></td></tr><tr><td id="L3927" class="css-a4x74f"><span>3927</span></td><td id="LC3927" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleFallback(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L3928" class="css-a4x74f"><span>3928</span></td><td id="LC3928" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.prefix) {
</code></td></tr><tr><td id="L3929" class="css-a4x74f"><span>3929</span></td><td id="LC3929" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.target.requestFullscreen({
</code></td></tr><tr><td id="L3930" class="css-a4x74f"><span>3930</span></td><td id="LC3930" class="css-1dcdqdg"><code>            navigationUI: <span class="code-string">'hide'</span>
</code></td></tr><tr><td id="L3931" class="css-a4x74f"><span>3931</span></td><td id="LC3931" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L3932" class="css-a4x74f"><span>3932</span></td><td id="LC3932" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.prefix)) {
</code></td></tr><tr><td id="L3933" class="css-a4x74f"><span>3933</span></td><td id="LC3933" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.target[<span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.prefix}</span>Request<span class="code-subst">${<span class="code-keyword">this</span>.property}</span>`</span>]();
</code></td></tr><tr><td id="L3934" class="css-a4x74f"><span>3934</span></td><td id="LC3934" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3935" class="css-a4x74f"><span>3935</span></td><td id="LC3935" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3936" class="css-a4x74f"><span>3936</span></td><td id="LC3936" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail from fullscreen</span>
</code></td></tr><tr><td id="L3937" class="css-a4x74f"><span>3937</span></td><td id="LC3937" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"exit"</span>, () =&gt; {
</code></td></tr><tr><td id="L3938" class="css-a4x74f"><span>3938</span></td><td id="LC3938" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3939" class="css-a4x74f"><span>3939</span></td><td id="LC3939" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3940" class="css-a4x74f"><span>3940</span></td><td id="LC3940" class="css-1dcdqdg"><code>        <span class="code-comment">// iOS native fullscreen</span>
</code></td></tr><tr><td id="L3941" class="css-a4x74f"><span>3941</span></td><td id="LC3941" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isIos &amp;&amp; <span class="code-keyword">this</span>.player.config.fullscreen.iosNative) {
</code></td></tr><tr><td id="L3942" class="css-a4x74f"><span>3942</span></td><td id="LC3942" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.player.isVimeo) {
</code></td></tr><tr><td id="L3943" class="css-a4x74f"><span>3943</span></td><td id="LC3943" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.player.embed.exitFullscreen();
</code></td></tr><tr><td id="L3944" class="css-a4x74f"><span>3944</span></td><td id="LC3944" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L3945" class="css-a4x74f"><span>3945</span></td><td id="LC3945" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.target.webkitEnterFullscreen();
</code></td></tr><tr><td id="L3946" class="css-a4x74f"><span>3946</span></td><td id="LC3946" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L3947" class="css-a4x74f"><span>3947</span></td><td id="LC3947" class="css-1dcdqdg"><code>          silencePromise(<span class="code-keyword">this</span>.player.play());
</code></td></tr><tr><td id="L3948" class="css-a4x74f"><span>3948</span></td><td id="LC3948" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!Fullscreen.nativeSupported || <span class="code-keyword">this</span>.forceFallback) {
</code></td></tr><tr><td id="L3949" class="css-a4x74f"><span>3949</span></td><td id="LC3949" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleFallback(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L3950" class="css-a4x74f"><span>3950</span></td><td id="LC3950" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.prefix) {
</code></td></tr><tr><td id="L3951" class="css-a4x74f"><span>3951</span></td><td id="LC3951" class="css-1dcdqdg"><code>          (<span class="code-built_in">document</span>.cancelFullScreen || <span class="code-built_in">document</span>.exitFullscreen).call(<span class="code-built_in">document</span>);
</code></td></tr><tr><td id="L3952" class="css-a4x74f"><span>3952</span></td><td id="LC3952" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.prefix)) {
</code></td></tr><tr><td id="L3953" class="css-a4x74f"><span>3953</span></td><td id="LC3953" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> action = <span class="code-keyword">this</span>.prefix === <span class="code-string">'moz'</span> ? <span class="code-string">'Cancel'</span> : <span class="code-string">'Exit'</span>;
</code></td></tr><tr><td id="L3954" class="css-a4x74f"><span>3954</span></td><td id="LC3954" class="css-1dcdqdg"><code>          <span class="code-built_in">document</span>[<span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.prefix}</span><span class="code-subst">${action}</span><span class="code-subst">${<span class="code-keyword">this</span>.property}</span>`</span>]();
</code></td></tr><tr><td id="L3955" class="css-a4x74f"><span>3955</span></td><td id="LC3955" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3956" class="css-a4x74f"><span>3956</span></td><td id="LC3956" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3957" class="css-a4x74f"><span>3957</span></td><td id="LC3957" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle state</span>
</code></td></tr><tr><td id="L3958" class="css-a4x74f"><span>3958</span></td><td id="LC3958" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"toggle"</span>, () =&gt; {
</code></td></tr><tr><td id="L3959" class="css-a4x74f"><span>3959</span></td><td id="LC3959" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.active) <span class="code-keyword">this</span>.enter();<span class="code-keyword">else</span> <span class="code-keyword">this</span>.exit();
</code></td></tr><tr><td id="L3960" class="css-a4x74f"><span>3960</span></td><td id="LC3960" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3961" class="css-a4x74f"><span>3961</span></td><td id="LC3961" class="css-1dcdqdg"><code>      <span class="code-comment">// Keep reference to parent</span>
</code></td></tr><tr><td id="L3962" class="css-a4x74f"><span>3962</span></td><td id="LC3962" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player = player;
</code></td></tr><tr><td id="L3963" class="css-a4x74f"><span>3963</span></td><td id="LC3963" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3964" class="css-a4x74f"><span>3964</span></td><td id="LC3964" class="css-1dcdqdg"><code>      <span class="code-comment">// Get prefix</span>
</code></td></tr><tr><td id="L3965" class="css-a4x74f"><span>3965</span></td><td id="LC3965" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.prefix = Fullscreen.prefix;
</code></td></tr><tr><td id="L3966" class="css-a4x74f"><span>3966</span></td><td id="LC3966" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.property = Fullscreen.property;
</code></td></tr><tr><td id="L3967" class="css-a4x74f"><span>3967</span></td><td id="LC3967" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3968" class="css-a4x74f"><span>3968</span></td><td id="LC3968" class="css-1dcdqdg"><code>      <span class="code-comment">// Scroll position</span>
</code></td></tr><tr><td id="L3969" class="css-a4x74f"><span>3969</span></td><td id="LC3969" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.scrollPosition = {
</code></td></tr><tr><td id="L3970" class="css-a4x74f"><span>3970</span></td><td id="LC3970" class="css-1dcdqdg"><code>        x: <span class="code-number">0</span>,
</code></td></tr><tr><td id="L3971" class="css-a4x74f"><span>3971</span></td><td id="LC3971" class="css-1dcdqdg"><code>        y: <span class="code-number">0</span>
</code></td></tr><tr><td id="L3972" class="css-a4x74f"><span>3972</span></td><td id="LC3972" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L3973" class="css-a4x74f"><span>3973</span></td><td id="LC3973" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3974" class="css-a4x74f"><span>3974</span></td><td id="LC3974" class="css-1dcdqdg"><code>      <span class="code-comment">// Force the use of 'full window/browser' rather than fullscreen</span>
</code></td></tr><tr><td id="L3975" class="css-a4x74f"><span>3975</span></td><td id="LC3975" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.forceFallback = player.config.fullscreen.fallback === <span class="code-string">'force'</span>;
</code></td></tr><tr><td id="L3976" class="css-a4x74f"><span>3976</span></td><td id="LC3976" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3977" class="css-a4x74f"><span>3977</span></td><td id="LC3977" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the fullscreen element</span>
</code></td></tr><tr><td id="L3978" class="css-a4x74f"><span>3978</span></td><td id="LC3978" class="css-1dcdqdg"><code>      <span class="code-comment">// Checks container is an ancestor, defaults to null</span>
</code></td></tr><tr><td id="L3979" class="css-a4x74f"><span>3979</span></td><td id="LC3979" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player.elements.fullscreen = player.config.fullscreen.container &amp;&amp; closest$<span class="code-number">1</span>(<span class="code-keyword">this</span>.player.elements.container, player.config.fullscreen.container);
</code></td></tr><tr><td id="L3980" class="css-a4x74f"><span>3980</span></td><td id="LC3980" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3981" class="css-a4x74f"><span>3981</span></td><td id="LC3981" class="css-1dcdqdg"><code>      <span class="code-comment">// Register event listeners</span>
</code></td></tr><tr><td id="L3982" class="css-a4x74f"><span>3982</span></td><td id="LC3982" class="css-1dcdqdg"><code>      <span class="code-comment">// Handle event (incase user presses escape etc)</span>
</code></td></tr><tr><td id="L3983" class="css-a4x74f"><span>3983</span></td><td id="LC3983" class="css-1dcdqdg"><code>      on.call(<span class="code-keyword">this</span>.player, <span class="code-built_in">document</span>, <span class="code-keyword">this</span>.prefix === <span class="code-string">'ms'</span> ? <span class="code-string">'MSFullscreenChange'</span> : <span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.prefix}</span>fullscreenchange`</span>, () =&gt; {
</code></td></tr><tr><td id="L3984" class="css-a4x74f"><span>3984</span></td><td id="LC3984" class="css-1dcdqdg"><code>        <span class="code-comment">// <span class="code-doctag">TODO:</span> Filter for target??</span>
</code></td></tr><tr><td id="L3985" class="css-a4x74f"><span>3985</span></td><td id="LC3985" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.onChange();
</code></td></tr><tr><td id="L3986" class="css-a4x74f"><span>3986</span></td><td id="LC3986" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3987" class="css-a4x74f"><span>3987</span></td><td id="LC3987" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3988" class="css-a4x74f"><span>3988</span></td><td id="LC3988" class="css-1dcdqdg"><code>      <span class="code-comment">// Fullscreen toggle on double click</span>
</code></td></tr><tr><td id="L3989" class="css-a4x74f"><span>3989</span></td><td id="LC3989" class="css-1dcdqdg"><code>      on.call(<span class="code-keyword">this</span>.player, <span class="code-keyword">this</span>.player.elements.container, <span class="code-string">'dblclick'</span>, event =&gt; {
</code></td></tr><tr><td id="L3990" class="css-a4x74f"><span>3990</span></td><td id="LC3990" class="css-1dcdqdg"><code>        <span class="code-comment">// Ignore double click in controls</span>
</code></td></tr><tr><td id="L3991" class="css-a4x74f"><span>3991</span></td><td id="LC3991" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.player.elements.controls) &amp;&amp; <span class="code-keyword">this</span>.player.elements.controls.contains(event.target)) {
</code></td></tr><tr><td id="L3992" class="css-a4x74f"><span>3992</span></td><td id="LC3992" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L3993" class="css-a4x74f"><span>3993</span></td><td id="LC3993" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L3994" class="css-a4x74f"><span>3994</span></td><td id="LC3994" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.listeners.proxy(event, <span class="code-keyword">this</span>.toggle, <span class="code-string">'fullscreen'</span>);
</code></td></tr><tr><td id="L3995" class="css-a4x74f"><span>3995</span></td><td id="LC3995" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L3996" class="css-a4x74f"><span>3996</span></td><td id="LC3996" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L3997" class="css-a4x74f"><span>3997</span></td><td id="LC3997" class="css-1dcdqdg"><code>      <span class="code-comment">// Tap focus when in fullscreen</span>
</code></td></tr><tr><td id="L3998" class="css-a4x74f"><span>3998</span></td><td id="LC3998" class="css-1dcdqdg"><code>      on.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.player.elements.container, <span class="code-string">'keydown'</span>, event =&gt; <span class="code-keyword">this</span>.trapFocus(event));
</code></td></tr><tr><td id="L3999" class="css-a4x74f"><span>3999</span></td><td id="LC3999" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4000" class="css-a4x74f"><span>4000</span></td><td id="LC4000" class="css-1dcdqdg"><code>      <span class="code-comment">// Update the UI</span>
</code></td></tr><tr><td id="L4001" class="css-a4x74f"><span>4001</span></td><td id="LC4001" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.update();
</code></td></tr><tr><td id="L4002" class="css-a4x74f"><span>4002</span></td><td id="LC4002" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4003" class="css-a4x74f"><span>4003</span></td><td id="LC4003" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4004" class="css-a4x74f"><span>4004</span></td><td id="LC4004" class="css-1dcdqdg"><code>    <span class="code-comment">// Determine if native supported</span>
</code></td></tr><tr><td id="L4005" class="css-a4x74f"><span>4005</span></td><td id="LC4005" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> <span class="code-keyword">get</span> nativeSupported() {
</code></td></tr><tr><td id="L4006" class="css-a4x74f"><span>4006</span></td><td id="LC4006" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> !!(<span class="code-built_in">document</span>.fullscreenEnabled || <span class="code-built_in">document</span>.webkitFullscreenEnabled || <span class="code-built_in">document</span>.mozFullScreenEnabled || <span class="code-built_in">document</span>.msFullscreenEnabled);
</code></td></tr><tr><td id="L4007" class="css-a4x74f"><span>4007</span></td><td id="LC4007" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4008" class="css-a4x74f"><span>4008</span></td><td id="LC4008" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4009" class="css-a4x74f"><span>4009</span></td><td id="LC4009" class="css-1dcdqdg"><code>    <span class="code-comment">// If we're actually using native</span>
</code></td></tr><tr><td id="L4010" class="css-a4x74f"><span>4010</span></td><td id="LC4010" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> useNative() {
</code></td></tr><tr><td id="L4011" class="css-a4x74f"><span>4011</span></td><td id="LC4011" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> Fullscreen.nativeSupported &amp;&amp; !<span class="code-keyword">this</span>.forceFallback;
</code></td></tr><tr><td id="L4012" class="css-a4x74f"><span>4012</span></td><td id="LC4012" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4013" class="css-a4x74f"><span>4013</span></td><td id="LC4013" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4014" class="css-a4x74f"><span>4014</span></td><td id="LC4014" class="css-1dcdqdg"><code>    <span class="code-comment">// Get the prefix for handlers</span>
</code></td></tr><tr><td id="L4015" class="css-a4x74f"><span>4015</span></td><td id="LC4015" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> <span class="code-keyword">get</span> prefix() {
</code></td></tr><tr><td id="L4016" class="css-a4x74f"><span>4016</span></td><td id="LC4016" class="css-1dcdqdg"><code>      <span class="code-comment">// No prefix</span>
</code></td></tr><tr><td id="L4017" class="css-a4x74f"><span>4017</span></td><td id="LC4017" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.function(<span class="code-built_in">document</span>.exitFullscreen)) <span class="code-keyword">return</span> <span class="code-string">''</span>;
</code></td></tr><tr><td id="L4018" class="css-a4x74f"><span>4018</span></td><td id="LC4018" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4019" class="css-a4x74f"><span>4019</span></td><td id="LC4019" class="css-1dcdqdg"><code>      <span class="code-comment">// Check for fullscreen support by vendor prefix</span>
</code></td></tr><tr><td id="L4020" class="css-a4x74f"><span>4020</span></td><td id="LC4020" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> value = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L4021" class="css-a4x74f"><span>4021</span></td><td id="LC4021" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> prefixes = [<span class="code-string">'webkit'</span>, <span class="code-string">'moz'</span>, <span class="code-string">'ms'</span>];
</code></td></tr><tr><td id="L4022" class="css-a4x74f"><span>4022</span></td><td id="LC4022" class="css-1dcdqdg"><code>      prefixes.some(<span class="code-function"><span class="code-params">pre</span> =&gt;</span> {
</code></td></tr><tr><td id="L4023" class="css-a4x74f"><span>4023</span></td><td id="LC4023" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.function(<span class="code-built_in">document</span>[<span class="code-string">`<span class="code-subst">${pre}</span>ExitFullscreen`</span>]) || is.function(<span class="code-built_in">document</span>[<span class="code-string">`<span class="code-subst">${pre}</span>CancelFullScreen`</span>])) {
</code></td></tr><tr><td id="L4024" class="css-a4x74f"><span>4024</span></td><td id="LC4024" class="css-1dcdqdg"><code>          value = pre;
</code></td></tr><tr><td id="L4025" class="css-a4x74f"><span>4025</span></td><td id="LC4025" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L4026" class="css-a4x74f"><span>4026</span></td><td id="LC4026" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4027" class="css-a4x74f"><span>4027</span></td><td id="LC4027" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L4028" class="css-a4x74f"><span>4028</span></td><td id="LC4028" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4029" class="css-a4x74f"><span>4029</span></td><td id="LC4029" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> value;
</code></td></tr><tr><td id="L4030" class="css-a4x74f"><span>4030</span></td><td id="LC4030" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4031" class="css-a4x74f"><span>4031</span></td><td id="LC4031" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> <span class="code-keyword">get</span> property() {
</code></td></tr><tr><td id="L4032" class="css-a4x74f"><span>4032</span></td><td id="LC4032" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.prefix === <span class="code-string">'moz'</span> ? <span class="code-string">'FullScreen'</span> : <span class="code-string">'Fullscreen'</span>;
</code></td></tr><tr><td id="L4033" class="css-a4x74f"><span>4033</span></td><td id="LC4033" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4034" class="css-a4x74f"><span>4034</span></td><td id="LC4034" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4035" class="css-a4x74f"><span>4035</span></td><td id="LC4035" class="css-1dcdqdg"><code>    <span class="code-comment">// Determine if fullscreen is supported</span>
</code></td></tr><tr><td id="L4036" class="css-a4x74f"><span>4036</span></td><td id="LC4036" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> supported() {
</code></td></tr><tr><td id="L4037" class="css-a4x74f"><span>4037</span></td><td id="LC4037" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> [
</code></td></tr><tr><td id="L4038" class="css-a4x74f"><span>4038</span></td><td id="LC4038" class="css-1dcdqdg"><code>      <span class="code-comment">// Fullscreen is enabled in config</span>
</code></td></tr><tr><td id="L4039" class="css-a4x74f"><span>4039</span></td><td id="LC4039" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player.config.fullscreen.enabled,
</code></td></tr><tr><td id="L4040" class="css-a4x74f"><span>4040</span></td><td id="LC4040" class="css-1dcdqdg"><code>      <span class="code-comment">// Must be a video</span>
</code></td></tr><tr><td id="L4041" class="css-a4x74f"><span>4041</span></td><td id="LC4041" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player.isVideo,
</code></td></tr><tr><td id="L4042" class="css-a4x74f"><span>4042</span></td><td id="LC4042" class="css-1dcdqdg"><code>      <span class="code-comment">// Either native is supported or fallback enabled</span>
</code></td></tr><tr><td id="L4043" class="css-a4x74f"><span>4043</span></td><td id="LC4043" class="css-1dcdqdg"><code>      Fullscreen.nativeSupported || <span class="code-keyword">this</span>.player.config.fullscreen.fallback,
</code></td></tr><tr><td id="L4044" class="css-a4x74f"><span>4044</span></td><td id="LC4044" class="css-1dcdqdg"><code>      <span class="code-comment">// YouTube has no way to trigger fullscreen, so on devices with no native support, playsinline</span>
</code></td></tr><tr><td id="L4045" class="css-a4x74f"><span>4045</span></td><td id="LC4045" class="css-1dcdqdg"><code>      <span class="code-comment">// must be enabled and iosNative fullscreen must be disabled to offer the fullscreen fallback</span>
</code></td></tr><tr><td id="L4046" class="css-a4x74f"><span>4046</span></td><td id="LC4046" class="css-1dcdqdg"><code>      !<span class="code-keyword">this</span>.player.isYouTube || Fullscreen.nativeSupported || !browser.isIos || <span class="code-keyword">this</span>.player.config.playsinline &amp;&amp; !<span class="code-keyword">this</span>.player.config.fullscreen.iosNative].every(<span class="code-built_in">Boolean</span>);
</code></td></tr><tr><td id="L4047" class="css-a4x74f"><span>4047</span></td><td id="LC4047" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4048" class="css-a4x74f"><span>4048</span></td><td id="LC4048" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4049" class="css-a4x74f"><span>4049</span></td><td id="LC4049" class="css-1dcdqdg"><code>    <span class="code-comment">// Get active state</span>
</code></td></tr><tr><td id="L4050" class="css-a4x74f"><span>4050</span></td><td id="LC4050" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> active() {
</code></td></tr><tr><td id="L4051" class="css-a4x74f"><span>4051</span></td><td id="LC4051" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported) <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L4052" class="css-a4x74f"><span>4052</span></td><td id="LC4052" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4053" class="css-a4x74f"><span>4053</span></td><td id="LC4053" class="css-1dcdqdg"><code>      <span class="code-comment">// Fallback using classname</span>
</code></td></tr><tr><td id="L4054" class="css-a4x74f"><span>4054</span></td><td id="LC4054" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!Fullscreen.nativeSupported || <span class="code-keyword">this</span>.forceFallback) {
</code></td></tr><tr><td id="L4055" class="css-a4x74f"><span>4055</span></td><td id="LC4055" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> hasClass(<span class="code-keyword">this</span>.target, <span class="code-keyword">this</span>.player.config.classNames.fullscreen.fallback);
</code></td></tr><tr><td id="L4056" class="css-a4x74f"><span>4056</span></td><td id="LC4056" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4057" class="css-a4x74f"><span>4057</span></td><td id="LC4057" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> element = !<span class="code-keyword">this</span>.prefix ? <span class="code-keyword">this</span>.target.getRootNode().fullscreenElement : <span class="code-keyword">this</span>.target.getRootNode()[<span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.prefix}</span><span class="code-subst">${<span class="code-keyword">this</span>.property}</span>Element`</span>];
</code></td></tr><tr><td id="L4058" class="css-a4x74f"><span>4058</span></td><td id="LC4058" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> element &amp;&amp; element.shadowRoot ? element === <span class="code-keyword">this</span>.target.getRootNode().host : element === <span class="code-keyword">this</span>.target;
</code></td></tr><tr><td id="L4059" class="css-a4x74f"><span>4059</span></td><td id="LC4059" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4060" class="css-a4x74f"><span>4060</span></td><td id="LC4060" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4061" class="css-a4x74f"><span>4061</span></td><td id="LC4061" class="css-1dcdqdg"><code>    <span class="code-comment">// Get target element</span>
</code></td></tr><tr><td id="L4062" class="css-a4x74f"><span>4062</span></td><td id="LC4062" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> target() {
</code></td></tr><tr><td id="L4063" class="css-a4x74f"><span>4063</span></td><td id="LC4063" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> browser.isIos &amp;&amp; <span class="code-keyword">this</span>.player.config.fullscreen.iosNative ? <span class="code-keyword">this</span>.player.media : <span class="code-keyword">this</span>.player.elements.fullscreen ?? <span class="code-keyword">this</span>.player.elements.container;
</code></td></tr><tr><td id="L4064" class="css-a4x74f"><span>4064</span></td><td id="LC4064" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4065" class="css-a4x74f"><span>4065</span></td><td id="LC4065" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L4066" class="css-a4x74f"><span>4066</span></td><td id="LC4066" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4067" class="css-a4x74f"><span>4067</span></td><td id="LC4067" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L4068" class="css-a4x74f"><span>4068</span></td><td id="LC4068" class="css-1dcdqdg"><code>  <span class="code-comment">// Load image avoiding xhr/fetch CORS issues</span>
</code></td></tr><tr><td id="L4069" class="css-a4x74f"><span>4069</span></td><td id="LC4069" class="css-1dcdqdg"><code>  <span class="code-comment">// Server status can't be obtained this way unfortunately, so this uses "naturalWidth" to determine if the image has loaded</span>
</code></td></tr><tr><td id="L4070" class="css-a4x74f"><span>4070</span></td><td id="LC4070" class="css-1dcdqdg"><code>  <span class="code-comment">// By default it checks if it is at least 1px, but you can add a second argument to change this</span>
</code></td></tr><tr><td id="L4071" class="css-a4x74f"><span>4071</span></td><td id="LC4071" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L4072" class="css-a4x74f"><span>4072</span></td><td id="LC4072" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4073" class="css-a4x74f"><span>4073</span></td><td id="LC4073" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadImage</span>(<span class="code-params">src, minWidth = <span class="code-number">1</span></span>) </span>{
</code></td></tr><tr><td id="L4074" class="css-a4x74f"><span>4074</span></td><td id="LC4074" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function">(<span class="code-params">resolve, reject</span>) =&gt;</span> {
</code></td></tr><tr><td id="L4075" class="css-a4x74f"><span>4075</span></td><td id="LC4075" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> image = <span class="code-keyword">new</span> Image();
</code></td></tr><tr><td id="L4076" class="css-a4x74f"><span>4076</span></td><td id="LC4076" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> handler = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4077" class="css-a4x74f"><span>4077</span></td><td id="LC4077" class="css-1dcdqdg"><code>        <span class="code-keyword">delete</span> image.onload;
</code></td></tr><tr><td id="L4078" class="css-a4x74f"><span>4078</span></td><td id="LC4078" class="css-1dcdqdg"><code>        <span class="code-keyword">delete</span> image.onerror;
</code></td></tr><tr><td id="L4079" class="css-a4x74f"><span>4079</span></td><td id="LC4079" class="css-1dcdqdg"><code>        (image.naturalWidth &gt;= minWidth ? resolve : reject)(image);
</code></td></tr><tr><td id="L4080" class="css-a4x74f"><span>4080</span></td><td id="LC4080" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L4081" class="css-a4x74f"><span>4081</span></td><td id="LC4081" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.assign(image, {
</code></td></tr><tr><td id="L4082" class="css-a4x74f"><span>4082</span></td><td id="LC4082" class="css-1dcdqdg"><code>        onload: handler,
</code></td></tr><tr><td id="L4083" class="css-a4x74f"><span>4083</span></td><td id="LC4083" class="css-1dcdqdg"><code>        onerror: handler,
</code></td></tr><tr><td id="L4084" class="css-a4x74f"><span>4084</span></td><td id="LC4084" class="css-1dcdqdg"><code>        src
</code></td></tr><tr><td id="L4085" class="css-a4x74f"><span>4085</span></td><td id="LC4085" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4086" class="css-a4x74f"><span>4086</span></td><td id="LC4086" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L4087" class="css-a4x74f"><span>4087</span></td><td id="LC4087" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L4088" class="css-a4x74f"><span>4088</span></td><td id="LC4088" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4089" class="css-a4x74f"><span>4089</span></td><td id="LC4089" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L4090" class="css-a4x74f"><span>4090</span></td><td id="LC4090" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> ui = {
</code></td></tr><tr><td id="L4091" class="css-a4x74f"><span>4091</span></td><td id="LC4091" class="css-1dcdqdg"><code>    addStyleHook() {
</code></td></tr><tr><td id="L4092" class="css-a4x74f"><span>4092</span></td><td id="LC4092" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.selectors.container.replace(<span class="code-string">'.'</span>, <span class="code-string">''</span>), <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4093" class="css-a4x74f"><span>4093</span></td><td id="LC4093" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.uiSupported, <span class="code-keyword">this</span>.supported.ui);
</code></td></tr><tr><td id="L4094" class="css-a4x74f"><span>4094</span></td><td id="LC4094" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4095" class="css-a4x74f"><span>4095</span></td><td id="LC4095" class="css-1dcdqdg"><code>    <span class="code-comment">// Toggle native HTML5 media controls</span>
</code></td></tr><tr><td id="L4096" class="css-a4x74f"><span>4096</span></td><td id="LC4096" class="css-1dcdqdg"><code>    toggleNativeControls(toggle = <span class="code-literal">false</span>) {
</code></td></tr><tr><td id="L4097" class="css-a4x74f"><span>4097</span></td><td id="LC4097" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (toggle &amp;&amp; <span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L4098" class="css-a4x74f"><span>4098</span></td><td id="LC4098" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'controls'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L4099" class="css-a4x74f"><span>4099</span></td><td id="LC4099" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L4100" class="css-a4x74f"><span>4100</span></td><td id="LC4100" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.removeAttribute(<span class="code-string">'controls'</span>);
</code></td></tr><tr><td id="L4101" class="css-a4x74f"><span>4101</span></td><td id="LC4101" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4102" class="css-a4x74f"><span>4102</span></td><td id="LC4102" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4103" class="css-a4x74f"><span>4103</span></td><td id="LC4103" class="css-1dcdqdg"><code>    <span class="code-comment">// Setup the UI</span>
</code></td></tr><tr><td id="L4104" class="css-a4x74f"><span>4104</span></td><td id="LC4104" class="css-1dcdqdg"><code>    build() {
</code></td></tr><tr><td id="L4105" class="css-a4x74f"><span>4105</span></td><td id="LC4105" class="css-1dcdqdg"><code>      <span class="code-comment">// Re-attach media element listeners</span>
</code></td></tr><tr><td id="L4106" class="css-a4x74f"><span>4106</span></td><td id="LC4106" class="css-1dcdqdg"><code>      <span class="code-comment">// <span class="code-doctag">TODO:</span> Use event bubbling?</span>
</code></td></tr><tr><td id="L4107" class="css-a4x74f"><span>4107</span></td><td id="LC4107" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.listeners.media();
</code></td></tr><tr><td id="L4108" class="css-a4x74f"><span>4108</span></td><td id="LC4108" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4109" class="css-a4x74f"><span>4109</span></td><td id="LC4109" class="css-1dcdqdg"><code>      <span class="code-comment">// Don't setup interface if no support</span>
</code></td></tr><tr><td id="L4110" class="css-a4x74f"><span>4110</span></td><td id="LC4110" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L4111" class="css-a4x74f"><span>4111</span></td><td id="LC4111" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">`Basic support only for <span class="code-subst">${<span class="code-keyword">this</span>.provider}</span> <span class="code-subst">${<span class="code-keyword">this</span>.type}</span>`</span>);
</code></td></tr><tr><td id="L4112" class="css-a4x74f"><span>4112</span></td><td id="LC4112" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4113" class="css-a4x74f"><span>4113</span></td><td id="LC4113" class="css-1dcdqdg"><code>        <span class="code-comment">// Restore native controls</span>
</code></td></tr><tr><td id="L4114" class="css-a4x74f"><span>4114</span></td><td id="LC4114" class="css-1dcdqdg"><code>        ui.toggleNativeControls.call(<span class="code-keyword">this</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4115" class="css-a4x74f"><span>4115</span></td><td id="LC4115" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4116" class="css-a4x74f"><span>4116</span></td><td id="LC4116" class="css-1dcdqdg"><code>        <span class="code-comment">// Bail</span>
</code></td></tr><tr><td id="L4117" class="css-a4x74f"><span>4117</span></td><td id="LC4117" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4118" class="css-a4x74f"><span>4118</span></td><td id="LC4118" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4119" class="css-a4x74f"><span>4119</span></td><td id="LC4119" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4120" class="css-a4x74f"><span>4120</span></td><td id="LC4120" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject custom controls if not present</span>
</code></td></tr><tr><td id="L4121" class="css-a4x74f"><span>4121</span></td><td id="LC4121" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.controls)) {
</code></td></tr><tr><td id="L4122" class="css-a4x74f"><span>4122</span></td><td id="LC4122" class="css-1dcdqdg"><code>        <span class="code-comment">// Inject custom controls</span>
</code></td></tr><tr><td id="L4123" class="css-a4x74f"><span>4123</span></td><td id="LC4123" class="css-1dcdqdg"><code>        controls.inject.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4124" class="css-a4x74f"><span>4124</span></td><td id="LC4124" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4125" class="css-a4x74f"><span>4125</span></td><td id="LC4125" class="css-1dcdqdg"><code>        <span class="code-comment">// Re-attach control listeners</span>
</code></td></tr><tr><td id="L4126" class="css-a4x74f"><span>4126</span></td><td id="LC4126" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.listeners.controls();
</code></td></tr><tr><td id="L4127" class="css-a4x74f"><span>4127</span></td><td id="LC4127" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4128" class="css-a4x74f"><span>4128</span></td><td id="LC4128" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4129" class="css-a4x74f"><span>4129</span></td><td id="LC4129" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove native controls</span>
</code></td></tr><tr><td id="L4130" class="css-a4x74f"><span>4130</span></td><td id="LC4130" class="css-1dcdqdg"><code>      ui.toggleNativeControls.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4131" class="css-a4x74f"><span>4131</span></td><td id="LC4131" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4132" class="css-a4x74f"><span>4132</span></td><td id="LC4132" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup captions for HTML5</span>
</code></td></tr><tr><td id="L4133" class="css-a4x74f"><span>4133</span></td><td id="LC4133" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L4134" class="css-a4x74f"><span>4134</span></td><td id="LC4134" class="css-1dcdqdg"><code>        captions.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4135" class="css-a4x74f"><span>4135</span></td><td id="LC4135" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4136" class="css-a4x74f"><span>4136</span></td><td id="LC4136" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4137" class="css-a4x74f"><span>4137</span></td><td id="LC4137" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset volume</span>
</code></td></tr><tr><td id="L4138" class="css-a4x74f"><span>4138</span></td><td id="LC4138" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.volume = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4139" class="css-a4x74f"><span>4139</span></td><td id="LC4139" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4140" class="css-a4x74f"><span>4140</span></td><td id="LC4140" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset mute state</span>
</code></td></tr><tr><td id="L4141" class="css-a4x74f"><span>4141</span></td><td id="LC4141" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.muted = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4142" class="css-a4x74f"><span>4142</span></td><td id="LC4142" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4143" class="css-a4x74f"><span>4143</span></td><td id="LC4143" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset loop state</span>
</code></td></tr><tr><td id="L4144" class="css-a4x74f"><span>4144</span></td><td id="LC4144" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loop = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4145" class="css-a4x74f"><span>4145</span></td><td id="LC4145" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4146" class="css-a4x74f"><span>4146</span></td><td id="LC4146" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset quality setting</span>
</code></td></tr><tr><td id="L4147" class="css-a4x74f"><span>4147</span></td><td id="LC4147" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.quality = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4148" class="css-a4x74f"><span>4148</span></td><td id="LC4148" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4149" class="css-a4x74f"><span>4149</span></td><td id="LC4149" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset speed</span>
</code></td></tr><tr><td id="L4150" class="css-a4x74f"><span>4150</span></td><td id="LC4150" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.speed = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4151" class="css-a4x74f"><span>4151</span></td><td id="LC4151" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4152" class="css-a4x74f"><span>4152</span></td><td id="LC4152" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset volume display</span>
</code></td></tr><tr><td id="L4153" class="css-a4x74f"><span>4153</span></td><td id="LC4153" class="css-1dcdqdg"><code>      controls.updateVolume.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4154" class="css-a4x74f"><span>4154</span></td><td id="LC4154" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4155" class="css-a4x74f"><span>4155</span></td><td id="LC4155" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset time display</span>
</code></td></tr><tr><td id="L4156" class="css-a4x74f"><span>4156</span></td><td id="LC4156" class="css-1dcdqdg"><code>      controls.timeUpdate.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4157" class="css-a4x74f"><span>4157</span></td><td id="LC4157" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4158" class="css-a4x74f"><span>4158</span></td><td id="LC4158" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset duration display</span>
</code></td></tr><tr><td id="L4159" class="css-a4x74f"><span>4159</span></td><td id="LC4159" class="css-1dcdqdg"><code>      controls.durationUpdate.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4160" class="css-a4x74f"><span>4160</span></td><td id="LC4160" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4161" class="css-a4x74f"><span>4161</span></td><td id="LC4161" class="css-1dcdqdg"><code>      <span class="code-comment">// Update the UI</span>
</code></td></tr><tr><td id="L4162" class="css-a4x74f"><span>4162</span></td><td id="LC4162" class="css-1dcdqdg"><code>      ui.checkPlaying.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4163" class="css-a4x74f"><span>4163</span></td><td id="LC4163" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4164" class="css-a4x74f"><span>4164</span></td><td id="LC4164" class="css-1dcdqdg"><code>      <span class="code-comment">// Check for picture-in-picture support</span>
</code></td></tr><tr><td id="L4165" class="css-a4x74f"><span>4165</span></td><td id="LC4165" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.pip.supported, support.pip &amp;&amp; <span class="code-keyword">this</span>.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.isVideo);
</code></td></tr><tr><td id="L4166" class="css-a4x74f"><span>4166</span></td><td id="LC4166" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4167" class="css-a4x74f"><span>4167</span></td><td id="LC4167" class="css-1dcdqdg"><code>      <span class="code-comment">// Check for airplay support</span>
</code></td></tr><tr><td id="L4168" class="css-a4x74f"><span>4168</span></td><td id="LC4168" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.airplay.supported, support.airplay &amp;&amp; <span class="code-keyword">this</span>.isHTML5);
</code></td></tr><tr><td id="L4169" class="css-a4x74f"><span>4169</span></td><td id="LC4169" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4170" class="css-a4x74f"><span>4170</span></td><td id="LC4170" class="css-1dcdqdg"><code>      <span class="code-comment">// Add touch class</span>
</code></td></tr><tr><td id="L4171" class="css-a4x74f"><span>4171</span></td><td id="LC4171" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.isTouch, <span class="code-keyword">this</span>.touch);
</code></td></tr><tr><td id="L4172" class="css-a4x74f"><span>4172</span></td><td id="LC4172" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4173" class="css-a4x74f"><span>4173</span></td><td id="LC4173" class="css-1dcdqdg"><code>      <span class="code-comment">// Ready for API calls</span>
</code></td></tr><tr><td id="L4174" class="css-a4x74f"><span>4174</span></td><td id="LC4174" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.ready = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L4175" class="css-a4x74f"><span>4175</span></td><td id="LC4175" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4176" class="css-a4x74f"><span>4176</span></td><td id="LC4176" class="css-1dcdqdg"><code>      <span class="code-comment">// Ready event at end of execution stack</span>
</code></td></tr><tr><td id="L4177" class="css-a4x74f"><span>4177</span></td><td id="LC4177" class="css-1dcdqdg"><code>      setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4178" class="css-a4x74f"><span>4178</span></td><td id="LC4178" class="css-1dcdqdg"><code>        triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, <span class="code-string">'ready'</span>);
</code></td></tr><tr><td id="L4179" class="css-a4x74f"><span>4179</span></td><td id="LC4179" class="css-1dcdqdg"><code>      }, <span class="code-number">0</span>);
</code></td></tr><tr><td id="L4180" class="css-a4x74f"><span>4180</span></td><td id="LC4180" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4181" class="css-a4x74f"><span>4181</span></td><td id="LC4181" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the title</span>
</code></td></tr><tr><td id="L4182" class="css-a4x74f"><span>4182</span></td><td id="LC4182" class="css-1dcdqdg"><code>      ui.setTitle.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4183" class="css-a4x74f"><span>4183</span></td><td id="LC4183" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4184" class="css-a4x74f"><span>4184</span></td><td id="LC4184" class="css-1dcdqdg"><code>      <span class="code-comment">// Assure the poster image is set, if the property was added before the element was created</span>
</code></td></tr><tr><td id="L4185" class="css-a4x74f"><span>4185</span></td><td id="LC4185" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.poster) {
</code></td></tr><tr><td id="L4186" class="css-a4x74f"><span>4186</span></td><td id="LC4186" class="css-1dcdqdg"><code>        ui.setPoster.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.poster, <span class="code-literal">false</span>).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L4187" class="css-a4x74f"><span>4187</span></td><td id="LC4187" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4188" class="css-a4x74f"><span>4188</span></td><td id="LC4188" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4189" class="css-a4x74f"><span>4189</span></td><td id="LC4189" class="css-1dcdqdg"><code>      <span class="code-comment">// Manually set the duration if user has overridden it.</span>
</code></td></tr><tr><td id="L4190" class="css-a4x74f"><span>4190</span></td><td id="LC4190" class="css-1dcdqdg"><code>      <span class="code-comment">// The event listeners for it doesn't get called if preload is disabled (#701)</span>
</code></td></tr><tr><td id="L4191" class="css-a4x74f"><span>4191</span></td><td id="LC4191" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.duration) {
</code></td></tr><tr><td id="L4192" class="css-a4x74f"><span>4192</span></td><td id="LC4192" class="css-1dcdqdg"><code>        controls.durationUpdate.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4193" class="css-a4x74f"><span>4193</span></td><td id="LC4193" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4194" class="css-a4x74f"><span>4194</span></td><td id="LC4194" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4195" class="css-a4x74f"><span>4195</span></td><td id="LC4195" class="css-1dcdqdg"><code>      <span class="code-comment">// Media metadata</span>
</code></td></tr><tr><td id="L4196" class="css-a4x74f"><span>4196</span></td><td id="LC4196" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.mediaMetadata) {
</code></td></tr><tr><td id="L4197" class="css-a4x74f"><span>4197</span></td><td id="LC4197" class="css-1dcdqdg"><code>        controls.setMediaMetadata.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4198" class="css-a4x74f"><span>4198</span></td><td id="LC4198" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4199" class="css-a4x74f"><span>4199</span></td><td id="LC4199" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4200" class="css-a4x74f"><span>4200</span></td><td id="LC4200" class="css-1dcdqdg"><code>    <span class="code-comment">// Setup aria attribute for play and iframe title</span>
</code></td></tr><tr><td id="L4201" class="css-a4x74f"><span>4201</span></td><td id="LC4201" class="css-1dcdqdg"><code>    setTitle() {
</code></td></tr><tr><td id="L4202" class="css-a4x74f"><span>4202</span></td><td id="LC4202" class="css-1dcdqdg"><code>      <span class="code-comment">// Find the current text</span>
</code></td></tr><tr><td id="L4203" class="css-a4x74f"><span>4203</span></td><td id="LC4203" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> label = i18n.get(<span class="code-string">'play'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L4204" class="css-a4x74f"><span>4204</span></td><td id="LC4204" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4205" class="css-a4x74f"><span>4205</span></td><td id="LC4205" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's a media title set, use that for the label</span>
</code></td></tr><tr><td id="L4206" class="css-a4x74f"><span>4206</span></td><td id="LC4206" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(<span class="code-keyword">this</span>.config.title) &amp;&amp; !is.empty(<span class="code-keyword">this</span>.config.title)) {
</code></td></tr><tr><td id="L4207" class="css-a4x74f"><span>4207</span></td><td id="LC4207" class="css-1dcdqdg"><code>        label += <span class="code-string">`, <span class="code-subst">${<span class="code-keyword">this</span>.config.title}</span>`</span>;
</code></td></tr><tr><td id="L4208" class="css-a4x74f"><span>4208</span></td><td id="LC4208" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4209" class="css-a4x74f"><span>4209</span></td><td id="LC4209" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4210" class="css-a4x74f"><span>4210</span></td><td id="LC4210" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's a play button, set label</span>
</code></td></tr><tr><td id="L4211" class="css-a4x74f"><span>4211</span></td><td id="LC4211" class="css-1dcdqdg"><code>      <span class="code-built_in">Array</span>.from(<span class="code-keyword">this</span>.elements.buttons.play || []).forEach(<span class="code-function"><span class="code-params">button</span> =&gt;</span> {
</code></td></tr><tr><td id="L4212" class="css-a4x74f"><span>4212</span></td><td id="LC4212" class="css-1dcdqdg"><code>        button.setAttribute(<span class="code-string">'aria-label'</span>, label);
</code></td></tr><tr><td id="L4213" class="css-a4x74f"><span>4213</span></td><td id="LC4213" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4214" class="css-a4x74f"><span>4214</span></td><td id="LC4214" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4215" class="css-a4x74f"><span>4215</span></td><td id="LC4215" class="css-1dcdqdg"><code>      <span class="code-comment">// Set iframe title</span>
</code></td></tr><tr><td id="L4216" class="css-a4x74f"><span>4216</span></td><td id="LC4216" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/sampotts/plyr/issues/124</span>
</code></td></tr><tr><td id="L4217" class="css-a4x74f"><span>4217</span></td><td id="LC4217" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isEmbed) {
</code></td></tr><tr><td id="L4218" class="css-a4x74f"><span>4218</span></td><td id="LC4218" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> iframe = getElement.call(<span class="code-keyword">this</span>, <span class="code-string">'iframe'</span>);
</code></td></tr><tr><td id="L4219" class="css-a4x74f"><span>4219</span></td><td id="LC4219" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.element(iframe)) {
</code></td></tr><tr><td id="L4220" class="css-a4x74f"><span>4220</span></td><td id="LC4220" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4221" class="css-a4x74f"><span>4221</span></td><td id="LC4221" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4222" class="css-a4x74f"><span>4222</span></td><td id="LC4222" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4223" class="css-a4x74f"><span>4223</span></td><td id="LC4223" class="css-1dcdqdg"><code>        <span class="code-comment">// Default to media type</span>
</code></td></tr><tr><td id="L4224" class="css-a4x74f"><span>4224</span></td><td id="LC4224" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> title = !is.empty(<span class="code-keyword">this</span>.config.title) ? <span class="code-keyword">this</span>.config.title : <span class="code-string">'video'</span>;
</code></td></tr><tr><td id="L4225" class="css-a4x74f"><span>4225</span></td><td id="LC4225" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> format = i18n.get(<span class="code-string">'frameTitle'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L4226" class="css-a4x74f"><span>4226</span></td><td id="LC4226" class="css-1dcdqdg"><code>        iframe.setAttribute(<span class="code-string">'title'</span>, format.replace(<span class="code-string">'{title}'</span>, title));
</code></td></tr><tr><td id="L4227" class="css-a4x74f"><span>4227</span></td><td id="LC4227" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4228" class="css-a4x74f"><span>4228</span></td><td id="LC4228" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4229" class="css-a4x74f"><span>4229</span></td><td id="LC4229" class="css-1dcdqdg"><code>    <span class="code-comment">// Toggle poster</span>
</code></td></tr><tr><td id="L4230" class="css-a4x74f"><span>4230</span></td><td id="LC4230" class="css-1dcdqdg"><code>    togglePoster(enable) {
</code></td></tr><tr><td id="L4231" class="css-a4x74f"><span>4231</span></td><td id="LC4231" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.posterEnabled, enable);
</code></td></tr><tr><td id="L4232" class="css-a4x74f"><span>4232</span></td><td id="LC4232" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4233" class="css-a4x74f"><span>4233</span></td><td id="LC4233" class="css-1dcdqdg"><code>    <span class="code-comment">// Set the poster image (async)</span>
</code></td></tr><tr><td id="L4234" class="css-a4x74f"><span>4234</span></td><td id="LC4234" class="css-1dcdqdg"><code>    <span class="code-comment">// Used internally for the poster setter, with the passive option forced to false</span>
</code></td></tr><tr><td id="L4235" class="css-a4x74f"><span>4235</span></td><td id="LC4235" class="css-1dcdqdg"><code>    setPoster(poster, passive = <span class="code-literal">true</span>) {
</code></td></tr><tr><td id="L4236" class="css-a4x74f"><span>4236</span></td><td id="LC4236" class="css-1dcdqdg"><code>      <span class="code-comment">// Don't override if call is passive</span>
</code></td></tr><tr><td id="L4237" class="css-a4x74f"><span>4237</span></td><td id="LC4237" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (passive &amp;&amp; <span class="code-keyword">this</span>.poster) {
</code></td></tr><tr><td id="L4238" class="css-a4x74f"><span>4238</span></td><td id="LC4238" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-built_in">Promise</span>.reject(<span class="code-keyword">new</span> <span class="code-built_in">Error</span>(<span class="code-string">'Poster already set'</span>));
</code></td></tr><tr><td id="L4239" class="css-a4x74f"><span>4239</span></td><td id="LC4239" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4240" class="css-a4x74f"><span>4240</span></td><td id="LC4240" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4241" class="css-a4x74f"><span>4241</span></td><td id="LC4241" class="css-1dcdqdg"><code>      <span class="code-comment">// Set property synchronously to respect the call order</span>
</code></td></tr><tr><td id="L4242" class="css-a4x74f"><span>4242</span></td><td id="LC4242" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'data-poster'</span>, poster);
</code></td></tr><tr><td id="L4243" class="css-a4x74f"><span>4243</span></td><td id="LC4243" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4244" class="css-a4x74f"><span>4244</span></td><td id="LC4244" class="css-1dcdqdg"><code>      <span class="code-comment">// Show the poster</span>
</code></td></tr><tr><td id="L4245" class="css-a4x74f"><span>4245</span></td><td id="LC4245" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.poster.removeAttribute(<span class="code-string">'hidden'</span>);
</code></td></tr><tr><td id="L4246" class="css-a4x74f"><span>4246</span></td><td id="LC4246" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4247" class="css-a4x74f"><span>4247</span></td><td id="LC4247" class="css-1dcdqdg"><code>      <span class="code-comment">// Wait until ui is ready</span>
</code></td></tr><tr><td id="L4248" class="css-a4x74f"><span>4248</span></td><td id="LC4248" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> ready.call(<span class="code-keyword">this</span>)
</code></td></tr><tr><td id="L4249" class="css-a4x74f"><span>4249</span></td><td id="LC4249" class="css-1dcdqdg"><code>      <span class="code-comment">// Load image</span>
</code></td></tr><tr><td id="L4250" class="css-a4x74f"><span>4250</span></td><td id="LC4250" class="css-1dcdqdg"><code>      .then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> loadImage(poster)).catch(<span class="code-function"><span class="code-params">error</span> =&gt;</span> {
</code></td></tr><tr><td id="L4251" class="css-a4x74f"><span>4251</span></td><td id="LC4251" class="css-1dcdqdg"><code>        <span class="code-comment">// Hide poster on error unless it's been set by another call</span>
</code></td></tr><tr><td id="L4252" class="css-a4x74f"><span>4252</span></td><td id="LC4252" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (poster === <span class="code-keyword">this</span>.poster) {
</code></td></tr><tr><td id="L4253" class="css-a4x74f"><span>4253</span></td><td id="LC4253" class="css-1dcdqdg"><code>          ui.togglePoster.call(<span class="code-keyword">this</span>, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4254" class="css-a4x74f"><span>4254</span></td><td id="LC4254" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4255" class="css-a4x74f"><span>4255</span></td><td id="LC4255" class="css-1dcdqdg"><code>        <span class="code-comment">// Rethrow</span>
</code></td></tr><tr><td id="L4256" class="css-a4x74f"><span>4256</span></td><td id="LC4256" class="css-1dcdqdg"><code>        <span class="code-keyword">throw</span> error;
</code></td></tr><tr><td id="L4257" class="css-a4x74f"><span>4257</span></td><td id="LC4257" class="css-1dcdqdg"><code>      }).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4258" class="css-a4x74f"><span>4258</span></td><td id="LC4258" class="css-1dcdqdg"><code>        <span class="code-comment">// Prevent race conditions</span>
</code></td></tr><tr><td id="L4259" class="css-a4x74f"><span>4259</span></td><td id="LC4259" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (poster !== <span class="code-keyword">this</span>.poster) {
</code></td></tr><tr><td id="L4260" class="css-a4x74f"><span>4260</span></td><td id="LC4260" class="css-1dcdqdg"><code>          <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-built_in">Error</span>(<span class="code-string">'setPoster cancelled by later call to setPoster'</span>);
</code></td></tr><tr><td id="L4261" class="css-a4x74f"><span>4261</span></td><td id="LC4261" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4262" class="css-a4x74f"><span>4262</span></td><td id="LC4262" class="css-1dcdqdg"><code>      }).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4263" class="css-a4x74f"><span>4263</span></td><td id="LC4263" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.assign(<span class="code-keyword">this</span>.elements.poster.style, {
</code></td></tr><tr><td id="L4264" class="css-a4x74f"><span>4264</span></td><td id="LC4264" class="css-1dcdqdg"><code>          backgroundImage: <span class="code-string">`url('<span class="code-subst">${poster}</span>')`</span>,
</code></td></tr><tr><td id="L4265" class="css-a4x74f"><span>4265</span></td><td id="LC4265" class="css-1dcdqdg"><code>          <span class="code-comment">// Reset backgroundSize as well (since it can be set to "cover" for padded thumbnails for youtube)</span>
</code></td></tr><tr><td id="L4266" class="css-a4x74f"><span>4266</span></td><td id="LC4266" class="css-1dcdqdg"><code>          backgroundSize: <span class="code-string">''</span>
</code></td></tr><tr><td id="L4267" class="css-a4x74f"><span>4267</span></td><td id="LC4267" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4268" class="css-a4x74f"><span>4268</span></td><td id="LC4268" class="css-1dcdqdg"><code>        ui.togglePoster.call(<span class="code-keyword">this</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4269" class="css-a4x74f"><span>4269</span></td><td id="LC4269" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> poster;
</code></td></tr><tr><td id="L4270" class="css-a4x74f"><span>4270</span></td><td id="LC4270" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4271" class="css-a4x74f"><span>4271</span></td><td id="LC4271" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4272" class="css-a4x74f"><span>4272</span></td><td id="LC4272" class="css-1dcdqdg"><code>    <span class="code-comment">// Check playing state</span>
</code></td></tr><tr><td id="L4273" class="css-a4x74f"><span>4273</span></td><td id="LC4273" class="css-1dcdqdg"><code>    checkPlaying(event) {
</code></td></tr><tr><td id="L4274" class="css-a4x74f"><span>4274</span></td><td id="LC4274" class="css-1dcdqdg"><code>      <span class="code-comment">// Class hooks</span>
</code></td></tr><tr><td id="L4275" class="css-a4x74f"><span>4275</span></td><td id="LC4275" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.playing, <span class="code-keyword">this</span>.playing);
</code></td></tr><tr><td id="L4276" class="css-a4x74f"><span>4276</span></td><td id="LC4276" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.paused, <span class="code-keyword">this</span>.paused);
</code></td></tr><tr><td id="L4277" class="css-a4x74f"><span>4277</span></td><td id="LC4277" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.stopped, <span class="code-keyword">this</span>.stopped);
</code></td></tr><tr><td id="L4278" class="css-a4x74f"><span>4278</span></td><td id="LC4278" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4279" class="css-a4x74f"><span>4279</span></td><td id="LC4279" class="css-1dcdqdg"><code>      <span class="code-comment">// Set state</span>
</code></td></tr><tr><td id="L4280" class="css-a4x74f"><span>4280</span></td><td id="LC4280" class="css-1dcdqdg"><code>      <span class="code-built_in">Array</span>.from(<span class="code-keyword">this</span>.elements.buttons.play || []).forEach(<span class="code-function"><span class="code-params">target</span> =&gt;</span> {
</code></td></tr><tr><td id="L4281" class="css-a4x74f"><span>4281</span></td><td id="LC4281" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.assign(target, {
</code></td></tr><tr><td id="L4282" class="css-a4x74f"><span>4282</span></td><td id="LC4282" class="css-1dcdqdg"><code>          pressed: <span class="code-keyword">this</span>.playing
</code></td></tr><tr><td id="L4283" class="css-a4x74f"><span>4283</span></td><td id="LC4283" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4284" class="css-a4x74f"><span>4284</span></td><td id="LC4284" class="css-1dcdqdg"><code>        target.setAttribute(<span class="code-string">'aria-label'</span>, i18n.get(<span class="code-keyword">this</span>.playing ? <span class="code-string">'pause'</span> : <span class="code-string">'play'</span>, <span class="code-keyword">this</span>.config));
</code></td></tr><tr><td id="L4285" class="css-a4x74f"><span>4285</span></td><td id="LC4285" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4286" class="css-a4x74f"><span>4286</span></td><td id="LC4286" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4287" class="css-a4x74f"><span>4287</span></td><td id="LC4287" class="css-1dcdqdg"><code>      <span class="code-comment">// Only update controls on non timeupdate events</span>
</code></td></tr><tr><td id="L4288" class="css-a4x74f"><span>4288</span></td><td id="LC4288" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.event(event) &amp;&amp; event.type === <span class="code-string">'timeupdate'</span>) {
</code></td></tr><tr><td id="L4289" class="css-a4x74f"><span>4289</span></td><td id="LC4289" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4290" class="css-a4x74f"><span>4290</span></td><td id="LC4290" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4291" class="css-a4x74f"><span>4291</span></td><td id="LC4291" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4292" class="css-a4x74f"><span>4292</span></td><td id="LC4292" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle controls</span>
</code></td></tr><tr><td id="L4293" class="css-a4x74f"><span>4293</span></td><td id="LC4293" class="css-1dcdqdg"><code>      ui.toggleControls.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4294" class="css-a4x74f"><span>4294</span></td><td id="LC4294" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4295" class="css-a4x74f"><span>4295</span></td><td id="LC4295" class="css-1dcdqdg"><code>    <span class="code-comment">// Check if media is loading</span>
</code></td></tr><tr><td id="L4296" class="css-a4x74f"><span>4296</span></td><td id="LC4296" class="css-1dcdqdg"><code>    checkLoading(event) {
</code></td></tr><tr><td id="L4297" class="css-a4x74f"><span>4297</span></td><td id="LC4297" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loading = [<span class="code-string">'stalled'</span>, <span class="code-string">'waiting'</span>].includes(event.type);
</code></td></tr><tr><td id="L4298" class="css-a4x74f"><span>4298</span></td><td id="LC4298" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4299" class="css-a4x74f"><span>4299</span></td><td id="LC4299" class="css-1dcdqdg"><code>      <span class="code-comment">// Clear timer</span>
</code></td></tr><tr><td id="L4300" class="css-a4x74f"><span>4300</span></td><td id="LC4300" class="css-1dcdqdg"><code>      clearTimeout(<span class="code-keyword">this</span>.timers.loading);
</code></td></tr><tr><td id="L4301" class="css-a4x74f"><span>4301</span></td><td id="LC4301" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4302" class="css-a4x74f"><span>4302</span></td><td id="LC4302" class="css-1dcdqdg"><code>      <span class="code-comment">// Timer to prevent flicker when seeking</span>
</code></td></tr><tr><td id="L4303" class="css-a4x74f"><span>4303</span></td><td id="LC4303" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.timers.loading = setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4304" class="css-a4x74f"><span>4304</span></td><td id="LC4304" class="css-1dcdqdg"><code>        <span class="code-comment">// Update progress bar loading class state</span>
</code></td></tr><tr><td id="L4305" class="css-a4x74f"><span>4305</span></td><td id="LC4305" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.loading, <span class="code-keyword">this</span>.loading);
</code></td></tr><tr><td id="L4306" class="css-a4x74f"><span>4306</span></td><td id="LC4306" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4307" class="css-a4x74f"><span>4307</span></td><td id="LC4307" class="css-1dcdqdg"><code>        <span class="code-comment">// Update controls visibility</span>
</code></td></tr><tr><td id="L4308" class="css-a4x74f"><span>4308</span></td><td id="LC4308" class="css-1dcdqdg"><code>        ui.toggleControls.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4309" class="css-a4x74f"><span>4309</span></td><td id="LC4309" class="css-1dcdqdg"><code>      }, <span class="code-keyword">this</span>.loading ? <span class="code-number">250</span> : <span class="code-number">0</span>);
</code></td></tr><tr><td id="L4310" class="css-a4x74f"><span>4310</span></td><td id="LC4310" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4311" class="css-a4x74f"><span>4311</span></td><td id="LC4311" class="css-1dcdqdg"><code>    <span class="code-comment">// Toggle controls based on state and `force` argument</span>
</code></td></tr><tr><td id="L4312" class="css-a4x74f"><span>4312</span></td><td id="LC4312" class="css-1dcdqdg"><code>    toggleControls(force) {
</code></td></tr><tr><td id="L4313" class="css-a4x74f"><span>4313</span></td><td id="LC4313" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4314" class="css-a4x74f"><span>4314</span></td><td id="LC4314" class="css-1dcdqdg"><code>        controls: controlsElement
</code></td></tr><tr><td id="L4315" class="css-a4x74f"><span>4315</span></td><td id="LC4315" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.elements;
</code></td></tr><tr><td id="L4316" class="css-a4x74f"><span>4316</span></td><td id="LC4316" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (controlsElement &amp;&amp; <span class="code-keyword">this</span>.config.hideControls) {
</code></td></tr><tr><td id="L4317" class="css-a4x74f"><span>4317</span></td><td id="LC4317" class="css-1dcdqdg"><code>        <span class="code-comment">// Don't hide controls if a touch-device user recently seeked. (Must be limited to touch devices, or it occasionally prevents desktop controls from hiding.)</span>
</code></td></tr><tr><td id="L4318" class="css-a4x74f"><span>4318</span></td><td id="LC4318" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> recentTouchSeek = <span class="code-keyword">this</span>.touch &amp;&amp; <span class="code-keyword">this</span>.lastSeekTime + <span class="code-number">2000</span> &gt; <span class="code-built_in">Date</span>.now();
</code></td></tr><tr><td id="L4319" class="css-a4x74f"><span>4319</span></td><td id="LC4319" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4320" class="css-a4x74f"><span>4320</span></td><td id="LC4320" class="css-1dcdqdg"><code>        <span class="code-comment">// Show controls if force, loading, paused, button interaction, or recent seek, otherwise hide</span>
</code></td></tr><tr><td id="L4321" class="css-a4x74f"><span>4321</span></td><td id="LC4321" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.toggleControls(<span class="code-built_in">Boolean</span>(force || <span class="code-keyword">this</span>.loading || <span class="code-keyword">this</span>.paused || controlsElement.pressed || controlsElement.hover || recentTouchSeek));
</code></td></tr><tr><td id="L4322" class="css-a4x74f"><span>4322</span></td><td id="LC4322" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4323" class="css-a4x74f"><span>4323</span></td><td id="LC4323" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L4324" class="css-a4x74f"><span>4324</span></td><td id="LC4324" class="css-1dcdqdg"><code>    <span class="code-comment">// Migrate any custom properties from the media to the parent</span>
</code></td></tr><tr><td id="L4325" class="css-a4x74f"><span>4325</span></td><td id="LC4325" class="css-1dcdqdg"><code>    migrateStyles() {
</code></td></tr><tr><td id="L4326" class="css-a4x74f"><span>4326</span></td><td id="LC4326" class="css-1dcdqdg"><code>      <span class="code-comment">// Loop through values (as they are the keys when the object is spread 🤔)</span>
</code></td></tr><tr><td id="L4327" class="css-a4x74f"><span>4327</span></td><td id="LC4327" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.values({
</code></td></tr><tr><td id="L4328" class="css-a4x74f"><span>4328</span></td><td id="LC4328" class="css-1dcdqdg"><code>        ...this.media.style
</code></td></tr><tr><td id="L4329" class="css-a4x74f"><span>4329</span></td><td id="LC4329" class="css-1dcdqdg"><code>      })
</code></td></tr><tr><td id="L4330" class="css-a4x74f"><span>4330</span></td><td id="LC4330" class="css-1dcdqdg"><code>      <span class="code-comment">// We're only fussed about Plyr specific properties</span>
</code></td></tr><tr><td id="L4331" class="css-a4x74f"><span>4331</span></td><td id="LC4331" class="css-1dcdqdg"><code>      .filter(<span class="code-function"><span class="code-params">key</span> =&gt;</span> !is.empty(key) &amp;&amp; is.string(key) &amp;&amp; key.startsWith(<span class="code-string">'--plyr'</span>)).forEach(<span class="code-function"><span class="code-params">key</span> =&gt;</span> {
</code></td></tr><tr><td id="L4332" class="css-a4x74f"><span>4332</span></td><td id="LC4332" class="css-1dcdqdg"><code>        <span class="code-comment">// Set on the container</span>
</code></td></tr><tr><td id="L4333" class="css-a4x74f"><span>4333</span></td><td id="LC4333" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container.style.setProperty(key, <span class="code-keyword">this</span>.media.style.getPropertyValue(key));
</code></td></tr><tr><td id="L4334" class="css-a4x74f"><span>4334</span></td><td id="LC4334" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4335" class="css-a4x74f"><span>4335</span></td><td id="LC4335" class="css-1dcdqdg"><code>        <span class="code-comment">// Clean up from media element</span>
</code></td></tr><tr><td id="L4336" class="css-a4x74f"><span>4336</span></td><td id="LC4336" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.style.removeProperty(key);
</code></td></tr><tr><td id="L4337" class="css-a4x74f"><span>4337</span></td><td id="LC4337" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4338" class="css-a4x74f"><span>4338</span></td><td id="LC4338" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4339" class="css-a4x74f"><span>4339</span></td><td id="LC4339" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove attribute if empty</span>
</code></td></tr><tr><td id="L4340" class="css-a4x74f"><span>4340</span></td><td id="LC4340" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(<span class="code-keyword">this</span>.media.style)) {
</code></td></tr><tr><td id="L4341" class="css-a4x74f"><span>4341</span></td><td id="LC4341" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.removeAttribute(<span class="code-string">'style'</span>);
</code></td></tr><tr><td id="L4342" class="css-a4x74f"><span>4342</span></td><td id="LC4342" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4343" class="css-a4x74f"><span>4343</span></td><td id="LC4343" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4344" class="css-a4x74f"><span>4344</span></td><td id="LC4344" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L4345" class="css-a4x74f"><span>4345</span></td><td id="LC4345" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4346" class="css-a4x74f"><span>4346</span></td><td id="LC4346" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Listeners</span> </span>{
</code></td></tr><tr><td id="L4347" class="css-a4x74f"><span>4347</span></td><td id="LC4347" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(_player) {
</code></td></tr><tr><td id="L4348" class="css-a4x74f"><span>4348</span></td><td id="LC4348" class="css-1dcdqdg"><code>      <span class="code-comment">// Device is touch enabled</span>
</code></td></tr><tr><td id="L4349" class="css-a4x74f"><span>4349</span></td><td id="LC4349" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"firstTouch"</span>, () =&gt; {
</code></td></tr><tr><td id="L4350" class="css-a4x74f"><span>4350</span></td><td id="LC4350" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4351" class="css-a4x74f"><span>4351</span></td><td id="LC4351" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4352" class="css-a4x74f"><span>4352</span></td><td id="LC4352" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4353" class="css-a4x74f"><span>4353</span></td><td id="LC4353" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4354" class="css-a4x74f"><span>4354</span></td><td id="LC4354" class="css-1dcdqdg"><code>          elements
</code></td></tr><tr><td id="L4355" class="css-a4x74f"><span>4355</span></td><td id="LC4355" class="css-1dcdqdg"><code>        } = player;
</code></td></tr><tr><td id="L4356" class="css-a4x74f"><span>4356</span></td><td id="LC4356" class="css-1dcdqdg"><code>        player.touch = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L4357" class="css-a4x74f"><span>4357</span></td><td id="LC4357" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4358" class="css-a4x74f"><span>4358</span></td><td id="LC4358" class="css-1dcdqdg"><code>        <span class="code-comment">// Add touch class</span>
</code></td></tr><tr><td id="L4359" class="css-a4x74f"><span>4359</span></td><td id="LC4359" class="css-1dcdqdg"><code>        toggleClass(elements.container, player.config.classNames.isTouch, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4360" class="css-a4x74f"><span>4360</span></td><td id="LC4360" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4361" class="css-a4x74f"><span>4361</span></td><td id="LC4361" class="css-1dcdqdg"><code>      <span class="code-comment">// Global window &amp; document listeners</span>
</code></td></tr><tr><td id="L4362" class="css-a4x74f"><span>4362</span></td><td id="LC4362" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"global"</span>, (toggle = <span class="code-literal">true</span>) =&gt; {
</code></td></tr><tr><td id="L4363" class="css-a4x74f"><span>4363</span></td><td id="LC4363" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4364" class="css-a4x74f"><span>4364</span></td><td id="LC4364" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4365" class="css-a4x74f"><span>4365</span></td><td id="LC4365" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4366" class="css-a4x74f"><span>4366</span></td><td id="LC4366" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4367" class="css-a4x74f"><span>4367</span></td><td id="LC4367" class="css-1dcdqdg"><code>        <span class="code-comment">// Keyboard shortcuts</span>
</code></td></tr><tr><td id="L4368" class="css-a4x74f"><span>4368</span></td><td id="LC4368" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (player.config.keyboard.global) {
</code></td></tr><tr><td id="L4369" class="css-a4x74f"><span>4369</span></td><td id="LC4369" class="css-1dcdqdg"><code>          toggleListener.call(player, <span class="code-built_in">window</span>, <span class="code-string">'keydown keyup'</span>, <span class="code-keyword">this</span>.handleKey, toggle, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4370" class="css-a4x74f"><span>4370</span></td><td id="LC4370" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4371" class="css-a4x74f"><span>4371</span></td><td id="LC4371" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4372" class="css-a4x74f"><span>4372</span></td><td id="LC4372" class="css-1dcdqdg"><code>        <span class="code-comment">// Click anywhere closes menu</span>
</code></td></tr><tr><td id="L4373" class="css-a4x74f"><span>4373</span></td><td id="LC4373" class="css-1dcdqdg"><code>        toggleListener.call(player, <span class="code-built_in">document</span>.body, <span class="code-string">'click'</span>, <span class="code-keyword">this</span>.toggleMenu, toggle);
</code></td></tr><tr><td id="L4374" class="css-a4x74f"><span>4374</span></td><td id="LC4374" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4375" class="css-a4x74f"><span>4375</span></td><td id="LC4375" class="css-1dcdqdg"><code>        <span class="code-comment">// Detect touch by events</span>
</code></td></tr><tr><td id="L4376" class="css-a4x74f"><span>4376</span></td><td id="LC4376" class="css-1dcdqdg"><code>        once.call(player, <span class="code-built_in">document</span>.body, <span class="code-string">'touchstart'</span>, <span class="code-keyword">this</span>.firstTouch);
</code></td></tr><tr><td id="L4377" class="css-a4x74f"><span>4377</span></td><td id="LC4377" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4378" class="css-a4x74f"><span>4378</span></td><td id="LC4378" class="css-1dcdqdg"><code>      <span class="code-comment">// Container listeners</span>
</code></td></tr><tr><td id="L4379" class="css-a4x74f"><span>4379</span></td><td id="LC4379" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"container"</span>, () =&gt; {
</code></td></tr><tr><td id="L4380" class="css-a4x74f"><span>4380</span></td><td id="LC4380" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4381" class="css-a4x74f"><span>4381</span></td><td id="LC4381" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4382" class="css-a4x74f"><span>4382</span></td><td id="LC4382" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4383" class="css-a4x74f"><span>4383</span></td><td id="LC4383" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4384" class="css-a4x74f"><span>4384</span></td><td id="LC4384" class="css-1dcdqdg"><code>          config,
</code></td></tr><tr><td id="L4385" class="css-a4x74f"><span>4385</span></td><td id="LC4385" class="css-1dcdqdg"><code>          elements,
</code></td></tr><tr><td id="L4386" class="css-a4x74f"><span>4386</span></td><td id="LC4386" class="css-1dcdqdg"><code>          timers
</code></td></tr><tr><td id="L4387" class="css-a4x74f"><span>4387</span></td><td id="LC4387" class="css-1dcdqdg"><code>        } = player;
</code></td></tr><tr><td id="L4388" class="css-a4x74f"><span>4388</span></td><td id="LC4388" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4389" class="css-a4x74f"><span>4389</span></td><td id="LC4389" class="css-1dcdqdg"><code>        <span class="code-comment">// Keyboard shortcuts</span>
</code></td></tr><tr><td id="L4390" class="css-a4x74f"><span>4390</span></td><td id="LC4390" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!config.keyboard.global &amp;&amp; config.keyboard.focused) {
</code></td></tr><tr><td id="L4391" class="css-a4x74f"><span>4391</span></td><td id="LC4391" class="css-1dcdqdg"><code>          on.call(player, elements.container, <span class="code-string">'keydown keyup'</span>, <span class="code-keyword">this</span>.handleKey, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4392" class="css-a4x74f"><span>4392</span></td><td id="LC4392" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4393" class="css-a4x74f"><span>4393</span></td><td id="LC4393" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4394" class="css-a4x74f"><span>4394</span></td><td id="LC4394" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle controls on mouse events and entering fullscreen</span>
</code></td></tr><tr><td id="L4395" class="css-a4x74f"><span>4395</span></td><td id="LC4395" class="css-1dcdqdg"><code>        on.call(player, elements.container, <span class="code-string">'mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen'</span>, event =&gt; {
</code></td></tr><tr><td id="L4396" class="css-a4x74f"><span>4396</span></td><td id="LC4396" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4397" class="css-a4x74f"><span>4397</span></td><td id="LC4397" class="css-1dcdqdg"><code>            controls: controlsElement
</code></td></tr><tr><td id="L4398" class="css-a4x74f"><span>4398</span></td><td id="LC4398" class="css-1dcdqdg"><code>          } = elements;
</code></td></tr><tr><td id="L4399" class="css-a4x74f"><span>4399</span></td><td id="LC4399" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4400" class="css-a4x74f"><span>4400</span></td><td id="LC4400" class="css-1dcdqdg"><code>          <span class="code-comment">// Remove button states for fullscreen</span>
</code></td></tr><tr><td id="L4401" class="css-a4x74f"><span>4401</span></td><td id="LC4401" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (controlsElement &amp;&amp; event.type === <span class="code-string">'enterfullscreen'</span>) {
</code></td></tr><tr><td id="L4402" class="css-a4x74f"><span>4402</span></td><td id="LC4402" class="css-1dcdqdg"><code>            controlsElement.pressed = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L4403" class="css-a4x74f"><span>4403</span></td><td id="LC4403" class="css-1dcdqdg"><code>            controlsElement.hover = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L4404" class="css-a4x74f"><span>4404</span></td><td id="LC4404" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4405" class="css-a4x74f"><span>4405</span></td><td id="LC4405" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4406" class="css-a4x74f"><span>4406</span></td><td id="LC4406" class="css-1dcdqdg"><code>          <span class="code-comment">// Show, then hide after a timeout unless another control event occurs</span>
</code></td></tr><tr><td id="L4407" class="css-a4x74f"><span>4407</span></td><td id="LC4407" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> show = [<span class="code-string">'touchstart'</span>, <span class="code-string">'touchmove'</span>, <span class="code-string">'mousemove'</span>].includes(event.type);
</code></td></tr><tr><td id="L4408" class="css-a4x74f"><span>4408</span></td><td id="LC4408" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> delay = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L4409" class="css-a4x74f"><span>4409</span></td><td id="LC4409" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (show) {
</code></td></tr><tr><td id="L4410" class="css-a4x74f"><span>4410</span></td><td id="LC4410" class="css-1dcdqdg"><code>            ui.toggleControls.call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4411" class="css-a4x74f"><span>4411</span></td><td id="LC4411" class="css-1dcdqdg"><code>            <span class="code-comment">// Use longer timeout for touch devices</span>
</code></td></tr><tr><td id="L4412" class="css-a4x74f"><span>4412</span></td><td id="LC4412" class="css-1dcdqdg"><code>            delay = player.touch ? <span class="code-number">3000</span> : <span class="code-number">2000</span>;
</code></td></tr><tr><td id="L4413" class="css-a4x74f"><span>4413</span></td><td id="LC4413" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4414" class="css-a4x74f"><span>4414</span></td><td id="LC4414" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4415" class="css-a4x74f"><span>4415</span></td><td id="LC4415" class="css-1dcdqdg"><code>          <span class="code-comment">// Clear timer</span>
</code></td></tr><tr><td id="L4416" class="css-a4x74f"><span>4416</span></td><td id="LC4416" class="css-1dcdqdg"><code>          clearTimeout(timers.controls);
</code></td></tr><tr><td id="L4417" class="css-a4x74f"><span>4417</span></td><td id="LC4417" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4418" class="css-a4x74f"><span>4418</span></td><td id="LC4418" class="css-1dcdqdg"><code>          <span class="code-comment">// Set new timer to prevent flicker when seeking</span>
</code></td></tr><tr><td id="L4419" class="css-a4x74f"><span>4419</span></td><td id="LC4419" class="css-1dcdqdg"><code>          timers.controls = setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> ui.toggleControls.call(player, <span class="code-literal">false</span>), delay);
</code></td></tr><tr><td id="L4420" class="css-a4x74f"><span>4420</span></td><td id="LC4420" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4421" class="css-a4x74f"><span>4421</span></td><td id="LC4421" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4422" class="css-a4x74f"><span>4422</span></td><td id="LC4422" class="css-1dcdqdg"><code>        <span class="code-comment">// Set a gutter for Vimeo</span>
</code></td></tr><tr><td id="L4423" class="css-a4x74f"><span>4423</span></td><td id="LC4423" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> setGutter = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4424" class="css-a4x74f"><span>4424</span></td><td id="LC4424" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!player.isVimeo || player.config.vimeo.premium) {
</code></td></tr><tr><td id="L4425" class="css-a4x74f"><span>4425</span></td><td id="LC4425" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4426" class="css-a4x74f"><span>4426</span></td><td id="LC4426" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4427" class="css-a4x74f"><span>4427</span></td><td id="LC4427" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> target = elements.wrapper;
</code></td></tr><tr><td id="L4428" class="css-a4x74f"><span>4428</span></td><td id="LC4428" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4429" class="css-a4x74f"><span>4429</span></td><td id="LC4429" class="css-1dcdqdg"><code>            active
</code></td></tr><tr><td id="L4430" class="css-a4x74f"><span>4430</span></td><td id="LC4430" class="css-1dcdqdg"><code>          } = player.fullscreen;
</code></td></tr><tr><td id="L4431" class="css-a4x74f"><span>4431</span></td><td id="LC4431" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> [videoWidth, videoHeight] = getAspectRatio.call(player);
</code></td></tr><tr><td id="L4432" class="css-a4x74f"><span>4432</span></td><td id="LC4432" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> useNativeAspectRatio = supportsCSS(<span class="code-string">`aspect-ratio: <span class="code-subst">${videoWidth}</span> / <span class="code-subst">${videoHeight}</span>`</span>);
</code></td></tr><tr><td id="L4433" class="css-a4x74f"><span>4433</span></td><td id="LC4433" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4434" class="css-a4x74f"><span>4434</span></td><td id="LC4434" class="css-1dcdqdg"><code>          <span class="code-comment">// If not active, remove styles</span>
</code></td></tr><tr><td id="L4435" class="css-a4x74f"><span>4435</span></td><td id="LC4435" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!active) {
</code></td></tr><tr><td id="L4436" class="css-a4x74f"><span>4436</span></td><td id="LC4436" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (useNativeAspectRatio) {
</code></td></tr><tr><td id="L4437" class="css-a4x74f"><span>4437</span></td><td id="LC4437" class="css-1dcdqdg"><code>              target.style.width = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4438" class="css-a4x74f"><span>4438</span></td><td id="LC4438" class="css-1dcdqdg"><code>              target.style.height = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4439" class="css-a4x74f"><span>4439</span></td><td id="LC4439" class="css-1dcdqdg"><code>            } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L4440" class="css-a4x74f"><span>4440</span></td><td id="LC4440" class="css-1dcdqdg"><code>              target.style.maxWidth = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4441" class="css-a4x74f"><span>4441</span></td><td id="LC4441" class="css-1dcdqdg"><code>              target.style.margin = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4442" class="css-a4x74f"><span>4442</span></td><td id="LC4442" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L4443" class="css-a4x74f"><span>4443</span></td><td id="LC4443" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4444" class="css-a4x74f"><span>4444</span></td><td id="LC4444" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4445" class="css-a4x74f"><span>4445</span></td><td id="LC4445" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4446" class="css-a4x74f"><span>4446</span></td><td id="LC4446" class="css-1dcdqdg"><code>          <span class="code-comment">// Determine which dimension will overflow and constrain view</span>
</code></td></tr><tr><td id="L4447" class="css-a4x74f"><span>4447</span></td><td id="LC4447" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> [viewportWidth, viewportHeight] = getViewportSize();
</code></td></tr><tr><td id="L4448" class="css-a4x74f"><span>4448</span></td><td id="LC4448" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> overflow = viewportWidth / viewportHeight &gt; videoWidth / videoHeight;
</code></td></tr><tr><td id="L4449" class="css-a4x74f"><span>4449</span></td><td id="LC4449" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (useNativeAspectRatio) {
</code></td></tr><tr><td id="L4450" class="css-a4x74f"><span>4450</span></td><td id="LC4450" class="css-1dcdqdg"><code>            target.style.width = overflow ? <span class="code-string">'auto'</span> : <span class="code-string">'100%'</span>;
</code></td></tr><tr><td id="L4451" class="css-a4x74f"><span>4451</span></td><td id="LC4451" class="css-1dcdqdg"><code>            target.style.height = overflow ? <span class="code-string">'100%'</span> : <span class="code-string">'auto'</span>;
</code></td></tr><tr><td id="L4452" class="css-a4x74f"><span>4452</span></td><td id="LC4452" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L4453" class="css-a4x74f"><span>4453</span></td><td id="LC4453" class="css-1dcdqdg"><code>            target.style.maxWidth = overflow ? `${viewportHeight / videoHeight * videoWidth}px` : null;
</code></td></tr><tr><td id="L4454" class="css-a4x74f"><span>4454</span></td><td id="LC4454" class="css-1dcdqdg"><code>            target.style.margin = overflow ? <span class="code-string">'0 auto'</span> : <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4455" class="css-a4x74f"><span>4455</span></td><td id="LC4455" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4456" class="css-a4x74f"><span>4456</span></td><td id="LC4456" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L4457" class="css-a4x74f"><span>4457</span></td><td id="LC4457" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4458" class="css-a4x74f"><span>4458</span></td><td id="LC4458" class="css-1dcdqdg"><code>        <span class="code-comment">// Handle resizing</span>
</code></td></tr><tr><td id="L4459" class="css-a4x74f"><span>4459</span></td><td id="LC4459" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> resized = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4460" class="css-a4x74f"><span>4460</span></td><td id="LC4460" class="css-1dcdqdg"><code>          clearTimeout(timers.resized);
</code></td></tr><tr><td id="L4461" class="css-a4x74f"><span>4461</span></td><td id="LC4461" class="css-1dcdqdg"><code>          timers.resized = setTimeout(setGutter, <span class="code-number">50</span>);
</code></td></tr><tr><td id="L4462" class="css-a4x74f"><span>4462</span></td><td id="LC4462" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L4463" class="css-a4x74f"><span>4463</span></td><td id="LC4463" class="css-1dcdqdg"><code>        on.call(player, elements.container, <span class="code-string">'enterfullscreen exitfullscreen'</span>, event =&gt; {
</code></td></tr><tr><td id="L4464" class="css-a4x74f"><span>4464</span></td><td id="LC4464" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4465" class="css-a4x74f"><span>4465</span></td><td id="LC4465" class="css-1dcdqdg"><code>            target
</code></td></tr><tr><td id="L4466" class="css-a4x74f"><span>4466</span></td><td id="LC4466" class="css-1dcdqdg"><code>          } = player.fullscreen;
</code></td></tr><tr><td id="L4467" class="css-a4x74f"><span>4467</span></td><td id="LC4467" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4468" class="css-a4x74f"><span>4468</span></td><td id="LC4468" class="css-1dcdqdg"><code>          <span class="code-comment">// Ignore events not from target</span>
</code></td></tr><tr><td id="L4469" class="css-a4x74f"><span>4469</span></td><td id="LC4469" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (target !== elements.container) {
</code></td></tr><tr><td id="L4470" class="css-a4x74f"><span>4470</span></td><td id="LC4470" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4471" class="css-a4x74f"><span>4471</span></td><td id="LC4471" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4472" class="css-a4x74f"><span>4472</span></td><td id="LC4472" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4473" class="css-a4x74f"><span>4473</span></td><td id="LC4473" class="css-1dcdqdg"><code>          <span class="code-comment">// If it's not an embed and no ratio specified</span>
</code></td></tr><tr><td id="L4474" class="css-a4x74f"><span>4474</span></td><td id="LC4474" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!player.isEmbed &amp;&amp; is.empty(player.config.ratio)) {
</code></td></tr><tr><td id="L4475" class="css-a4x74f"><span>4475</span></td><td id="LC4475" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4476" class="css-a4x74f"><span>4476</span></td><td id="LC4476" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4477" class="css-a4x74f"><span>4477</span></td><td id="LC4477" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4478" class="css-a4x74f"><span>4478</span></td><td id="LC4478" class="css-1dcdqdg"><code>          <span class="code-comment">// Set Vimeo gutter</span>
</code></td></tr><tr><td id="L4479" class="css-a4x74f"><span>4479</span></td><td id="LC4479" class="css-1dcdqdg"><code>          setGutter();
</code></td></tr><tr><td id="L4480" class="css-a4x74f"><span>4480</span></td><td id="LC4480" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4481" class="css-a4x74f"><span>4481</span></td><td id="LC4481" class="css-1dcdqdg"><code>          <span class="code-comment">// Watch for resizes</span>
</code></td></tr><tr><td id="L4482" class="css-a4x74f"><span>4482</span></td><td id="LC4482" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> method = event.type === <span class="code-string">'enterfullscreen'</span> ? on : off;
</code></td></tr><tr><td id="L4483" class="css-a4x74f"><span>4483</span></td><td id="LC4483" class="css-1dcdqdg"><code>          method.call(player, <span class="code-built_in">window</span>, <span class="code-string">'resize'</span>, resized);
</code></td></tr><tr><td id="L4484" class="css-a4x74f"><span>4484</span></td><td id="LC4484" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4485" class="css-a4x74f"><span>4485</span></td><td id="LC4485" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4486" class="css-a4x74f"><span>4486</span></td><td id="LC4486" class="css-1dcdqdg"><code>      <span class="code-comment">// Listen for media events</span>
</code></td></tr><tr><td id="L4487" class="css-a4x74f"><span>4487</span></td><td id="LC4487" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"media"</span>, () =&gt; {
</code></td></tr><tr><td id="L4488" class="css-a4x74f"><span>4488</span></td><td id="LC4488" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4489" class="css-a4x74f"><span>4489</span></td><td id="LC4489" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4490" class="css-a4x74f"><span>4490</span></td><td id="LC4490" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4491" class="css-a4x74f"><span>4491</span></td><td id="LC4491" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4492" class="css-a4x74f"><span>4492</span></td><td id="LC4492" class="css-1dcdqdg"><code>          elements
</code></td></tr><tr><td id="L4493" class="css-a4x74f"><span>4493</span></td><td id="LC4493" class="css-1dcdqdg"><code>        } = player;
</code></td></tr><tr><td id="L4494" class="css-a4x74f"><span>4494</span></td><td id="LC4494" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4495" class="css-a4x74f"><span>4495</span></td><td id="LC4495" class="css-1dcdqdg"><code>        <span class="code-comment">// Time change on media</span>
</code></td></tr><tr><td id="L4496" class="css-a4x74f"><span>4496</span></td><td id="LC4496" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'timeupdate seeking seeked'</span>, event =&gt; controls.timeUpdate.call(player, event));
</code></td></tr><tr><td id="L4497" class="css-a4x74f"><span>4497</span></td><td id="LC4497" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4498" class="css-a4x74f"><span>4498</span></td><td id="LC4498" class="css-1dcdqdg"><code>        <span class="code-comment">// Display duration</span>
</code></td></tr><tr><td id="L4499" class="css-a4x74f"><span>4499</span></td><td id="LC4499" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'durationchange loadeddata loadedmetadata'</span>, event =&gt; controls.durationUpdate.call(player, event));
</code></td></tr><tr><td id="L4500" class="css-a4x74f"><span>4500</span></td><td id="LC4500" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4501" class="css-a4x74f"><span>4501</span></td><td id="LC4501" class="css-1dcdqdg"><code>        <span class="code-comment">// Handle the media finishing</span>
</code></td></tr><tr><td id="L4502" class="css-a4x74f"><span>4502</span></td><td id="LC4502" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'ended'</span>, () =&gt; {
</code></td></tr><tr><td id="L4503" class="css-a4x74f"><span>4503</span></td><td id="LC4503" class="css-1dcdqdg"><code>          <span class="code-comment">// Show poster on end</span>
</code></td></tr><tr><td id="L4504" class="css-a4x74f"><span>4504</span></td><td id="LC4504" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (player.isHTML5 &amp;&amp; player.isVideo &amp;&amp; player.config.resetOnEnd) {
</code></td></tr><tr><td id="L4505" class="css-a4x74f"><span>4505</span></td><td id="LC4505" class="css-1dcdqdg"><code>            <span class="code-comment">// Restart</span>
</code></td></tr><tr><td id="L4506" class="css-a4x74f"><span>4506</span></td><td id="LC4506" class="css-1dcdqdg"><code>            player.restart();
</code></td></tr><tr><td id="L4507" class="css-a4x74f"><span>4507</span></td><td id="LC4507" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4508" class="css-a4x74f"><span>4508</span></td><td id="LC4508" class="css-1dcdqdg"><code>            <span class="code-comment">// Call pause otherwise IE11 will start playing the video again</span>
</code></td></tr><tr><td id="L4509" class="css-a4x74f"><span>4509</span></td><td id="LC4509" class="css-1dcdqdg"><code>            player.pause();
</code></td></tr><tr><td id="L4510" class="css-a4x74f"><span>4510</span></td><td id="LC4510" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4511" class="css-a4x74f"><span>4511</span></td><td id="LC4511" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4512" class="css-a4x74f"><span>4512</span></td><td id="LC4512" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4513" class="css-a4x74f"><span>4513</span></td><td id="LC4513" class="css-1dcdqdg"><code>        <span class="code-comment">// Check for buffer progress</span>
</code></td></tr><tr><td id="L4514" class="css-a4x74f"><span>4514</span></td><td id="LC4514" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'progress playing seeking seeked'</span>, event =&gt; controls.updateProgress.call(player, event));
</code></td></tr><tr><td id="L4515" class="css-a4x74f"><span>4515</span></td><td id="LC4515" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4516" class="css-a4x74f"><span>4516</span></td><td id="LC4516" class="css-1dcdqdg"><code>        <span class="code-comment">// Handle volume changes</span>
</code></td></tr><tr><td id="L4517" class="css-a4x74f"><span>4517</span></td><td id="LC4517" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'volumechange'</span>, event =&gt; controls.updateVolume.call(player, event));
</code></td></tr><tr><td id="L4518" class="css-a4x74f"><span>4518</span></td><td id="LC4518" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4519" class="css-a4x74f"><span>4519</span></td><td id="LC4519" class="css-1dcdqdg"><code>        <span class="code-comment">// Handle play/pause</span>
</code></td></tr><tr><td id="L4520" class="css-a4x74f"><span>4520</span></td><td id="LC4520" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'playing play pause ended emptied timeupdate'</span>, event =&gt; ui.checkPlaying.call(player, event));
</code></td></tr><tr><td id="L4521" class="css-a4x74f"><span>4521</span></td><td id="LC4521" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4522" class="css-a4x74f"><span>4522</span></td><td id="LC4522" class="css-1dcdqdg"><code>        <span class="code-comment">// Loading state</span>
</code></td></tr><tr><td id="L4523" class="css-a4x74f"><span>4523</span></td><td id="LC4523" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'waiting canplay seeked playing'</span>, event =&gt; ui.checkLoading.call(player, event));
</code></td></tr><tr><td id="L4524" class="css-a4x74f"><span>4524</span></td><td id="LC4524" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4525" class="css-a4x74f"><span>4525</span></td><td id="LC4525" class="css-1dcdqdg"><code>        <span class="code-comment">// Click video</span>
</code></td></tr><tr><td id="L4526" class="css-a4x74f"><span>4526</span></td><td id="LC4526" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (player.supported.ui &amp;&amp; player.config.clickToPlay &amp;&amp; !player.isAudio) {
</code></td></tr><tr><td id="L4527" class="css-a4x74f"><span>4527</span></td><td id="LC4527" class="css-1dcdqdg"><code>          <span class="code-comment">// Re-fetch the wrapper</span>
</code></td></tr><tr><td id="L4528" class="css-a4x74f"><span>4528</span></td><td id="LC4528" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> wrapper = getElement.call(player, <span class="code-string">`.<span class="code-subst">${player.config.classNames.video}</span>`</span>);
</code></td></tr><tr><td id="L4529" class="css-a4x74f"><span>4529</span></td><td id="LC4529" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4530" class="css-a4x74f"><span>4530</span></td><td id="LC4530" class="css-1dcdqdg"><code>          <span class="code-comment">// Bail if there's no wrapper (this should never happen)</span>
</code></td></tr><tr><td id="L4531" class="css-a4x74f"><span>4531</span></td><td id="LC4531" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!is.element(wrapper)) {
</code></td></tr><tr><td id="L4532" class="css-a4x74f"><span>4532</span></td><td id="LC4532" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4533" class="css-a4x74f"><span>4533</span></td><td id="LC4533" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4534" class="css-a4x74f"><span>4534</span></td><td id="LC4534" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4535" class="css-a4x74f"><span>4535</span></td><td id="LC4535" class="css-1dcdqdg"><code>          <span class="code-comment">// On click play, pause or restart</span>
</code></td></tr><tr><td id="L4536" class="css-a4x74f"><span>4536</span></td><td id="LC4536" class="css-1dcdqdg"><code>          on.call(player, elements.container, <span class="code-string">'click'</span>, event =&gt; {
</code></td></tr><tr><td id="L4537" class="css-a4x74f"><span>4537</span></td><td id="LC4537" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> targets = [elements.container, wrapper];
</code></td></tr><tr><td id="L4538" class="css-a4x74f"><span>4538</span></td><td id="LC4538" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4539" class="css-a4x74f"><span>4539</span></td><td id="LC4539" class="css-1dcdqdg"><code>            <span class="code-comment">// Ignore if click if not container or in video wrapper</span>
</code></td></tr><tr><td id="L4540" class="css-a4x74f"><span>4540</span></td><td id="LC4540" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!targets.includes(event.target) &amp;&amp; !wrapper.contains(event.target)) {
</code></td></tr><tr><td id="L4541" class="css-a4x74f"><span>4541</span></td><td id="LC4541" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4542" class="css-a4x74f"><span>4542</span></td><td id="LC4542" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L4543" class="css-a4x74f"><span>4543</span></td><td id="LC4543" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4544" class="css-a4x74f"><span>4544</span></td><td id="LC4544" class="css-1dcdqdg"><code>            <span class="code-comment">// Touch devices will just show controls (if hidden)</span>
</code></td></tr><tr><td id="L4545" class="css-a4x74f"><span>4545</span></td><td id="LC4545" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (player.touch &amp;&amp; player.config.hideControls) {
</code></td></tr><tr><td id="L4546" class="css-a4x74f"><span>4546</span></td><td id="LC4546" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4547" class="css-a4x74f"><span>4547</span></td><td id="LC4547" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L4548" class="css-a4x74f"><span>4548</span></td><td id="LC4548" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (player.ended) {
</code></td></tr><tr><td id="L4549" class="css-a4x74f"><span>4549</span></td><td id="LC4549" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.proxy(event, player.restart, <span class="code-string">'restart'</span>);
</code></td></tr><tr><td id="L4550" class="css-a4x74f"><span>4550</span></td><td id="LC4550" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.proxy(event, () =&gt; {
</code></td></tr><tr><td id="L4551" class="css-a4x74f"><span>4551</span></td><td id="LC4551" class="css-1dcdqdg"><code>                silencePromise(player.play());
</code></td></tr><tr><td id="L4552" class="css-a4x74f"><span>4552</span></td><td id="LC4552" class="css-1dcdqdg"><code>              }, <span class="code-string">'play'</span>);
</code></td></tr><tr><td id="L4553" class="css-a4x74f"><span>4553</span></td><td id="LC4553" class="css-1dcdqdg"><code>            } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L4554" class="css-a4x74f"><span>4554</span></td><td id="LC4554" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.proxy(event, () =&gt; {
</code></td></tr><tr><td id="L4555" class="css-a4x74f"><span>4555</span></td><td id="LC4555" class="css-1dcdqdg"><code>                silencePromise(player.togglePlay());
</code></td></tr><tr><td id="L4556" class="css-a4x74f"><span>4556</span></td><td id="LC4556" class="css-1dcdqdg"><code>              }, <span class="code-string">'play'</span>);
</code></td></tr><tr><td id="L4557" class="css-a4x74f"><span>4557</span></td><td id="LC4557" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L4558" class="css-a4x74f"><span>4558</span></td><td id="LC4558" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4559" class="css-a4x74f"><span>4559</span></td><td id="LC4559" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4560" class="css-a4x74f"><span>4560</span></td><td id="LC4560" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4561" class="css-a4x74f"><span>4561</span></td><td id="LC4561" class="css-1dcdqdg"><code>        <span class="code-comment">// Disable right click</span>
</code></td></tr><tr><td id="L4562" class="css-a4x74f"><span>4562</span></td><td id="LC4562" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (player.supported.ui &amp;&amp; player.config.disableContextMenu) {
</code></td></tr><tr><td id="L4563" class="css-a4x74f"><span>4563</span></td><td id="LC4563" class="css-1dcdqdg"><code>          on.call(player, elements.wrapper, <span class="code-string">'contextmenu'</span>, event =&gt; {
</code></td></tr><tr><td id="L4564" class="css-a4x74f"><span>4564</span></td><td id="LC4564" class="css-1dcdqdg"><code>            event.preventDefault();
</code></td></tr><tr><td id="L4565" class="css-a4x74f"><span>4565</span></td><td id="LC4565" class="css-1dcdqdg"><code>          }, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4566" class="css-a4x74f"><span>4566</span></td><td id="LC4566" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4567" class="css-a4x74f"><span>4567</span></td><td id="LC4567" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4568" class="css-a4x74f"><span>4568</span></td><td id="LC4568" class="css-1dcdqdg"><code>        <span class="code-comment">// Volume change</span>
</code></td></tr><tr><td id="L4569" class="css-a4x74f"><span>4569</span></td><td id="LC4569" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'volumechange'</span>, () =&gt; {
</code></td></tr><tr><td id="L4570" class="css-a4x74f"><span>4570</span></td><td id="LC4570" class="css-1dcdqdg"><code>          <span class="code-comment">// Save to storage</span>
</code></td></tr><tr><td id="L4571" class="css-a4x74f"><span>4571</span></td><td id="LC4571" class="css-1dcdqdg"><code>          player.storage.set({
</code></td></tr><tr><td id="L4572" class="css-a4x74f"><span>4572</span></td><td id="LC4572" class="css-1dcdqdg"><code>            volume: player.volume,
</code></td></tr><tr><td id="L4573" class="css-a4x74f"><span>4573</span></td><td id="LC4573" class="css-1dcdqdg"><code>            muted: player.muted
</code></td></tr><tr><td id="L4574" class="css-a4x74f"><span>4574</span></td><td id="LC4574" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4575" class="css-a4x74f"><span>4575</span></td><td id="LC4575" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4576" class="css-a4x74f"><span>4576</span></td><td id="LC4576" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4577" class="css-a4x74f"><span>4577</span></td><td id="LC4577" class="css-1dcdqdg"><code>        <span class="code-comment">// Speed change</span>
</code></td></tr><tr><td id="L4578" class="css-a4x74f"><span>4578</span></td><td id="LC4578" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'ratechange'</span>, () =&gt; {
</code></td></tr><tr><td id="L4579" class="css-a4x74f"><span>4579</span></td><td id="LC4579" class="css-1dcdqdg"><code>          <span class="code-comment">// Update UI</span>
</code></td></tr><tr><td id="L4580" class="css-a4x74f"><span>4580</span></td><td id="LC4580" class="css-1dcdqdg"><code>          controls.updateSetting.call(player, <span class="code-string">'speed'</span>);
</code></td></tr><tr><td id="L4581" class="css-a4x74f"><span>4581</span></td><td id="LC4581" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4582" class="css-a4x74f"><span>4582</span></td><td id="LC4582" class="css-1dcdqdg"><code>          <span class="code-comment">// Save to storage</span>
</code></td></tr><tr><td id="L4583" class="css-a4x74f"><span>4583</span></td><td id="LC4583" class="css-1dcdqdg"><code>          player.storage.set({
</code></td></tr><tr><td id="L4584" class="css-a4x74f"><span>4584</span></td><td id="LC4584" class="css-1dcdqdg"><code>            speed: player.speed
</code></td></tr><tr><td id="L4585" class="css-a4x74f"><span>4585</span></td><td id="LC4585" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4586" class="css-a4x74f"><span>4586</span></td><td id="LC4586" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4587" class="css-a4x74f"><span>4587</span></td><td id="LC4587" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4588" class="css-a4x74f"><span>4588</span></td><td id="LC4588" class="css-1dcdqdg"><code>        <span class="code-comment">// Quality change</span>
</code></td></tr><tr><td id="L4589" class="css-a4x74f"><span>4589</span></td><td id="LC4589" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'qualitychange'</span>, event =&gt; {
</code></td></tr><tr><td id="L4590" class="css-a4x74f"><span>4590</span></td><td id="LC4590" class="css-1dcdqdg"><code>          <span class="code-comment">// Update UI</span>
</code></td></tr><tr><td id="L4591" class="css-a4x74f"><span>4591</span></td><td id="LC4591" class="css-1dcdqdg"><code>          controls.updateSetting.call(player, <span class="code-string">'quality'</span>, <span class="code-literal">null</span>, event.detail.quality);
</code></td></tr><tr><td id="L4592" class="css-a4x74f"><span>4592</span></td><td id="LC4592" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4593" class="css-a4x74f"><span>4593</span></td><td id="LC4593" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4594" class="css-a4x74f"><span>4594</span></td><td id="LC4594" class="css-1dcdqdg"><code>        <span class="code-comment">// Update download link when ready and if quality changes</span>
</code></td></tr><tr><td id="L4595" class="css-a4x74f"><span>4595</span></td><td id="LC4595" class="css-1dcdqdg"><code>        on.call(player, player.media, <span class="code-string">'ready qualitychange'</span>, () =&gt; {
</code></td></tr><tr><td id="L4596" class="css-a4x74f"><span>4596</span></td><td id="LC4596" class="css-1dcdqdg"><code>          controls.setDownloadUrl.call(player);
</code></td></tr><tr><td id="L4597" class="css-a4x74f"><span>4597</span></td><td id="LC4597" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4598" class="css-a4x74f"><span>4598</span></td><td id="LC4598" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4599" class="css-a4x74f"><span>4599</span></td><td id="LC4599" class="css-1dcdqdg"><code>        <span class="code-comment">// Proxy events to container</span>
</code></td></tr><tr><td id="L4600" class="css-a4x74f"><span>4600</span></td><td id="LC4600" class="css-1dcdqdg"><code>        <span class="code-comment">// Bubble up key events for Edge</span>
</code></td></tr><tr><td id="L4601" class="css-a4x74f"><span>4601</span></td><td id="LC4601" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> proxyEvents = player.config.events.concat([<span class="code-string">'keyup'</span>, <span class="code-string">'keydown'</span>]).join(<span class="code-string">' '</span>);
</code></td></tr><tr><td id="L4602" class="css-a4x74f"><span>4602</span></td><td id="LC4602" class="css-1dcdqdg"><code>        on.call(player, player.media, proxyEvents, event =&gt; {
</code></td></tr><tr><td id="L4603" class="css-a4x74f"><span>4603</span></td><td id="LC4603" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L4604" class="css-a4x74f"><span>4604</span></td><td id="LC4604" class="css-1dcdqdg"><code>            detail = {}
</code></td></tr><tr><td id="L4605" class="css-a4x74f"><span>4605</span></td><td id="LC4605" class="css-1dcdqdg"><code>          } = event;
</code></td></tr><tr><td id="L4606" class="css-a4x74f"><span>4606</span></td><td id="LC4606" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4607" class="css-a4x74f"><span>4607</span></td><td id="LC4607" class="css-1dcdqdg"><code>          <span class="code-comment">// Get error details from media</span>
</code></td></tr><tr><td id="L4608" class="css-a4x74f"><span>4608</span></td><td id="LC4608" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.type === <span class="code-string">'error'</span>) {
</code></td></tr><tr><td id="L4609" class="css-a4x74f"><span>4609</span></td><td id="LC4609" class="css-1dcdqdg"><code>            detail = player.media.error;
</code></td></tr><tr><td id="L4610" class="css-a4x74f"><span>4610</span></td><td id="LC4610" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4611" class="css-a4x74f"><span>4611</span></td><td id="LC4611" class="css-1dcdqdg"><code>          triggerEvent.call(player, elements.container, event.type, <span class="code-literal">true</span>, detail);
</code></td></tr><tr><td id="L4612" class="css-a4x74f"><span>4612</span></td><td id="LC4612" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4613" class="css-a4x74f"><span>4613</span></td><td id="LC4613" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4614" class="css-a4x74f"><span>4614</span></td><td id="LC4614" class="css-1dcdqdg"><code>      <span class="code-comment">// Run default and custom handlers</span>
</code></td></tr><tr><td id="L4615" class="css-a4x74f"><span>4615</span></td><td id="LC4615" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"proxy"</span>, (event, defaultHandler, customHandlerKey) =&gt; {
</code></td></tr><tr><td id="L4616" class="css-a4x74f"><span>4616</span></td><td id="LC4616" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4617" class="css-a4x74f"><span>4617</span></td><td id="LC4617" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4618" class="css-a4x74f"><span>4618</span></td><td id="LC4618" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4619" class="css-a4x74f"><span>4619</span></td><td id="LC4619" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> customHandler = player.config.listeners[customHandlerKey];
</code></td></tr><tr><td id="L4620" class="css-a4x74f"><span>4620</span></td><td id="LC4620" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> hasCustomHandler = is.function(customHandler);
</code></td></tr><tr><td id="L4621" class="css-a4x74f"><span>4621</span></td><td id="LC4621" class="css-1dcdqdg"><code>        <span class="code-keyword">let</span> returned = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L4622" class="css-a4x74f"><span>4622</span></td><td id="LC4622" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4623" class="css-a4x74f"><span>4623</span></td><td id="LC4623" class="css-1dcdqdg"><code>        <span class="code-comment">// Execute custom handler</span>
</code></td></tr><tr><td id="L4624" class="css-a4x74f"><span>4624</span></td><td id="LC4624" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (hasCustomHandler) {
</code></td></tr><tr><td id="L4625" class="css-a4x74f"><span>4625</span></td><td id="LC4625" class="css-1dcdqdg"><code>          returned = customHandler.call(player, event);
</code></td></tr><tr><td id="L4626" class="css-a4x74f"><span>4626</span></td><td id="LC4626" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4627" class="css-a4x74f"><span>4627</span></td><td id="LC4627" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4628" class="css-a4x74f"><span>4628</span></td><td id="LC4628" class="css-1dcdqdg"><code>        <span class="code-comment">// Only call default handler if not prevented in custom handler</span>
</code></td></tr><tr><td id="L4629" class="css-a4x74f"><span>4629</span></td><td id="LC4629" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (returned !== <span class="code-literal">false</span> &amp;&amp; is.function(defaultHandler)) {
</code></td></tr><tr><td id="L4630" class="css-a4x74f"><span>4630</span></td><td id="LC4630" class="css-1dcdqdg"><code>          defaultHandler.call(player, event);
</code></td></tr><tr><td id="L4631" class="css-a4x74f"><span>4631</span></td><td id="LC4631" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4632" class="css-a4x74f"><span>4632</span></td><td id="LC4632" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4633" class="css-a4x74f"><span>4633</span></td><td id="LC4633" class="css-1dcdqdg"><code>      <span class="code-comment">// Trigger custom and default handlers</span>
</code></td></tr><tr><td id="L4634" class="css-a4x74f"><span>4634</span></td><td id="LC4634" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"bind"</span>, (element, type, defaultHandler, customHandlerKey, passive = <span class="code-literal">true</span>) =&gt; {
</code></td></tr><tr><td id="L4635" class="css-a4x74f"><span>4635</span></td><td id="LC4635" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4636" class="css-a4x74f"><span>4636</span></td><td id="LC4636" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4637" class="css-a4x74f"><span>4637</span></td><td id="LC4637" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4638" class="css-a4x74f"><span>4638</span></td><td id="LC4638" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> customHandler = player.config.listeners[customHandlerKey];
</code></td></tr><tr><td id="L4639" class="css-a4x74f"><span>4639</span></td><td id="LC4639" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> hasCustomHandler = is.function(customHandler);
</code></td></tr><tr><td id="L4640" class="css-a4x74f"><span>4640</span></td><td id="LC4640" class="css-1dcdqdg"><code>        on.call(player, element, type, event =&gt; <span class="code-keyword">this</span>.proxy(event, defaultHandler, customHandlerKey), passive &amp;&amp; !hasCustomHandler);
</code></td></tr><tr><td id="L4641" class="css-a4x74f"><span>4641</span></td><td id="LC4641" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4642" class="css-a4x74f"><span>4642</span></td><td id="LC4642" class="css-1dcdqdg"><code>      <span class="code-comment">// Listen for control events</span>
</code></td></tr><tr><td id="L4643" class="css-a4x74f"><span>4643</span></td><td id="LC4643" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"controls"</span>, () =&gt; {
</code></td></tr><tr><td id="L4644" class="css-a4x74f"><span>4644</span></td><td id="LC4644" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4645" class="css-a4x74f"><span>4645</span></td><td id="LC4645" class="css-1dcdqdg"><code>          player
</code></td></tr><tr><td id="L4646" class="css-a4x74f"><span>4646</span></td><td id="LC4646" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4647" class="css-a4x74f"><span>4647</span></td><td id="LC4647" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4648" class="css-a4x74f"><span>4648</span></td><td id="LC4648" class="css-1dcdqdg"><code>          elements
</code></td></tr><tr><td id="L4649" class="css-a4x74f"><span>4649</span></td><td id="LC4649" class="css-1dcdqdg"><code>        } = player;
</code></td></tr><tr><td id="L4650" class="css-a4x74f"><span>4650</span></td><td id="LC4650" class="css-1dcdqdg"><code>        <span class="code-comment">// IE doesn't support input event, so we fallback to change</span>
</code></td></tr><tr><td id="L4651" class="css-a4x74f"><span>4651</span></td><td id="LC4651" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> inputEvent = browser.isIE ? <span class="code-string">'change'</span> : <span class="code-string">'input'</span>;
</code></td></tr><tr><td id="L4652" class="css-a4x74f"><span>4652</span></td><td id="LC4652" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4653" class="css-a4x74f"><span>4653</span></td><td id="LC4653" class="css-1dcdqdg"><code>        <span class="code-comment">// Play/pause toggle</span>
</code></td></tr><tr><td id="L4654" class="css-a4x74f"><span>4654</span></td><td id="LC4654" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (elements.buttons.play) {
</code></td></tr><tr><td id="L4655" class="css-a4x74f"><span>4655</span></td><td id="LC4655" class="css-1dcdqdg"><code>          <span class="code-built_in">Array</span>.from(elements.buttons.play).forEach(<span class="code-function"><span class="code-params">button</span> =&gt;</span> {
</code></td></tr><tr><td id="L4656" class="css-a4x74f"><span>4656</span></td><td id="LC4656" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.bind(button, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4657" class="css-a4x74f"><span>4657</span></td><td id="LC4657" class="css-1dcdqdg"><code>              silencePromise(player.togglePlay());
</code></td></tr><tr><td id="L4658" class="css-a4x74f"><span>4658</span></td><td id="LC4658" class="css-1dcdqdg"><code>            }, <span class="code-string">'play'</span>);
</code></td></tr><tr><td id="L4659" class="css-a4x74f"><span>4659</span></td><td id="LC4659" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4660" class="css-a4x74f"><span>4660</span></td><td id="LC4660" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4661" class="css-a4x74f"><span>4661</span></td><td id="LC4661" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4662" class="css-a4x74f"><span>4662</span></td><td id="LC4662" class="css-1dcdqdg"><code>        <span class="code-comment">// Pause</span>
</code></td></tr><tr><td id="L4663" class="css-a4x74f"><span>4663</span></td><td id="LC4663" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.restart, <span class="code-string">'click'</span>, player.restart, <span class="code-string">'restart'</span>);
</code></td></tr><tr><td id="L4664" class="css-a4x74f"><span>4664</span></td><td id="LC4664" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4665" class="css-a4x74f"><span>4665</span></td><td id="LC4665" class="css-1dcdqdg"><code>        <span class="code-comment">// Rewind</span>
</code></td></tr><tr><td id="L4666" class="css-a4x74f"><span>4666</span></td><td id="LC4666" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.rewind, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4667" class="css-a4x74f"><span>4667</span></td><td id="LC4667" class="css-1dcdqdg"><code>          <span class="code-comment">// Record seek time so we can prevent hiding controls for a few seconds after rewind</span>
</code></td></tr><tr><td id="L4668" class="css-a4x74f"><span>4668</span></td><td id="LC4668" class="css-1dcdqdg"><code>          player.lastSeekTime = <span class="code-built_in">Date</span>.now();
</code></td></tr><tr><td id="L4669" class="css-a4x74f"><span>4669</span></td><td id="LC4669" class="css-1dcdqdg"><code>          player.rewind();
</code></td></tr><tr><td id="L4670" class="css-a4x74f"><span>4670</span></td><td id="LC4670" class="css-1dcdqdg"><code>        }, <span class="code-string">'rewind'</span>);
</code></td></tr><tr><td id="L4671" class="css-a4x74f"><span>4671</span></td><td id="LC4671" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4672" class="css-a4x74f"><span>4672</span></td><td id="LC4672" class="css-1dcdqdg"><code>        <span class="code-comment">// Rewind</span>
</code></td></tr><tr><td id="L4673" class="css-a4x74f"><span>4673</span></td><td id="LC4673" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.fastForward, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4674" class="css-a4x74f"><span>4674</span></td><td id="LC4674" class="css-1dcdqdg"><code>          <span class="code-comment">// Record seek time so we can prevent hiding controls for a few seconds after fast forward</span>
</code></td></tr><tr><td id="L4675" class="css-a4x74f"><span>4675</span></td><td id="LC4675" class="css-1dcdqdg"><code>          player.lastSeekTime = <span class="code-built_in">Date</span>.now();
</code></td></tr><tr><td id="L4676" class="css-a4x74f"><span>4676</span></td><td id="LC4676" class="css-1dcdqdg"><code>          player.forward();
</code></td></tr><tr><td id="L4677" class="css-a4x74f"><span>4677</span></td><td id="LC4677" class="css-1dcdqdg"><code>        }, <span class="code-string">'fastForward'</span>);
</code></td></tr><tr><td id="L4678" class="css-a4x74f"><span>4678</span></td><td id="LC4678" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4679" class="css-a4x74f"><span>4679</span></td><td id="LC4679" class="css-1dcdqdg"><code>        <span class="code-comment">// Mute toggle</span>
</code></td></tr><tr><td id="L4680" class="css-a4x74f"><span>4680</span></td><td id="LC4680" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.mute, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4681" class="css-a4x74f"><span>4681</span></td><td id="LC4681" class="css-1dcdqdg"><code>          player.muted = !player.muted;
</code></td></tr><tr><td id="L4682" class="css-a4x74f"><span>4682</span></td><td id="LC4682" class="css-1dcdqdg"><code>        }, <span class="code-string">'mute'</span>);
</code></td></tr><tr><td id="L4683" class="css-a4x74f"><span>4683</span></td><td id="LC4683" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4684" class="css-a4x74f"><span>4684</span></td><td id="LC4684" class="css-1dcdqdg"><code>        <span class="code-comment">// Captions toggle</span>
</code></td></tr><tr><td id="L4685" class="css-a4x74f"><span>4685</span></td><td id="LC4685" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.captions, <span class="code-string">'click'</span>, () =&gt; player.toggleCaptions());
</code></td></tr><tr><td id="L4686" class="css-a4x74f"><span>4686</span></td><td id="LC4686" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4687" class="css-a4x74f"><span>4687</span></td><td id="LC4687" class="css-1dcdqdg"><code>        <span class="code-comment">// Download</span>
</code></td></tr><tr><td id="L4688" class="css-a4x74f"><span>4688</span></td><td id="LC4688" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.download, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4689" class="css-a4x74f"><span>4689</span></td><td id="LC4689" class="css-1dcdqdg"><code>          triggerEvent.call(player, player.media, <span class="code-string">'download'</span>);
</code></td></tr><tr><td id="L4690" class="css-a4x74f"><span>4690</span></td><td id="LC4690" class="css-1dcdqdg"><code>        }, <span class="code-string">'download'</span>);
</code></td></tr><tr><td id="L4691" class="css-a4x74f"><span>4691</span></td><td id="LC4691" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4692" class="css-a4x74f"><span>4692</span></td><td id="LC4692" class="css-1dcdqdg"><code>        <span class="code-comment">// Fullscreen toggle</span>
</code></td></tr><tr><td id="L4693" class="css-a4x74f"><span>4693</span></td><td id="LC4693" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.fullscreen, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4694" class="css-a4x74f"><span>4694</span></td><td id="LC4694" class="css-1dcdqdg"><code>          player.fullscreen.toggle();
</code></td></tr><tr><td id="L4695" class="css-a4x74f"><span>4695</span></td><td id="LC4695" class="css-1dcdqdg"><code>        }, <span class="code-string">'fullscreen'</span>);
</code></td></tr><tr><td id="L4696" class="css-a4x74f"><span>4696</span></td><td id="LC4696" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4697" class="css-a4x74f"><span>4697</span></td><td id="LC4697" class="css-1dcdqdg"><code>        <span class="code-comment">// Picture-in-Picture</span>
</code></td></tr><tr><td id="L4698" class="css-a4x74f"><span>4698</span></td><td id="LC4698" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.pip, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4699" class="css-a4x74f"><span>4699</span></td><td id="LC4699" class="css-1dcdqdg"><code>          player.pip = <span class="code-string">'toggle'</span>;
</code></td></tr><tr><td id="L4700" class="css-a4x74f"><span>4700</span></td><td id="LC4700" class="css-1dcdqdg"><code>        }, <span class="code-string">'pip'</span>);
</code></td></tr><tr><td id="L4701" class="css-a4x74f"><span>4701</span></td><td id="LC4701" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4702" class="css-a4x74f"><span>4702</span></td><td id="LC4702" class="css-1dcdqdg"><code>        <span class="code-comment">// Airplay</span>
</code></td></tr><tr><td id="L4703" class="css-a4x74f"><span>4703</span></td><td id="LC4703" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.airplay, <span class="code-string">'click'</span>, player.airplay, <span class="code-string">'airplay'</span>);
</code></td></tr><tr><td id="L4704" class="css-a4x74f"><span>4704</span></td><td id="LC4704" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4705" class="css-a4x74f"><span>4705</span></td><td id="LC4705" class="css-1dcdqdg"><code>        <span class="code-comment">// Settings menu - click toggle</span>
</code></td></tr><tr><td id="L4706" class="css-a4x74f"><span>4706</span></td><td id="LC4706" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.settings, <span class="code-string">'click'</span>, event =&gt; {
</code></td></tr><tr><td id="L4707" class="css-a4x74f"><span>4707</span></td><td id="LC4707" class="css-1dcdqdg"><code>          <span class="code-comment">// Prevent the document click listener closing the menu</span>
</code></td></tr><tr><td id="L4708" class="css-a4x74f"><span>4708</span></td><td id="LC4708" class="css-1dcdqdg"><code>          event.stopPropagation();
</code></td></tr><tr><td id="L4709" class="css-a4x74f"><span>4709</span></td><td id="LC4709" class="css-1dcdqdg"><code>          event.preventDefault();
</code></td></tr><tr><td id="L4710" class="css-a4x74f"><span>4710</span></td><td id="LC4710" class="css-1dcdqdg"><code>          controls.toggleMenu.call(player, event);
</code></td></tr><tr><td id="L4711" class="css-a4x74f"><span>4711</span></td><td id="LC4711" class="css-1dcdqdg"><code>        }, <span class="code-literal">null</span>, <span class="code-literal">false</span>); <span class="code-comment">// Can't be passive as we're preventing default</span>
</code></td></tr><tr><td id="L4712" class="css-a4x74f"><span>4712</span></td><td id="LC4712" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4713" class="css-a4x74f"><span>4713</span></td><td id="LC4713" class="css-1dcdqdg"><code>        <span class="code-comment">// Settings menu - keyboard toggle</span>
</code></td></tr><tr><td id="L4714" class="css-a4x74f"><span>4714</span></td><td id="LC4714" class="css-1dcdqdg"><code>        <span class="code-comment">// We have to bind to keyup otherwise Firefox triggers a click when a keydown event handler shifts focus</span>
</code></td></tr><tr><td id="L4715" class="css-a4x74f"><span>4715</span></td><td id="LC4715" class="css-1dcdqdg"><code>        <span class="code-comment">// https://bugzilla.mozilla.org/show_bug.cgi?id=1220143</span>
</code></td></tr><tr><td id="L4716" class="css-a4x74f"><span>4716</span></td><td id="LC4716" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.buttons.settings, <span class="code-string">'keyup'</span>, event =&gt; {
</code></td></tr><tr><td id="L4717" class="css-a4x74f"><span>4717</span></td><td id="LC4717" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (![<span class="code-string">' '</span>, <span class="code-string">'Enter'</span>].includes(event.key)) {
</code></td></tr><tr><td id="L4718" class="css-a4x74f"><span>4718</span></td><td id="LC4718" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4719" class="css-a4x74f"><span>4719</span></td><td id="LC4719" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4720" class="css-a4x74f"><span>4720</span></td><td id="LC4720" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4721" class="css-a4x74f"><span>4721</span></td><td id="LC4721" class="css-1dcdqdg"><code>          <span class="code-comment">// Because return triggers a click anyway, all we need to do is set focus</span>
</code></td></tr><tr><td id="L4722" class="css-a4x74f"><span>4722</span></td><td id="LC4722" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.key === <span class="code-string">'Enter'</span>) {
</code></td></tr><tr><td id="L4723" class="css-a4x74f"><span>4723</span></td><td id="LC4723" class="css-1dcdqdg"><code>            controls.focusFirstMenuItem.call(player, <span class="code-literal">null</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4724" class="css-a4x74f"><span>4724</span></td><td id="LC4724" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4725" class="css-a4x74f"><span>4725</span></td><td id="LC4725" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4726" class="css-a4x74f"><span>4726</span></td><td id="LC4726" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4727" class="css-a4x74f"><span>4727</span></td><td id="LC4727" class="css-1dcdqdg"><code>          <span class="code-comment">// Prevent scroll</span>
</code></td></tr><tr><td id="L4728" class="css-a4x74f"><span>4728</span></td><td id="LC4728" class="css-1dcdqdg"><code>          event.preventDefault();
</code></td></tr><tr><td id="L4729" class="css-a4x74f"><span>4729</span></td><td id="LC4729" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4730" class="css-a4x74f"><span>4730</span></td><td id="LC4730" class="css-1dcdqdg"><code>          <span class="code-comment">// Prevent playing video (Firefox)</span>
</code></td></tr><tr><td id="L4731" class="css-a4x74f"><span>4731</span></td><td id="LC4731" class="css-1dcdqdg"><code>          event.stopPropagation();
</code></td></tr><tr><td id="L4732" class="css-a4x74f"><span>4732</span></td><td id="LC4732" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4733" class="css-a4x74f"><span>4733</span></td><td id="LC4733" class="css-1dcdqdg"><code>          <span class="code-comment">// Toggle menu</span>
</code></td></tr><tr><td id="L4734" class="css-a4x74f"><span>4734</span></td><td id="LC4734" class="css-1dcdqdg"><code>          controls.toggleMenu.call(player, event);
</code></td></tr><tr><td id="L4735" class="css-a4x74f"><span>4735</span></td><td id="LC4735" class="css-1dcdqdg"><code>        }, <span class="code-literal">null</span>, <span class="code-literal">false</span> <span class="code-comment">// Can't be passive as we're preventing default</span>
</code></td></tr><tr><td id="L4736" class="css-a4x74f"><span>4736</span></td><td id="LC4736" class="css-1dcdqdg"><code>        );
</code></td></tr><tr><td id="L4737" class="css-a4x74f"><span>4737</span></td><td id="LC4737" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4738" class="css-a4x74f"><span>4738</span></td><td id="LC4738" class="css-1dcdqdg"><code>        <span class="code-comment">// Escape closes menu</span>
</code></td></tr><tr><td id="L4739" class="css-a4x74f"><span>4739</span></td><td id="LC4739" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.settings.menu, <span class="code-string">'keydown'</span>, event =&gt; {
</code></td></tr><tr><td id="L4740" class="css-a4x74f"><span>4740</span></td><td id="LC4740" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.key === <span class="code-string">'Escape'</span>) {
</code></td></tr><tr><td id="L4741" class="css-a4x74f"><span>4741</span></td><td id="LC4741" class="css-1dcdqdg"><code>            controls.toggleMenu.call(player, event);
</code></td></tr><tr><td id="L4742" class="css-a4x74f"><span>4742</span></td><td id="LC4742" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4743" class="css-a4x74f"><span>4743</span></td><td id="LC4743" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4744" class="css-a4x74f"><span>4744</span></td><td id="LC4744" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4745" class="css-a4x74f"><span>4745</span></td><td id="LC4745" class="css-1dcdqdg"><code>        <span class="code-comment">// Set range input alternative "value", which matches the tooltip time (#954)</span>
</code></td></tr><tr><td id="L4746" class="css-a4x74f"><span>4746</span></td><td id="LC4746" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.inputs.seek, <span class="code-string">'mousedown mousemove'</span>, event =&gt; {
</code></td></tr><tr><td id="L4747" class="css-a4x74f"><span>4747</span></td><td id="LC4747" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> rect = elements.progress.getBoundingClientRect();
</code></td></tr><tr><td id="L4748" class="css-a4x74f"><span>4748</span></td><td id="LC4748" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> percent = <span class="code-number">100</span> / rect.width * (event.pageX - rect.left);
</code></td></tr><tr><td id="L4749" class="css-a4x74f"><span>4749</span></td><td id="LC4749" class="css-1dcdqdg"><code>          event.currentTarget.setAttribute(<span class="code-string">'seek-value'</span>, percent);
</code></td></tr><tr><td id="L4750" class="css-a4x74f"><span>4750</span></td><td id="LC4750" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4751" class="css-a4x74f"><span>4751</span></td><td id="LC4751" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4752" class="css-a4x74f"><span>4752</span></td><td id="LC4752" class="css-1dcdqdg"><code>        <span class="code-comment">// Pause while seeking</span>
</code></td></tr><tr><td id="L4753" class="css-a4x74f"><span>4753</span></td><td id="LC4753" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.inputs.seek, <span class="code-string">'mousedown mouseup keydown keyup touchstart touchend'</span>, event =&gt; {
</code></td></tr><tr><td id="L4754" class="css-a4x74f"><span>4754</span></td><td id="LC4754" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> seek = event.currentTarget;
</code></td></tr><tr><td id="L4755" class="css-a4x74f"><span>4755</span></td><td id="LC4755" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> attribute = <span class="code-string">'play-on-seeked'</span>;
</code></td></tr><tr><td id="L4756" class="css-a4x74f"><span>4756</span></td><td id="LC4756" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.keyboardEvent(event) &amp;&amp; ![<span class="code-string">'ArrowLeft'</span>, <span class="code-string">'ArrowRight'</span>].includes(event.key)) {
</code></td></tr><tr><td id="L4757" class="css-a4x74f"><span>4757</span></td><td id="LC4757" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4758" class="css-a4x74f"><span>4758</span></td><td id="LC4758" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4759" class="css-a4x74f"><span>4759</span></td><td id="LC4759" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4760" class="css-a4x74f"><span>4760</span></td><td id="LC4760" class="css-1dcdqdg"><code>          <span class="code-comment">// Record seek time so we can prevent hiding controls for a few seconds after seek</span>
</code></td></tr><tr><td id="L4761" class="css-a4x74f"><span>4761</span></td><td id="LC4761" class="css-1dcdqdg"><code>          player.lastSeekTime = <span class="code-built_in">Date</span>.now();
</code></td></tr><tr><td id="L4762" class="css-a4x74f"><span>4762</span></td><td id="LC4762" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4763" class="css-a4x74f"><span>4763</span></td><td id="LC4763" class="css-1dcdqdg"><code>          <span class="code-comment">// Was playing before?</span>
</code></td></tr><tr><td id="L4764" class="css-a4x74f"><span>4764</span></td><td id="LC4764" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> play = seek.hasAttribute(attribute);
</code></td></tr><tr><td id="L4765" class="css-a4x74f"><span>4765</span></td><td id="LC4765" class="css-1dcdqdg"><code>          <span class="code-comment">// Done seeking</span>
</code></td></tr><tr><td id="L4766" class="css-a4x74f"><span>4766</span></td><td id="LC4766" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> done = [<span class="code-string">'mouseup'</span>, <span class="code-string">'touchend'</span>, <span class="code-string">'keyup'</span>].includes(event.type);
</code></td></tr><tr><td id="L4767" class="css-a4x74f"><span>4767</span></td><td id="LC4767" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4768" class="css-a4x74f"><span>4768</span></td><td id="LC4768" class="css-1dcdqdg"><code>          <span class="code-comment">// If we're done seeking and it was playing, resume playback</span>
</code></td></tr><tr><td id="L4769" class="css-a4x74f"><span>4769</span></td><td id="LC4769" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (play &amp;&amp; done) {
</code></td></tr><tr><td id="L4770" class="css-a4x74f"><span>4770</span></td><td id="LC4770" class="css-1dcdqdg"><code>            seek.removeAttribute(attribute);
</code></td></tr><tr><td id="L4771" class="css-a4x74f"><span>4771</span></td><td id="LC4771" class="css-1dcdqdg"><code>            silencePromise(player.play());
</code></td></tr><tr><td id="L4772" class="css-a4x74f"><span>4772</span></td><td id="LC4772" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!done &amp;&amp; player.playing) {
</code></td></tr><tr><td id="L4773" class="css-a4x74f"><span>4773</span></td><td id="LC4773" class="css-1dcdqdg"><code>            seek.setAttribute(attribute, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L4774" class="css-a4x74f"><span>4774</span></td><td id="LC4774" class="css-1dcdqdg"><code>            player.pause();
</code></td></tr><tr><td id="L4775" class="css-a4x74f"><span>4775</span></td><td id="LC4775" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4776" class="css-a4x74f"><span>4776</span></td><td id="LC4776" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4777" class="css-a4x74f"><span>4777</span></td><td id="LC4777" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4778" class="css-a4x74f"><span>4778</span></td><td id="LC4778" class="css-1dcdqdg"><code>        <span class="code-comment">// Fix range inputs on iOS</span>
</code></td></tr><tr><td id="L4779" class="css-a4x74f"><span>4779</span></td><td id="LC4779" class="css-1dcdqdg"><code>        <span class="code-comment">// Super weird iOS bug where after you interact with an &lt;input type="range"&gt;,</span>
</code></td></tr><tr><td id="L4780" class="css-a4x74f"><span>4780</span></td><td id="LC4780" class="css-1dcdqdg"><code>        <span class="code-comment">// it takes over further interactions on the page. This is a hack</span>
</code></td></tr><tr><td id="L4781" class="css-a4x74f"><span>4781</span></td><td id="LC4781" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isIos) {
</code></td></tr><tr><td id="L4782" class="css-a4x74f"><span>4782</span></td><td id="LC4782" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> inputs = getElements.call(player, <span class="code-string">'input[type="range"]'</span>);
</code></td></tr><tr><td id="L4783" class="css-a4x74f"><span>4783</span></td><td id="LC4783" class="css-1dcdqdg"><code>          <span class="code-built_in">Array</span>.from(inputs).forEach(<span class="code-function"><span class="code-params">input</span> =&gt;</span> <span class="code-keyword">this</span>.bind(input, inputEvent, event =&gt; repaint(event.target)));
</code></td></tr><tr><td id="L4784" class="css-a4x74f"><span>4784</span></td><td id="LC4784" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4785" class="css-a4x74f"><span>4785</span></td><td id="LC4785" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4786" class="css-a4x74f"><span>4786</span></td><td id="LC4786" class="css-1dcdqdg"><code>        <span class="code-comment">// Seek</span>
</code></td></tr><tr><td id="L4787" class="css-a4x74f"><span>4787</span></td><td id="LC4787" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.inputs.seek, inputEvent, event =&gt; {
</code></td></tr><tr><td id="L4788" class="css-a4x74f"><span>4788</span></td><td id="LC4788" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> seek = event.currentTarget;
</code></td></tr><tr><td id="L4789" class="css-a4x74f"><span>4789</span></td><td id="LC4789" class="css-1dcdqdg"><code>          <span class="code-comment">// If it exists, use seek-value instead of "value" for consistency with tooltip time (#954)</span>
</code></td></tr><tr><td id="L4790" class="css-a4x74f"><span>4790</span></td><td id="LC4790" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> seekTo = seek.getAttribute(<span class="code-string">'seek-value'</span>);
</code></td></tr><tr><td id="L4791" class="css-a4x74f"><span>4791</span></td><td id="LC4791" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(seekTo)) {
</code></td></tr><tr><td id="L4792" class="css-a4x74f"><span>4792</span></td><td id="LC4792" class="css-1dcdqdg"><code>            seekTo = seek.value;
</code></td></tr><tr><td id="L4793" class="css-a4x74f"><span>4793</span></td><td id="LC4793" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4794" class="css-a4x74f"><span>4794</span></td><td id="LC4794" class="css-1dcdqdg"><code>          seek.removeAttribute(<span class="code-string">'seek-value'</span>);
</code></td></tr><tr><td id="L4795" class="css-a4x74f"><span>4795</span></td><td id="LC4795" class="css-1dcdqdg"><code>          player.currentTime = seekTo / seek.max * player.duration;
</code></td></tr><tr><td id="L4796" class="css-a4x74f"><span>4796</span></td><td id="LC4796" class="css-1dcdqdg"><code>        }, <span class="code-string">'seek'</span>);
</code></td></tr><tr><td id="L4797" class="css-a4x74f"><span>4797</span></td><td id="LC4797" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4798" class="css-a4x74f"><span>4798</span></td><td id="LC4798" class="css-1dcdqdg"><code>        <span class="code-comment">// Seek tooltip</span>
</code></td></tr><tr><td id="L4799" class="css-a4x74f"><span>4799</span></td><td id="LC4799" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.progress, <span class="code-string">'mouseenter mouseleave mousemove'</span>, event =&gt; controls.updateSeekTooltip.call(player, event));
</code></td></tr><tr><td id="L4800" class="css-a4x74f"><span>4800</span></td><td id="LC4800" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4801" class="css-a4x74f"><span>4801</span></td><td id="LC4801" class="css-1dcdqdg"><code>        <span class="code-comment">// Preview thumbnails plugin</span>
</code></td></tr><tr><td id="L4802" class="css-a4x74f"><span>4802</span></td><td id="LC4802" class="css-1dcdqdg"><code>        <span class="code-comment">// <span class="code-doctag">TODO:</span> Really need to work on some sort of plug-in wide event bus or pub-sub for this</span>
</code></td></tr><tr><td id="L4803" class="css-a4x74f"><span>4803</span></td><td id="LC4803" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.progress, <span class="code-string">'mousemove touchmove'</span>, event =&gt; {
</code></td></tr><tr><td id="L4804" class="css-a4x74f"><span>4804</span></td><td id="LC4804" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4805" class="css-a4x74f"><span>4805</span></td><td id="LC4805" class="css-1dcdqdg"><code>            previewThumbnails
</code></td></tr><tr><td id="L4806" class="css-a4x74f"><span>4806</span></td><td id="LC4806" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L4807" class="css-a4x74f"><span>4807</span></td><td id="LC4807" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {
</code></td></tr><tr><td id="L4808" class="css-a4x74f"><span>4808</span></td><td id="LC4808" class="css-1dcdqdg"><code>            previewThumbnails.startMove(event);
</code></td></tr><tr><td id="L4809" class="css-a4x74f"><span>4809</span></td><td id="LC4809" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4810" class="css-a4x74f"><span>4810</span></td><td id="LC4810" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4811" class="css-a4x74f"><span>4811</span></td><td id="LC4811" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4812" class="css-a4x74f"><span>4812</span></td><td id="LC4812" class="css-1dcdqdg"><code>        <span class="code-comment">// Hide thumbnail preview - on mouse click, mouse leave, and video play/seek. All four are required, e.g., for buffering</span>
</code></td></tr><tr><td id="L4813" class="css-a4x74f"><span>4813</span></td><td id="LC4813" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.progress, <span class="code-string">'mouseleave touchend click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4814" class="css-a4x74f"><span>4814</span></td><td id="LC4814" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4815" class="css-a4x74f"><span>4815</span></td><td id="LC4815" class="css-1dcdqdg"><code>            previewThumbnails
</code></td></tr><tr><td id="L4816" class="css-a4x74f"><span>4816</span></td><td id="LC4816" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L4817" class="css-a4x74f"><span>4817</span></td><td id="LC4817" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {
</code></td></tr><tr><td id="L4818" class="css-a4x74f"><span>4818</span></td><td id="LC4818" class="css-1dcdqdg"><code>            previewThumbnails.endMove(<span class="code-literal">false</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4819" class="css-a4x74f"><span>4819</span></td><td id="LC4819" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4820" class="css-a4x74f"><span>4820</span></td><td id="LC4820" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4821" class="css-a4x74f"><span>4821</span></td><td id="LC4821" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4822" class="css-a4x74f"><span>4822</span></td><td id="LC4822" class="css-1dcdqdg"><code>        <span class="code-comment">// Show scrubbing preview</span>
</code></td></tr><tr><td id="L4823" class="css-a4x74f"><span>4823</span></td><td id="LC4823" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.progress, <span class="code-string">'mousedown touchstart'</span>, event =&gt; {
</code></td></tr><tr><td id="L4824" class="css-a4x74f"><span>4824</span></td><td id="LC4824" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4825" class="css-a4x74f"><span>4825</span></td><td id="LC4825" class="css-1dcdqdg"><code>            previewThumbnails
</code></td></tr><tr><td id="L4826" class="css-a4x74f"><span>4826</span></td><td id="LC4826" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L4827" class="css-a4x74f"><span>4827</span></td><td id="LC4827" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {
</code></td></tr><tr><td id="L4828" class="css-a4x74f"><span>4828</span></td><td id="LC4828" class="css-1dcdqdg"><code>            previewThumbnails.startScrubbing(event);
</code></td></tr><tr><td id="L4829" class="css-a4x74f"><span>4829</span></td><td id="LC4829" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4830" class="css-a4x74f"><span>4830</span></td><td id="LC4830" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4831" class="css-a4x74f"><span>4831</span></td><td id="LC4831" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.progress, <span class="code-string">'mouseup touchend'</span>, event =&gt; {
</code></td></tr><tr><td id="L4832" class="css-a4x74f"><span>4832</span></td><td id="LC4832" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4833" class="css-a4x74f"><span>4833</span></td><td id="LC4833" class="css-1dcdqdg"><code>            previewThumbnails
</code></td></tr><tr><td id="L4834" class="css-a4x74f"><span>4834</span></td><td id="LC4834" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L4835" class="css-a4x74f"><span>4835</span></td><td id="LC4835" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (previewThumbnails &amp;&amp; previewThumbnails.loaded) {
</code></td></tr><tr><td id="L4836" class="css-a4x74f"><span>4836</span></td><td id="LC4836" class="css-1dcdqdg"><code>            previewThumbnails.endScrubbing(event);
</code></td></tr><tr><td id="L4837" class="css-a4x74f"><span>4837</span></td><td id="LC4837" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4838" class="css-a4x74f"><span>4838</span></td><td id="LC4838" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4839" class="css-a4x74f"><span>4839</span></td><td id="LC4839" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4840" class="css-a4x74f"><span>4840</span></td><td id="LC4840" class="css-1dcdqdg"><code>        <span class="code-comment">// Polyfill for lower fill in &lt;input type="range"&gt; for webkit</span>
</code></td></tr><tr><td id="L4841" class="css-a4x74f"><span>4841</span></td><td id="LC4841" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (browser.isWebKit) {
</code></td></tr><tr><td id="L4842" class="css-a4x74f"><span>4842</span></td><td id="LC4842" class="css-1dcdqdg"><code>          <span class="code-built_in">Array</span>.from(getElements.call(player, <span class="code-string">'input[type="range"]'</span>)).forEach(<span class="code-function"><span class="code-params">element</span> =&gt;</span> {
</code></td></tr><tr><td id="L4843" class="css-a4x74f"><span>4843</span></td><td id="LC4843" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.bind(element, <span class="code-string">'input'</span>, event =&gt; controls.updateRangeFill.call(player, event.target));
</code></td></tr><tr><td id="L4844" class="css-a4x74f"><span>4844</span></td><td id="LC4844" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4845" class="css-a4x74f"><span>4845</span></td><td id="LC4845" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4846" class="css-a4x74f"><span>4846</span></td><td id="LC4846" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4847" class="css-a4x74f"><span>4847</span></td><td id="LC4847" class="css-1dcdqdg"><code>        <span class="code-comment">// Current time invert</span>
</code></td></tr><tr><td id="L4848" class="css-a4x74f"><span>4848</span></td><td id="LC4848" class="css-1dcdqdg"><code>        <span class="code-comment">// Only if one time element is used for both currentTime and duration</span>
</code></td></tr><tr><td id="L4849" class="css-a4x74f"><span>4849</span></td><td id="LC4849" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (player.config.toggleInvert &amp;&amp; !is.element(elements.display.duration)) {
</code></td></tr><tr><td id="L4850" class="css-a4x74f"><span>4850</span></td><td id="LC4850" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.bind(elements.display.currentTime, <span class="code-string">'click'</span>, () =&gt; {
</code></td></tr><tr><td id="L4851" class="css-a4x74f"><span>4851</span></td><td id="LC4851" class="css-1dcdqdg"><code>            <span class="code-comment">// Do nothing if we're at the start</span>
</code></td></tr><tr><td id="L4852" class="css-a4x74f"><span>4852</span></td><td id="LC4852" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (player.currentTime === <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L4853" class="css-a4x74f"><span>4853</span></td><td id="LC4853" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4854" class="css-a4x74f"><span>4854</span></td><td id="LC4854" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L4855" class="css-a4x74f"><span>4855</span></td><td id="LC4855" class="css-1dcdqdg"><code>            player.config.invertTime = !player.config.invertTime;
</code></td></tr><tr><td id="L4856" class="css-a4x74f"><span>4856</span></td><td id="LC4856" class="css-1dcdqdg"><code>            controls.timeUpdate.call(player);
</code></td></tr><tr><td id="L4857" class="css-a4x74f"><span>4857</span></td><td id="LC4857" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4858" class="css-a4x74f"><span>4858</span></td><td id="LC4858" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4859" class="css-a4x74f"><span>4859</span></td><td id="LC4859" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4860" class="css-a4x74f"><span>4860</span></td><td id="LC4860" class="css-1dcdqdg"><code>        <span class="code-comment">// Volume</span>
</code></td></tr><tr><td id="L4861" class="css-a4x74f"><span>4861</span></td><td id="LC4861" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.inputs.volume, inputEvent, event =&gt; {
</code></td></tr><tr><td id="L4862" class="css-a4x74f"><span>4862</span></td><td id="LC4862" class="css-1dcdqdg"><code>          player.volume = event.target.value;
</code></td></tr><tr><td id="L4863" class="css-a4x74f"><span>4863</span></td><td id="LC4863" class="css-1dcdqdg"><code>        }, <span class="code-string">'volume'</span>);
</code></td></tr><tr><td id="L4864" class="css-a4x74f"><span>4864</span></td><td id="LC4864" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4865" class="css-a4x74f"><span>4865</span></td><td id="LC4865" class="css-1dcdqdg"><code>        <span class="code-comment">// Update controls.hover state (used for ui.toggleControls to avoid hiding when interacting)</span>
</code></td></tr><tr><td id="L4866" class="css-a4x74f"><span>4866</span></td><td id="LC4866" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.controls, <span class="code-string">'mouseenter mouseleave'</span>, event =&gt; {
</code></td></tr><tr><td id="L4867" class="css-a4x74f"><span>4867</span></td><td id="LC4867" class="css-1dcdqdg"><code>          elements.controls.hover = !player.touch &amp;&amp; event.type === <span class="code-string">'mouseenter'</span>;
</code></td></tr><tr><td id="L4868" class="css-a4x74f"><span>4868</span></td><td id="LC4868" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4869" class="css-a4x74f"><span>4869</span></td><td id="LC4869" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4870" class="css-a4x74f"><span>4870</span></td><td id="LC4870" class="css-1dcdqdg"><code>        <span class="code-comment">// Also update controls.hover state for any non-player children of fullscreen element (as above)</span>
</code></td></tr><tr><td id="L4871" class="css-a4x74f"><span>4871</span></td><td id="LC4871" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (elements.fullscreen) {
</code></td></tr><tr><td id="L4872" class="css-a4x74f"><span>4872</span></td><td id="LC4872" class="css-1dcdqdg"><code>          <span class="code-built_in">Array</span>.from(elements.fullscreen.children).filter(<span class="code-function"><span class="code-params">c</span> =&gt;</span> !c.contains(elements.container)).forEach(<span class="code-function"><span class="code-params">child</span> =&gt;</span> {
</code></td></tr><tr><td id="L4873" class="css-a4x74f"><span>4873</span></td><td id="LC4873" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.bind(child, <span class="code-string">'mouseenter mouseleave'</span>, event =&gt; {
</code></td></tr><tr><td id="L4874" class="css-a4x74f"><span>4874</span></td><td id="LC4874" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (elements.controls) {
</code></td></tr><tr><td id="L4875" class="css-a4x74f"><span>4875</span></td><td id="LC4875" class="css-1dcdqdg"><code>                elements.controls.hover = !player.touch &amp;&amp; event.type === <span class="code-string">'mouseenter'</span>;
</code></td></tr><tr><td id="L4876" class="css-a4x74f"><span>4876</span></td><td id="LC4876" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L4877" class="css-a4x74f"><span>4877</span></td><td id="LC4877" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L4878" class="css-a4x74f"><span>4878</span></td><td id="LC4878" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L4879" class="css-a4x74f"><span>4879</span></td><td id="LC4879" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L4880" class="css-a4x74f"><span>4880</span></td><td id="LC4880" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4881" class="css-a4x74f"><span>4881</span></td><td id="LC4881" class="css-1dcdqdg"><code>        <span class="code-comment">// Update controls.pressed state (used for ui.toggleControls to avoid hiding when interacting)</span>
</code></td></tr><tr><td id="L4882" class="css-a4x74f"><span>4882</span></td><td id="LC4882" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.controls, <span class="code-string">'mousedown mouseup touchstart touchend touchcancel'</span>, event =&gt; {
</code></td></tr><tr><td id="L4883" class="css-a4x74f"><span>4883</span></td><td id="LC4883" class="css-1dcdqdg"><code>          elements.controls.pressed = [<span class="code-string">'mousedown'</span>, <span class="code-string">'touchstart'</span>].includes(event.type);
</code></td></tr><tr><td id="L4884" class="css-a4x74f"><span>4884</span></td><td id="LC4884" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4885" class="css-a4x74f"><span>4885</span></td><td id="LC4885" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4886" class="css-a4x74f"><span>4886</span></td><td id="LC4886" class="css-1dcdqdg"><code>        <span class="code-comment">// Show controls when they receive focus (e.g., when using keyboard tab key)</span>
</code></td></tr><tr><td id="L4887" class="css-a4x74f"><span>4887</span></td><td id="LC4887" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.controls, <span class="code-string">'focusin'</span>, () =&gt; {
</code></td></tr><tr><td id="L4888" class="css-a4x74f"><span>4888</span></td><td id="LC4888" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4889" class="css-a4x74f"><span>4889</span></td><td id="LC4889" class="css-1dcdqdg"><code>            config,
</code></td></tr><tr><td id="L4890" class="css-a4x74f"><span>4890</span></td><td id="LC4890" class="css-1dcdqdg"><code>            timers
</code></td></tr><tr><td id="L4891" class="css-a4x74f"><span>4891</span></td><td id="LC4891" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L4892" class="css-a4x74f"><span>4892</span></td><td id="LC4892" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4893" class="css-a4x74f"><span>4893</span></td><td id="LC4893" class="css-1dcdqdg"><code>          <span class="code-comment">// Skip transition to prevent focus from scrolling the parent element</span>
</code></td></tr><tr><td id="L4894" class="css-a4x74f"><span>4894</span></td><td id="LC4894" class="css-1dcdqdg"><code>          toggleClass(elements.controls, config.classNames.noTransition, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4895" class="css-a4x74f"><span>4895</span></td><td id="LC4895" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4896" class="css-a4x74f"><span>4896</span></td><td id="LC4896" class="css-1dcdqdg"><code>          <span class="code-comment">// Toggle</span>
</code></td></tr><tr><td id="L4897" class="css-a4x74f"><span>4897</span></td><td id="LC4897" class="css-1dcdqdg"><code>          ui.toggleControls.call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L4898" class="css-a4x74f"><span>4898</span></td><td id="LC4898" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4899" class="css-a4x74f"><span>4899</span></td><td id="LC4899" class="css-1dcdqdg"><code>          <span class="code-comment">// Restore transition</span>
</code></td></tr><tr><td id="L4900" class="css-a4x74f"><span>4900</span></td><td id="LC4900" class="css-1dcdqdg"><code>          setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L4901" class="css-a4x74f"><span>4901</span></td><td id="LC4901" class="css-1dcdqdg"><code>            toggleClass(elements.controls, config.classNames.noTransition, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4902" class="css-a4x74f"><span>4902</span></td><td id="LC4902" class="css-1dcdqdg"><code>          }, <span class="code-number">0</span>);
</code></td></tr><tr><td id="L4903" class="css-a4x74f"><span>4903</span></td><td id="LC4903" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4904" class="css-a4x74f"><span>4904</span></td><td id="LC4904" class="css-1dcdqdg"><code>          <span class="code-comment">// Delay a little more for mouse users</span>
</code></td></tr><tr><td id="L4905" class="css-a4x74f"><span>4905</span></td><td id="LC4905" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> delay = <span class="code-keyword">this</span>.touch ? <span class="code-number">3000</span> : <span class="code-number">4000</span>;
</code></td></tr><tr><td id="L4906" class="css-a4x74f"><span>4906</span></td><td id="LC4906" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4907" class="css-a4x74f"><span>4907</span></td><td id="LC4907" class="css-1dcdqdg"><code>          <span class="code-comment">// Clear timer</span>
</code></td></tr><tr><td id="L4908" class="css-a4x74f"><span>4908</span></td><td id="LC4908" class="css-1dcdqdg"><code>          clearTimeout(timers.controls);
</code></td></tr><tr><td id="L4909" class="css-a4x74f"><span>4909</span></td><td id="LC4909" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4910" class="css-a4x74f"><span>4910</span></td><td id="LC4910" class="css-1dcdqdg"><code>          <span class="code-comment">// Hide again after delay</span>
</code></td></tr><tr><td id="L4911" class="css-a4x74f"><span>4911</span></td><td id="LC4911" class="css-1dcdqdg"><code>          timers.controls = setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> ui.toggleControls.call(player, <span class="code-literal">false</span>), delay);
</code></td></tr><tr><td id="L4912" class="css-a4x74f"><span>4912</span></td><td id="LC4912" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L4913" class="css-a4x74f"><span>4913</span></td><td id="LC4913" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4914" class="css-a4x74f"><span>4914</span></td><td id="LC4914" class="css-1dcdqdg"><code>        <span class="code-comment">// Mouse wheel for volume</span>
</code></td></tr><tr><td id="L4915" class="css-a4x74f"><span>4915</span></td><td id="LC4915" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.bind(elements.inputs.volume, <span class="code-string">'wheel'</span>, event =&gt; {
</code></td></tr><tr><td id="L4916" class="css-a4x74f"><span>4916</span></td><td id="LC4916" class="css-1dcdqdg"><code>          <span class="code-comment">// Detect "natural" scroll - supported on OS X Safari only</span>
</code></td></tr><tr><td id="L4917" class="css-a4x74f"><span>4917</span></td><td id="LC4917" class="css-1dcdqdg"><code>          <span class="code-comment">// Other browsers on OS X will be inverted until support improves</span>
</code></td></tr><tr><td id="L4918" class="css-a4x74f"><span>4918</span></td><td id="LC4918" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> inverted = event.webkitDirectionInvertedFromDevice;
</code></td></tr><tr><td id="L4919" class="css-a4x74f"><span>4919</span></td><td id="LC4919" class="css-1dcdqdg"><code>          <span class="code-comment">// Get delta from event. Invert if `inverted` is true</span>
</code></td></tr><tr><td id="L4920" class="css-a4x74f"><span>4920</span></td><td id="LC4920" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> [x, y] = [event.deltaX, -event.deltaY].map(<span class="code-function"><span class="code-params">value</span> =&gt;</span> inverted ? -value : value);
</code></td></tr><tr><td id="L4921" class="css-a4x74f"><span>4921</span></td><td id="LC4921" class="css-1dcdqdg"><code>          <span class="code-comment">// Using the biggest delta, normalize to 1 or -1 (or 0 if no delta)</span>
</code></td></tr><tr><td id="L4922" class="css-a4x74f"><span>4922</span></td><td id="LC4922" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> direction = <span class="code-built_in">Math</span>.sign(<span class="code-built_in">Math</span>.abs(x) &gt; <span class="code-built_in">Math</span>.abs(y) ? x : y);
</code></td></tr><tr><td id="L4923" class="css-a4x74f"><span>4923</span></td><td id="LC4923" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4924" class="css-a4x74f"><span>4924</span></td><td id="LC4924" class="css-1dcdqdg"><code>          <span class="code-comment">// Change the volume by 2%</span>
</code></td></tr><tr><td id="L4925" class="css-a4x74f"><span>4925</span></td><td id="LC4925" class="css-1dcdqdg"><code>          player.increaseVolume(direction / <span class="code-number">50</span>);
</code></td></tr><tr><td id="L4926" class="css-a4x74f"><span>4926</span></td><td id="LC4926" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4927" class="css-a4x74f"><span>4927</span></td><td id="LC4927" class="css-1dcdqdg"><code>          <span class="code-comment">// Don't break page scrolling at max and min</span>
</code></td></tr><tr><td id="L4928" class="css-a4x74f"><span>4928</span></td><td id="LC4928" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4929" class="css-a4x74f"><span>4929</span></td><td id="LC4929" class="css-1dcdqdg"><code>            volume
</code></td></tr><tr><td id="L4930" class="css-a4x74f"><span>4930</span></td><td id="LC4930" class="css-1dcdqdg"><code>          } = player.media;
</code></td></tr><tr><td id="L4931" class="css-a4x74f"><span>4931</span></td><td id="LC4931" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (direction === <span class="code-number">1</span> &amp;&amp; volume &lt; <span class="code-number">1</span> || direction === <span class="code-number">-1</span> &amp;&amp; volume &gt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L4932" class="css-a4x74f"><span>4932</span></td><td id="LC4932" class="css-1dcdqdg"><code>            event.preventDefault();
</code></td></tr><tr><td id="L4933" class="css-a4x74f"><span>4933</span></td><td id="LC4933" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4934" class="css-a4x74f"><span>4934</span></td><td id="LC4934" class="css-1dcdqdg"><code>        }, <span class="code-string">'volume'</span>, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L4935" class="css-a4x74f"><span>4935</span></td><td id="LC4935" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L4936" class="css-a4x74f"><span>4936</span></td><td id="LC4936" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player = _player;
</code></td></tr><tr><td id="L4937" class="css-a4x74f"><span>4937</span></td><td id="LC4937" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.lastKey = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4938" class="css-a4x74f"><span>4938</span></td><td id="LC4938" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.focusTimer = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4939" class="css-a4x74f"><span>4939</span></td><td id="LC4939" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.lastKeyDown = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L4940" class="css-a4x74f"><span>4940</span></td><td id="LC4940" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.handleKey = <span class="code-keyword">this</span>.handleKey.bind(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4941" class="css-a4x74f"><span>4941</span></td><td id="LC4941" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.toggleMenu = <span class="code-keyword">this</span>.toggleMenu.bind(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4942" class="css-a4x74f"><span>4942</span></td><td id="LC4942" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.firstTouch = <span class="code-keyword">this</span>.firstTouch.bind(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L4943" class="css-a4x74f"><span>4943</span></td><td id="LC4943" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L4944" class="css-a4x74f"><span>4944</span></td><td id="LC4944" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4945" class="css-a4x74f"><span>4945</span></td><td id="LC4945" class="css-1dcdqdg"><code>    <span class="code-comment">// Handle key presses</span>
</code></td></tr><tr><td id="L4946" class="css-a4x74f"><span>4946</span></td><td id="LC4946" class="css-1dcdqdg"><code>    handleKey(event) {
</code></td></tr><tr><td id="L4947" class="css-a4x74f"><span>4947</span></td><td id="LC4947" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4948" class="css-a4x74f"><span>4948</span></td><td id="LC4948" class="css-1dcdqdg"><code>        player
</code></td></tr><tr><td id="L4949" class="css-a4x74f"><span>4949</span></td><td id="LC4949" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L4950" class="css-a4x74f"><span>4950</span></td><td id="LC4950" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4951" class="css-a4x74f"><span>4951</span></td><td id="LC4951" class="css-1dcdqdg"><code>        elements
</code></td></tr><tr><td id="L4952" class="css-a4x74f"><span>4952</span></td><td id="LC4952" class="css-1dcdqdg"><code>      } = player;
</code></td></tr><tr><td id="L4953" class="css-a4x74f"><span>4953</span></td><td id="LC4953" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4954" class="css-a4x74f"><span>4954</span></td><td id="LC4954" class="css-1dcdqdg"><code>        key,
</code></td></tr><tr><td id="L4955" class="css-a4x74f"><span>4955</span></td><td id="LC4955" class="css-1dcdqdg"><code>        type,
</code></td></tr><tr><td id="L4956" class="css-a4x74f"><span>4956</span></td><td id="LC4956" class="css-1dcdqdg"><code>        altKey,
</code></td></tr><tr><td id="L4957" class="css-a4x74f"><span>4957</span></td><td id="LC4957" class="css-1dcdqdg"><code>        ctrlKey,
</code></td></tr><tr><td id="L4958" class="css-a4x74f"><span>4958</span></td><td id="LC4958" class="css-1dcdqdg"><code>        metaKey,
</code></td></tr><tr><td id="L4959" class="css-a4x74f"><span>4959</span></td><td id="LC4959" class="css-1dcdqdg"><code>        shiftKey
</code></td></tr><tr><td id="L4960" class="css-a4x74f"><span>4960</span></td><td id="LC4960" class="css-1dcdqdg"><code>      } = event;
</code></td></tr><tr><td id="L4961" class="css-a4x74f"><span>4961</span></td><td id="LC4961" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> pressed = type === <span class="code-string">'keydown'</span>;
</code></td></tr><tr><td id="L4962" class="css-a4x74f"><span>4962</span></td><td id="LC4962" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> repeat = pressed &amp;&amp; key === <span class="code-keyword">this</span>.lastKey;
</code></td></tr><tr><td id="L4963" class="css-a4x74f"><span>4963</span></td><td id="LC4963" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4964" class="css-a4x74f"><span>4964</span></td><td id="LC4964" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if a modifier key is set</span>
</code></td></tr><tr><td id="L4965" class="css-a4x74f"><span>4965</span></td><td id="LC4965" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (altKey || ctrlKey || metaKey || shiftKey) {
</code></td></tr><tr><td id="L4966" class="css-a4x74f"><span>4966</span></td><td id="LC4966" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4967" class="css-a4x74f"><span>4967</span></td><td id="LC4967" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4968" class="css-a4x74f"><span>4968</span></td><td id="LC4968" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4969" class="css-a4x74f"><span>4969</span></td><td id="LC4969" class="css-1dcdqdg"><code>      <span class="code-comment">// If the event is bubbled from the media element</span>
</code></td></tr><tr><td id="L4970" class="css-a4x74f"><span>4970</span></td><td id="LC4970" class="css-1dcdqdg"><code>      <span class="code-comment">// Firefox doesn't get the key for whatever reason</span>
</code></td></tr><tr><td id="L4971" class="css-a4x74f"><span>4971</span></td><td id="LC4971" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!key) {
</code></td></tr><tr><td id="L4972" class="css-a4x74f"><span>4972</span></td><td id="LC4972" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4973" class="css-a4x74f"><span>4973</span></td><td id="LC4973" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L4974" class="css-a4x74f"><span>4974</span></td><td id="LC4974" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4975" class="css-a4x74f"><span>4975</span></td><td id="LC4975" class="css-1dcdqdg"><code>      <span class="code-comment">// Seek by increment</span>
</code></td></tr><tr><td id="L4976" class="css-a4x74f"><span>4976</span></td><td id="LC4976" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> seekByIncrement = <span class="code-function"><span class="code-params">increment</span> =&gt;</span> {
</code></td></tr><tr><td id="L4977" class="css-a4x74f"><span>4977</span></td><td id="LC4977" class="css-1dcdqdg"><code>        <span class="code-comment">// Divide the max duration into 10th's and times by the number value</span>
</code></td></tr><tr><td id="L4978" class="css-a4x74f"><span>4978</span></td><td id="LC4978" class="css-1dcdqdg"><code>        player.currentTime = player.duration / <span class="code-number">10</span> * increment;
</code></td></tr><tr><td id="L4979" class="css-a4x74f"><span>4979</span></td><td id="LC4979" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L4980" class="css-a4x74f"><span>4980</span></td><td id="LC4980" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L4981" class="css-a4x74f"><span>4981</span></td><td id="LC4981" class="css-1dcdqdg"><code>      <span class="code-comment">// Handle the key on keydown</span>
</code></td></tr><tr><td id="L4982" class="css-a4x74f"><span>4982</span></td><td id="LC4982" class="css-1dcdqdg"><code>      <span class="code-comment">// Reset on keyup</span>
</code></td></tr><tr><td id="L4983" class="css-a4x74f"><span>4983</span></td><td id="LC4983" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (pressed) {
</code></td></tr><tr><td id="L4984" class="css-a4x74f"><span>4984</span></td><td id="LC4984" class="css-1dcdqdg"><code>        <span class="code-comment">// Check focused element</span>
</code></td></tr><tr><td id="L4985" class="css-a4x74f"><span>4985</span></td><td id="LC4985" class="css-1dcdqdg"><code>        <span class="code-comment">// and if the focused element is not editable (e.g. text input)</span>
</code></td></tr><tr><td id="L4986" class="css-a4x74f"><span>4986</span></td><td id="LC4986" class="css-1dcdqdg"><code>        <span class="code-comment">// and any that accept key input http://webaim.org/techniques/keyboard/</span>
</code></td></tr><tr><td id="L4987" class="css-a4x74f"><span>4987</span></td><td id="LC4987" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> focused = <span class="code-built_in">document</span>.activeElement;
</code></td></tr><tr><td id="L4988" class="css-a4x74f"><span>4988</span></td><td id="LC4988" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(focused)) {
</code></td></tr><tr><td id="L4989" class="css-a4x74f"><span>4989</span></td><td id="LC4989" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4990" class="css-a4x74f"><span>4990</span></td><td id="LC4990" class="css-1dcdqdg"><code>            editable
</code></td></tr><tr><td id="L4991" class="css-a4x74f"><span>4991</span></td><td id="LC4991" class="css-1dcdqdg"><code>          } = player.config.selectors;
</code></td></tr><tr><td id="L4992" class="css-a4x74f"><span>4992</span></td><td id="LC4992" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L4993" class="css-a4x74f"><span>4993</span></td><td id="LC4993" class="css-1dcdqdg"><code>            seek
</code></td></tr><tr><td id="L4994" class="css-a4x74f"><span>4994</span></td><td id="LC4994" class="css-1dcdqdg"><code>          } = elements.inputs;
</code></td></tr><tr><td id="L4995" class="css-a4x74f"><span>4995</span></td><td id="LC4995" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (focused !== seek &amp;&amp; matches(focused, editable)) {
</code></td></tr><tr><td id="L4996" class="css-a4x74f"><span>4996</span></td><td id="LC4996" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L4997" class="css-a4x74f"><span>4997</span></td><td id="LC4997" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L4998" class="css-a4x74f"><span>4998</span></td><td id="LC4998" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (event.key === <span class="code-string">' '</span> &amp;&amp; matches(focused, <span class="code-string">'button, [role^="menuitem"]'</span>)) {
</code></td></tr><tr><td id="L4999" class="css-a4x74f"><span>4999</span></td><td id="LC4999" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5000" class="css-a4x74f"><span>5000</span></td><td id="LC5000" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5001" class="css-a4x74f"><span>5001</span></td><td id="LC5001" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5002" class="css-a4x74f"><span>5002</span></td><td id="LC5002" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5003" class="css-a4x74f"><span>5003</span></td><td id="LC5003" class="css-1dcdqdg"><code>        <span class="code-comment">// Which keys should we prevent default</span>
</code></td></tr><tr><td id="L5004" class="css-a4x74f"><span>5004</span></td><td id="LC5004" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> preventDefault = [<span class="code-string">' '</span>, <span class="code-string">'ArrowLeft'</span>, <span class="code-string">'ArrowUp'</span>, <span class="code-string">'ArrowRight'</span>, <span class="code-string">'ArrowDown'</span>, <span class="code-string">'0'</span>, <span class="code-string">'1'</span>, <span class="code-string">'2'</span>, <span class="code-string">'3'</span>, <span class="code-string">'4'</span>, <span class="code-string">'5'</span>, <span class="code-string">'6'</span>, <span class="code-string">'7'</span>, <span class="code-string">'8'</span>, <span class="code-string">'9'</span>, <span class="code-string">'c'</span>, <span class="code-string">'f'</span>, <span class="code-string">'k'</span>, <span class="code-string">'l'</span>, <span class="code-string">'m'</span>];
</code></td></tr><tr><td id="L5005" class="css-a4x74f"><span>5005</span></td><td id="LC5005" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5006" class="css-a4x74f"><span>5006</span></td><td id="LC5006" class="css-1dcdqdg"><code>        <span class="code-comment">// If the key is found prevent default (e.g. prevent scrolling for arrows)</span>
</code></td></tr><tr><td id="L5007" class="css-a4x74f"><span>5007</span></td><td id="LC5007" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (preventDefault.includes(key)) {
</code></td></tr><tr><td id="L5008" class="css-a4x74f"><span>5008</span></td><td id="LC5008" class="css-1dcdqdg"><code>          event.preventDefault();
</code></td></tr><tr><td id="L5009" class="css-a4x74f"><span>5009</span></td><td id="LC5009" class="css-1dcdqdg"><code>          event.stopPropagation();
</code></td></tr><tr><td id="L5010" class="css-a4x74f"><span>5010</span></td><td id="LC5010" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5011" class="css-a4x74f"><span>5011</span></td><td id="LC5011" class="css-1dcdqdg"><code>        <span class="code-keyword">switch</span> (key) {
</code></td></tr><tr><td id="L5012" class="css-a4x74f"><span>5012</span></td><td id="LC5012" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'0'</span>:
</code></td></tr><tr><td id="L5013" class="css-a4x74f"><span>5013</span></td><td id="LC5013" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'1'</span>:
</code></td></tr><tr><td id="L5014" class="css-a4x74f"><span>5014</span></td><td id="LC5014" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'2'</span>:
</code></td></tr><tr><td id="L5015" class="css-a4x74f"><span>5015</span></td><td id="LC5015" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'3'</span>:
</code></td></tr><tr><td id="L5016" class="css-a4x74f"><span>5016</span></td><td id="LC5016" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'4'</span>:
</code></td></tr><tr><td id="L5017" class="css-a4x74f"><span>5017</span></td><td id="LC5017" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'5'</span>:
</code></td></tr><tr><td id="L5018" class="css-a4x74f"><span>5018</span></td><td id="LC5018" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'6'</span>:
</code></td></tr><tr><td id="L5019" class="css-a4x74f"><span>5019</span></td><td id="LC5019" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'7'</span>:
</code></td></tr><tr><td id="L5020" class="css-a4x74f"><span>5020</span></td><td id="LC5020" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'8'</span>:
</code></td></tr><tr><td id="L5021" class="css-a4x74f"><span>5021</span></td><td id="LC5021" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'9'</span>:
</code></td></tr><tr><td id="L5022" class="css-a4x74f"><span>5022</span></td><td id="LC5022" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!repeat) {
</code></td></tr><tr><td id="L5023" class="css-a4x74f"><span>5023</span></td><td id="LC5023" class="css-1dcdqdg"><code>              seekByIncrement(<span class="code-built_in">parseInt</span>(key, <span class="code-number">10</span>));
</code></td></tr><tr><td id="L5024" class="css-a4x74f"><span>5024</span></td><td id="LC5024" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5025" class="css-a4x74f"><span>5025</span></td><td id="LC5025" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5026" class="css-a4x74f"><span>5026</span></td><td id="LC5026" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">' '</span>:
</code></td></tr><tr><td id="L5027" class="css-a4x74f"><span>5027</span></td><td id="LC5027" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'k'</span>:
</code></td></tr><tr><td id="L5028" class="css-a4x74f"><span>5028</span></td><td id="LC5028" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!repeat) {
</code></td></tr><tr><td id="L5029" class="css-a4x74f"><span>5029</span></td><td id="LC5029" class="css-1dcdqdg"><code>              silencePromise(player.togglePlay());
</code></td></tr><tr><td id="L5030" class="css-a4x74f"><span>5030</span></td><td id="LC5030" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5031" class="css-a4x74f"><span>5031</span></td><td id="LC5031" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5032" class="css-a4x74f"><span>5032</span></td><td id="LC5032" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'ArrowUp'</span>:
</code></td></tr><tr><td id="L5033" class="css-a4x74f"><span>5033</span></td><td id="LC5033" class="css-1dcdqdg"><code>            player.increaseVolume(<span class="code-number">0.1</span>);
</code></td></tr><tr><td id="L5034" class="css-a4x74f"><span>5034</span></td><td id="LC5034" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5035" class="css-a4x74f"><span>5035</span></td><td id="LC5035" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'ArrowDown'</span>:
</code></td></tr><tr><td id="L5036" class="css-a4x74f"><span>5036</span></td><td id="LC5036" class="css-1dcdqdg"><code>            player.decreaseVolume(<span class="code-number">0.1</span>);
</code></td></tr><tr><td id="L5037" class="css-a4x74f"><span>5037</span></td><td id="LC5037" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5038" class="css-a4x74f"><span>5038</span></td><td id="LC5038" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'m'</span>:
</code></td></tr><tr><td id="L5039" class="css-a4x74f"><span>5039</span></td><td id="LC5039" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!repeat) {
</code></td></tr><tr><td id="L5040" class="css-a4x74f"><span>5040</span></td><td id="LC5040" class="css-1dcdqdg"><code>              player.muted = !player.muted;
</code></td></tr><tr><td id="L5041" class="css-a4x74f"><span>5041</span></td><td id="LC5041" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5042" class="css-a4x74f"><span>5042</span></td><td id="LC5042" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5043" class="css-a4x74f"><span>5043</span></td><td id="LC5043" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'ArrowRight'</span>:
</code></td></tr><tr><td id="L5044" class="css-a4x74f"><span>5044</span></td><td id="LC5044" class="css-1dcdqdg"><code>            player.forward();
</code></td></tr><tr><td id="L5045" class="css-a4x74f"><span>5045</span></td><td id="LC5045" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5046" class="css-a4x74f"><span>5046</span></td><td id="LC5046" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'ArrowLeft'</span>:
</code></td></tr><tr><td id="L5047" class="css-a4x74f"><span>5047</span></td><td id="LC5047" class="css-1dcdqdg"><code>            player.rewind();
</code></td></tr><tr><td id="L5048" class="css-a4x74f"><span>5048</span></td><td id="LC5048" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5049" class="css-a4x74f"><span>5049</span></td><td id="LC5049" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'f'</span>:
</code></td></tr><tr><td id="L5050" class="css-a4x74f"><span>5050</span></td><td id="LC5050" class="css-1dcdqdg"><code>            player.fullscreen.toggle();
</code></td></tr><tr><td id="L5051" class="css-a4x74f"><span>5051</span></td><td id="LC5051" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5052" class="css-a4x74f"><span>5052</span></td><td id="LC5052" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'c'</span>:
</code></td></tr><tr><td id="L5053" class="css-a4x74f"><span>5053</span></td><td id="LC5053" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!repeat) {
</code></td></tr><tr><td id="L5054" class="css-a4x74f"><span>5054</span></td><td id="LC5054" class="css-1dcdqdg"><code>              player.toggleCaptions();
</code></td></tr><tr><td id="L5055" class="css-a4x74f"><span>5055</span></td><td id="LC5055" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5056" class="css-a4x74f"><span>5056</span></td><td id="LC5056" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5057" class="css-a4x74f"><span>5057</span></td><td id="LC5057" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> <span class="code-string">'l'</span>:
</code></td></tr><tr><td id="L5058" class="css-a4x74f"><span>5058</span></td><td id="LC5058" class="css-1dcdqdg"><code>            player.loop = !player.loop;
</code></td></tr><tr><td id="L5059" class="css-a4x74f"><span>5059</span></td><td id="LC5059" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L5060" class="css-a4x74f"><span>5060</span></td><td id="LC5060" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5061" class="css-a4x74f"><span>5061</span></td><td id="LC5061" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5062" class="css-a4x74f"><span>5062</span></td><td id="LC5062" class="css-1dcdqdg"><code>        <span class="code-comment">// Escape is handle natively when in full screen</span>
</code></td></tr><tr><td id="L5063" class="css-a4x74f"><span>5063</span></td><td id="LC5063" class="css-1dcdqdg"><code>        <span class="code-comment">// So we only need to worry about non native</span>
</code></td></tr><tr><td id="L5064" class="css-a4x74f"><span>5064</span></td><td id="LC5064" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (key === <span class="code-string">'Escape'</span> &amp;&amp; !player.fullscreen.usingNative &amp;&amp; player.fullscreen.active) {
</code></td></tr><tr><td id="L5065" class="css-a4x74f"><span>5065</span></td><td id="LC5065" class="css-1dcdqdg"><code>          player.fullscreen.toggle();
</code></td></tr><tr><td id="L5066" class="css-a4x74f"><span>5066</span></td><td id="LC5066" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5067" class="css-a4x74f"><span>5067</span></td><td id="LC5067" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5068" class="css-a4x74f"><span>5068</span></td><td id="LC5068" class="css-1dcdqdg"><code>        <span class="code-comment">// Store last key for next cycle</span>
</code></td></tr><tr><td id="L5069" class="css-a4x74f"><span>5069</span></td><td id="LC5069" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.lastKey = key;
</code></td></tr><tr><td id="L5070" class="css-a4x74f"><span>5070</span></td><td id="LC5070" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5071" class="css-a4x74f"><span>5071</span></td><td id="LC5071" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.lastKey = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L5072" class="css-a4x74f"><span>5072</span></td><td id="LC5072" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5073" class="css-a4x74f"><span>5073</span></td><td id="LC5073" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5074" class="css-a4x74f"><span>5074</span></td><td id="LC5074" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5075" class="css-a4x74f"><span>5075</span></td><td id="LC5075" class="css-1dcdqdg"><code>    <span class="code-comment">// Toggle menu</span>
</code></td></tr><tr><td id="L5076" class="css-a4x74f"><span>5076</span></td><td id="LC5076" class="css-1dcdqdg"><code>    toggleMenu(event) {
</code></td></tr><tr><td id="L5077" class="css-a4x74f"><span>5077</span></td><td id="LC5077" class="css-1dcdqdg"><code>      controls.toggleMenu.call(<span class="code-keyword">this</span>.player, event);
</code></td></tr><tr><td id="L5078" class="css-a4x74f"><span>5078</span></td><td id="LC5078" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5079" class="css-a4x74f"><span>5079</span></td><td id="LC5079" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5080" class="css-a4x74f"><span>5080</span></td><td id="LC5080" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5081" class="css-a4x74f"><span>5081</span></td><td id="LC5081" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> commonjsGlobal = <span class="code-keyword">typeof</span> globalThis !== <span class="code-string">'undefined'</span> ? globalThis : <span class="code-keyword">typeof</span> <span class="code-built_in">window</span> !== <span class="code-string">'undefined'</span> ? <span class="code-built_in">window</span> : <span class="code-keyword">typeof</span> global !== <span class="code-string">'undefined'</span> ? global : <span class="code-keyword">typeof</span> self !== <span class="code-string">'undefined'</span> ? self : {};
</code></td></tr><tr><td id="L5082" class="css-a4x74f"><span>5082</span></td><td id="LC5082" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5083" class="css-a4x74f"><span>5083</span></td><td id="LC5083" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">createCommonjsModule</span>(<span class="code-params">fn, module</span>) </span>{
</code></td></tr><tr><td id="L5084" class="css-a4x74f"><span>5084</span></td><td id="LC5084" class="css-1dcdqdg"><code>  	<span class="code-keyword">return</span> <span class="code-built_in">module</span> = { <span class="code-attr">exports</span>: {} }, fn(<span class="code-built_in">module</span>, <span class="code-built_in">module</span>.exports), <span class="code-built_in">module</span>.exports;
</code></td></tr><tr><td id="L5085" class="css-a4x74f"><span>5085</span></td><td id="LC5085" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5086" class="css-a4x74f"><span>5086</span></td><td id="LC5086" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5087" class="css-a4x74f"><span>5087</span></td><td id="LC5087" class="css-1dcdqdg"><code>  <span class="code-keyword">var</span> loadjs_umd = createCommonjsModule(<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">module, exports</span>) </span>{
</code></td></tr><tr><td id="L5088" class="css-a4x74f"><span>5088</span></td><td id="LC5088" class="css-1dcdqdg"><code>    (<span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">root, factory</span>) </span>{
</code></td></tr><tr><td id="L5089" class="css-a4x74f"><span>5089</span></td><td id="LC5089" class="css-1dcdqdg"><code>      {
</code></td></tr><tr><td id="L5090" class="css-a4x74f"><span>5090</span></td><td id="LC5090" class="css-1dcdqdg"><code>        <span class="code-built_in">module</span>.exports = factory();
</code></td></tr><tr><td id="L5091" class="css-a4x74f"><span>5091</span></td><td id="LC5091" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5092" class="css-a4x74f"><span>5092</span></td><td id="LC5092" class="css-1dcdqdg"><code>    })(commonjsGlobal, <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L5093" class="css-a4x74f"><span>5093</span></td><td id="LC5093" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5094" class="css-a4x74f"><span>5094</span></td><td id="LC5094" class="css-1dcdqdg"><code><span class="code-comment">       * Global dependencies.
</span></code></td></tr><tr><td id="L5095" class="css-a4x74f"><span>5095</span></td><td id="LC5095" class="css-1dcdqdg"><code><span class="code-comment">       * @global {Object} document - DOM
</span></code></td></tr><tr><td id="L5096" class="css-a4x74f"><span>5096</span></td><td id="LC5096" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5097" class="css-a4x74f"><span>5097</span></td><td id="LC5097" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5098" class="css-a4x74f"><span>5098</span></td><td id="LC5098" class="css-1dcdqdg"><code>      <span class="code-keyword">var</span> devnull = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params"></span>) </span>{},
</code></td></tr><tr><td id="L5099" class="css-a4x74f"><span>5099</span></td><td id="LC5099" class="css-1dcdqdg"><code>        bundleIdCache = {},
</code></td></tr><tr><td id="L5100" class="css-a4x74f"><span>5100</span></td><td id="LC5100" class="css-1dcdqdg"><code>        bundleResultCache = {},
</code></td></tr><tr><td id="L5101" class="css-a4x74f"><span>5101</span></td><td id="LC5101" class="css-1dcdqdg"><code>        bundleCallbackQueue = {};
</code></td></tr><tr><td id="L5102" class="css-a4x74f"><span>5102</span></td><td id="LC5102" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5103" class="css-a4x74f"><span>5103</span></td><td id="LC5103" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5104" class="css-a4x74f"><span>5104</span></td><td id="LC5104" class="css-1dcdqdg"><code><span class="code-comment">       * Subscribe to bundle load event.
</span></code></td></tr><tr><td id="L5105" class="css-a4x74f"><span>5105</span></td><td id="LC5105" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string[]} bundleIds - Bundle ids
</span></code></td></tr><tr><td id="L5106" class="css-a4x74f"><span>5106</span></td><td id="LC5106" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callbackFn - The callback function
</span></code></td></tr><tr><td id="L5107" class="css-a4x74f"><span>5107</span></td><td id="LC5107" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5108" class="css-a4x74f"><span>5108</span></td><td id="LC5108" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">subscribe</span>(<span class="code-params">bundleIds, callbackFn</span>) </span>{
</code></td></tr><tr><td id="L5109" class="css-a4x74f"><span>5109</span></td><td id="LC5109" class="css-1dcdqdg"><code>        <span class="code-comment">// listify</span>
</code></td></tr><tr><td id="L5110" class="css-a4x74f"><span>5110</span></td><td id="LC5110" class="css-1dcdqdg"><code>        bundleIds = bundleIds.push ? bundleIds : [bundleIds];
</code></td></tr><tr><td id="L5111" class="css-a4x74f"><span>5111</span></td><td id="LC5111" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> depsNotFound = [],
</code></td></tr><tr><td id="L5112" class="css-a4x74f"><span>5112</span></td><td id="LC5112" class="css-1dcdqdg"><code>          i = bundleIds.length,
</code></td></tr><tr><td id="L5113" class="css-a4x74f"><span>5113</span></td><td id="LC5113" class="css-1dcdqdg"><code>          numWaiting = i,
</code></td></tr><tr><td id="L5114" class="css-a4x74f"><span>5114</span></td><td id="LC5114" class="css-1dcdqdg"><code>          fn,
</code></td></tr><tr><td id="L5115" class="css-a4x74f"><span>5115</span></td><td id="LC5115" class="css-1dcdqdg"><code>          bundleId,
</code></td></tr><tr><td id="L5116" class="css-a4x74f"><span>5116</span></td><td id="LC5116" class="css-1dcdqdg"><code>          r,
</code></td></tr><tr><td id="L5117" class="css-a4x74f"><span>5117</span></td><td id="LC5117" class="css-1dcdqdg"><code>          q;
</code></td></tr><tr><td id="L5118" class="css-a4x74f"><span>5118</span></td><td id="LC5118" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5119" class="css-a4x74f"><span>5119</span></td><td id="LC5119" class="css-1dcdqdg"><code>        <span class="code-comment">// define callback function</span>
</code></td></tr><tr><td id="L5120" class="css-a4x74f"><span>5120</span></td><td id="LC5120" class="css-1dcdqdg"><code>        fn = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">bundleId, pathsNotFound</span>) </span>{
</code></td></tr><tr><td id="L5121" class="css-a4x74f"><span>5121</span></td><td id="LC5121" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (pathsNotFound.length) depsNotFound.push(bundleId);
</code></td></tr><tr><td id="L5122" class="css-a4x74f"><span>5122</span></td><td id="LC5122" class="css-1dcdqdg"><code>          numWaiting--;
</code></td></tr><tr><td id="L5123" class="css-a4x74f"><span>5123</span></td><td id="LC5123" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!numWaiting) callbackFn(depsNotFound);
</code></td></tr><tr><td id="L5124" class="css-a4x74f"><span>5124</span></td><td id="LC5124" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L5125" class="css-a4x74f"><span>5125</span></td><td id="LC5125" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5126" class="css-a4x74f"><span>5126</span></td><td id="LC5126" class="css-1dcdqdg"><code>        <span class="code-comment">// register callback</span>
</code></td></tr><tr><td id="L5127" class="css-a4x74f"><span>5127</span></td><td id="LC5127" class="css-1dcdqdg"><code>        <span class="code-keyword">while</span> (i--) {
</code></td></tr><tr><td id="L5128" class="css-a4x74f"><span>5128</span></td><td id="LC5128" class="css-1dcdqdg"><code>          bundleId = bundleIds[i];
</code></td></tr><tr><td id="L5129" class="css-a4x74f"><span>5129</span></td><td id="LC5129" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5130" class="css-a4x74f"><span>5130</span></td><td id="LC5130" class="css-1dcdqdg"><code>          <span class="code-comment">// execute callback if in result cache</span>
</code></td></tr><tr><td id="L5131" class="css-a4x74f"><span>5131</span></td><td id="LC5131" class="css-1dcdqdg"><code>          r = bundleResultCache[bundleId];
</code></td></tr><tr><td id="L5132" class="css-a4x74f"><span>5132</span></td><td id="LC5132" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (r) {
</code></td></tr><tr><td id="L5133" class="css-a4x74f"><span>5133</span></td><td id="LC5133" class="css-1dcdqdg"><code>            fn(bundleId, r);
</code></td></tr><tr><td id="L5134" class="css-a4x74f"><span>5134</span></td><td id="LC5134" class="css-1dcdqdg"><code>            <span class="code-keyword">continue</span>;
</code></td></tr><tr><td id="L5135" class="css-a4x74f"><span>5135</span></td><td id="LC5135" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5136" class="css-a4x74f"><span>5136</span></td><td id="LC5136" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5137" class="css-a4x74f"><span>5137</span></td><td id="LC5137" class="css-1dcdqdg"><code>          <span class="code-comment">// add to callback queue</span>
</code></td></tr><tr><td id="L5138" class="css-a4x74f"><span>5138</span></td><td id="LC5138" class="css-1dcdqdg"><code>          q = bundleCallbackQueue[bundleId] = bundleCallbackQueue[bundleId] || [];
</code></td></tr><tr><td id="L5139" class="css-a4x74f"><span>5139</span></td><td id="LC5139" class="css-1dcdqdg"><code>          q.push(fn);
</code></td></tr><tr><td id="L5140" class="css-a4x74f"><span>5140</span></td><td id="LC5140" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5141" class="css-a4x74f"><span>5141</span></td><td id="LC5141" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5142" class="css-a4x74f"><span>5142</span></td><td id="LC5142" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5143" class="css-a4x74f"><span>5143</span></td><td id="LC5143" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5144" class="css-a4x74f"><span>5144</span></td><td id="LC5144" class="css-1dcdqdg"><code><span class="code-comment">       * Publish bundle load event.
</span></code></td></tr><tr><td id="L5145" class="css-a4x74f"><span>5145</span></td><td id="LC5145" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string} bundleId - Bundle id
</span></code></td></tr><tr><td id="L5146" class="css-a4x74f"><span>5146</span></td><td id="LC5146" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string[]} pathsNotFound - List of files not found
</span></code></td></tr><tr><td id="L5147" class="css-a4x74f"><span>5147</span></td><td id="LC5147" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5148" class="css-a4x74f"><span>5148</span></td><td id="LC5148" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">publish</span>(<span class="code-params">bundleId, pathsNotFound</span>) </span>{
</code></td></tr><tr><td id="L5149" class="css-a4x74f"><span>5149</span></td><td id="LC5149" class="css-1dcdqdg"><code>        <span class="code-comment">// exit if id isn't defined</span>
</code></td></tr><tr><td id="L5150" class="css-a4x74f"><span>5150</span></td><td id="LC5150" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!bundleId) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5151" class="css-a4x74f"><span>5151</span></td><td id="LC5151" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> q = bundleCallbackQueue[bundleId];
</code></td></tr><tr><td id="L5152" class="css-a4x74f"><span>5152</span></td><td id="LC5152" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5153" class="css-a4x74f"><span>5153</span></td><td id="LC5153" class="css-1dcdqdg"><code>        <span class="code-comment">// cache result</span>
</code></td></tr><tr><td id="L5154" class="css-a4x74f"><span>5154</span></td><td id="LC5154" class="css-1dcdqdg"><code>        bundleResultCache[bundleId] = pathsNotFound;
</code></td></tr><tr><td id="L5155" class="css-a4x74f"><span>5155</span></td><td id="LC5155" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5156" class="css-a4x74f"><span>5156</span></td><td id="LC5156" class="css-1dcdqdg"><code>        <span class="code-comment">// exit if queue is empty</span>
</code></td></tr><tr><td id="L5157" class="css-a4x74f"><span>5157</span></td><td id="LC5157" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!q) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5158" class="css-a4x74f"><span>5158</span></td><td id="LC5158" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5159" class="css-a4x74f"><span>5159</span></td><td id="LC5159" class="css-1dcdqdg"><code>        <span class="code-comment">// empty callback queue</span>
</code></td></tr><tr><td id="L5160" class="css-a4x74f"><span>5160</span></td><td id="LC5160" class="css-1dcdqdg"><code>        <span class="code-keyword">while</span> (q.length) {
</code></td></tr><tr><td id="L5161" class="css-a4x74f"><span>5161</span></td><td id="LC5161" class="css-1dcdqdg"><code>          q[<span class="code-number">0</span>](bundleId, pathsNotFound);
</code></td></tr><tr><td id="L5162" class="css-a4x74f"><span>5162</span></td><td id="LC5162" class="css-1dcdqdg"><code>          q.splice(<span class="code-number">0</span>, <span class="code-number">1</span>);
</code></td></tr><tr><td id="L5163" class="css-a4x74f"><span>5163</span></td><td id="LC5163" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5164" class="css-a4x74f"><span>5164</span></td><td id="LC5164" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5165" class="css-a4x74f"><span>5165</span></td><td id="LC5165" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5166" class="css-a4x74f"><span>5166</span></td><td id="LC5166" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5167" class="css-a4x74f"><span>5167</span></td><td id="LC5167" class="css-1dcdqdg"><code><span class="code-comment">       * Execute callbacks.
</span></code></td></tr><tr><td id="L5168" class="css-a4x74f"><span>5168</span></td><td id="LC5168" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Object or Function} args - The callback args
</span></code></td></tr><tr><td id="L5169" class="css-a4x74f"><span>5169</span></td><td id="LC5169" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string[]} depsNotFound - List of dependencies not found
</span></code></td></tr><tr><td id="L5170" class="css-a4x74f"><span>5170</span></td><td id="LC5170" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5171" class="css-a4x74f"><span>5171</span></td><td id="LC5171" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">executeCallbacks</span>(<span class="code-params">args, depsNotFound</span>) </span>{
</code></td></tr><tr><td id="L5172" class="css-a4x74f"><span>5172</span></td><td id="LC5172" class="css-1dcdqdg"><code>        <span class="code-comment">// accept function as argument</span>
</code></td></tr><tr><td id="L5173" class="css-a4x74f"><span>5173</span></td><td id="LC5173" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (args.call) args = {
</code></td></tr><tr><td id="L5174" class="css-a4x74f"><span>5174</span></td><td id="LC5174" class="css-1dcdqdg"><code>          success: args
</code></td></tr><tr><td id="L5175" class="css-a4x74f"><span>5175</span></td><td id="LC5175" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L5176" class="css-a4x74f"><span>5176</span></td><td id="LC5176" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5177" class="css-a4x74f"><span>5177</span></td><td id="LC5177" class="css-1dcdqdg"><code>        <span class="code-comment">// success and error callbacks</span>
</code></td></tr><tr><td id="L5178" class="css-a4x74f"><span>5178</span></td><td id="LC5178" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (depsNotFound.length) (args.error || devnull)(depsNotFound);<span class="code-keyword">else</span> (args.success || devnull)(args);
</code></td></tr><tr><td id="L5179" class="css-a4x74f"><span>5179</span></td><td id="LC5179" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5180" class="css-a4x74f"><span>5180</span></td><td id="LC5180" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5181" class="css-a4x74f"><span>5181</span></td><td id="LC5181" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5182" class="css-a4x74f"><span>5182</span></td><td id="LC5182" class="css-1dcdqdg"><code><span class="code-comment">       * Load individual file.
</span></code></td></tr><tr><td id="L5183" class="css-a4x74f"><span>5183</span></td><td id="LC5183" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string} path - The file path
</span></code></td></tr><tr><td id="L5184" class="css-a4x74f"><span>5184</span></td><td id="LC5184" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callbackFn - The callback function
</span></code></td></tr><tr><td id="L5185" class="css-a4x74f"><span>5185</span></td><td id="LC5185" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5186" class="css-a4x74f"><span>5186</span></td><td id="LC5186" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadFile</span>(<span class="code-params">path, callbackFn, args, numTries</span>) </span>{
</code></td></tr><tr><td id="L5187" class="css-a4x74f"><span>5187</span></td><td id="LC5187" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> doc = <span class="code-built_in">document</span>,
</code></td></tr><tr><td id="L5188" class="css-a4x74f"><span>5188</span></td><td id="LC5188" class="css-1dcdqdg"><code>          <span class="code-keyword">async</span> = args.async,
</code></td></tr><tr><td id="L5189" class="css-a4x74f"><span>5189</span></td><td id="LC5189" class="css-1dcdqdg"><code>          maxTries = (args.numRetries || <span class="code-number">0</span>) + <span class="code-number">1</span>,
</code></td></tr><tr><td id="L5190" class="css-a4x74f"><span>5190</span></td><td id="LC5190" class="css-1dcdqdg"><code>          beforeCallbackFn = args.before || devnull,
</code></td></tr><tr><td id="L5191" class="css-a4x74f"><span>5191</span></td><td id="LC5191" class="css-1dcdqdg"><code>          pathname = path.replace(<span class="code-regexp">/[\?|#].*$/</span>, <span class="code-string">''</span>),
</code></td></tr><tr><td id="L5192" class="css-a4x74f"><span>5192</span></td><td id="LC5192" class="css-1dcdqdg"><code>          pathStripped = path.replace(<span class="code-regexp">/^(css|img)!/</span>, <span class="code-string">''</span>),
</code></td></tr><tr><td id="L5193" class="css-a4x74f"><span>5193</span></td><td id="LC5193" class="css-1dcdqdg"><code>          isLegacyIECss,
</code></td></tr><tr><td id="L5194" class="css-a4x74f"><span>5194</span></td><td id="LC5194" class="css-1dcdqdg"><code>          e;
</code></td></tr><tr><td id="L5195" class="css-a4x74f"><span>5195</span></td><td id="LC5195" class="css-1dcdqdg"><code>        numTries = numTries || <span class="code-number">0</span>;
</code></td></tr><tr><td id="L5196" class="css-a4x74f"><span>5196</span></td><td id="LC5196" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-regexp">/(^css!|\.css$)/</span>.test(pathname)) {
</code></td></tr><tr><td id="L5197" class="css-a4x74f"><span>5197</span></td><td id="LC5197" class="css-1dcdqdg"><code>          <span class="code-comment">// css</span>
</code></td></tr><tr><td id="L5198" class="css-a4x74f"><span>5198</span></td><td id="LC5198" class="css-1dcdqdg"><code>          e = doc.createElement(<span class="code-string">'link'</span>);
</code></td></tr><tr><td id="L5199" class="css-a4x74f"><span>5199</span></td><td id="LC5199" class="css-1dcdqdg"><code>          e.rel = <span class="code-string">'stylesheet'</span>;
</code></td></tr><tr><td id="L5200" class="css-a4x74f"><span>5200</span></td><td id="LC5200" class="css-1dcdqdg"><code>          e.href = pathStripped;
</code></td></tr><tr><td id="L5201" class="css-a4x74f"><span>5201</span></td><td id="LC5201" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5202" class="css-a4x74f"><span>5202</span></td><td id="LC5202" class="css-1dcdqdg"><code>          <span class="code-comment">// tag IE9+</span>
</code></td></tr><tr><td id="L5203" class="css-a4x74f"><span>5203</span></td><td id="LC5203" class="css-1dcdqdg"><code>          isLegacyIECss = <span class="code-string">'hideFocus'</span> <span class="code-keyword">in</span> e;
</code></td></tr><tr><td id="L5204" class="css-a4x74f"><span>5204</span></td><td id="LC5204" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5205" class="css-a4x74f"><span>5205</span></td><td id="LC5205" class="css-1dcdqdg"><code>          <span class="code-comment">// use preload in IE Edge (to detect load errors)</span>
</code></td></tr><tr><td id="L5206" class="css-a4x74f"><span>5206</span></td><td id="LC5206" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (isLegacyIECss &amp;&amp; e.relList) {
</code></td></tr><tr><td id="L5207" class="css-a4x74f"><span>5207</span></td><td id="LC5207" class="css-1dcdqdg"><code>            isLegacyIECss = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L5208" class="css-a4x74f"><span>5208</span></td><td id="LC5208" class="css-1dcdqdg"><code>            e.rel = <span class="code-string">'preload'</span>;
</code></td></tr><tr><td id="L5209" class="css-a4x74f"><span>5209</span></td><td id="LC5209" class="css-1dcdqdg"><code>            e.as = <span class="code-string">'style'</span>;
</code></td></tr><tr><td id="L5210" class="css-a4x74f"><span>5210</span></td><td id="LC5210" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5211" class="css-a4x74f"><span>5211</span></td><td id="LC5211" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-regexp">/(^img!|\.(png|gif|jpg|svg|webp)$)/</span>.test(pathname)) {
</code></td></tr><tr><td id="L5212" class="css-a4x74f"><span>5212</span></td><td id="LC5212" class="css-1dcdqdg"><code>          <span class="code-comment">// image</span>
</code></td></tr><tr><td id="L5213" class="css-a4x74f"><span>5213</span></td><td id="LC5213" class="css-1dcdqdg"><code>          e = doc.createElement(<span class="code-string">'img'</span>);
</code></td></tr><tr><td id="L5214" class="css-a4x74f"><span>5214</span></td><td id="LC5214" class="css-1dcdqdg"><code>          e.src = pathStripped;
</code></td></tr><tr><td id="L5215" class="css-a4x74f"><span>5215</span></td><td id="LC5215" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5216" class="css-a4x74f"><span>5216</span></td><td id="LC5216" class="css-1dcdqdg"><code>          <span class="code-comment">// javascript</span>
</code></td></tr><tr><td id="L5217" class="css-a4x74f"><span>5217</span></td><td id="LC5217" class="css-1dcdqdg"><code>          e = doc.createElement(<span class="code-string">'script'</span>);
</code></td></tr><tr><td id="L5218" class="css-a4x74f"><span>5218</span></td><td id="LC5218" class="css-1dcdqdg"><code>          e.src = path;
</code></td></tr><tr><td id="L5219" class="css-a4x74f"><span>5219</span></td><td id="LC5219" class="css-1dcdqdg"><code>          e.async = <span class="code-keyword">async</span> === <span class="code-literal">undefined</span> ? <span class="code-literal">true</span> : <span class="code-keyword">async</span>;
</code></td></tr><tr><td id="L5220" class="css-a4x74f"><span>5220</span></td><td id="LC5220" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5221" class="css-a4x74f"><span>5221</span></td><td id="LC5221" class="css-1dcdqdg"><code>        e.onload = e.onerror = e.onbeforeload = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">ev</span>) </span>{
</code></td></tr><tr><td id="L5222" class="css-a4x74f"><span>5222</span></td><td id="LC5222" class="css-1dcdqdg"><code>          <span class="code-keyword">var</span> result = ev.type[<span class="code-number">0</span>];
</code></td></tr><tr><td id="L5223" class="css-a4x74f"><span>5223</span></td><td id="LC5223" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5224" class="css-a4x74f"><span>5224</span></td><td id="LC5224" class="css-1dcdqdg"><code>          <span class="code-comment">// treat empty stylesheets as failures to get around lack of onerror</span>
</code></td></tr><tr><td id="L5225" class="css-a4x74f"><span>5225</span></td><td id="LC5225" class="css-1dcdqdg"><code>          <span class="code-comment">// support in IE9-11</span>
</code></td></tr><tr><td id="L5226" class="css-a4x74f"><span>5226</span></td><td id="LC5226" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (isLegacyIECss) {
</code></td></tr><tr><td id="L5227" class="css-a4x74f"><span>5227</span></td><td id="LC5227" class="css-1dcdqdg"><code>            <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L5228" class="css-a4x74f"><span>5228</span></td><td id="LC5228" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (!e.sheet.cssText.length) result = <span class="code-string">'e'</span>;
</code></td></tr><tr><td id="L5229" class="css-a4x74f"><span>5229</span></td><td id="LC5229" class="css-1dcdqdg"><code>            } <span class="code-keyword">catch</span> (x) {
</code></td></tr><tr><td id="L5230" class="css-a4x74f"><span>5230</span></td><td id="LC5230" class="css-1dcdqdg"><code>              <span class="code-comment">// sheets objects created from load errors don't allow access to</span>
</code></td></tr><tr><td id="L5231" class="css-a4x74f"><span>5231</span></td><td id="LC5231" class="css-1dcdqdg"><code>              <span class="code-comment">// `cssText` (unless error is Code:18 SecurityError)</span>
</code></td></tr><tr><td id="L5232" class="css-a4x74f"><span>5232</span></td><td id="LC5232" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (x.code != <span class="code-number">18</span>) result = <span class="code-string">'e'</span>;
</code></td></tr><tr><td id="L5233" class="css-a4x74f"><span>5233</span></td><td id="LC5233" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5234" class="css-a4x74f"><span>5234</span></td><td id="LC5234" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5235" class="css-a4x74f"><span>5235</span></td><td id="LC5235" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5236" class="css-a4x74f"><span>5236</span></td><td id="LC5236" class="css-1dcdqdg"><code>          <span class="code-comment">// handle retries in case of load failure</span>
</code></td></tr><tr><td id="L5237" class="css-a4x74f"><span>5237</span></td><td id="LC5237" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (result == <span class="code-string">'e'</span>) {
</code></td></tr><tr><td id="L5238" class="css-a4x74f"><span>5238</span></td><td id="LC5238" class="css-1dcdqdg"><code>            <span class="code-comment">// increment counter</span>
</code></td></tr><tr><td id="L5239" class="css-a4x74f"><span>5239</span></td><td id="LC5239" class="css-1dcdqdg"><code>            numTries += <span class="code-number">1</span>;
</code></td></tr><tr><td id="L5240" class="css-a4x74f"><span>5240</span></td><td id="LC5240" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5241" class="css-a4x74f"><span>5241</span></td><td id="LC5241" class="css-1dcdqdg"><code>            <span class="code-comment">// exit function and try again</span>
</code></td></tr><tr><td id="L5242" class="css-a4x74f"><span>5242</span></td><td id="LC5242" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (numTries &lt; maxTries) {
</code></td></tr><tr><td id="L5243" class="css-a4x74f"><span>5243</span></td><td id="LC5243" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span> loadFile(path, callbackFn, args, numTries);
</code></td></tr><tr><td id="L5244" class="css-a4x74f"><span>5244</span></td><td id="LC5244" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5245" class="css-a4x74f"><span>5245</span></td><td id="LC5245" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (e.rel == <span class="code-string">'preload'</span> &amp;&amp; e.as == <span class="code-string">'style'</span>) {
</code></td></tr><tr><td id="L5246" class="css-a4x74f"><span>5246</span></td><td id="LC5246" class="css-1dcdqdg"><code>            <span class="code-comment">// activate preloaded stylesheets</span>
</code></td></tr><tr><td id="L5247" class="css-a4x74f"><span>5247</span></td><td id="LC5247" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span> e.rel = <span class="code-string">'stylesheet'</span>; <span class="code-comment">// jshint ignore:line</span>
</code></td></tr><tr><td id="L5248" class="css-a4x74f"><span>5248</span></td><td id="LC5248" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5249" class="css-a4x74f"><span>5249</span></td><td id="LC5249" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5250" class="css-a4x74f"><span>5250</span></td><td id="LC5250" class="css-1dcdqdg"><code>          <span class="code-comment">// execute callback</span>
</code></td></tr><tr><td id="L5251" class="css-a4x74f"><span>5251</span></td><td id="LC5251" class="css-1dcdqdg"><code>          callbackFn(path, result, ev.defaultPrevented);
</code></td></tr><tr><td id="L5252" class="css-a4x74f"><span>5252</span></td><td id="LC5252" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L5253" class="css-a4x74f"><span>5253</span></td><td id="LC5253" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5254" class="css-a4x74f"><span>5254</span></td><td id="LC5254" class="css-1dcdqdg"><code>        <span class="code-comment">// add to document (unless callback returns `false`)</span>
</code></td></tr><tr><td id="L5255" class="css-a4x74f"><span>5255</span></td><td id="LC5255" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (beforeCallbackFn(path, e) !== <span class="code-literal">false</span>) doc.head.appendChild(e);
</code></td></tr><tr><td id="L5256" class="css-a4x74f"><span>5256</span></td><td id="LC5256" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5257" class="css-a4x74f"><span>5257</span></td><td id="LC5257" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5258" class="css-a4x74f"><span>5258</span></td><td id="LC5258" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5259" class="css-a4x74f"><span>5259</span></td><td id="LC5259" class="css-1dcdqdg"><code><span class="code-comment">       * Load multiple files.
</span></code></td></tr><tr><td id="L5260" class="css-a4x74f"><span>5260</span></td><td id="LC5260" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string[]} paths - The file paths
</span></code></td></tr><tr><td id="L5261" class="css-a4x74f"><span>5261</span></td><td id="LC5261" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callbackFn - The callback function
</span></code></td></tr><tr><td id="L5262" class="css-a4x74f"><span>5262</span></td><td id="LC5262" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5263" class="css-a4x74f"><span>5263</span></td><td id="LC5263" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadFiles</span>(<span class="code-params">paths, callbackFn, args</span>) </span>{
</code></td></tr><tr><td id="L5264" class="css-a4x74f"><span>5264</span></td><td id="LC5264" class="css-1dcdqdg"><code>        <span class="code-comment">// listify paths</span>
</code></td></tr><tr><td id="L5265" class="css-a4x74f"><span>5265</span></td><td id="LC5265" class="css-1dcdqdg"><code>        paths = paths.push ? paths : [paths];
</code></td></tr><tr><td id="L5266" class="css-a4x74f"><span>5266</span></td><td id="LC5266" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> numWaiting = paths.length,
</code></td></tr><tr><td id="L5267" class="css-a4x74f"><span>5267</span></td><td id="LC5267" class="css-1dcdqdg"><code>          x = numWaiting,
</code></td></tr><tr><td id="L5268" class="css-a4x74f"><span>5268</span></td><td id="LC5268" class="css-1dcdqdg"><code>          pathsNotFound = [],
</code></td></tr><tr><td id="L5269" class="css-a4x74f"><span>5269</span></td><td id="LC5269" class="css-1dcdqdg"><code>          fn,
</code></td></tr><tr><td id="L5270" class="css-a4x74f"><span>5270</span></td><td id="LC5270" class="css-1dcdqdg"><code>          i;
</code></td></tr><tr><td id="L5271" class="css-a4x74f"><span>5271</span></td><td id="LC5271" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5272" class="css-a4x74f"><span>5272</span></td><td id="LC5272" class="css-1dcdqdg"><code>        <span class="code-comment">// define callback function</span>
</code></td></tr><tr><td id="L5273" class="css-a4x74f"><span>5273</span></td><td id="LC5273" class="css-1dcdqdg"><code>        fn = <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">path, result, defaultPrevented</span>) </span>{
</code></td></tr><tr><td id="L5274" class="css-a4x74f"><span>5274</span></td><td id="LC5274" class="css-1dcdqdg"><code>          <span class="code-comment">// handle error</span>
</code></td></tr><tr><td id="L5275" class="css-a4x74f"><span>5275</span></td><td id="LC5275" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (result == <span class="code-string">'e'</span>) pathsNotFound.push(path);
</code></td></tr><tr><td id="L5276" class="css-a4x74f"><span>5276</span></td><td id="LC5276" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5277" class="css-a4x74f"><span>5277</span></td><td id="LC5277" class="css-1dcdqdg"><code>          <span class="code-comment">// handle beforeload event. If defaultPrevented then that means the load</span>
</code></td></tr><tr><td id="L5278" class="css-a4x74f"><span>5278</span></td><td id="LC5278" class="css-1dcdqdg"><code>          <span class="code-comment">// will be blocked (ex. Ghostery/ABP on Safari)</span>
</code></td></tr><tr><td id="L5279" class="css-a4x74f"><span>5279</span></td><td id="LC5279" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (result == <span class="code-string">'b'</span>) {
</code></td></tr><tr><td id="L5280" class="css-a4x74f"><span>5280</span></td><td id="LC5280" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (defaultPrevented) pathsNotFound.push(path);<span class="code-keyword">else</span> <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5281" class="css-a4x74f"><span>5281</span></td><td id="LC5281" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5282" class="css-a4x74f"><span>5282</span></td><td id="LC5282" class="css-1dcdqdg"><code>          numWaiting--;
</code></td></tr><tr><td id="L5283" class="css-a4x74f"><span>5283</span></td><td id="LC5283" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!numWaiting) callbackFn(pathsNotFound);
</code></td></tr><tr><td id="L5284" class="css-a4x74f"><span>5284</span></td><td id="LC5284" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L5285" class="css-a4x74f"><span>5285</span></td><td id="LC5285" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5286" class="css-a4x74f"><span>5286</span></td><td id="LC5286" class="css-1dcdqdg"><code>        <span class="code-comment">// load scripts</span>
</code></td></tr><tr><td id="L5287" class="css-a4x74f"><span>5287</span></td><td id="LC5287" class="css-1dcdqdg"><code>        <span class="code-keyword">for</span> (i = <span class="code-number">0</span>; i &lt; x; i++) loadFile(paths[i], fn, args);
</code></td></tr><tr><td id="L5288" class="css-a4x74f"><span>5288</span></td><td id="LC5288" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5289" class="css-a4x74f"><span>5289</span></td><td id="LC5289" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5290" class="css-a4x74f"><span>5290</span></td><td id="LC5290" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5291" class="css-a4x74f"><span>5291</span></td><td id="LC5291" class="css-1dcdqdg"><code><span class="code-comment">       * Initiate script load and register bundle.
</span></code></td></tr><tr><td id="L5292" class="css-a4x74f"><span>5292</span></td><td id="LC5292" class="css-1dcdqdg"><code><span class="code-comment">       * @param {(string|string[])} paths - The file paths
</span></code></td></tr><tr><td id="L5293" class="css-a4x74f"><span>5293</span></td><td id="LC5293" class="css-1dcdqdg"><code><span class="code-comment">       * @param {(string|Function|Object)} [arg1] - The (1) bundleId or (2) success
</span></code></td></tr><tr><td id="L5294" class="css-a4x74f"><span>5294</span></td><td id="LC5294" class="css-1dcdqdg"><code><span class="code-comment">       *   callback or (3) object literal with success/error arguments, numRetries,
</span></code></td></tr><tr><td id="L5295" class="css-a4x74f"><span>5295</span></td><td id="LC5295" class="css-1dcdqdg"><code><span class="code-comment">       *   etc.
</span></code></td></tr><tr><td id="L5296" class="css-a4x74f"><span>5296</span></td><td id="LC5296" class="css-1dcdqdg"><code><span class="code-comment">       * @param {(Function|Object)} [arg2] - The (1) success callback or (2) object
</span></code></td></tr><tr><td id="L5297" class="css-a4x74f"><span>5297</span></td><td id="LC5297" class="css-1dcdqdg"><code><span class="code-comment">       *   literal with success/error arguments, numRetries, etc.
</span></code></td></tr><tr><td id="L5298" class="css-a4x74f"><span>5298</span></td><td id="LC5298" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5299" class="css-a4x74f"><span>5299</span></td><td id="LC5299" class="css-1dcdqdg"><code>      <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadjs</span>(<span class="code-params">paths, arg1, arg2</span>) </span>{
</code></td></tr><tr><td id="L5300" class="css-a4x74f"><span>5300</span></td><td id="LC5300" class="css-1dcdqdg"><code>        <span class="code-keyword">var</span> bundleId, args;
</code></td></tr><tr><td id="L5301" class="css-a4x74f"><span>5301</span></td><td id="LC5301" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5302" class="css-a4x74f"><span>5302</span></td><td id="LC5302" class="css-1dcdqdg"><code>        <span class="code-comment">// bundleId (if string)</span>
</code></td></tr><tr><td id="L5303" class="css-a4x74f"><span>5303</span></td><td id="LC5303" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (arg1 &amp;&amp; arg1.trim) bundleId = arg1;
</code></td></tr><tr><td id="L5304" class="css-a4x74f"><span>5304</span></td><td id="LC5304" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5305" class="css-a4x74f"><span>5305</span></td><td id="LC5305" class="css-1dcdqdg"><code>        <span class="code-comment">// args (default is {})</span>
</code></td></tr><tr><td id="L5306" class="css-a4x74f"><span>5306</span></td><td id="LC5306" class="css-1dcdqdg"><code>        args = (bundleId ? arg2 : arg1) || {};
</code></td></tr><tr><td id="L5307" class="css-a4x74f"><span>5307</span></td><td id="LC5307" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5308" class="css-a4x74f"><span>5308</span></td><td id="LC5308" class="css-1dcdqdg"><code>        <span class="code-comment">// throw error if bundle is already defined</span>
</code></td></tr><tr><td id="L5309" class="css-a4x74f"><span>5309</span></td><td id="LC5309" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (bundleId) {
</code></td></tr><tr><td id="L5310" class="css-a4x74f"><span>5310</span></td><td id="LC5310" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (bundleId <span class="code-keyword">in</span> bundleIdCache) {
</code></td></tr><tr><td id="L5311" class="css-a4x74f"><span>5311</span></td><td id="LC5311" class="css-1dcdqdg"><code>            <span class="code-keyword">throw</span> <span class="code-string">"LoadJS"</span>;
</code></td></tr><tr><td id="L5312" class="css-a4x74f"><span>5312</span></td><td id="LC5312" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5313" class="css-a4x74f"><span>5313</span></td><td id="LC5313" class="css-1dcdqdg"><code>            bundleIdCache[bundleId] = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5314" class="css-a4x74f"><span>5314</span></td><td id="LC5314" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5315" class="css-a4x74f"><span>5315</span></td><td id="LC5315" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5316" class="css-a4x74f"><span>5316</span></td><td id="LC5316" class="css-1dcdqdg"><code>        <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadFn</span>(<span class="code-params">resolve, reject</span>) </span>{
</code></td></tr><tr><td id="L5317" class="css-a4x74f"><span>5317</span></td><td id="LC5317" class="css-1dcdqdg"><code>          loadFiles(paths, <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">pathsNotFound</span>) </span>{
</code></td></tr><tr><td id="L5318" class="css-a4x74f"><span>5318</span></td><td id="LC5318" class="css-1dcdqdg"><code>            <span class="code-comment">// execute callbacks</span>
</code></td></tr><tr><td id="L5319" class="css-a4x74f"><span>5319</span></td><td id="LC5319" class="css-1dcdqdg"><code>            executeCallbacks(args, pathsNotFound);
</code></td></tr><tr><td id="L5320" class="css-a4x74f"><span>5320</span></td><td id="LC5320" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5321" class="css-a4x74f"><span>5321</span></td><td id="LC5321" class="css-1dcdqdg"><code>            <span class="code-comment">// resolve Promise</span>
</code></td></tr><tr><td id="L5322" class="css-a4x74f"><span>5322</span></td><td id="LC5322" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (resolve) {
</code></td></tr><tr><td id="L5323" class="css-a4x74f"><span>5323</span></td><td id="LC5323" class="css-1dcdqdg"><code>              executeCallbacks({
</code></td></tr><tr><td id="L5324" class="css-a4x74f"><span>5324</span></td><td id="LC5324" class="css-1dcdqdg"><code>                success: resolve,
</code></td></tr><tr><td id="L5325" class="css-a4x74f"><span>5325</span></td><td id="LC5325" class="css-1dcdqdg"><code>                error: reject
</code></td></tr><tr><td id="L5326" class="css-a4x74f"><span>5326</span></td><td id="LC5326" class="css-1dcdqdg"><code>              }, pathsNotFound);
</code></td></tr><tr><td id="L5327" class="css-a4x74f"><span>5327</span></td><td id="LC5327" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5328" class="css-a4x74f"><span>5328</span></td><td id="LC5328" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5329" class="css-a4x74f"><span>5329</span></td><td id="LC5329" class="css-1dcdqdg"><code>            <span class="code-comment">// publish bundle load event</span>
</code></td></tr><tr><td id="L5330" class="css-a4x74f"><span>5330</span></td><td id="LC5330" class="css-1dcdqdg"><code>            publish(bundleId, pathsNotFound);
</code></td></tr><tr><td id="L5331" class="css-a4x74f"><span>5331</span></td><td id="LC5331" class="css-1dcdqdg"><code>          }, args);
</code></td></tr><tr><td id="L5332" class="css-a4x74f"><span>5332</span></td><td id="LC5332" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5333" class="css-a4x74f"><span>5333</span></td><td id="LC5333" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (args.returnPromise) <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(loadFn);<span class="code-keyword">else</span> loadFn();
</code></td></tr><tr><td id="L5334" class="css-a4x74f"><span>5334</span></td><td id="LC5334" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5335" class="css-a4x74f"><span>5335</span></td><td id="LC5335" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5336" class="css-a4x74f"><span>5336</span></td><td id="LC5336" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5337" class="css-a4x74f"><span>5337</span></td><td id="LC5337" class="css-1dcdqdg"><code><span class="code-comment">       * Execute callbacks when dependencies have been satisfied.
</span></code></td></tr><tr><td id="L5338" class="css-a4x74f"><span>5338</span></td><td id="LC5338" class="css-1dcdqdg"><code><span class="code-comment">       * @param {(string|string[])} deps - List of bundle ids
</span></code></td></tr><tr><td id="L5339" class="css-a4x74f"><span>5339</span></td><td id="LC5339" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Object} args - success/error arguments
</span></code></td></tr><tr><td id="L5340" class="css-a4x74f"><span>5340</span></td><td id="LC5340" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5341" class="css-a4x74f"><span>5341</span></td><td id="LC5341" class="css-1dcdqdg"><code>      loadjs.ready = <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">ready</span>(<span class="code-params">deps, args</span>) </span>{
</code></td></tr><tr><td id="L5342" class="css-a4x74f"><span>5342</span></td><td id="LC5342" class="css-1dcdqdg"><code>        <span class="code-comment">// subscribe to bundle load event</span>
</code></td></tr><tr><td id="L5343" class="css-a4x74f"><span>5343</span></td><td id="LC5343" class="css-1dcdqdg"><code>        subscribe(deps, <span class="code-function"><span class="code-keyword">function</span> (<span class="code-params">depsNotFound</span>) </span>{
</code></td></tr><tr><td id="L5344" class="css-a4x74f"><span>5344</span></td><td id="LC5344" class="css-1dcdqdg"><code>          <span class="code-comment">// execute callbacks</span>
</code></td></tr><tr><td id="L5345" class="css-a4x74f"><span>5345</span></td><td id="LC5345" class="css-1dcdqdg"><code>          executeCallbacks(args, depsNotFound);
</code></td></tr><tr><td id="L5346" class="css-a4x74f"><span>5346</span></td><td id="LC5346" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5347" class="css-a4x74f"><span>5347</span></td><td id="LC5347" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> loadjs;
</code></td></tr><tr><td id="L5348" class="css-a4x74f"><span>5348</span></td><td id="LC5348" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5349" class="css-a4x74f"><span>5349</span></td><td id="LC5349" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5350" class="css-a4x74f"><span>5350</span></td><td id="LC5350" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5351" class="css-a4x74f"><span>5351</span></td><td id="LC5351" class="css-1dcdqdg"><code><span class="code-comment">       * Manually satisfy bundle dependencies.
</span></code></td></tr><tr><td id="L5352" class="css-a4x74f"><span>5352</span></td><td id="LC5352" class="css-1dcdqdg"><code><span class="code-comment">       * @param {string} bundleId - The bundle id
</span></code></td></tr><tr><td id="L5353" class="css-a4x74f"><span>5353</span></td><td id="LC5353" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5354" class="css-a4x74f"><span>5354</span></td><td id="LC5354" class="css-1dcdqdg"><code>      loadjs.done = <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">done</span>(<span class="code-params">bundleId</span>) </span>{
</code></td></tr><tr><td id="L5355" class="css-a4x74f"><span>5355</span></td><td id="LC5355" class="css-1dcdqdg"><code>        publish(bundleId, []);
</code></td></tr><tr><td id="L5356" class="css-a4x74f"><span>5356</span></td><td id="LC5356" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5357" class="css-a4x74f"><span>5357</span></td><td id="LC5357" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5358" class="css-a4x74f"><span>5358</span></td><td id="LC5358" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5359" class="css-a4x74f"><span>5359</span></td><td id="LC5359" class="css-1dcdqdg"><code><span class="code-comment">       * Reset loadjs dependencies statuses
</span></code></td></tr><tr><td id="L5360" class="css-a4x74f"><span>5360</span></td><td id="LC5360" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5361" class="css-a4x74f"><span>5361</span></td><td id="LC5361" class="css-1dcdqdg"><code>      loadjs.reset = <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">reset</span>(<span class="code-params"></span>) </span>{
</code></td></tr><tr><td id="L5362" class="css-a4x74f"><span>5362</span></td><td id="LC5362" class="css-1dcdqdg"><code>        bundleIdCache = {};
</code></td></tr><tr><td id="L5363" class="css-a4x74f"><span>5363</span></td><td id="LC5363" class="css-1dcdqdg"><code>        bundleResultCache = {};
</code></td></tr><tr><td id="L5364" class="css-a4x74f"><span>5364</span></td><td id="LC5364" class="css-1dcdqdg"><code>        bundleCallbackQueue = {};
</code></td></tr><tr><td id="L5365" class="css-a4x74f"><span>5365</span></td><td id="LC5365" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5366" class="css-a4x74f"><span>5366</span></td><td id="LC5366" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5367" class="css-a4x74f"><span>5367</span></td><td id="LC5367" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L5368" class="css-a4x74f"><span>5368</span></td><td id="LC5368" class="css-1dcdqdg"><code><span class="code-comment">       * Determine if bundle has already been defined
</span></code></td></tr><tr><td id="L5369" class="css-a4x74f"><span>5369</span></td><td id="LC5369" class="css-1dcdqdg"><code><span class="code-comment">       * @param String} bundleId - The bundle id
</span></code></td></tr><tr><td id="L5370" class="css-a4x74f"><span>5370</span></td><td id="LC5370" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L5371" class="css-a4x74f"><span>5371</span></td><td id="LC5371" class="css-1dcdqdg"><code>      loadjs.isDefined = <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">isDefined</span>(<span class="code-params">bundleId</span>) </span>{
</code></td></tr><tr><td id="L5372" class="css-a4x74f"><span>5372</span></td><td id="LC5372" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> bundleId <span class="code-keyword">in</span> bundleIdCache;
</code></td></tr><tr><td id="L5373" class="css-a4x74f"><span>5373</span></td><td id="LC5373" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5374" class="css-a4x74f"><span>5374</span></td><td id="LC5374" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5375" class="css-a4x74f"><span>5375</span></td><td id="LC5375" class="css-1dcdqdg"><code>      <span class="code-comment">// export</span>
</code></td></tr><tr><td id="L5376" class="css-a4x74f"><span>5376</span></td><td id="LC5376" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> loadjs;
</code></td></tr><tr><td id="L5377" class="css-a4x74f"><span>5377</span></td><td id="LC5377" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L5378" class="css-a4x74f"><span>5378</span></td><td id="LC5378" class="css-1dcdqdg"><code>  });
</code></td></tr><tr><td id="L5379" class="css-a4x74f"><span>5379</span></td><td id="LC5379" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5380" class="css-a4x74f"><span>5380</span></td><td id="LC5380" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L5381" class="css-a4x74f"><span>5381</span></td><td id="LC5381" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">loadScript</span>(<span class="code-params">url</span>) </span>{
</code></td></tr><tr><td id="L5382" class="css-a4x74f"><span>5382</span></td><td id="LC5382" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function">(<span class="code-params">resolve, reject</span>) =&gt;</span> {
</code></td></tr><tr><td id="L5383" class="css-a4x74f"><span>5383</span></td><td id="LC5383" class="css-1dcdqdg"><code>      loadjs_umd(url, {
</code></td></tr><tr><td id="L5384" class="css-a4x74f"><span>5384</span></td><td id="LC5384" class="css-1dcdqdg"><code>        success: resolve,
</code></td></tr><tr><td id="L5385" class="css-a4x74f"><span>5385</span></td><td id="LC5385" class="css-1dcdqdg"><code>        error: reject
</code></td></tr><tr><td id="L5386" class="css-a4x74f"><span>5386</span></td><td id="LC5386" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5387" class="css-a4x74f"><span>5387</span></td><td id="LC5387" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L5388" class="css-a4x74f"><span>5388</span></td><td id="LC5388" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5389" class="css-a4x74f"><span>5389</span></td><td id="LC5389" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5390" class="css-a4x74f"><span>5390</span></td><td id="LC5390" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L5391" class="css-a4x74f"><span>5391</span></td><td id="LC5391" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5392" class="css-a4x74f"><span>5392</span></td><td id="LC5392" class="css-1dcdqdg"><code>  <span class="code-comment">// Parse Vimeo ID from URL</span>
</code></td></tr><tr><td id="L5393" class="css-a4x74f"><span>5393</span></td><td id="LC5393" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">parseId$1</span>(<span class="code-params">url</span>) </span>{
</code></td></tr><tr><td id="L5394" class="css-a4x74f"><span>5394</span></td><td id="LC5394" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.empty(url)) {
</code></td></tr><tr><td id="L5395" class="css-a4x74f"><span>5395</span></td><td id="LC5395" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L5396" class="css-a4x74f"><span>5396</span></td><td id="LC5396" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5397" class="css-a4x74f"><span>5397</span></td><td id="LC5397" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.number(<span class="code-built_in">Number</span>(url))) {
</code></td></tr><tr><td id="L5398" class="css-a4x74f"><span>5398</span></td><td id="LC5398" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> url;
</code></td></tr><tr><td id="L5399" class="css-a4x74f"><span>5399</span></td><td id="LC5399" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5400" class="css-a4x74f"><span>5400</span></td><td id="LC5400" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> regex = <span class="code-regexp">/^.*(vimeo.com\/|video\/)(\d+).*/</span>;
</code></td></tr><tr><td id="L5401" class="css-a4x74f"><span>5401</span></td><td id="LC5401" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> url.match(regex) ? <span class="code-built_in">RegExp</span>.$<span class="code-number">2</span> : url;
</code></td></tr><tr><td id="L5402" class="css-a4x74f"><span>5402</span></td><td id="LC5402" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5403" class="css-a4x74f"><span>5403</span></td><td id="LC5403" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5404" class="css-a4x74f"><span>5404</span></td><td id="LC5404" class="css-1dcdqdg"><code>  <span class="code-comment">// Try to extract a hash for private videos from the URL</span>
</code></td></tr><tr><td id="L5405" class="css-a4x74f"><span>5405</span></td><td id="LC5405" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">parseHash</span>(<span class="code-params">url</span>) </span>{
</code></td></tr><tr><td id="L5406" class="css-a4x74f"><span>5406</span></td><td id="LC5406" class="css-1dcdqdg"><code>    <span class="code-comment">/* This regex matches a hexadecimal hash if given in any of these forms:
</span></code></td></tr><tr><td id="L5407" class="css-a4x74f"><span>5407</span></td><td id="LC5407" class="css-1dcdqdg"><code><span class="code-comment">     *  - [https://player.]vimeo.com/video/{id}/{hash}[?params]
</span></code></td></tr><tr><td id="L5408" class="css-a4x74f"><span>5408</span></td><td id="LC5408" class="css-1dcdqdg"><code><span class="code-comment">     *  - [https://player.]vimeo.com/video/{id}?h={hash}[&amp;params]
</span></code></td></tr><tr><td id="L5409" class="css-a4x74f"><span>5409</span></td><td id="LC5409" class="css-1dcdqdg"><code><span class="code-comment">     *  - [https://player.]vimeo.com/video/{id}?[params]&amp;h={hash}
</span></code></td></tr><tr><td id="L5410" class="css-a4x74f"><span>5410</span></td><td id="LC5410" class="css-1dcdqdg"><code><span class="code-comment">     *  - video/{id}/{hash}
</span></code></td></tr><tr><td id="L5411" class="css-a4x74f"><span>5411</span></td><td id="LC5411" class="css-1dcdqdg"><code><span class="code-comment">     * If matched, the hash is available in capture group 4
</span></code></td></tr><tr><td id="L5412" class="css-a4x74f"><span>5412</span></td><td id="LC5412" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L5413" class="css-a4x74f"><span>5413</span></td><td id="LC5413" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> regex = <span class="code-regexp">/^.*(vimeo.com\/|video\/)(\d+)(\?.*&amp;*h=|\/)+([\d,a-f]+)/</span>;
</code></td></tr><tr><td id="L5414" class="css-a4x74f"><span>5414</span></td><td id="LC5414" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> found = url.match(regex);
</code></td></tr><tr><td id="L5415" class="css-a4x74f"><span>5415</span></td><td id="LC5415" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> found &amp;&amp; found.length === <span class="code-number">5</span> ? found[<span class="code-number">4</span>] : <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L5416" class="css-a4x74f"><span>5416</span></td><td id="LC5416" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5417" class="css-a4x74f"><span>5417</span></td><td id="LC5417" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5418" class="css-a4x74f"><span>5418</span></td><td id="LC5418" class="css-1dcdqdg"><code>  <span class="code-comment">// Set playback state and trigger change (only on actual change)</span>
</code></td></tr><tr><td id="L5419" class="css-a4x74f"><span>5419</span></td><td id="LC5419" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">assurePlaybackState$1</span>(<span class="code-params">play</span>) </span>{
</code></td></tr><tr><td id="L5420" class="css-a4x74f"><span>5420</span></td><td id="LC5420" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (play &amp;&amp; !<span class="code-keyword">this</span>.embed.hasPlayed) {
</code></td></tr><tr><td id="L5421" class="css-a4x74f"><span>5421</span></td><td id="LC5421" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.embed.hasPlayed = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5422" class="css-a4x74f"><span>5422</span></td><td id="LC5422" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5423" class="css-a4x74f"><span>5423</span></td><td id="LC5423" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.paused === play) {
</code></td></tr><tr><td id="L5424" class="css-a4x74f"><span>5424</span></td><td id="LC5424" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.paused = !play;
</code></td></tr><tr><td id="L5425" class="css-a4x74f"><span>5425</span></td><td id="LC5425" class="css-1dcdqdg"><code>      triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, play ? <span class="code-string">'play'</span> : <span class="code-string">'pause'</span>);
</code></td></tr><tr><td id="L5426" class="css-a4x74f"><span>5426</span></td><td id="LC5426" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5427" class="css-a4x74f"><span>5427</span></td><td id="LC5427" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5428" class="css-a4x74f"><span>5428</span></td><td id="LC5428" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> vimeo = {
</code></td></tr><tr><td id="L5429" class="css-a4x74f"><span>5429</span></td><td id="LC5429" class="css-1dcdqdg"><code>    setup() {
</code></td></tr><tr><td id="L5430" class="css-a4x74f"><span>5430</span></td><td id="LC5430" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> player = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L5431" class="css-a4x74f"><span>5431</span></td><td id="LC5431" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5432" class="css-a4x74f"><span>5432</span></td><td id="LC5432" class="css-1dcdqdg"><code>      <span class="code-comment">// Add embed class for responsive</span>
</code></td></tr><tr><td id="L5433" class="css-a4x74f"><span>5433</span></td><td id="LC5433" class="css-1dcdqdg"><code>      toggleClass(player.elements.wrapper, player.config.classNames.embed, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L5434" class="css-a4x74f"><span>5434</span></td><td id="LC5434" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5435" class="css-a4x74f"><span>5435</span></td><td id="LC5435" class="css-1dcdqdg"><code>      <span class="code-comment">// Set speed options from config</span>
</code></td></tr><tr><td id="L5436" class="css-a4x74f"><span>5436</span></td><td id="LC5436" class="css-1dcdqdg"><code>      player.options.speed = player.config.speed.options;
</code></td></tr><tr><td id="L5437" class="css-a4x74f"><span>5437</span></td><td id="LC5437" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5438" class="css-a4x74f"><span>5438</span></td><td id="LC5438" class="css-1dcdqdg"><code>      <span class="code-comment">// Set intial ratio</span>
</code></td></tr><tr><td id="L5439" class="css-a4x74f"><span>5439</span></td><td id="LC5439" class="css-1dcdqdg"><code>      setAspectRatio.call(player);
</code></td></tr><tr><td id="L5440" class="css-a4x74f"><span>5440</span></td><td id="LC5440" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5441" class="css-a4x74f"><span>5441</span></td><td id="LC5441" class="css-1dcdqdg"><code>      <span class="code-comment">// Load the SDK if not already</span>
</code></td></tr><tr><td id="L5442" class="css-a4x74f"><span>5442</span></td><td id="LC5442" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.object(<span class="code-built_in">window</span>.Vimeo)) {
</code></td></tr><tr><td id="L5443" class="css-a4x74f"><span>5443</span></td><td id="LC5443" class="css-1dcdqdg"><code>        loadScript(player.config.urls.vimeo.sdk).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5444" class="css-a4x74f"><span>5444</span></td><td id="LC5444" class="css-1dcdqdg"><code>          vimeo.ready.call(player);
</code></td></tr><tr><td id="L5445" class="css-a4x74f"><span>5445</span></td><td id="LC5445" class="css-1dcdqdg"><code>        }).catch(<span class="code-function"><span class="code-params">error</span> =&gt;</span> {
</code></td></tr><tr><td id="L5446" class="css-a4x74f"><span>5446</span></td><td id="LC5446" class="css-1dcdqdg"><code>          player.debug.warn(<span class="code-string">'Vimeo SDK (player.js) failed to load'</span>, error);
</code></td></tr><tr><td id="L5447" class="css-a4x74f"><span>5447</span></td><td id="LC5447" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5448" class="css-a4x74f"><span>5448</span></td><td id="LC5448" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5449" class="css-a4x74f"><span>5449</span></td><td id="LC5449" class="css-1dcdqdg"><code>        vimeo.ready.call(player);
</code></td></tr><tr><td id="L5450" class="css-a4x74f"><span>5450</span></td><td id="LC5450" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5451" class="css-a4x74f"><span>5451</span></td><td id="LC5451" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L5452" class="css-a4x74f"><span>5452</span></td><td id="LC5452" class="css-1dcdqdg"><code>    <span class="code-comment">// API Ready</span>
</code></td></tr><tr><td id="L5453" class="css-a4x74f"><span>5453</span></td><td id="LC5453" class="css-1dcdqdg"><code>    ready() {
</code></td></tr><tr><td id="L5454" class="css-a4x74f"><span>5454</span></td><td id="LC5454" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> player = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L5455" class="css-a4x74f"><span>5455</span></td><td id="LC5455" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> config = player.config.vimeo;
</code></td></tr><tr><td id="L5456" class="css-a4x74f"><span>5456</span></td><td id="LC5456" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L5457" class="css-a4x74f"><span>5457</span></td><td id="LC5457" class="css-1dcdqdg"><code>        premium,
</code></td></tr><tr><td id="L5458" class="css-a4x74f"><span>5458</span></td><td id="LC5458" class="css-1dcdqdg"><code>        referrerPolicy,
</code></td></tr><tr><td id="L5459" class="css-a4x74f"><span>5459</span></td><td id="LC5459" class="css-1dcdqdg"><code>        ...frameParams
</code></td></tr><tr><td id="L5460" class="css-a4x74f"><span>5460</span></td><td id="LC5460" class="css-1dcdqdg"><code>      } = config;
</code></td></tr><tr><td id="L5461" class="css-a4x74f"><span>5461</span></td><td id="LC5461" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the source URL or ID</span>
</code></td></tr><tr><td id="L5462" class="css-a4x74f"><span>5462</span></td><td id="LC5462" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> source = player.media.getAttribute(<span class="code-string">'src'</span>);
</code></td></tr><tr><td id="L5463" class="css-a4x74f"><span>5463</span></td><td id="LC5463" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> hash = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L5464" class="css-a4x74f"><span>5464</span></td><td id="LC5464" class="css-1dcdqdg"><code>      <span class="code-comment">// Get from &lt;div&gt; if needed</span>
</code></td></tr><tr><td id="L5465" class="css-a4x74f"><span>5465</span></td><td id="LC5465" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(source)) {
</code></td></tr><tr><td id="L5466" class="css-a4x74f"><span>5466</span></td><td id="LC5466" class="css-1dcdqdg"><code>        source = player.media.getAttribute(player.config.attributes.embed.id);
</code></td></tr><tr><td id="L5467" class="css-a4x74f"><span>5467</span></td><td id="LC5467" class="css-1dcdqdg"><code>        <span class="code-comment">// hash can also be set as attribute on the &lt;div&gt;</span>
</code></td></tr><tr><td id="L5468" class="css-a4x74f"><span>5468</span></td><td id="LC5468" class="css-1dcdqdg"><code>        hash = player.media.getAttribute(player.config.attributes.embed.hash);
</code></td></tr><tr><td id="L5469" class="css-a4x74f"><span>5469</span></td><td id="LC5469" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5470" class="css-a4x74f"><span>5470</span></td><td id="LC5470" class="css-1dcdqdg"><code>        hash = parseHash(source);
</code></td></tr><tr><td id="L5471" class="css-a4x74f"><span>5471</span></td><td id="LC5471" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5472" class="css-a4x74f"><span>5472</span></td><td id="LC5472" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> hashParam = hash ? {
</code></td></tr><tr><td id="L5473" class="css-a4x74f"><span>5473</span></td><td id="LC5473" class="css-1dcdqdg"><code>        h: hash
</code></td></tr><tr><td id="L5474" class="css-a4x74f"><span>5474</span></td><td id="LC5474" class="css-1dcdqdg"><code>      } : {};
</code></td></tr><tr><td id="L5475" class="css-a4x74f"><span>5475</span></td><td id="LC5475" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5476" class="css-a4x74f"><span>5476</span></td><td id="LC5476" class="css-1dcdqdg"><code>      <span class="code-comment">// If the owner has a pro or premium account then we can hide controls etc</span>
</code></td></tr><tr><td id="L5477" class="css-a4x74f"><span>5477</span></td><td id="LC5477" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (premium) {
</code></td></tr><tr><td id="L5478" class="css-a4x74f"><span>5478</span></td><td id="LC5478" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.assign(frameParams, {
</code></td></tr><tr><td id="L5479" class="css-a4x74f"><span>5479</span></td><td id="LC5479" class="css-1dcdqdg"><code>          controls: <span class="code-literal">false</span>,
</code></td></tr><tr><td id="L5480" class="css-a4x74f"><span>5480</span></td><td id="LC5480" class="css-1dcdqdg"><code>          sidedock: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L5481" class="css-a4x74f"><span>5481</span></td><td id="LC5481" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5482" class="css-a4x74f"><span>5482</span></td><td id="LC5482" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5483" class="css-a4x74f"><span>5483</span></td><td id="LC5483" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5484" class="css-a4x74f"><span>5484</span></td><td id="LC5484" class="css-1dcdqdg"><code>      <span class="code-comment">// Get Vimeo params for the iframe</span>
</code></td></tr><tr><td id="L5485" class="css-a4x74f"><span>5485</span></td><td id="LC5485" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> params = buildUrlParams({
</code></td></tr><tr><td id="L5486" class="css-a4x74f"><span>5486</span></td><td id="LC5486" class="css-1dcdqdg"><code>        loop: player.config.loop.active,
</code></td></tr><tr><td id="L5487" class="css-a4x74f"><span>5487</span></td><td id="LC5487" class="css-1dcdqdg"><code>        autoplay: player.autoplay,
</code></td></tr><tr><td id="L5488" class="css-a4x74f"><span>5488</span></td><td id="LC5488" class="css-1dcdqdg"><code>        muted: player.muted,
</code></td></tr><tr><td id="L5489" class="css-a4x74f"><span>5489</span></td><td id="LC5489" class="css-1dcdqdg"><code>        gesture: <span class="code-string">'media'</span>,
</code></td></tr><tr><td id="L5490" class="css-a4x74f"><span>5490</span></td><td id="LC5490" class="css-1dcdqdg"><code>        playsinline: player.config.playsinline,
</code></td></tr><tr><td id="L5491" class="css-a4x74f"><span>5491</span></td><td id="LC5491" class="css-1dcdqdg"><code>        <span class="code-comment">// hash has to be added to iframe-URL</span>
</code></td></tr><tr><td id="L5492" class="css-a4x74f"><span>5492</span></td><td id="LC5492" class="css-1dcdqdg"><code>        ...hashParam,
</code></td></tr><tr><td id="L5493" class="css-a4x74f"><span>5493</span></td><td id="LC5493" class="css-1dcdqdg"><code>        ...frameParams
</code></td></tr><tr><td id="L5494" class="css-a4x74f"><span>5494</span></td><td id="LC5494" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5495" class="css-a4x74f"><span>5495</span></td><td id="LC5495" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> id = parseId$<span class="code-number">1</span>(source);
</code></td></tr><tr><td id="L5496" class="css-a4x74f"><span>5496</span></td><td id="LC5496" class="css-1dcdqdg"><code>      <span class="code-comment">// Build an iframe</span>
</code></td></tr><tr><td id="L5497" class="css-a4x74f"><span>5497</span></td><td id="LC5497" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> iframe = createElement(<span class="code-string">'iframe'</span>);
</code></td></tr><tr><td id="L5498" class="css-a4x74f"><span>5498</span></td><td id="LC5498" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> src = format(player.config.urls.vimeo.iframe, id, params);
</code></td></tr><tr><td id="L5499" class="css-a4x74f"><span>5499</span></td><td id="LC5499" class="css-1dcdqdg"><code>      iframe.setAttribute(<span class="code-string">'src'</span>, src);
</code></td></tr><tr><td id="L5500" class="css-a4x74f"><span>5500</span></td><td id="LC5500" class="css-1dcdqdg"><code>      iframe.setAttribute(<span class="code-string">'allowfullscreen'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L5501" class="css-a4x74f"><span>5501</span></td><td id="LC5501" class="css-1dcdqdg"><code>      iframe.setAttribute(<span class="code-string">'allow'</span>, [<span class="code-string">'autoplay'</span>, <span class="code-string">'fullscreen'</span>, <span class="code-string">'picture-in-picture'</span>, <span class="code-string">'encrypted-media'</span>, <span class="code-string">'accelerometer'</span>, <span class="code-string">'gyroscope'</span>].join(<span class="code-string">'; '</span>));
</code></td></tr><tr><td id="L5502" class="css-a4x74f"><span>5502</span></td><td id="LC5502" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5503" class="css-a4x74f"><span>5503</span></td><td id="LC5503" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the referrer policy if required</span>
</code></td></tr><tr><td id="L5504" class="css-a4x74f"><span>5504</span></td><td id="LC5504" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(referrerPolicy)) {
</code></td></tr><tr><td id="L5505" class="css-a4x74f"><span>5505</span></td><td id="LC5505" class="css-1dcdqdg"><code>        iframe.setAttribute(<span class="code-string">'referrerPolicy'</span>, referrerPolicy);
</code></td></tr><tr><td id="L5506" class="css-a4x74f"><span>5506</span></td><td id="LC5506" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5507" class="css-a4x74f"><span>5507</span></td><td id="LC5507" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5508" class="css-a4x74f"><span>5508</span></td><td id="LC5508" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject the package</span>
</code></td></tr><tr><td id="L5509" class="css-a4x74f"><span>5509</span></td><td id="LC5509" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (premium || !config.customControls) {
</code></td></tr><tr><td id="L5510" class="css-a4x74f"><span>5510</span></td><td id="LC5510" class="css-1dcdqdg"><code>        iframe.setAttribute(<span class="code-string">'data-poster'</span>, player.poster);
</code></td></tr><tr><td id="L5511" class="css-a4x74f"><span>5511</span></td><td id="LC5511" class="css-1dcdqdg"><code>        player.media = replaceElement(iframe, player.media);
</code></td></tr><tr><td id="L5512" class="css-a4x74f"><span>5512</span></td><td id="LC5512" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5513" class="css-a4x74f"><span>5513</span></td><td id="LC5513" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> wrapper = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L5514" class="css-a4x74f"><span>5514</span></td><td id="LC5514" class="css-1dcdqdg"><code>          class: player.config.classNames.embedContainer,
</code></td></tr><tr><td id="L5515" class="css-a4x74f"><span>5515</span></td><td id="LC5515" class="css-1dcdqdg"><code>          <span class="code-string">'data-poster'</span>: player.poster
</code></td></tr><tr><td id="L5516" class="css-a4x74f"><span>5516</span></td><td id="LC5516" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5517" class="css-a4x74f"><span>5517</span></td><td id="LC5517" class="css-1dcdqdg"><code>        wrapper.appendChild(iframe);
</code></td></tr><tr><td id="L5518" class="css-a4x74f"><span>5518</span></td><td id="LC5518" class="css-1dcdqdg"><code>        player.media = replaceElement(wrapper, player.media);
</code></td></tr><tr><td id="L5519" class="css-a4x74f"><span>5519</span></td><td id="LC5519" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5520" class="css-a4x74f"><span>5520</span></td><td id="LC5520" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5521" class="css-a4x74f"><span>5521</span></td><td id="LC5521" class="css-1dcdqdg"><code>      <span class="code-comment">// Get poster image</span>
</code></td></tr><tr><td id="L5522" class="css-a4x74f"><span>5522</span></td><td id="LC5522" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!config.customControls) {
</code></td></tr><tr><td id="L5523" class="css-a4x74f"><span>5523</span></td><td id="LC5523" class="css-1dcdqdg"><code>        fetch(format(player.config.urls.vimeo.api, src)).then(<span class="code-function"><span class="code-params">response</span> =&gt;</span> {
</code></td></tr><tr><td id="L5524" class="css-a4x74f"><span>5524</span></td><td id="LC5524" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(response) || !response.thumbnail_url) {
</code></td></tr><tr><td id="L5525" class="css-a4x74f"><span>5525</span></td><td id="LC5525" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5526" class="css-a4x74f"><span>5526</span></td><td id="LC5526" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5527" class="css-a4x74f"><span>5527</span></td><td id="LC5527" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5528" class="css-a4x74f"><span>5528</span></td><td id="LC5528" class="css-1dcdqdg"><code>          <span class="code-comment">// Set and show poster</span>
</code></td></tr><tr><td id="L5529" class="css-a4x74f"><span>5529</span></td><td id="LC5529" class="css-1dcdqdg"><code>          ui.setPoster.call(player, response.thumbnail_url).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L5530" class="css-a4x74f"><span>5530</span></td><td id="LC5530" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5531" class="css-a4x74f"><span>5531</span></td><td id="LC5531" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5532" class="css-a4x74f"><span>5532</span></td><td id="LC5532" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5533" class="css-a4x74f"><span>5533</span></td><td id="LC5533" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup instance</span>
</code></td></tr><tr><td id="L5534" class="css-a4x74f"><span>5534</span></td><td id="LC5534" class="css-1dcdqdg"><code>      <span class="code-comment">// https://github.com/vimeo/player.js</span>
</code></td></tr><tr><td id="L5535" class="css-a4x74f"><span>5535</span></td><td id="LC5535" class="css-1dcdqdg"><code>      player.embed = <span class="code-keyword">new</span> <span class="code-built_in">window</span>.Vimeo.Player(iframe, {
</code></td></tr><tr><td id="L5536" class="css-a4x74f"><span>5536</span></td><td id="LC5536" class="css-1dcdqdg"><code>        autopause: player.config.autopause,
</code></td></tr><tr><td id="L5537" class="css-a4x74f"><span>5537</span></td><td id="LC5537" class="css-1dcdqdg"><code>        muted: player.muted
</code></td></tr><tr><td id="L5538" class="css-a4x74f"><span>5538</span></td><td id="LC5538" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5539" class="css-a4x74f"><span>5539</span></td><td id="LC5539" class="css-1dcdqdg"><code>      player.media.paused = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5540" class="css-a4x74f"><span>5540</span></td><td id="LC5540" class="css-1dcdqdg"><code>      player.media.currentTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L5541" class="css-a4x74f"><span>5541</span></td><td id="LC5541" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5542" class="css-a4x74f"><span>5542</span></td><td id="LC5542" class="css-1dcdqdg"><code>      <span class="code-comment">// Disable native text track rendering</span>
</code></td></tr><tr><td id="L5543" class="css-a4x74f"><span>5543</span></td><td id="LC5543" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (player.supported.ui) {
</code></td></tr><tr><td id="L5544" class="css-a4x74f"><span>5544</span></td><td id="LC5544" class="css-1dcdqdg"><code>        player.embed.disableTextTrack();
</code></td></tr><tr><td id="L5545" class="css-a4x74f"><span>5545</span></td><td id="LC5545" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5546" class="css-a4x74f"><span>5546</span></td><td id="LC5546" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5547" class="css-a4x74f"><span>5547</span></td><td id="LC5547" class="css-1dcdqdg"><code>      <span class="code-comment">// Create a faux HTML5 API using the Vimeo API</span>
</code></td></tr><tr><td id="L5548" class="css-a4x74f"><span>5548</span></td><td id="LC5548" class="css-1dcdqdg"><code>      player.media.play = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5549" class="css-a4x74f"><span>5549</span></td><td id="LC5549" class="css-1dcdqdg"><code>        assurePlaybackState$<span class="code-number">1.</span>call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L5550" class="css-a4x74f"><span>5550</span></td><td id="LC5550" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> player.embed.play();
</code></td></tr><tr><td id="L5551" class="css-a4x74f"><span>5551</span></td><td id="LC5551" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5552" class="css-a4x74f"><span>5552</span></td><td id="LC5552" class="css-1dcdqdg"><code>      player.media.pause = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5553" class="css-a4x74f"><span>5553</span></td><td id="LC5553" class="css-1dcdqdg"><code>        assurePlaybackState$<span class="code-number">1.</span>call(player, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L5554" class="css-a4x74f"><span>5554</span></td><td id="LC5554" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> player.embed.pause();
</code></td></tr><tr><td id="L5555" class="css-a4x74f"><span>5555</span></td><td id="LC5555" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5556" class="css-a4x74f"><span>5556</span></td><td id="LC5556" class="css-1dcdqdg"><code>      player.media.stop = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5557" class="css-a4x74f"><span>5557</span></td><td id="LC5557" class="css-1dcdqdg"><code>        player.pause();
</code></td></tr><tr><td id="L5558" class="css-a4x74f"><span>5558</span></td><td id="LC5558" class="css-1dcdqdg"><code>        player.currentTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L5559" class="css-a4x74f"><span>5559</span></td><td id="LC5559" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L5560" class="css-a4x74f"><span>5560</span></td><td id="LC5560" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5561" class="css-a4x74f"><span>5561</span></td><td id="LC5561" class="css-1dcdqdg"><code>      <span class="code-comment">// Seeking</span>
</code></td></tr><tr><td id="L5562" class="css-a4x74f"><span>5562</span></td><td id="LC5562" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L5563" class="css-a4x74f"><span>5563</span></td><td id="LC5563" class="css-1dcdqdg"><code>        currentTime
</code></td></tr><tr><td id="L5564" class="css-a4x74f"><span>5564</span></td><td id="LC5564" class="css-1dcdqdg"><code>      } = player.media;
</code></td></tr><tr><td id="L5565" class="css-a4x74f"><span>5565</span></td><td id="LC5565" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'currentTime'</span>, {
</code></td></tr><tr><td id="L5566" class="css-a4x74f"><span>5566</span></td><td id="LC5566" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5567" class="css-a4x74f"><span>5567</span></td><td id="LC5567" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> currentTime;
</code></td></tr><tr><td id="L5568" class="css-a4x74f"><span>5568</span></td><td id="LC5568" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L5569" class="css-a4x74f"><span>5569</span></td><td id="LC5569" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(time) {
</code></td></tr><tr><td id="L5570" class="css-a4x74f"><span>5570</span></td><td id="LC5570" class="css-1dcdqdg"><code>          <span class="code-comment">// Vimeo will automatically play on seek if the video hasn't been played before</span>
</code></td></tr><tr><td id="L5571" class="css-a4x74f"><span>5571</span></td><td id="LC5571" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5572" class="css-a4x74f"><span>5572</span></td><td id="LC5572" class="css-1dcdqdg"><code>          <span class="code-comment">// Get current paused state and volume etc</span>
</code></td></tr><tr><td id="L5573" class="css-a4x74f"><span>5573</span></td><td id="LC5573" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L5574" class="css-a4x74f"><span>5574</span></td><td id="LC5574" class="css-1dcdqdg"><code>            embed,
</code></td></tr><tr><td id="L5575" class="css-a4x74f"><span>5575</span></td><td id="LC5575" class="css-1dcdqdg"><code>            media,
</code></td></tr><tr><td id="L5576" class="css-a4x74f"><span>5576</span></td><td id="LC5576" class="css-1dcdqdg"><code>            paused,
</code></td></tr><tr><td id="L5577" class="css-a4x74f"><span>5577</span></td><td id="LC5577" class="css-1dcdqdg"><code>            volume
</code></td></tr><tr><td id="L5578" class="css-a4x74f"><span>5578</span></td><td id="LC5578" class="css-1dcdqdg"><code>          } = player;
</code></td></tr><tr><td id="L5579" class="css-a4x74f"><span>5579</span></td><td id="LC5579" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> restorePause = paused &amp;&amp; !embed.hasPlayed;
</code></td></tr><tr><td id="L5580" class="css-a4x74f"><span>5580</span></td><td id="LC5580" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5581" class="css-a4x74f"><span>5581</span></td><td id="LC5581" class="css-1dcdqdg"><code>          <span class="code-comment">// Set seeking state and trigger event</span>
</code></td></tr><tr><td id="L5582" class="css-a4x74f"><span>5582</span></td><td id="LC5582" class="css-1dcdqdg"><code>          media.seeking = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5583" class="css-a4x74f"><span>5583</span></td><td id="LC5583" class="css-1dcdqdg"><code>          triggerEvent.call(player, media, <span class="code-string">'seeking'</span>);
</code></td></tr><tr><td id="L5584" class="css-a4x74f"><span>5584</span></td><td id="LC5584" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5585" class="css-a4x74f"><span>5585</span></td><td id="LC5585" class="css-1dcdqdg"><code>          <span class="code-comment">// If paused, mute until seek is complete</span>
</code></td></tr><tr><td id="L5586" class="css-a4x74f"><span>5586</span></td><td id="LC5586" class="css-1dcdqdg"><code>          <span class="code-built_in">Promise</span>.resolve(restorePause &amp;&amp; embed.setVolume(<span class="code-number">0</span>))
</code></td></tr><tr><td id="L5587" class="css-a4x74f"><span>5587</span></td><td id="LC5587" class="css-1dcdqdg"><code>          <span class="code-comment">// Seek</span>
</code></td></tr><tr><td id="L5588" class="css-a4x74f"><span>5588</span></td><td id="LC5588" class="css-1dcdqdg"><code>          .then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> embed.setCurrentTime(time))
</code></td></tr><tr><td id="L5589" class="css-a4x74f"><span>5589</span></td><td id="LC5589" class="css-1dcdqdg"><code>          <span class="code-comment">// Restore paused</span>
</code></td></tr><tr><td id="L5590" class="css-a4x74f"><span>5590</span></td><td id="LC5590" class="css-1dcdqdg"><code>          .then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> restorePause &amp;&amp; embed.pause())
</code></td></tr><tr><td id="L5591" class="css-a4x74f"><span>5591</span></td><td id="LC5591" class="css-1dcdqdg"><code>          <span class="code-comment">// Restore volume</span>
</code></td></tr><tr><td id="L5592" class="css-a4x74f"><span>5592</span></td><td id="LC5592" class="css-1dcdqdg"><code>          .then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> restorePause &amp;&amp; embed.setVolume(volume)).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5593" class="css-a4x74f"><span>5593</span></td><td id="LC5593" class="css-1dcdqdg"><code>            <span class="code-comment">// Do nothing</span>
</code></td></tr><tr><td id="L5594" class="css-a4x74f"><span>5594</span></td><td id="LC5594" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L5595" class="css-a4x74f"><span>5595</span></td><td id="LC5595" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5596" class="css-a4x74f"><span>5596</span></td><td id="LC5596" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5597" class="css-a4x74f"><span>5597</span></td><td id="LC5597" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5598" class="css-a4x74f"><span>5598</span></td><td id="LC5598" class="css-1dcdqdg"><code>      <span class="code-comment">// Playback speed</span>
</code></td></tr><tr><td id="L5599" class="css-a4x74f"><span>5599</span></td><td id="LC5599" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> speed = player.config.speed.selected;
</code></td></tr><tr><td id="L5600" class="css-a4x74f"><span>5600</span></td><td id="LC5600" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'playbackRate'</span>, {
</code></td></tr><tr><td id="L5601" class="css-a4x74f"><span>5601</span></td><td id="LC5601" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5602" class="css-a4x74f"><span>5602</span></td><td id="LC5602" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> speed;
</code></td></tr><tr><td id="L5603" class="css-a4x74f"><span>5603</span></td><td id="LC5603" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L5604" class="css-a4x74f"><span>5604</span></td><td id="LC5604" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L5605" class="css-a4x74f"><span>5605</span></td><td id="LC5605" class="css-1dcdqdg"><code>          player.embed.setPlaybackRate(input).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5606" class="css-a4x74f"><span>5606</span></td><td id="LC5606" class="css-1dcdqdg"><code>            speed = input;
</code></td></tr><tr><td id="L5607" class="css-a4x74f"><span>5607</span></td><td id="LC5607" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'ratechange'</span>);
</code></td></tr><tr><td id="L5608" class="css-a4x74f"><span>5608</span></td><td id="LC5608" class="css-1dcdqdg"><code>          }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5609" class="css-a4x74f"><span>5609</span></td><td id="LC5609" class="css-1dcdqdg"><code>            <span class="code-comment">// Cannot set Playback Rate, Video is probably not on Pro account</span>
</code></td></tr><tr><td id="L5610" class="css-a4x74f"><span>5610</span></td><td id="LC5610" class="css-1dcdqdg"><code>            player.options.speed = [<span class="code-number">1</span>];
</code></td></tr><tr><td id="L5611" class="css-a4x74f"><span>5611</span></td><td id="LC5611" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L5612" class="css-a4x74f"><span>5612</span></td><td id="LC5612" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5613" class="css-a4x74f"><span>5613</span></td><td id="LC5613" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5614" class="css-a4x74f"><span>5614</span></td><td id="LC5614" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5615" class="css-a4x74f"><span>5615</span></td><td id="LC5615" class="css-1dcdqdg"><code>      <span class="code-comment">// Volume</span>
</code></td></tr><tr><td id="L5616" class="css-a4x74f"><span>5616</span></td><td id="LC5616" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L5617" class="css-a4x74f"><span>5617</span></td><td id="LC5617" class="css-1dcdqdg"><code>        volume
</code></td></tr><tr><td id="L5618" class="css-a4x74f"><span>5618</span></td><td id="LC5618" class="css-1dcdqdg"><code>      } = player.config;
</code></td></tr><tr><td id="L5619" class="css-a4x74f"><span>5619</span></td><td id="LC5619" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'volume'</span>, {
</code></td></tr><tr><td id="L5620" class="css-a4x74f"><span>5620</span></td><td id="LC5620" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5621" class="css-a4x74f"><span>5621</span></td><td id="LC5621" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> volume;
</code></td></tr><tr><td id="L5622" class="css-a4x74f"><span>5622</span></td><td id="LC5622" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L5623" class="css-a4x74f"><span>5623</span></td><td id="LC5623" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L5624" class="css-a4x74f"><span>5624</span></td><td id="LC5624" class="css-1dcdqdg"><code>          player.embed.setVolume(input).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5625" class="css-a4x74f"><span>5625</span></td><td id="LC5625" class="css-1dcdqdg"><code>            volume = input;
</code></td></tr><tr><td id="L5626" class="css-a4x74f"><span>5626</span></td><td id="LC5626" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'volumechange'</span>);
</code></td></tr><tr><td id="L5627" class="css-a4x74f"><span>5627</span></td><td id="LC5627" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L5628" class="css-a4x74f"><span>5628</span></td><td id="LC5628" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5629" class="css-a4x74f"><span>5629</span></td><td id="LC5629" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5630" class="css-a4x74f"><span>5630</span></td><td id="LC5630" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5631" class="css-a4x74f"><span>5631</span></td><td id="LC5631" class="css-1dcdqdg"><code>      <span class="code-comment">// Muted</span>
</code></td></tr><tr><td id="L5632" class="css-a4x74f"><span>5632</span></td><td id="LC5632" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L5633" class="css-a4x74f"><span>5633</span></td><td id="LC5633" class="css-1dcdqdg"><code>        muted
</code></td></tr><tr><td id="L5634" class="css-a4x74f"><span>5634</span></td><td id="LC5634" class="css-1dcdqdg"><code>      } = player.config;
</code></td></tr><tr><td id="L5635" class="css-a4x74f"><span>5635</span></td><td id="LC5635" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'muted'</span>, {
</code></td></tr><tr><td id="L5636" class="css-a4x74f"><span>5636</span></td><td id="LC5636" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5637" class="css-a4x74f"><span>5637</span></td><td id="LC5637" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> muted;
</code></td></tr><tr><td id="L5638" class="css-a4x74f"><span>5638</span></td><td id="LC5638" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L5639" class="css-a4x74f"><span>5639</span></td><td id="LC5639" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L5640" class="css-a4x74f"><span>5640</span></td><td id="LC5640" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L5641" class="css-a4x74f"><span>5641</span></td><td id="LC5641" class="css-1dcdqdg"><code>          player.embed.setMuted(toggle ? <span class="code-literal">true</span> : player.config.muted).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5642" class="css-a4x74f"><span>5642</span></td><td id="LC5642" class="css-1dcdqdg"><code>            muted = toggle;
</code></td></tr><tr><td id="L5643" class="css-a4x74f"><span>5643</span></td><td id="LC5643" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'volumechange'</span>);
</code></td></tr><tr><td id="L5644" class="css-a4x74f"><span>5644</span></td><td id="LC5644" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L5645" class="css-a4x74f"><span>5645</span></td><td id="LC5645" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5646" class="css-a4x74f"><span>5646</span></td><td id="LC5646" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5647" class="css-a4x74f"><span>5647</span></td><td id="LC5647" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5648" class="css-a4x74f"><span>5648</span></td><td id="LC5648" class="css-1dcdqdg"><code>      <span class="code-comment">// Loop</span>
</code></td></tr><tr><td id="L5649" class="css-a4x74f"><span>5649</span></td><td id="LC5649" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L5650" class="css-a4x74f"><span>5650</span></td><td id="LC5650" class="css-1dcdqdg"><code>        loop
</code></td></tr><tr><td id="L5651" class="css-a4x74f"><span>5651</span></td><td id="LC5651" class="css-1dcdqdg"><code>      } = player.config;
</code></td></tr><tr><td id="L5652" class="css-a4x74f"><span>5652</span></td><td id="LC5652" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'loop'</span>, {
</code></td></tr><tr><td id="L5653" class="css-a4x74f"><span>5653</span></td><td id="LC5653" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5654" class="css-a4x74f"><span>5654</span></td><td id="LC5654" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> loop;
</code></td></tr><tr><td id="L5655" class="css-a4x74f"><span>5655</span></td><td id="LC5655" class="css-1dcdqdg"><code>        },
</code></td></tr><tr><td id="L5656" class="css-a4x74f"><span>5656</span></td><td id="LC5656" class="css-1dcdqdg"><code>        <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L5657" class="css-a4x74f"><span>5657</span></td><td id="LC5657" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : player.config.loop.active;
</code></td></tr><tr><td id="L5658" class="css-a4x74f"><span>5658</span></td><td id="LC5658" class="css-1dcdqdg"><code>          player.embed.setLoop(toggle).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5659" class="css-a4x74f"><span>5659</span></td><td id="LC5659" class="css-1dcdqdg"><code>            loop = toggle;
</code></td></tr><tr><td id="L5660" class="css-a4x74f"><span>5660</span></td><td id="LC5660" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L5661" class="css-a4x74f"><span>5661</span></td><td id="LC5661" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5662" class="css-a4x74f"><span>5662</span></td><td id="LC5662" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5663" class="css-a4x74f"><span>5663</span></td><td id="LC5663" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5664" class="css-a4x74f"><span>5664</span></td><td id="LC5664" class="css-1dcdqdg"><code>      <span class="code-comment">// Source</span>
</code></td></tr><tr><td id="L5665" class="css-a4x74f"><span>5665</span></td><td id="LC5665" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> currentSrc;
</code></td></tr><tr><td id="L5666" class="css-a4x74f"><span>5666</span></td><td id="LC5666" class="css-1dcdqdg"><code>      player.embed.getVideoUrl().then(<span class="code-function"><span class="code-params">value</span> =&gt;</span> {
</code></td></tr><tr><td id="L5667" class="css-a4x74f"><span>5667</span></td><td id="LC5667" class="css-1dcdqdg"><code>        currentSrc = value;
</code></td></tr><tr><td id="L5668" class="css-a4x74f"><span>5668</span></td><td id="LC5668" class="css-1dcdqdg"><code>        controls.setDownloadUrl.call(player);
</code></td></tr><tr><td id="L5669" class="css-a4x74f"><span>5669</span></td><td id="LC5669" class="css-1dcdqdg"><code>      }).catch(<span class="code-function"><span class="code-params">error</span> =&gt;</span> {
</code></td></tr><tr><td id="L5670" class="css-a4x74f"><span>5670</span></td><td id="LC5670" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(error);
</code></td></tr><tr><td id="L5671" class="css-a4x74f"><span>5671</span></td><td id="LC5671" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5672" class="css-a4x74f"><span>5672</span></td><td id="LC5672" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'currentSrc'</span>, {
</code></td></tr><tr><td id="L5673" class="css-a4x74f"><span>5673</span></td><td id="LC5673" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5674" class="css-a4x74f"><span>5674</span></td><td id="LC5674" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> currentSrc;
</code></td></tr><tr><td id="L5675" class="css-a4x74f"><span>5675</span></td><td id="LC5675" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5676" class="css-a4x74f"><span>5676</span></td><td id="LC5676" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5677" class="css-a4x74f"><span>5677</span></td><td id="LC5677" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5678" class="css-a4x74f"><span>5678</span></td><td id="LC5678" class="css-1dcdqdg"><code>      <span class="code-comment">// Ended</span>
</code></td></tr><tr><td id="L5679" class="css-a4x74f"><span>5679</span></td><td id="LC5679" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'ended'</span>, {
</code></td></tr><tr><td id="L5680" class="css-a4x74f"><span>5680</span></td><td id="LC5680" class="css-1dcdqdg"><code>        <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L5681" class="css-a4x74f"><span>5681</span></td><td id="LC5681" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> player.currentTime === player.duration;
</code></td></tr><tr><td id="L5682" class="css-a4x74f"><span>5682</span></td><td id="LC5682" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5683" class="css-a4x74f"><span>5683</span></td><td id="LC5683" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5684" class="css-a4x74f"><span>5684</span></td><td id="LC5684" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5685" class="css-a4x74f"><span>5685</span></td><td id="LC5685" class="css-1dcdqdg"><code>      <span class="code-comment">// Set aspect ratio based on video size</span>
</code></td></tr><tr><td id="L5686" class="css-a4x74f"><span>5686</span></td><td id="LC5686" class="css-1dcdqdg"><code>      <span class="code-built_in">Promise</span>.all([player.embed.getVideoWidth(), player.embed.getVideoHeight()]).then(<span class="code-function"><span class="code-params">dimensions</span> =&gt;</span> {
</code></td></tr><tr><td id="L5687" class="css-a4x74f"><span>5687</span></td><td id="LC5687" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> [width, height] = dimensions;
</code></td></tr><tr><td id="L5688" class="css-a4x74f"><span>5688</span></td><td id="LC5688" class="css-1dcdqdg"><code>        player.embed.ratio = roundAspectRatio(width, height);
</code></td></tr><tr><td id="L5689" class="css-a4x74f"><span>5689</span></td><td id="LC5689" class="css-1dcdqdg"><code>        setAspectRatio.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5690" class="css-a4x74f"><span>5690</span></td><td id="LC5690" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5691" class="css-a4x74f"><span>5691</span></td><td id="LC5691" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5692" class="css-a4x74f"><span>5692</span></td><td id="LC5692" class="css-1dcdqdg"><code>      <span class="code-comment">// Set autopause</span>
</code></td></tr><tr><td id="L5693" class="css-a4x74f"><span>5693</span></td><td id="LC5693" class="css-1dcdqdg"><code>      player.embed.setAutopause(player.config.autopause).then(<span class="code-function"><span class="code-params">state</span> =&gt;</span> {
</code></td></tr><tr><td id="L5694" class="css-a4x74f"><span>5694</span></td><td id="LC5694" class="css-1dcdqdg"><code>        player.config.autopause = state;
</code></td></tr><tr><td id="L5695" class="css-a4x74f"><span>5695</span></td><td id="LC5695" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5696" class="css-a4x74f"><span>5696</span></td><td id="LC5696" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5697" class="css-a4x74f"><span>5697</span></td><td id="LC5697" class="css-1dcdqdg"><code>      <span class="code-comment">// Get title</span>
</code></td></tr><tr><td id="L5698" class="css-a4x74f"><span>5698</span></td><td id="LC5698" class="css-1dcdqdg"><code>      player.embed.getVideoTitle().then(<span class="code-function"><span class="code-params">title</span> =&gt;</span> {
</code></td></tr><tr><td id="L5699" class="css-a4x74f"><span>5699</span></td><td id="LC5699" class="css-1dcdqdg"><code>        player.config.title = title;
</code></td></tr><tr><td id="L5700" class="css-a4x74f"><span>5700</span></td><td id="LC5700" class="css-1dcdqdg"><code>        ui.setTitle.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5701" class="css-a4x74f"><span>5701</span></td><td id="LC5701" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5702" class="css-a4x74f"><span>5702</span></td><td id="LC5702" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5703" class="css-a4x74f"><span>5703</span></td><td id="LC5703" class="css-1dcdqdg"><code>      <span class="code-comment">// Get current time</span>
</code></td></tr><tr><td id="L5704" class="css-a4x74f"><span>5704</span></td><td id="LC5704" class="css-1dcdqdg"><code>      player.embed.getCurrentTime().then(<span class="code-function"><span class="code-params">value</span> =&gt;</span> {
</code></td></tr><tr><td id="L5705" class="css-a4x74f"><span>5705</span></td><td id="LC5705" class="css-1dcdqdg"><code>        currentTime = value;
</code></td></tr><tr><td id="L5706" class="css-a4x74f"><span>5706</span></td><td id="LC5706" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'timeupdate'</span>);
</code></td></tr><tr><td id="L5707" class="css-a4x74f"><span>5707</span></td><td id="LC5707" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5708" class="css-a4x74f"><span>5708</span></td><td id="LC5708" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5709" class="css-a4x74f"><span>5709</span></td><td id="LC5709" class="css-1dcdqdg"><code>      <span class="code-comment">// Get duration</span>
</code></td></tr><tr><td id="L5710" class="css-a4x74f"><span>5710</span></td><td id="LC5710" class="css-1dcdqdg"><code>      player.embed.getDuration().then(<span class="code-function"><span class="code-params">value</span> =&gt;</span> {
</code></td></tr><tr><td id="L5711" class="css-a4x74f"><span>5711</span></td><td id="LC5711" class="css-1dcdqdg"><code>        player.media.duration = value;
</code></td></tr><tr><td id="L5712" class="css-a4x74f"><span>5712</span></td><td id="LC5712" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'durationchange'</span>);
</code></td></tr><tr><td id="L5713" class="css-a4x74f"><span>5713</span></td><td id="LC5713" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5714" class="css-a4x74f"><span>5714</span></td><td id="LC5714" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5715" class="css-a4x74f"><span>5715</span></td><td id="LC5715" class="css-1dcdqdg"><code>      <span class="code-comment">// Get captions</span>
</code></td></tr><tr><td id="L5716" class="css-a4x74f"><span>5716</span></td><td id="LC5716" class="css-1dcdqdg"><code>      player.embed.getTextTracks().then(<span class="code-function"><span class="code-params">tracks</span> =&gt;</span> {
</code></td></tr><tr><td id="L5717" class="css-a4x74f"><span>5717</span></td><td id="LC5717" class="css-1dcdqdg"><code>        player.media.textTracks = tracks;
</code></td></tr><tr><td id="L5718" class="css-a4x74f"><span>5718</span></td><td id="LC5718" class="css-1dcdqdg"><code>        captions.setup.call(player);
</code></td></tr><tr><td id="L5719" class="css-a4x74f"><span>5719</span></td><td id="LC5719" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5720" class="css-a4x74f"><span>5720</span></td><td id="LC5720" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'cuechange'</span>, ({
</code></td></tr><tr><td id="L5721" class="css-a4x74f"><span>5721</span></td><td id="LC5721" class="css-1dcdqdg"><code>        cues = []
</code></td></tr><tr><td id="L5722" class="css-a4x74f"><span>5722</span></td><td id="LC5722" class="css-1dcdqdg"><code>      }) =&gt; {
</code></td></tr><tr><td id="L5723" class="css-a4x74f"><span>5723</span></td><td id="LC5723" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> strippedCues = cues.map(<span class="code-function"><span class="code-params">cue</span> =&gt;</span> stripHTML(cue.text));
</code></td></tr><tr><td id="L5724" class="css-a4x74f"><span>5724</span></td><td id="LC5724" class="css-1dcdqdg"><code>        captions.updateCues.call(player, strippedCues);
</code></td></tr><tr><td id="L5725" class="css-a4x74f"><span>5725</span></td><td id="LC5725" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5726" class="css-a4x74f"><span>5726</span></td><td id="LC5726" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'loaded'</span>, () =&gt; {
</code></td></tr><tr><td id="L5727" class="css-a4x74f"><span>5727</span></td><td id="LC5727" class="css-1dcdqdg"><code>        <span class="code-comment">// Assure state and events are updated on autoplay</span>
</code></td></tr><tr><td id="L5728" class="css-a4x74f"><span>5728</span></td><td id="LC5728" class="css-1dcdqdg"><code>        player.embed.getPaused().then(<span class="code-function"><span class="code-params">paused</span> =&gt;</span> {
</code></td></tr><tr><td id="L5729" class="css-a4x74f"><span>5729</span></td><td id="LC5729" class="css-1dcdqdg"><code>          assurePlaybackState$<span class="code-number">1.</span>call(player, !paused);
</code></td></tr><tr><td id="L5730" class="css-a4x74f"><span>5730</span></td><td id="LC5730" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!paused) {
</code></td></tr><tr><td id="L5731" class="css-a4x74f"><span>5731</span></td><td id="LC5731" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'playing'</span>);
</code></td></tr><tr><td id="L5732" class="css-a4x74f"><span>5732</span></td><td id="LC5732" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5733" class="css-a4x74f"><span>5733</span></td><td id="LC5733" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5734" class="css-a4x74f"><span>5734</span></td><td id="LC5734" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(player.embed.element) &amp;&amp; player.supported.ui) {
</code></td></tr><tr><td id="L5735" class="css-a4x74f"><span>5735</span></td><td id="LC5735" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> frame = player.embed.element;
</code></td></tr><tr><td id="L5736" class="css-a4x74f"><span>5736</span></td><td id="LC5736" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5737" class="css-a4x74f"><span>5737</span></td><td id="LC5737" class="css-1dcdqdg"><code>          <span class="code-comment">// Fix keyboard focus issues</span>
</code></td></tr><tr><td id="L5738" class="css-a4x74f"><span>5738</span></td><td id="LC5738" class="css-1dcdqdg"><code>          <span class="code-comment">// https://github.com/sampotts/plyr/issues/317</span>
</code></td></tr><tr><td id="L5739" class="css-a4x74f"><span>5739</span></td><td id="LC5739" class="css-1dcdqdg"><code>          frame.setAttribute(<span class="code-string">'tabindex'</span>, <span class="code-number">-1</span>);
</code></td></tr><tr><td id="L5740" class="css-a4x74f"><span>5740</span></td><td id="LC5740" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5741" class="css-a4x74f"><span>5741</span></td><td id="LC5741" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5742" class="css-a4x74f"><span>5742</span></td><td id="LC5742" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'bufferstart'</span>, () =&gt; {
</code></td></tr><tr><td id="L5743" class="css-a4x74f"><span>5743</span></td><td id="LC5743" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'waiting'</span>);
</code></td></tr><tr><td id="L5744" class="css-a4x74f"><span>5744</span></td><td id="LC5744" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5745" class="css-a4x74f"><span>5745</span></td><td id="LC5745" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'bufferend'</span>, () =&gt; {
</code></td></tr><tr><td id="L5746" class="css-a4x74f"><span>5746</span></td><td id="LC5746" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'playing'</span>);
</code></td></tr><tr><td id="L5747" class="css-a4x74f"><span>5747</span></td><td id="LC5747" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5748" class="css-a4x74f"><span>5748</span></td><td id="LC5748" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'play'</span>, () =&gt; {
</code></td></tr><tr><td id="L5749" class="css-a4x74f"><span>5749</span></td><td id="LC5749" class="css-1dcdqdg"><code>        assurePlaybackState$<span class="code-number">1.</span>call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L5750" class="css-a4x74f"><span>5750</span></td><td id="LC5750" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'playing'</span>);
</code></td></tr><tr><td id="L5751" class="css-a4x74f"><span>5751</span></td><td id="LC5751" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5752" class="css-a4x74f"><span>5752</span></td><td id="LC5752" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'pause'</span>, () =&gt; {
</code></td></tr><tr><td id="L5753" class="css-a4x74f"><span>5753</span></td><td id="LC5753" class="css-1dcdqdg"><code>        assurePlaybackState$<span class="code-number">1.</span>call(player, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L5754" class="css-a4x74f"><span>5754</span></td><td id="LC5754" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5755" class="css-a4x74f"><span>5755</span></td><td id="LC5755" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'timeupdate'</span>, data =&gt; {
</code></td></tr><tr><td id="L5756" class="css-a4x74f"><span>5756</span></td><td id="LC5756" class="css-1dcdqdg"><code>        player.media.seeking = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L5757" class="css-a4x74f"><span>5757</span></td><td id="LC5757" class="css-1dcdqdg"><code>        currentTime = data.seconds;
</code></td></tr><tr><td id="L5758" class="css-a4x74f"><span>5758</span></td><td id="LC5758" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'timeupdate'</span>);
</code></td></tr><tr><td id="L5759" class="css-a4x74f"><span>5759</span></td><td id="LC5759" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5760" class="css-a4x74f"><span>5760</span></td><td id="LC5760" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'progress'</span>, data =&gt; {
</code></td></tr><tr><td id="L5761" class="css-a4x74f"><span>5761</span></td><td id="LC5761" class="css-1dcdqdg"><code>        player.media.buffered = data.percent;
</code></td></tr><tr><td id="L5762" class="css-a4x74f"><span>5762</span></td><td id="LC5762" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'progress'</span>);
</code></td></tr><tr><td id="L5763" class="css-a4x74f"><span>5763</span></td><td id="LC5763" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5764" class="css-a4x74f"><span>5764</span></td><td id="LC5764" class="css-1dcdqdg"><code>        <span class="code-comment">// Check all loaded</span>
</code></td></tr><tr><td id="L5765" class="css-a4x74f"><span>5765</span></td><td id="LC5765" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-built_in">parseInt</span>(data.percent, <span class="code-number">10</span>) === <span class="code-number">1</span>) {
</code></td></tr><tr><td id="L5766" class="css-a4x74f"><span>5766</span></td><td id="LC5766" class="css-1dcdqdg"><code>          triggerEvent.call(player, player.media, <span class="code-string">'canplaythrough'</span>);
</code></td></tr><tr><td id="L5767" class="css-a4x74f"><span>5767</span></td><td id="LC5767" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5768" class="css-a4x74f"><span>5768</span></td><td id="LC5768" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5769" class="css-a4x74f"><span>5769</span></td><td id="LC5769" class="css-1dcdqdg"><code>        <span class="code-comment">// Get duration as if we do it before load, it gives an incorrect value</span>
</code></td></tr><tr><td id="L5770" class="css-a4x74f"><span>5770</span></td><td id="LC5770" class="css-1dcdqdg"><code>        <span class="code-comment">// https://github.com/sampotts/plyr/issues/891</span>
</code></td></tr><tr><td id="L5771" class="css-a4x74f"><span>5771</span></td><td id="LC5771" class="css-1dcdqdg"><code>        player.embed.getDuration().then(<span class="code-function"><span class="code-params">value</span> =&gt;</span> {
</code></td></tr><tr><td id="L5772" class="css-a4x74f"><span>5772</span></td><td id="LC5772" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (value !== player.media.duration) {
</code></td></tr><tr><td id="L5773" class="css-a4x74f"><span>5773</span></td><td id="LC5773" class="css-1dcdqdg"><code>            player.media.duration = value;
</code></td></tr><tr><td id="L5774" class="css-a4x74f"><span>5774</span></td><td id="LC5774" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'durationchange'</span>);
</code></td></tr><tr><td id="L5775" class="css-a4x74f"><span>5775</span></td><td id="LC5775" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5776" class="css-a4x74f"><span>5776</span></td><td id="LC5776" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5777" class="css-a4x74f"><span>5777</span></td><td id="LC5777" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5778" class="css-a4x74f"><span>5778</span></td><td id="LC5778" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'seeked'</span>, () =&gt; {
</code></td></tr><tr><td id="L5779" class="css-a4x74f"><span>5779</span></td><td id="LC5779" class="css-1dcdqdg"><code>        player.media.seeking = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L5780" class="css-a4x74f"><span>5780</span></td><td id="LC5780" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'seeked'</span>);
</code></td></tr><tr><td id="L5781" class="css-a4x74f"><span>5781</span></td><td id="LC5781" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5782" class="css-a4x74f"><span>5782</span></td><td id="LC5782" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'ended'</span>, () =&gt; {
</code></td></tr><tr><td id="L5783" class="css-a4x74f"><span>5783</span></td><td id="LC5783" class="css-1dcdqdg"><code>        player.media.paused = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5784" class="css-a4x74f"><span>5784</span></td><td id="LC5784" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'ended'</span>);
</code></td></tr><tr><td id="L5785" class="css-a4x74f"><span>5785</span></td><td id="LC5785" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5786" class="css-a4x74f"><span>5786</span></td><td id="LC5786" class="css-1dcdqdg"><code>      player.embed.on(<span class="code-string">'error'</span>, detail =&gt; {
</code></td></tr><tr><td id="L5787" class="css-a4x74f"><span>5787</span></td><td id="LC5787" class="css-1dcdqdg"><code>        player.media.error = detail;
</code></td></tr><tr><td id="L5788" class="css-a4x74f"><span>5788</span></td><td id="LC5788" class="css-1dcdqdg"><code>        triggerEvent.call(player, player.media, <span class="code-string">'error'</span>);
</code></td></tr><tr><td id="L5789" class="css-a4x74f"><span>5789</span></td><td id="LC5789" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5790" class="css-a4x74f"><span>5790</span></td><td id="LC5790" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5791" class="css-a4x74f"><span>5791</span></td><td id="LC5791" class="css-1dcdqdg"><code>      <span class="code-comment">// Rebuild UI</span>
</code></td></tr><tr><td id="L5792" class="css-a4x74f"><span>5792</span></td><td id="LC5792" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (config.customControls) {
</code></td></tr><tr><td id="L5793" class="css-a4x74f"><span>5793</span></td><td id="LC5793" class="css-1dcdqdg"><code>        setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> ui.build.call(player), <span class="code-number">0</span>);
</code></td></tr><tr><td id="L5794" class="css-a4x74f"><span>5794</span></td><td id="LC5794" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5795" class="css-a4x74f"><span>5795</span></td><td id="LC5795" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5796" class="css-a4x74f"><span>5796</span></td><td id="LC5796" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L5797" class="css-a4x74f"><span>5797</span></td><td id="LC5797" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5798" class="css-a4x74f"><span>5798</span></td><td id="LC5798" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L5799" class="css-a4x74f"><span>5799</span></td><td id="LC5799" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5800" class="css-a4x74f"><span>5800</span></td><td id="LC5800" class="css-1dcdqdg"><code>  <span class="code-comment">// Parse YouTube ID from URL</span>
</code></td></tr><tr><td id="L5801" class="css-a4x74f"><span>5801</span></td><td id="LC5801" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">parseId</span>(<span class="code-params">url</span>) </span>{
</code></td></tr><tr><td id="L5802" class="css-a4x74f"><span>5802</span></td><td id="LC5802" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (is.empty(url)) {
</code></td></tr><tr><td id="L5803" class="css-a4x74f"><span>5803</span></td><td id="LC5803" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L5804" class="css-a4x74f"><span>5804</span></td><td id="LC5804" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5805" class="css-a4x74f"><span>5805</span></td><td id="LC5805" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> regex = <span class="code-regexp">/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&amp;v=)([^#&amp;?]*).*/</span>;
</code></td></tr><tr><td id="L5806" class="css-a4x74f"><span>5806</span></td><td id="LC5806" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> url.match(regex) ? <span class="code-built_in">RegExp</span>.$<span class="code-number">2</span> : url;
</code></td></tr><tr><td id="L5807" class="css-a4x74f"><span>5807</span></td><td id="LC5807" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5808" class="css-a4x74f"><span>5808</span></td><td id="LC5808" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5809" class="css-a4x74f"><span>5809</span></td><td id="LC5809" class="css-1dcdqdg"><code>  <span class="code-comment">// Set playback state and trigger change (only on actual change)</span>
</code></td></tr><tr><td id="L5810" class="css-a4x74f"><span>5810</span></td><td id="LC5810" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">assurePlaybackState</span>(<span class="code-params">play</span>) </span>{
</code></td></tr><tr><td id="L5811" class="css-a4x74f"><span>5811</span></td><td id="LC5811" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (play &amp;&amp; !<span class="code-keyword">this</span>.embed.hasPlayed) {
</code></td></tr><tr><td id="L5812" class="css-a4x74f"><span>5812</span></td><td id="LC5812" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.embed.hasPlayed = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L5813" class="css-a4x74f"><span>5813</span></td><td id="LC5813" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5814" class="css-a4x74f"><span>5814</span></td><td id="LC5814" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.paused === play) {
</code></td></tr><tr><td id="L5815" class="css-a4x74f"><span>5815</span></td><td id="LC5815" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.paused = !play;
</code></td></tr><tr><td id="L5816" class="css-a4x74f"><span>5816</span></td><td id="LC5816" class="css-1dcdqdg"><code>      triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, play ? <span class="code-string">'play'</span> : <span class="code-string">'pause'</span>);
</code></td></tr><tr><td id="L5817" class="css-a4x74f"><span>5817</span></td><td id="LC5817" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5818" class="css-a4x74f"><span>5818</span></td><td id="LC5818" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5819" class="css-a4x74f"><span>5819</span></td><td id="LC5819" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">getHost</span>(<span class="code-params">config</span>) </span>{
</code></td></tr><tr><td id="L5820" class="css-a4x74f"><span>5820</span></td><td id="LC5820" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (config.noCookie) {
</code></td></tr><tr><td id="L5821" class="css-a4x74f"><span>5821</span></td><td id="LC5821" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-string">'https://www.youtube-nocookie.com'</span>;
</code></td></tr><tr><td id="L5822" class="css-a4x74f"><span>5822</span></td><td id="LC5822" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5823" class="css-a4x74f"><span>5823</span></td><td id="LC5823" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (<span class="code-built_in">window</span>.location.protocol === <span class="code-string">'http:'</span>) {
</code></td></tr><tr><td id="L5824" class="css-a4x74f"><span>5824</span></td><td id="LC5824" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-string">'http://www.youtube.com'</span>;
</code></td></tr><tr><td id="L5825" class="css-a4x74f"><span>5825</span></td><td id="LC5825" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L5826" class="css-a4x74f"><span>5826</span></td><td id="LC5826" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5827" class="css-a4x74f"><span>5827</span></td><td id="LC5827" class="css-1dcdqdg"><code>    <span class="code-comment">// Use YouTube's default</span>
</code></td></tr><tr><td id="L5828" class="css-a4x74f"><span>5828</span></td><td id="LC5828" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-literal">undefined</span>;
</code></td></tr><tr><td id="L5829" class="css-a4x74f"><span>5829</span></td><td id="LC5829" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L5830" class="css-a4x74f"><span>5830</span></td><td id="LC5830" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> youtube = {
</code></td></tr><tr><td id="L5831" class="css-a4x74f"><span>5831</span></td><td id="LC5831" class="css-1dcdqdg"><code>    setup() {
</code></td></tr><tr><td id="L5832" class="css-a4x74f"><span>5832</span></td><td id="LC5832" class="css-1dcdqdg"><code>      <span class="code-comment">// Add embed class for responsive</span>
</code></td></tr><tr><td id="L5833" class="css-a4x74f"><span>5833</span></td><td id="LC5833" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.wrapper, <span class="code-keyword">this</span>.config.classNames.embed, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L5834" class="css-a4x74f"><span>5834</span></td><td id="LC5834" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5835" class="css-a4x74f"><span>5835</span></td><td id="LC5835" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup API</span>
</code></td></tr><tr><td id="L5836" class="css-a4x74f"><span>5836</span></td><td id="LC5836" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.object(<span class="code-built_in">window</span>.YT) &amp;&amp; is.function(<span class="code-built_in">window</span>.YT.Player)) {
</code></td></tr><tr><td id="L5837" class="css-a4x74f"><span>5837</span></td><td id="LC5837" class="css-1dcdqdg"><code>        youtube.ready.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5838" class="css-a4x74f"><span>5838</span></td><td id="LC5838" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L5839" class="css-a4x74f"><span>5839</span></td><td id="LC5839" class="css-1dcdqdg"><code>        <span class="code-comment">// Reference current global callback</span>
</code></td></tr><tr><td id="L5840" class="css-a4x74f"><span>5840</span></td><td id="LC5840" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> callback = <span class="code-built_in">window</span>.onYouTubeIframeAPIReady;
</code></td></tr><tr><td id="L5841" class="css-a4x74f"><span>5841</span></td><td id="LC5841" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5842" class="css-a4x74f"><span>5842</span></td><td id="LC5842" class="css-1dcdqdg"><code>        <span class="code-comment">// Set callback to process queue</span>
</code></td></tr><tr><td id="L5843" class="css-a4x74f"><span>5843</span></td><td id="LC5843" class="css-1dcdqdg"><code>        <span class="code-built_in">window</span>.onYouTubeIframeAPIReady = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5844" class="css-a4x74f"><span>5844</span></td><td id="LC5844" class="css-1dcdqdg"><code>          <span class="code-comment">// Call global callback if set</span>
</code></td></tr><tr><td id="L5845" class="css-a4x74f"><span>5845</span></td><td id="LC5845" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.function(callback)) {
</code></td></tr><tr><td id="L5846" class="css-a4x74f"><span>5846</span></td><td id="LC5846" class="css-1dcdqdg"><code>            callback();
</code></td></tr><tr><td id="L5847" class="css-a4x74f"><span>5847</span></td><td id="LC5847" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5848" class="css-a4x74f"><span>5848</span></td><td id="LC5848" class="css-1dcdqdg"><code>          youtube.ready.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5849" class="css-a4x74f"><span>5849</span></td><td id="LC5849" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L5850" class="css-a4x74f"><span>5850</span></td><td id="LC5850" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5851" class="css-a4x74f"><span>5851</span></td><td id="LC5851" class="css-1dcdqdg"><code>        <span class="code-comment">// Load the SDK</span>
</code></td></tr><tr><td id="L5852" class="css-a4x74f"><span>5852</span></td><td id="LC5852" class="css-1dcdqdg"><code>        loadScript(<span class="code-keyword">this</span>.config.urls.youtube.sdk).catch(<span class="code-function"><span class="code-params">error</span> =&gt;</span> {
</code></td></tr><tr><td id="L5853" class="css-a4x74f"><span>5853</span></td><td id="LC5853" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'YouTube API failed to load'</span>, error);
</code></td></tr><tr><td id="L5854" class="css-a4x74f"><span>5854</span></td><td id="LC5854" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L5855" class="css-a4x74f"><span>5855</span></td><td id="LC5855" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5856" class="css-a4x74f"><span>5856</span></td><td id="LC5856" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L5857" class="css-a4x74f"><span>5857</span></td><td id="LC5857" class="css-1dcdqdg"><code>    <span class="code-comment">// Get the media title</span>
</code></td></tr><tr><td id="L5858" class="css-a4x74f"><span>5858</span></td><td id="LC5858" class="css-1dcdqdg"><code>    getTitle(videoId) {
</code></td></tr><tr><td id="L5859" class="css-a4x74f"><span>5859</span></td><td id="LC5859" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> url = format(<span class="code-keyword">this</span>.config.urls.youtube.api, videoId);
</code></td></tr><tr><td id="L5860" class="css-a4x74f"><span>5860</span></td><td id="LC5860" class="css-1dcdqdg"><code>      fetch(url).then(<span class="code-function"><span class="code-params">data</span> =&gt;</span> {
</code></td></tr><tr><td id="L5861" class="css-a4x74f"><span>5861</span></td><td id="LC5861" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.object(data)) {
</code></td></tr><tr><td id="L5862" class="css-a4x74f"><span>5862</span></td><td id="LC5862" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L5863" class="css-a4x74f"><span>5863</span></td><td id="LC5863" class="css-1dcdqdg"><code>            title,
</code></td></tr><tr><td id="L5864" class="css-a4x74f"><span>5864</span></td><td id="LC5864" class="css-1dcdqdg"><code>            height,
</code></td></tr><tr><td id="L5865" class="css-a4x74f"><span>5865</span></td><td id="LC5865" class="css-1dcdqdg"><code>            width
</code></td></tr><tr><td id="L5866" class="css-a4x74f"><span>5866</span></td><td id="LC5866" class="css-1dcdqdg"><code>          } = data;
</code></td></tr><tr><td id="L5867" class="css-a4x74f"><span>5867</span></td><td id="LC5867" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5868" class="css-a4x74f"><span>5868</span></td><td id="LC5868" class="css-1dcdqdg"><code>          <span class="code-comment">// Set title</span>
</code></td></tr><tr><td id="L5869" class="css-a4x74f"><span>5869</span></td><td id="LC5869" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.config.title = title;
</code></td></tr><tr><td id="L5870" class="css-a4x74f"><span>5870</span></td><td id="LC5870" class="css-1dcdqdg"><code>          ui.setTitle.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5871" class="css-a4x74f"><span>5871</span></td><td id="LC5871" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5872" class="css-a4x74f"><span>5872</span></td><td id="LC5872" class="css-1dcdqdg"><code>          <span class="code-comment">// Set aspect ratio</span>
</code></td></tr><tr><td id="L5873" class="css-a4x74f"><span>5873</span></td><td id="LC5873" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.embed.ratio = roundAspectRatio(width, height);
</code></td></tr><tr><td id="L5874" class="css-a4x74f"><span>5874</span></td><td id="LC5874" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L5875" class="css-a4x74f"><span>5875</span></td><td id="LC5875" class="css-1dcdqdg"><code>        setAspectRatio.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5876" class="css-a4x74f"><span>5876</span></td><td id="LC5876" class="css-1dcdqdg"><code>      }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5877" class="css-a4x74f"><span>5877</span></td><td id="LC5877" class="css-1dcdqdg"><code>        <span class="code-comment">// Set aspect ratio</span>
</code></td></tr><tr><td id="L5878" class="css-a4x74f"><span>5878</span></td><td id="LC5878" class="css-1dcdqdg"><code>        setAspectRatio.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L5879" class="css-a4x74f"><span>5879</span></td><td id="LC5879" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5880" class="css-a4x74f"><span>5880</span></td><td id="LC5880" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L5881" class="css-a4x74f"><span>5881</span></td><td id="LC5881" class="css-1dcdqdg"><code>    <span class="code-comment">// API ready</span>
</code></td></tr><tr><td id="L5882" class="css-a4x74f"><span>5882</span></td><td id="LC5882" class="css-1dcdqdg"><code>    ready() {
</code></td></tr><tr><td id="L5883" class="css-a4x74f"><span>5883</span></td><td id="LC5883" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> player = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L5884" class="css-a4x74f"><span>5884</span></td><td id="LC5884" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> config = player.config.youtube;
</code></td></tr><tr><td id="L5885" class="css-a4x74f"><span>5885</span></td><td id="LC5885" class="css-1dcdqdg"><code>      <span class="code-comment">// Ignore already setup (race condition)</span>
</code></td></tr><tr><td id="L5886" class="css-a4x74f"><span>5886</span></td><td id="LC5886" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> currentId = player.media &amp;&amp; player.media.getAttribute(<span class="code-string">'id'</span>);
</code></td></tr><tr><td id="L5887" class="css-a4x74f"><span>5887</span></td><td id="LC5887" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(currentId) &amp;&amp; currentId.startsWith(<span class="code-string">'youtube-'</span>)) {
</code></td></tr><tr><td id="L5888" class="css-a4x74f"><span>5888</span></td><td id="LC5888" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5889" class="css-a4x74f"><span>5889</span></td><td id="LC5889" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5890" class="css-a4x74f"><span>5890</span></td><td id="LC5890" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5891" class="css-a4x74f"><span>5891</span></td><td id="LC5891" class="css-1dcdqdg"><code>      <span class="code-comment">// Get the source URL or ID</span>
</code></td></tr><tr><td id="L5892" class="css-a4x74f"><span>5892</span></td><td id="LC5892" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> source = player.media.getAttribute(<span class="code-string">'src'</span>);
</code></td></tr><tr><td id="L5893" class="css-a4x74f"><span>5893</span></td><td id="LC5893" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5894" class="css-a4x74f"><span>5894</span></td><td id="LC5894" class="css-1dcdqdg"><code>      <span class="code-comment">// Get from &lt;div&gt; if needed</span>
</code></td></tr><tr><td id="L5895" class="css-a4x74f"><span>5895</span></td><td id="LC5895" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(source)) {
</code></td></tr><tr><td id="L5896" class="css-a4x74f"><span>5896</span></td><td id="LC5896" class="css-1dcdqdg"><code>        source = player.media.getAttribute(<span class="code-keyword">this</span>.config.attributes.embed.id);
</code></td></tr><tr><td id="L5897" class="css-a4x74f"><span>5897</span></td><td id="LC5897" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5898" class="css-a4x74f"><span>5898</span></td><td id="LC5898" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5899" class="css-a4x74f"><span>5899</span></td><td id="LC5899" class="css-1dcdqdg"><code>      <span class="code-comment">// Replace the &lt;iframe&gt; with a &lt;div&gt; due to YouTube API issues</span>
</code></td></tr><tr><td id="L5900" class="css-a4x74f"><span>5900</span></td><td id="LC5900" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> videoId = parseId(source);
</code></td></tr><tr><td id="L5901" class="css-a4x74f"><span>5901</span></td><td id="LC5901" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> id = generateId(player.provider);
</code></td></tr><tr><td id="L5902" class="css-a4x74f"><span>5902</span></td><td id="LC5902" class="css-1dcdqdg"><code>      <span class="code-comment">// Replace media element</span>
</code></td></tr><tr><td id="L5903" class="css-a4x74f"><span>5903</span></td><td id="LC5903" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> container = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L5904" class="css-a4x74f"><span>5904</span></td><td id="LC5904" class="css-1dcdqdg"><code>        id,
</code></td></tr><tr><td id="L5905" class="css-a4x74f"><span>5905</span></td><td id="LC5905" class="css-1dcdqdg"><code>        <span class="code-string">'data-poster'</span>: config.customControls ? player.poster : <span class="code-literal">undefined</span>
</code></td></tr><tr><td id="L5906" class="css-a4x74f"><span>5906</span></td><td id="LC5906" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L5907" class="css-a4x74f"><span>5907</span></td><td id="LC5907" class="css-1dcdqdg"><code>      player.media = replaceElement(container, player.media);
</code></td></tr><tr><td id="L5908" class="css-a4x74f"><span>5908</span></td><td id="LC5908" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5909" class="css-a4x74f"><span>5909</span></td><td id="LC5909" class="css-1dcdqdg"><code>      <span class="code-comment">// Only load the poster when using custom controls</span>
</code></td></tr><tr><td id="L5910" class="css-a4x74f"><span>5910</span></td><td id="LC5910" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (config.customControls) {
</code></td></tr><tr><td id="L5911" class="css-a4x74f"><span>5911</span></td><td id="LC5911" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> posterSrc = <span class="code-function"><span class="code-params">s</span> =&gt;</span> <span class="code-string">`https://i.ytimg.com/vi/<span class="code-subst">${videoId}</span>/<span class="code-subst">${s}</span>default.jpg`</span>;
</code></td></tr><tr><td id="L5912" class="css-a4x74f"><span>5912</span></td><td id="LC5912" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5913" class="css-a4x74f"><span>5913</span></td><td id="LC5913" class="css-1dcdqdg"><code>        <span class="code-comment">// Check thumbnail images in order of quality, but reject fallback thumbnails (120px wide)</span>
</code></td></tr><tr><td id="L5914" class="css-a4x74f"><span>5914</span></td><td id="LC5914" class="css-1dcdqdg"><code>        loadImage(posterSrc(<span class="code-string">'maxres'</span>), <span class="code-number">121</span>) <span class="code-comment">// Highest quality and un-padded</span>
</code></td></tr><tr><td id="L5915" class="css-a4x74f"><span>5915</span></td><td id="LC5915" class="css-1dcdqdg"><code>        .catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> loadImage(posterSrc(<span class="code-string">'sd'</span>), <span class="code-number">121</span>)) <span class="code-comment">// 480p padded 4:3</span>
</code></td></tr><tr><td id="L5916" class="css-a4x74f"><span>5916</span></td><td id="LC5916" class="css-1dcdqdg"><code>        .catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> loadImage(posterSrc(<span class="code-string">'hq'</span>))) <span class="code-comment">// 360p padded 4:3. Always exists</span>
</code></td></tr><tr><td id="L5917" class="css-a4x74f"><span>5917</span></td><td id="LC5917" class="css-1dcdqdg"><code>        .then(<span class="code-function"><span class="code-params">image</span> =&gt;</span> ui.setPoster.call(player, image.src)).then(<span class="code-function"><span class="code-params">src</span> =&gt;</span> {
</code></td></tr><tr><td id="L5918" class="css-a4x74f"><span>5918</span></td><td id="LC5918" class="css-1dcdqdg"><code>          <span class="code-comment">// If the image is padded, use background-size "cover" instead (like youtube does too with their posters)</span>
</code></td></tr><tr><td id="L5919" class="css-a4x74f"><span>5919</span></td><td id="LC5919" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!src.includes(<span class="code-string">'maxres'</span>)) {
</code></td></tr><tr><td id="L5920" class="css-a4x74f"><span>5920</span></td><td id="LC5920" class="css-1dcdqdg"><code>            player.elements.poster.style.backgroundSize = <span class="code-string">'cover'</span>;
</code></td></tr><tr><td id="L5921" class="css-a4x74f"><span>5921</span></td><td id="LC5921" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L5922" class="css-a4x74f"><span>5922</span></td><td id="LC5922" class="css-1dcdqdg"><code>        }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L5923" class="css-a4x74f"><span>5923</span></td><td id="LC5923" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L5924" class="css-a4x74f"><span>5924</span></td><td id="LC5924" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5925" class="css-a4x74f"><span>5925</span></td><td id="LC5925" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup instance</span>
</code></td></tr><tr><td id="L5926" class="css-a4x74f"><span>5926</span></td><td id="LC5926" class="css-1dcdqdg"><code>      <span class="code-comment">// https://developers.google.com/youtube/iframe_api_reference</span>
</code></td></tr><tr><td id="L5927" class="css-a4x74f"><span>5927</span></td><td id="LC5927" class="css-1dcdqdg"><code>      player.embed = <span class="code-keyword">new</span> <span class="code-built_in">window</span>.YT.Player(player.media, {
</code></td></tr><tr><td id="L5928" class="css-a4x74f"><span>5928</span></td><td id="LC5928" class="css-1dcdqdg"><code>        videoId,
</code></td></tr><tr><td id="L5929" class="css-a4x74f"><span>5929</span></td><td id="LC5929" class="css-1dcdqdg"><code>        host: getHost(config),
</code></td></tr><tr><td id="L5930" class="css-a4x74f"><span>5930</span></td><td id="LC5930" class="css-1dcdqdg"><code>        playerVars: extend({}, {
</code></td></tr><tr><td id="L5931" class="css-a4x74f"><span>5931</span></td><td id="LC5931" class="css-1dcdqdg"><code>          <span class="code-comment">// Autoplay</span>
</code></td></tr><tr><td id="L5932" class="css-a4x74f"><span>5932</span></td><td id="LC5932" class="css-1dcdqdg"><code>          autoplay: player.config.autoplay ? <span class="code-number">1</span> : <span class="code-number">0</span>,
</code></td></tr><tr><td id="L5933" class="css-a4x74f"><span>5933</span></td><td id="LC5933" class="css-1dcdqdg"><code>          <span class="code-comment">// iframe interface language</span>
</code></td></tr><tr><td id="L5934" class="css-a4x74f"><span>5934</span></td><td id="LC5934" class="css-1dcdqdg"><code>          hl: player.config.hl,
</code></td></tr><tr><td id="L5935" class="css-a4x74f"><span>5935</span></td><td id="LC5935" class="css-1dcdqdg"><code>          <span class="code-comment">// Only show controls if not fully supported or opted out</span>
</code></td></tr><tr><td id="L5936" class="css-a4x74f"><span>5936</span></td><td id="LC5936" class="css-1dcdqdg"><code>          controls: player.supported.ui &amp;&amp; config.customControls ? <span class="code-number">0</span> : <span class="code-number">1</span>,
</code></td></tr><tr><td id="L5937" class="css-a4x74f"><span>5937</span></td><td id="LC5937" class="css-1dcdqdg"><code>          <span class="code-comment">// Disable keyboard as we handle it</span>
</code></td></tr><tr><td id="L5938" class="css-a4x74f"><span>5938</span></td><td id="LC5938" class="css-1dcdqdg"><code>          disablekb: <span class="code-number">1</span>,
</code></td></tr><tr><td id="L5939" class="css-a4x74f"><span>5939</span></td><td id="LC5939" class="css-1dcdqdg"><code>          <span class="code-comment">// Allow iOS inline playback</span>
</code></td></tr><tr><td id="L5940" class="css-a4x74f"><span>5940</span></td><td id="LC5940" class="css-1dcdqdg"><code>          playsinline: player.config.playsinline &amp;&amp; !player.config.fullscreen.iosNative ? <span class="code-number">1</span> : <span class="code-number">0</span>,
</code></td></tr><tr><td id="L5941" class="css-a4x74f"><span>5941</span></td><td id="LC5941" class="css-1dcdqdg"><code>          <span class="code-comment">// Captions are flaky on YouTube</span>
</code></td></tr><tr><td id="L5942" class="css-a4x74f"><span>5942</span></td><td id="LC5942" class="css-1dcdqdg"><code>          cc_load_policy: player.captions.active ? <span class="code-number">1</span> : <span class="code-number">0</span>,
</code></td></tr><tr><td id="L5943" class="css-a4x74f"><span>5943</span></td><td id="LC5943" class="css-1dcdqdg"><code>          cc_lang_pref: player.config.captions.language,
</code></td></tr><tr><td id="L5944" class="css-a4x74f"><span>5944</span></td><td id="LC5944" class="css-1dcdqdg"><code>          <span class="code-comment">// Tracking for stats</span>
</code></td></tr><tr><td id="L5945" class="css-a4x74f"><span>5945</span></td><td id="LC5945" class="css-1dcdqdg"><code>          widget_referrer: <span class="code-built_in">window</span> ? <span class="code-built_in">window</span>.location.href : <span class="code-literal">null</span>
</code></td></tr><tr><td id="L5946" class="css-a4x74f"><span>5946</span></td><td id="LC5946" class="css-1dcdqdg"><code>        }, config),
</code></td></tr><tr><td id="L5947" class="css-a4x74f"><span>5947</span></td><td id="LC5947" class="css-1dcdqdg"><code>        events: {
</code></td></tr><tr><td id="L5948" class="css-a4x74f"><span>5948</span></td><td id="LC5948" class="css-1dcdqdg"><code>          onError(event) {
</code></td></tr><tr><td id="L5949" class="css-a4x74f"><span>5949</span></td><td id="LC5949" class="css-1dcdqdg"><code>            <span class="code-comment">// YouTube may fire onError twice, so only handle it once</span>
</code></td></tr><tr><td id="L5950" class="css-a4x74f"><span>5950</span></td><td id="LC5950" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!player.media.error) {
</code></td></tr><tr><td id="L5951" class="css-a4x74f"><span>5951</span></td><td id="LC5951" class="css-1dcdqdg"><code>              <span class="code-keyword">const</span> code = event.data;
</code></td></tr><tr><td id="L5952" class="css-a4x74f"><span>5952</span></td><td id="LC5952" class="css-1dcdqdg"><code>              <span class="code-comment">// Messages copied from https://developers.google.com/youtube/iframe_api_reference#onError</span>
</code></td></tr><tr><td id="L5953" class="css-a4x74f"><span>5953</span></td><td id="LC5953" class="css-1dcdqdg"><code>              <span class="code-keyword">const</span> message = {
</code></td></tr><tr><td id="L5954" class="css-a4x74f"><span>5954</span></td><td id="LC5954" class="css-1dcdqdg"><code>                <span class="code-number">2</span>: <span class="code-string">'The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.'</span>,
</code></td></tr><tr><td id="L5955" class="css-a4x74f"><span>5955</span></td><td id="LC5955" class="css-1dcdqdg"><code>                <span class="code-number">5</span>: <span class="code-string">'The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.'</span>,
</code></td></tr><tr><td id="L5956" class="css-a4x74f"><span>5956</span></td><td id="LC5956" class="css-1dcdqdg"><code>                <span class="code-number">100</span>: <span class="code-string">'The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.'</span>,
</code></td></tr><tr><td id="L5957" class="css-a4x74f"><span>5957</span></td><td id="LC5957" class="css-1dcdqdg"><code>                <span class="code-number">101</span>: <span class="code-string">'The owner of the requested video does not allow it to be played in embedded players.'</span>,
</code></td></tr><tr><td id="L5958" class="css-a4x74f"><span>5958</span></td><td id="LC5958" class="css-1dcdqdg"><code>                <span class="code-number">150</span>: <span class="code-string">'The owner of the requested video does not allow it to be played in embedded players.'</span>
</code></td></tr><tr><td id="L5959" class="css-a4x74f"><span>5959</span></td><td id="LC5959" class="css-1dcdqdg"><code>              }[code] || <span class="code-string">'An unknown error occurred'</span>;
</code></td></tr><tr><td id="L5960" class="css-a4x74f"><span>5960</span></td><td id="LC5960" class="css-1dcdqdg"><code>              player.media.error = {
</code></td></tr><tr><td id="L5961" class="css-a4x74f"><span>5961</span></td><td id="LC5961" class="css-1dcdqdg"><code>                code,
</code></td></tr><tr><td id="L5962" class="css-a4x74f"><span>5962</span></td><td id="LC5962" class="css-1dcdqdg"><code>                message
</code></td></tr><tr><td id="L5963" class="css-a4x74f"><span>5963</span></td><td id="LC5963" class="css-1dcdqdg"><code>              };
</code></td></tr><tr><td id="L5964" class="css-a4x74f"><span>5964</span></td><td id="LC5964" class="css-1dcdqdg"><code>              triggerEvent.call(player, player.media, <span class="code-string">'error'</span>);
</code></td></tr><tr><td id="L5965" class="css-a4x74f"><span>5965</span></td><td id="LC5965" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5966" class="css-a4x74f"><span>5966</span></td><td id="LC5966" class="css-1dcdqdg"><code>          },
</code></td></tr><tr><td id="L5967" class="css-a4x74f"><span>5967</span></td><td id="LC5967" class="css-1dcdqdg"><code>          onPlaybackRateChange(event) {
</code></td></tr><tr><td id="L5968" class="css-a4x74f"><span>5968</span></td><td id="LC5968" class="css-1dcdqdg"><code>            <span class="code-comment">// Get the instance</span>
</code></td></tr><tr><td id="L5969" class="css-a4x74f"><span>5969</span></td><td id="LC5969" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> instance = event.target;
</code></td></tr><tr><td id="L5970" class="css-a4x74f"><span>5970</span></td><td id="LC5970" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5971" class="css-a4x74f"><span>5971</span></td><td id="LC5971" class="css-1dcdqdg"><code>            <span class="code-comment">// Get current speed</span>
</code></td></tr><tr><td id="L5972" class="css-a4x74f"><span>5972</span></td><td id="LC5972" class="css-1dcdqdg"><code>            player.media.playbackRate = instance.getPlaybackRate();
</code></td></tr><tr><td id="L5973" class="css-a4x74f"><span>5973</span></td><td id="LC5973" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'ratechange'</span>);
</code></td></tr><tr><td id="L5974" class="css-a4x74f"><span>5974</span></td><td id="LC5974" class="css-1dcdqdg"><code>          },
</code></td></tr><tr><td id="L5975" class="css-a4x74f"><span>5975</span></td><td id="LC5975" class="css-1dcdqdg"><code>          onReady(event) {
</code></td></tr><tr><td id="L5976" class="css-a4x74f"><span>5976</span></td><td id="LC5976" class="css-1dcdqdg"><code>            <span class="code-comment">// Bail if onReady has already been called. See issue #1108</span>
</code></td></tr><tr><td id="L5977" class="css-a4x74f"><span>5977</span></td><td id="LC5977" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (is.function(player.media.play)) {
</code></td></tr><tr><td id="L5978" class="css-a4x74f"><span>5978</span></td><td id="LC5978" class="css-1dcdqdg"><code>              <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L5979" class="css-a4x74f"><span>5979</span></td><td id="LC5979" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L5980" class="css-a4x74f"><span>5980</span></td><td id="LC5980" class="css-1dcdqdg"><code>            <span class="code-comment">// Get the instance</span>
</code></td></tr><tr><td id="L5981" class="css-a4x74f"><span>5981</span></td><td id="LC5981" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> instance = event.target;
</code></td></tr><tr><td id="L5982" class="css-a4x74f"><span>5982</span></td><td id="LC5982" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5983" class="css-a4x74f"><span>5983</span></td><td id="LC5983" class="css-1dcdqdg"><code>            <span class="code-comment">// Get the title</span>
</code></td></tr><tr><td id="L5984" class="css-a4x74f"><span>5984</span></td><td id="LC5984" class="css-1dcdqdg"><code>            youtube.getTitle.call(player, videoId);
</code></td></tr><tr><td id="L5985" class="css-a4x74f"><span>5985</span></td><td id="LC5985" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L5986" class="css-a4x74f"><span>5986</span></td><td id="LC5986" class="css-1dcdqdg"><code>            <span class="code-comment">// Create a faux HTML5 API using the YouTube API</span>
</code></td></tr><tr><td id="L5987" class="css-a4x74f"><span>5987</span></td><td id="LC5987" class="css-1dcdqdg"><code>            player.media.play = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5988" class="css-a4x74f"><span>5988</span></td><td id="LC5988" class="css-1dcdqdg"><code>              assurePlaybackState.call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L5989" class="css-a4x74f"><span>5989</span></td><td id="LC5989" class="css-1dcdqdg"><code>              instance.playVideo();
</code></td></tr><tr><td id="L5990" class="css-a4x74f"><span>5990</span></td><td id="LC5990" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L5991" class="css-a4x74f"><span>5991</span></td><td id="LC5991" class="css-1dcdqdg"><code>            player.media.pause = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5992" class="css-a4x74f"><span>5992</span></td><td id="LC5992" class="css-1dcdqdg"><code>              assurePlaybackState.call(player, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L5993" class="css-a4x74f"><span>5993</span></td><td id="LC5993" class="css-1dcdqdg"><code>              instance.pauseVideo();
</code></td></tr><tr><td id="L5994" class="css-a4x74f"><span>5994</span></td><td id="LC5994" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L5995" class="css-a4x74f"><span>5995</span></td><td id="LC5995" class="css-1dcdqdg"><code>            player.media.stop = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L5996" class="css-a4x74f"><span>5996</span></td><td id="LC5996" class="css-1dcdqdg"><code>              instance.stopVideo();
</code></td></tr><tr><td id="L5997" class="css-a4x74f"><span>5997</span></td><td id="LC5997" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L5998" class="css-a4x74f"><span>5998</span></td><td id="LC5998" class="css-1dcdqdg"><code>            player.media.duration = instance.getDuration();
</code></td></tr><tr><td id="L5999" class="css-a4x74f"><span>5999</span></td><td id="LC5999" class="css-1dcdqdg"><code>            player.media.paused = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6000" class="css-a4x74f"><span>6000</span></td><td id="LC6000" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6001" class="css-a4x74f"><span>6001</span></td><td id="LC6001" class="css-1dcdqdg"><code>            <span class="code-comment">// Seeking</span>
</code></td></tr><tr><td id="L6002" class="css-a4x74f"><span>6002</span></td><td id="LC6002" class="css-1dcdqdg"><code>            player.media.currentTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L6003" class="css-a4x74f"><span>6003</span></td><td id="LC6003" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'currentTime'</span>, {
</code></td></tr><tr><td id="L6004" class="css-a4x74f"><span>6004</span></td><td id="LC6004" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6005" class="css-a4x74f"><span>6005</span></td><td id="LC6005" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> <span class="code-built_in">Number</span>(instance.getCurrentTime());
</code></td></tr><tr><td id="L6006" class="css-a4x74f"><span>6006</span></td><td id="LC6006" class="css-1dcdqdg"><code>              },
</code></td></tr><tr><td id="L6007" class="css-a4x74f"><span>6007</span></td><td id="LC6007" class="css-1dcdqdg"><code>              <span class="code-keyword">set</span>(time) {
</code></td></tr><tr><td id="L6008" class="css-a4x74f"><span>6008</span></td><td id="LC6008" class="css-1dcdqdg"><code>                <span class="code-comment">// If paused and never played, mute audio preventively (YouTube starts playing on seek if the video hasn't been played yet).</span>
</code></td></tr><tr><td id="L6009" class="css-a4x74f"><span>6009</span></td><td id="LC6009" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (player.paused &amp;&amp; !player.embed.hasPlayed) {
</code></td></tr><tr><td id="L6010" class="css-a4x74f"><span>6010</span></td><td id="LC6010" class="css-1dcdqdg"><code>                  player.embed.mute();
</code></td></tr><tr><td id="L6011" class="css-a4x74f"><span>6011</span></td><td id="LC6011" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L6012" class="css-a4x74f"><span>6012</span></td><td id="LC6012" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6013" class="css-a4x74f"><span>6013</span></td><td id="LC6013" class="css-1dcdqdg"><code>                <span class="code-comment">// Set seeking state and trigger event</span>
</code></td></tr><tr><td id="L6014" class="css-a4x74f"><span>6014</span></td><td id="LC6014" class="css-1dcdqdg"><code>                player.media.seeking = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6015" class="css-a4x74f"><span>6015</span></td><td id="LC6015" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'seeking'</span>);
</code></td></tr><tr><td id="L6016" class="css-a4x74f"><span>6016</span></td><td id="LC6016" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6017" class="css-a4x74f"><span>6017</span></td><td id="LC6017" class="css-1dcdqdg"><code>                <span class="code-comment">// Seek after events sent</span>
</code></td></tr><tr><td id="L6018" class="css-a4x74f"><span>6018</span></td><td id="LC6018" class="css-1dcdqdg"><code>                instance.seekTo(time);
</code></td></tr><tr><td id="L6019" class="css-a4x74f"><span>6019</span></td><td id="LC6019" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6020" class="css-a4x74f"><span>6020</span></td><td id="LC6020" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6021" class="css-a4x74f"><span>6021</span></td><td id="LC6021" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6022" class="css-a4x74f"><span>6022</span></td><td id="LC6022" class="css-1dcdqdg"><code>            <span class="code-comment">// Playback speed</span>
</code></td></tr><tr><td id="L6023" class="css-a4x74f"><span>6023</span></td><td id="LC6023" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'playbackRate'</span>, {
</code></td></tr><tr><td id="L6024" class="css-a4x74f"><span>6024</span></td><td id="LC6024" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6025" class="css-a4x74f"><span>6025</span></td><td id="LC6025" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> instance.getPlaybackRate();
</code></td></tr><tr><td id="L6026" class="css-a4x74f"><span>6026</span></td><td id="LC6026" class="css-1dcdqdg"><code>              },
</code></td></tr><tr><td id="L6027" class="css-a4x74f"><span>6027</span></td><td id="LC6027" class="css-1dcdqdg"><code>              <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L6028" class="css-a4x74f"><span>6028</span></td><td id="LC6028" class="css-1dcdqdg"><code>                instance.setPlaybackRate(input);
</code></td></tr><tr><td id="L6029" class="css-a4x74f"><span>6029</span></td><td id="LC6029" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6030" class="css-a4x74f"><span>6030</span></td><td id="LC6030" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6031" class="css-a4x74f"><span>6031</span></td><td id="LC6031" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6032" class="css-a4x74f"><span>6032</span></td><td id="LC6032" class="css-1dcdqdg"><code>            <span class="code-comment">// Volume</span>
</code></td></tr><tr><td id="L6033" class="css-a4x74f"><span>6033</span></td><td id="LC6033" class="css-1dcdqdg"><code>            <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L6034" class="css-a4x74f"><span>6034</span></td><td id="LC6034" class="css-1dcdqdg"><code>              volume
</code></td></tr><tr><td id="L6035" class="css-a4x74f"><span>6035</span></td><td id="LC6035" class="css-1dcdqdg"><code>            } = player.config;
</code></td></tr><tr><td id="L6036" class="css-a4x74f"><span>6036</span></td><td id="LC6036" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'volume'</span>, {
</code></td></tr><tr><td id="L6037" class="css-a4x74f"><span>6037</span></td><td id="LC6037" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6038" class="css-a4x74f"><span>6038</span></td><td id="LC6038" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> volume;
</code></td></tr><tr><td id="L6039" class="css-a4x74f"><span>6039</span></td><td id="LC6039" class="css-1dcdqdg"><code>              },
</code></td></tr><tr><td id="L6040" class="css-a4x74f"><span>6040</span></td><td id="LC6040" class="css-1dcdqdg"><code>              <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L6041" class="css-a4x74f"><span>6041</span></td><td id="LC6041" class="css-1dcdqdg"><code>                volume = input;
</code></td></tr><tr><td id="L6042" class="css-a4x74f"><span>6042</span></td><td id="LC6042" class="css-1dcdqdg"><code>                instance.setVolume(volume * <span class="code-number">100</span>);
</code></td></tr><tr><td id="L6043" class="css-a4x74f"><span>6043</span></td><td id="LC6043" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'volumechange'</span>);
</code></td></tr><tr><td id="L6044" class="css-a4x74f"><span>6044</span></td><td id="LC6044" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6045" class="css-a4x74f"><span>6045</span></td><td id="LC6045" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6046" class="css-a4x74f"><span>6046</span></td><td id="LC6046" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6047" class="css-a4x74f"><span>6047</span></td><td id="LC6047" class="css-1dcdqdg"><code>            <span class="code-comment">// Muted</span>
</code></td></tr><tr><td id="L6048" class="css-a4x74f"><span>6048</span></td><td id="LC6048" class="css-1dcdqdg"><code>            <span class="code-keyword">let</span> {
</code></td></tr><tr><td id="L6049" class="css-a4x74f"><span>6049</span></td><td id="LC6049" class="css-1dcdqdg"><code>              muted
</code></td></tr><tr><td id="L6050" class="css-a4x74f"><span>6050</span></td><td id="LC6050" class="css-1dcdqdg"><code>            } = player.config;
</code></td></tr><tr><td id="L6051" class="css-a4x74f"><span>6051</span></td><td id="LC6051" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'muted'</span>, {
</code></td></tr><tr><td id="L6052" class="css-a4x74f"><span>6052</span></td><td id="LC6052" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6053" class="css-a4x74f"><span>6053</span></td><td id="LC6053" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> muted;
</code></td></tr><tr><td id="L6054" class="css-a4x74f"><span>6054</span></td><td id="LC6054" class="css-1dcdqdg"><code>              },
</code></td></tr><tr><td id="L6055" class="css-a4x74f"><span>6055</span></td><td id="LC6055" class="css-1dcdqdg"><code>              <span class="code-keyword">set</span>(input) {
</code></td></tr><tr><td id="L6056" class="css-a4x74f"><span>6056</span></td><td id="LC6056" class="css-1dcdqdg"><code>                <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : muted;
</code></td></tr><tr><td id="L6057" class="css-a4x74f"><span>6057</span></td><td id="LC6057" class="css-1dcdqdg"><code>                muted = toggle;
</code></td></tr><tr><td id="L6058" class="css-a4x74f"><span>6058</span></td><td id="LC6058" class="css-1dcdqdg"><code>                instance[toggle ? <span class="code-string">'mute'</span> : <span class="code-string">'unMute'</span>]();
</code></td></tr><tr><td id="L6059" class="css-a4x74f"><span>6059</span></td><td id="LC6059" class="css-1dcdqdg"><code>                instance.setVolume(volume * <span class="code-number">100</span>);
</code></td></tr><tr><td id="L6060" class="css-a4x74f"><span>6060</span></td><td id="LC6060" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'volumechange'</span>);
</code></td></tr><tr><td id="L6061" class="css-a4x74f"><span>6061</span></td><td id="LC6061" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6062" class="css-a4x74f"><span>6062</span></td><td id="LC6062" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6063" class="css-a4x74f"><span>6063</span></td><td id="LC6063" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6064" class="css-a4x74f"><span>6064</span></td><td id="LC6064" class="css-1dcdqdg"><code>            <span class="code-comment">// Source</span>
</code></td></tr><tr><td id="L6065" class="css-a4x74f"><span>6065</span></td><td id="LC6065" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'currentSrc'</span>, {
</code></td></tr><tr><td id="L6066" class="css-a4x74f"><span>6066</span></td><td id="LC6066" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6067" class="css-a4x74f"><span>6067</span></td><td id="LC6067" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> instance.getVideoUrl();
</code></td></tr><tr><td id="L6068" class="css-a4x74f"><span>6068</span></td><td id="LC6068" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6069" class="css-a4x74f"><span>6069</span></td><td id="LC6069" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6070" class="css-a4x74f"><span>6070</span></td><td id="LC6070" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6071" class="css-a4x74f"><span>6071</span></td><td id="LC6071" class="css-1dcdqdg"><code>            <span class="code-comment">// Ended</span>
</code></td></tr><tr><td id="L6072" class="css-a4x74f"><span>6072</span></td><td id="LC6072" class="css-1dcdqdg"><code>            <span class="code-built_in">Object</span>.defineProperty(player.media, <span class="code-string">'ended'</span>, {
</code></td></tr><tr><td id="L6073" class="css-a4x74f"><span>6073</span></td><td id="LC6073" class="css-1dcdqdg"><code>              <span class="code-keyword">get</span>() {
</code></td></tr><tr><td id="L6074" class="css-a4x74f"><span>6074</span></td><td id="LC6074" class="css-1dcdqdg"><code>                <span class="code-keyword">return</span> player.currentTime === player.duration;
</code></td></tr><tr><td id="L6075" class="css-a4x74f"><span>6075</span></td><td id="LC6075" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6076" class="css-a4x74f"><span>6076</span></td><td id="LC6076" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6077" class="css-a4x74f"><span>6077</span></td><td id="LC6077" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6078" class="css-a4x74f"><span>6078</span></td><td id="LC6078" class="css-1dcdqdg"><code>            <span class="code-comment">// Get available speeds</span>
</code></td></tr><tr><td id="L6079" class="css-a4x74f"><span>6079</span></td><td id="LC6079" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> speeds = instance.getAvailablePlaybackRates();
</code></td></tr><tr><td id="L6080" class="css-a4x74f"><span>6080</span></td><td id="LC6080" class="css-1dcdqdg"><code>            <span class="code-comment">// Filter based on config</span>
</code></td></tr><tr><td id="L6081" class="css-a4x74f"><span>6081</span></td><td id="LC6081" class="css-1dcdqdg"><code>            player.options.speed = speeds.filter(<span class="code-function"><span class="code-params">s</span> =&gt;</span> player.config.speed.options.includes(s));
</code></td></tr><tr><td id="L6082" class="css-a4x74f"><span>6082</span></td><td id="LC6082" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6083" class="css-a4x74f"><span>6083</span></td><td id="LC6083" class="css-1dcdqdg"><code>            <span class="code-comment">// Set the tabindex to avoid focus entering iframe</span>
</code></td></tr><tr><td id="L6084" class="css-a4x74f"><span>6084</span></td><td id="LC6084" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (player.supported.ui &amp;&amp; config.customControls) {
</code></td></tr><tr><td id="L6085" class="css-a4x74f"><span>6085</span></td><td id="LC6085" class="css-1dcdqdg"><code>              player.media.setAttribute(<span class="code-string">'tabindex'</span>, <span class="code-number">-1</span>);
</code></td></tr><tr><td id="L6086" class="css-a4x74f"><span>6086</span></td><td id="LC6086" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6087" class="css-a4x74f"><span>6087</span></td><td id="LC6087" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'timeupdate'</span>);
</code></td></tr><tr><td id="L6088" class="css-a4x74f"><span>6088</span></td><td id="LC6088" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.media, <span class="code-string">'durationchange'</span>);
</code></td></tr><tr><td id="L6089" class="css-a4x74f"><span>6089</span></td><td id="LC6089" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6090" class="css-a4x74f"><span>6090</span></td><td id="LC6090" class="css-1dcdqdg"><code>            <span class="code-comment">// Reset timer</span>
</code></td></tr><tr><td id="L6091" class="css-a4x74f"><span>6091</span></td><td id="LC6091" class="css-1dcdqdg"><code>            clearInterval(player.timers.buffering);
</code></td></tr><tr><td id="L6092" class="css-a4x74f"><span>6092</span></td><td id="LC6092" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6093" class="css-a4x74f"><span>6093</span></td><td id="LC6093" class="css-1dcdqdg"><code>            <span class="code-comment">// Setup buffering</span>
</code></td></tr><tr><td id="L6094" class="css-a4x74f"><span>6094</span></td><td id="LC6094" class="css-1dcdqdg"><code>            player.timers.buffering = setInterval(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6095" class="css-a4x74f"><span>6095</span></td><td id="LC6095" class="css-1dcdqdg"><code>              <span class="code-comment">// Get loaded % from YouTube</span>
</code></td></tr><tr><td id="L6096" class="css-a4x74f"><span>6096</span></td><td id="LC6096" class="css-1dcdqdg"><code>              player.media.buffered = instance.getVideoLoadedFraction();
</code></td></tr><tr><td id="L6097" class="css-a4x74f"><span>6097</span></td><td id="LC6097" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6098" class="css-a4x74f"><span>6098</span></td><td id="LC6098" class="css-1dcdqdg"><code>              <span class="code-comment">// Trigger progress only when we actually buffer something</span>
</code></td></tr><tr><td id="L6099" class="css-a4x74f"><span>6099</span></td><td id="LC6099" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (player.media.lastBuffered === <span class="code-literal">null</span> || player.media.lastBuffered &lt; player.media.buffered) {
</code></td></tr><tr><td id="L6100" class="css-a4x74f"><span>6100</span></td><td id="LC6100" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'progress'</span>);
</code></td></tr><tr><td id="L6101" class="css-a4x74f"><span>6101</span></td><td id="LC6101" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6102" class="css-a4x74f"><span>6102</span></td><td id="LC6102" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6103" class="css-a4x74f"><span>6103</span></td><td id="LC6103" class="css-1dcdqdg"><code>              <span class="code-comment">// Set last buffer point</span>
</code></td></tr><tr><td id="L6104" class="css-a4x74f"><span>6104</span></td><td id="LC6104" class="css-1dcdqdg"><code>              player.media.lastBuffered = player.media.buffered;
</code></td></tr><tr><td id="L6105" class="css-a4x74f"><span>6105</span></td><td id="LC6105" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6106" class="css-a4x74f"><span>6106</span></td><td id="LC6106" class="css-1dcdqdg"><code>              <span class="code-comment">// Bail if we're at 100%</span>
</code></td></tr><tr><td id="L6107" class="css-a4x74f"><span>6107</span></td><td id="LC6107" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (player.media.buffered === <span class="code-number">1</span>) {
</code></td></tr><tr><td id="L6108" class="css-a4x74f"><span>6108</span></td><td id="LC6108" class="css-1dcdqdg"><code>                clearInterval(player.timers.buffering);
</code></td></tr><tr><td id="L6109" class="css-a4x74f"><span>6109</span></td><td id="LC6109" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6110" class="css-a4x74f"><span>6110</span></td><td id="LC6110" class="css-1dcdqdg"><code>                <span class="code-comment">// Trigger event</span>
</code></td></tr><tr><td id="L6111" class="css-a4x74f"><span>6111</span></td><td id="LC6111" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'canplaythrough'</span>);
</code></td></tr><tr><td id="L6112" class="css-a4x74f"><span>6112</span></td><td id="LC6112" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6113" class="css-a4x74f"><span>6113</span></td><td id="LC6113" class="css-1dcdqdg"><code>            }, <span class="code-number">200</span>);
</code></td></tr><tr><td id="L6114" class="css-a4x74f"><span>6114</span></td><td id="LC6114" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6115" class="css-a4x74f"><span>6115</span></td><td id="LC6115" class="css-1dcdqdg"><code>            <span class="code-comment">// Rebuild UI</span>
</code></td></tr><tr><td id="L6116" class="css-a4x74f"><span>6116</span></td><td id="LC6116" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (config.customControls) {
</code></td></tr><tr><td id="L6117" class="css-a4x74f"><span>6117</span></td><td id="LC6117" class="css-1dcdqdg"><code>              setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> ui.build.call(player), <span class="code-number">50</span>);
</code></td></tr><tr><td id="L6118" class="css-a4x74f"><span>6118</span></td><td id="LC6118" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6119" class="css-a4x74f"><span>6119</span></td><td id="LC6119" class="css-1dcdqdg"><code>          },
</code></td></tr><tr><td id="L6120" class="css-a4x74f"><span>6120</span></td><td id="LC6120" class="css-1dcdqdg"><code>          onStateChange(event) {
</code></td></tr><tr><td id="L6121" class="css-a4x74f"><span>6121</span></td><td id="LC6121" class="css-1dcdqdg"><code>            <span class="code-comment">// Get the instance</span>
</code></td></tr><tr><td id="L6122" class="css-a4x74f"><span>6122</span></td><td id="LC6122" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> instance = event.target;
</code></td></tr><tr><td id="L6123" class="css-a4x74f"><span>6123</span></td><td id="LC6123" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6124" class="css-a4x74f"><span>6124</span></td><td id="LC6124" class="css-1dcdqdg"><code>            <span class="code-comment">// Reset timer</span>
</code></td></tr><tr><td id="L6125" class="css-a4x74f"><span>6125</span></td><td id="LC6125" class="css-1dcdqdg"><code>            clearInterval(player.timers.playing);
</code></td></tr><tr><td id="L6126" class="css-a4x74f"><span>6126</span></td><td id="LC6126" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> seeked = player.media.seeking &amp;&amp; [<span class="code-number">1</span>, <span class="code-number">2</span>].includes(event.data);
</code></td></tr><tr><td id="L6127" class="css-a4x74f"><span>6127</span></td><td id="LC6127" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (seeked) {
</code></td></tr><tr><td id="L6128" class="css-a4x74f"><span>6128</span></td><td id="LC6128" class="css-1dcdqdg"><code>              <span class="code-comment">// Unset seeking and fire seeked event</span>
</code></td></tr><tr><td id="L6129" class="css-a4x74f"><span>6129</span></td><td id="LC6129" class="css-1dcdqdg"><code>              player.media.seeking = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6130" class="css-a4x74f"><span>6130</span></td><td id="LC6130" class="css-1dcdqdg"><code>              triggerEvent.call(player, player.media, <span class="code-string">'seeked'</span>);
</code></td></tr><tr><td id="L6131" class="css-a4x74f"><span>6131</span></td><td id="LC6131" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6132" class="css-a4x74f"><span>6132</span></td><td id="LC6132" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6133" class="css-a4x74f"><span>6133</span></td><td id="LC6133" class="css-1dcdqdg"><code>            <span class="code-comment">// Handle events</span>
</code></td></tr><tr><td id="L6134" class="css-a4x74f"><span>6134</span></td><td id="LC6134" class="css-1dcdqdg"><code>            <span class="code-comment">// -1   Unstarted</span>
</code></td></tr><tr><td id="L6135" class="css-a4x74f"><span>6135</span></td><td id="LC6135" class="css-1dcdqdg"><code>            <span class="code-comment">// 0    Ended</span>
</code></td></tr><tr><td id="L6136" class="css-a4x74f"><span>6136</span></td><td id="LC6136" class="css-1dcdqdg"><code>            <span class="code-comment">// 1    Playing</span>
</code></td></tr><tr><td id="L6137" class="css-a4x74f"><span>6137</span></td><td id="LC6137" class="css-1dcdqdg"><code>            <span class="code-comment">// 2    Paused</span>
</code></td></tr><tr><td id="L6138" class="css-a4x74f"><span>6138</span></td><td id="LC6138" class="css-1dcdqdg"><code>            <span class="code-comment">// 3    Buffering</span>
</code></td></tr><tr><td id="L6139" class="css-a4x74f"><span>6139</span></td><td id="LC6139" class="css-1dcdqdg"><code>            <span class="code-comment">// 5    Video cued</span>
</code></td></tr><tr><td id="L6140" class="css-a4x74f"><span>6140</span></td><td id="LC6140" class="css-1dcdqdg"><code>            <span class="code-keyword">switch</span> (event.data) {
</code></td></tr><tr><td id="L6141" class="css-a4x74f"><span>6141</span></td><td id="LC6141" class="css-1dcdqdg"><code>              <span class="code-keyword">case</span> <span class="code-number">-1</span>:
</code></td></tr><tr><td id="L6142" class="css-a4x74f"><span>6142</span></td><td id="LC6142" class="css-1dcdqdg"><code>                <span class="code-comment">// Update scrubber</span>
</code></td></tr><tr><td id="L6143" class="css-a4x74f"><span>6143</span></td><td id="LC6143" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'timeupdate'</span>);
</code></td></tr><tr><td id="L6144" class="css-a4x74f"><span>6144</span></td><td id="LC6144" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6145" class="css-a4x74f"><span>6145</span></td><td id="LC6145" class="css-1dcdqdg"><code>                <span class="code-comment">// Get loaded % from YouTube</span>
</code></td></tr><tr><td id="L6146" class="css-a4x74f"><span>6146</span></td><td id="LC6146" class="css-1dcdqdg"><code>                player.media.buffered = instance.getVideoLoadedFraction();
</code></td></tr><tr><td id="L6147" class="css-a4x74f"><span>6147</span></td><td id="LC6147" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'progress'</span>);
</code></td></tr><tr><td id="L6148" class="css-a4x74f"><span>6148</span></td><td id="LC6148" class="css-1dcdqdg"><code>                <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6149" class="css-a4x74f"><span>6149</span></td><td id="LC6149" class="css-1dcdqdg"><code>              <span class="code-keyword">case</span> <span class="code-number">0</span>:
</code></td></tr><tr><td id="L6150" class="css-a4x74f"><span>6150</span></td><td id="LC6150" class="css-1dcdqdg"><code>                assurePlaybackState.call(player, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L6151" class="css-a4x74f"><span>6151</span></td><td id="LC6151" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6152" class="css-a4x74f"><span>6152</span></td><td id="LC6152" class="css-1dcdqdg"><code>                <span class="code-comment">// YouTube doesn't support loop for a single video, so mimick it.</span>
</code></td></tr><tr><td id="L6153" class="css-a4x74f"><span>6153</span></td><td id="LC6153" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (player.media.loop) {
</code></td></tr><tr><td id="L6154" class="css-a4x74f"><span>6154</span></td><td id="LC6154" class="css-1dcdqdg"><code>                  <span class="code-comment">// YouTube needs a call to `stopVideo` before playing again</span>
</code></td></tr><tr><td id="L6155" class="css-a4x74f"><span>6155</span></td><td id="LC6155" class="css-1dcdqdg"><code>                  instance.stopVideo();
</code></td></tr><tr><td id="L6156" class="css-a4x74f"><span>6156</span></td><td id="LC6156" class="css-1dcdqdg"><code>                  instance.playVideo();
</code></td></tr><tr><td id="L6157" class="css-a4x74f"><span>6157</span></td><td id="LC6157" class="css-1dcdqdg"><code>                } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6158" class="css-a4x74f"><span>6158</span></td><td id="LC6158" class="css-1dcdqdg"><code>                  triggerEvent.call(player, player.media, <span class="code-string">'ended'</span>);
</code></td></tr><tr><td id="L6159" class="css-a4x74f"><span>6159</span></td><td id="LC6159" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L6160" class="css-a4x74f"><span>6160</span></td><td id="LC6160" class="css-1dcdqdg"><code>                <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6161" class="css-a4x74f"><span>6161</span></td><td id="LC6161" class="css-1dcdqdg"><code>              <span class="code-keyword">case</span> <span class="code-number">1</span>:
</code></td></tr><tr><td id="L6162" class="css-a4x74f"><span>6162</span></td><td id="LC6162" class="css-1dcdqdg"><code>                <span class="code-comment">// Restore paused state (YouTube starts playing on seek if the video hasn't been played yet)</span>
</code></td></tr><tr><td id="L6163" class="css-a4x74f"><span>6163</span></td><td id="LC6163" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (config.customControls &amp;&amp; !player.config.autoplay &amp;&amp; player.media.paused &amp;&amp; !player.embed.hasPlayed) {
</code></td></tr><tr><td id="L6164" class="css-a4x74f"><span>6164</span></td><td id="LC6164" class="css-1dcdqdg"><code>                  player.media.pause();
</code></td></tr><tr><td id="L6165" class="css-a4x74f"><span>6165</span></td><td id="LC6165" class="css-1dcdqdg"><code>                } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6166" class="css-a4x74f"><span>6166</span></td><td id="LC6166" class="css-1dcdqdg"><code>                  assurePlaybackState.call(player, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L6167" class="css-a4x74f"><span>6167</span></td><td id="LC6167" class="css-1dcdqdg"><code>                  triggerEvent.call(player, player.media, <span class="code-string">'playing'</span>);
</code></td></tr><tr><td id="L6168" class="css-a4x74f"><span>6168</span></td><td id="LC6168" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6169" class="css-a4x74f"><span>6169</span></td><td id="LC6169" class="css-1dcdqdg"><code>                  <span class="code-comment">// Poll to get playback progress</span>
</code></td></tr><tr><td id="L6170" class="css-a4x74f"><span>6170</span></td><td id="LC6170" class="css-1dcdqdg"><code>                  player.timers.playing = setInterval(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6171" class="css-a4x74f"><span>6171</span></td><td id="LC6171" class="css-1dcdqdg"><code>                    triggerEvent.call(player, player.media, <span class="code-string">'timeupdate'</span>);
</code></td></tr><tr><td id="L6172" class="css-a4x74f"><span>6172</span></td><td id="LC6172" class="css-1dcdqdg"><code>                  }, <span class="code-number">50</span>);
</code></td></tr><tr><td id="L6173" class="css-a4x74f"><span>6173</span></td><td id="LC6173" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6174" class="css-a4x74f"><span>6174</span></td><td id="LC6174" class="css-1dcdqdg"><code>                  <span class="code-comment">// Check duration again due to YouTube bug</span>
</code></td></tr><tr><td id="L6175" class="css-a4x74f"><span>6175</span></td><td id="LC6175" class="css-1dcdqdg"><code>                  <span class="code-comment">// https://github.com/sampotts/plyr/issues/374</span>
</code></td></tr><tr><td id="L6176" class="css-a4x74f"><span>6176</span></td><td id="LC6176" class="css-1dcdqdg"><code>                  <span class="code-comment">// https://code.google.com/p/gdata-issues/issues/detail?id=8690</span>
</code></td></tr><tr><td id="L6177" class="css-a4x74f"><span>6177</span></td><td id="LC6177" class="css-1dcdqdg"><code>                  <span class="code-keyword">if</span> (player.media.duration !== instance.getDuration()) {
</code></td></tr><tr><td id="L6178" class="css-a4x74f"><span>6178</span></td><td id="LC6178" class="css-1dcdqdg"><code>                    player.media.duration = instance.getDuration();
</code></td></tr><tr><td id="L6179" class="css-a4x74f"><span>6179</span></td><td id="LC6179" class="css-1dcdqdg"><code>                    triggerEvent.call(player, player.media, <span class="code-string">'durationchange'</span>);
</code></td></tr><tr><td id="L6180" class="css-a4x74f"><span>6180</span></td><td id="LC6180" class="css-1dcdqdg"><code>                  }
</code></td></tr><tr><td id="L6181" class="css-a4x74f"><span>6181</span></td><td id="LC6181" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L6182" class="css-a4x74f"><span>6182</span></td><td id="LC6182" class="css-1dcdqdg"><code>                <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6183" class="css-a4x74f"><span>6183</span></td><td id="LC6183" class="css-1dcdqdg"><code>              <span class="code-keyword">case</span> <span class="code-number">2</span>:
</code></td></tr><tr><td id="L6184" class="css-a4x74f"><span>6184</span></td><td id="LC6184" class="css-1dcdqdg"><code>                <span class="code-comment">// Restore audio (YouTube starts playing on seek if the video hasn't been played yet)</span>
</code></td></tr><tr><td id="L6185" class="css-a4x74f"><span>6185</span></td><td id="LC6185" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (!player.muted) {
</code></td></tr><tr><td id="L6186" class="css-a4x74f"><span>6186</span></td><td id="LC6186" class="css-1dcdqdg"><code>                  player.embed.unMute();
</code></td></tr><tr><td id="L6187" class="css-a4x74f"><span>6187</span></td><td id="LC6187" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L6188" class="css-a4x74f"><span>6188</span></td><td id="LC6188" class="css-1dcdqdg"><code>                assurePlaybackState.call(player, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L6189" class="css-a4x74f"><span>6189</span></td><td id="LC6189" class="css-1dcdqdg"><code>                <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6190" class="css-a4x74f"><span>6190</span></td><td id="LC6190" class="css-1dcdqdg"><code>              <span class="code-keyword">case</span> <span class="code-number">3</span>:
</code></td></tr><tr><td id="L6191" class="css-a4x74f"><span>6191</span></td><td id="LC6191" class="css-1dcdqdg"><code>                <span class="code-comment">// Trigger waiting event to add loading classes to container as the video buffers.</span>
</code></td></tr><tr><td id="L6192" class="css-a4x74f"><span>6192</span></td><td id="LC6192" class="css-1dcdqdg"><code>                triggerEvent.call(player, player.media, <span class="code-string">'waiting'</span>);
</code></td></tr><tr><td id="L6193" class="css-a4x74f"><span>6193</span></td><td id="LC6193" class="css-1dcdqdg"><code>                <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6194" class="css-a4x74f"><span>6194</span></td><td id="LC6194" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6195" class="css-a4x74f"><span>6195</span></td><td id="LC6195" class="css-1dcdqdg"><code>            triggerEvent.call(player, player.elements.container, <span class="code-string">'statechange'</span>, <span class="code-literal">false</span>, {
</code></td></tr><tr><td id="L6196" class="css-a4x74f"><span>6196</span></td><td id="LC6196" class="css-1dcdqdg"><code>              code: event.data
</code></td></tr><tr><td id="L6197" class="css-a4x74f"><span>6197</span></td><td id="LC6197" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6198" class="css-a4x74f"><span>6198</span></td><td id="LC6198" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6199" class="css-a4x74f"><span>6199</span></td><td id="LC6199" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6200" class="css-a4x74f"><span>6200</span></td><td id="LC6200" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6201" class="css-a4x74f"><span>6201</span></td><td id="LC6201" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6202" class="css-a4x74f"><span>6202</span></td><td id="LC6202" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L6203" class="css-a4x74f"><span>6203</span></td><td id="LC6203" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6204" class="css-a4x74f"><span>6204</span></td><td id="LC6204" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L6205" class="css-a4x74f"><span>6205</span></td><td id="LC6205" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> media = {
</code></td></tr><tr><td id="L6206" class="css-a4x74f"><span>6206</span></td><td id="LC6206" class="css-1dcdqdg"><code>    <span class="code-comment">// Setup media</span>
</code></td></tr><tr><td id="L6207" class="css-a4x74f"><span>6207</span></td><td id="LC6207" class="css-1dcdqdg"><code>    setup() {
</code></td></tr><tr><td id="L6208" class="css-a4x74f"><span>6208</span></td><td id="LC6208" class="css-1dcdqdg"><code>      <span class="code-comment">// If there's no media, bail</span>
</code></td></tr><tr><td id="L6209" class="css-a4x74f"><span>6209</span></td><td id="LC6209" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.media) {
</code></td></tr><tr><td id="L6210" class="css-a4x74f"><span>6210</span></td><td id="LC6210" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'No media element found!'</span>);
</code></td></tr><tr><td id="L6211" class="css-a4x74f"><span>6211</span></td><td id="LC6211" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6212" class="css-a4x74f"><span>6212</span></td><td id="LC6212" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6213" class="css-a4x74f"><span>6213</span></td><td id="LC6213" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6214" class="css-a4x74f"><span>6214</span></td><td id="LC6214" class="css-1dcdqdg"><code>      <span class="code-comment">// Add type class</span>
</code></td></tr><tr><td id="L6215" class="css-a4x74f"><span>6215</span></td><td id="LC6215" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.type.replace(<span class="code-string">'{0}'</span>, <span class="code-keyword">this</span>.type), <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L6216" class="css-a4x74f"><span>6216</span></td><td id="LC6216" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6217" class="css-a4x74f"><span>6217</span></td><td id="LC6217" class="css-1dcdqdg"><code>      <span class="code-comment">// Add provider class</span>
</code></td></tr><tr><td id="L6218" class="css-a4x74f"><span>6218</span></td><td id="LC6218" class="css-1dcdqdg"><code>      toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.provider.replace(<span class="code-string">'{0}'</span>, <span class="code-keyword">this</span>.provider), <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L6219" class="css-a4x74f"><span>6219</span></td><td id="LC6219" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6220" class="css-a4x74f"><span>6220</span></td><td id="LC6220" class="css-1dcdqdg"><code>      <span class="code-comment">// Add video class for embeds</span>
</code></td></tr><tr><td id="L6221" class="css-a4x74f"><span>6221</span></td><td id="LC6221" class="css-1dcdqdg"><code>      <span class="code-comment">// This will require changes if audio embeds are added</span>
</code></td></tr><tr><td id="L6222" class="css-a4x74f"><span>6222</span></td><td id="LC6222" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isEmbed) {
</code></td></tr><tr><td id="L6223" class="css-a4x74f"><span>6223</span></td><td id="LC6223" class="css-1dcdqdg"><code>        toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.type.replace(<span class="code-string">'{0}'</span>, <span class="code-string">'video'</span>), <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L6224" class="css-a4x74f"><span>6224</span></td><td id="LC6224" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6225" class="css-a4x74f"><span>6225</span></td><td id="LC6225" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6226" class="css-a4x74f"><span>6226</span></td><td id="LC6226" class="css-1dcdqdg"><code>      <span class="code-comment">// Inject the player wrapper</span>
</code></td></tr><tr><td id="L6227" class="css-a4x74f"><span>6227</span></td><td id="LC6227" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L6228" class="css-a4x74f"><span>6228</span></td><td id="LC6228" class="css-1dcdqdg"><code>        <span class="code-comment">// Create the wrapper div</span>
</code></td></tr><tr><td id="L6229" class="css-a4x74f"><span>6229</span></td><td id="LC6229" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.wrapper = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L6230" class="css-a4x74f"><span>6230</span></td><td id="LC6230" class="css-1dcdqdg"><code>          class: this.config.classNames.video
</code></td></tr><tr><td id="L6231" class="css-a4x74f"><span>6231</span></td><td id="LC6231" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6232" class="css-a4x74f"><span>6232</span></td><td id="LC6232" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6233" class="css-a4x74f"><span>6233</span></td><td id="LC6233" class="css-1dcdqdg"><code>        <span class="code-comment">// Wrap the video in a container</span>
</code></td></tr><tr><td id="L6234" class="css-a4x74f"><span>6234</span></td><td id="LC6234" class="css-1dcdqdg"><code>        wrap(<span class="code-keyword">this</span>.media, <span class="code-keyword">this</span>.elements.wrapper);
</code></td></tr><tr><td id="L6235" class="css-a4x74f"><span>6235</span></td><td id="LC6235" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6236" class="css-a4x74f"><span>6236</span></td><td id="LC6236" class="css-1dcdqdg"><code>        <span class="code-comment">// Poster image container</span>
</code></td></tr><tr><td id="L6237" class="css-a4x74f"><span>6237</span></td><td id="LC6237" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.poster = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L6238" class="css-a4x74f"><span>6238</span></td><td id="LC6238" class="css-1dcdqdg"><code>          class: this.config.classNames.poster
</code></td></tr><tr><td id="L6239" class="css-a4x74f"><span>6239</span></td><td id="LC6239" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6240" class="css-a4x74f"><span>6240</span></td><td id="LC6240" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.wrapper.appendChild(<span class="code-keyword">this</span>.elements.poster);
</code></td></tr><tr><td id="L6241" class="css-a4x74f"><span>6241</span></td><td id="LC6241" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6242" class="css-a4x74f"><span>6242</span></td><td id="LC6242" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L6243" class="css-a4x74f"><span>6243</span></td><td id="LC6243" class="css-1dcdqdg"><code>        html5.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L6244" class="css-a4x74f"><span>6244</span></td><td id="LC6244" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isYouTube) {
</code></td></tr><tr><td id="L6245" class="css-a4x74f"><span>6245</span></td><td id="LC6245" class="css-1dcdqdg"><code>        youtube.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L6246" class="css-a4x74f"><span>6246</span></td><td id="LC6246" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo) {
</code></td></tr><tr><td id="L6247" class="css-a4x74f"><span>6247</span></td><td id="LC6247" class="css-1dcdqdg"><code>        vimeo.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L6248" class="css-a4x74f"><span>6248</span></td><td id="LC6248" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6249" class="css-a4x74f"><span>6249</span></td><td id="LC6249" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6250" class="css-a4x74f"><span>6250</span></td><td id="LC6250" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L6251" class="css-a4x74f"><span>6251</span></td><td id="LC6251" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6252" class="css-a4x74f"><span>6252</span></td><td id="LC6252" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> destroy = <span class="code-function"><span class="code-params">instance</span> =&gt;</span> {
</code></td></tr><tr><td id="L6253" class="css-a4x74f"><span>6253</span></td><td id="LC6253" class="css-1dcdqdg"><code>    <span class="code-comment">// Destroy our adsManager</span>
</code></td></tr><tr><td id="L6254" class="css-a4x74f"><span>6254</span></td><td id="LC6254" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (instance.manager) {
</code></td></tr><tr><td id="L6255" class="css-a4x74f"><span>6255</span></td><td id="LC6255" class="css-1dcdqdg"><code>      instance.manager.destroy();
</code></td></tr><tr><td id="L6256" class="css-a4x74f"><span>6256</span></td><td id="LC6256" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6257" class="css-a4x74f"><span>6257</span></td><td id="LC6257" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6258" class="css-a4x74f"><span>6258</span></td><td id="LC6258" class="css-1dcdqdg"><code>    <span class="code-comment">// Destroy our adsManager</span>
</code></td></tr><tr><td id="L6259" class="css-a4x74f"><span>6259</span></td><td id="LC6259" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (instance.elements.displayContainer) {
</code></td></tr><tr><td id="L6260" class="css-a4x74f"><span>6260</span></td><td id="LC6260" class="css-1dcdqdg"><code>      instance.elements.displayContainer.destroy();
</code></td></tr><tr><td id="L6261" class="css-a4x74f"><span>6261</span></td><td id="LC6261" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6262" class="css-a4x74f"><span>6262</span></td><td id="LC6262" class="css-1dcdqdg"><code>    instance.elements.container.remove();
</code></td></tr><tr><td id="L6263" class="css-a4x74f"><span>6263</span></td><td id="LC6263" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L6264" class="css-a4x74f"><span>6264</span></td><td id="LC6264" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Ads</span> </span>{
</code></td></tr><tr><td id="L6265" class="css-a4x74f"><span>6265</span></td><td id="LC6265" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6266" class="css-a4x74f"><span>6266</span></td><td id="LC6266" class="css-1dcdqdg"><code><span class="code-comment">     * Ads constructor.
</span></code></td></tr><tr><td id="L6267" class="css-a4x74f"><span>6267</span></td><td id="LC6267" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Object} player
</span></code></td></tr><tr><td id="L6268" class="css-a4x74f"><span>6268</span></td><td id="LC6268" class="css-1dcdqdg"><code><span class="code-comment">     * @return {Ads}
</span></code></td></tr><tr><td id="L6269" class="css-a4x74f"><span>6269</span></td><td id="LC6269" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L6270" class="css-a4x74f"><span>6270</span></td><td id="LC6270" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(player) {
</code></td></tr><tr><td id="L6271" class="css-a4x74f"><span>6271</span></td><td id="LC6271" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6272" class="css-a4x74f"><span>6272</span></td><td id="LC6272" class="css-1dcdqdg"><code><span class="code-comment">       * Load the IMA SDK
</span></code></td></tr><tr><td id="L6273" class="css-a4x74f"><span>6273</span></td><td id="LC6273" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6274" class="css-a4x74f"><span>6274</span></td><td id="LC6274" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"load"</span>, () =&gt; {
</code></td></tr><tr><td id="L6275" class="css-a4x74f"><span>6275</span></td><td id="LC6275" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L6276" class="css-a4x74f"><span>6276</span></td><td id="LC6276" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6277" class="css-a4x74f"><span>6277</span></td><td id="LC6277" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6278" class="css-a4x74f"><span>6278</span></td><td id="LC6278" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6279" class="css-a4x74f"><span>6279</span></td><td id="LC6279" class="css-1dcdqdg"><code>        <span class="code-comment">// Check if the Google IMA3 SDK is loaded or load it ourselves</span>
</code></td></tr><tr><td id="L6280" class="css-a4x74f"><span>6280</span></td><td id="LC6280" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.object(<span class="code-built_in">window</span>.google) || !is.object(<span class="code-built_in">window</span>.google.ima)) {
</code></td></tr><tr><td id="L6281" class="css-a4x74f"><span>6281</span></td><td id="LC6281" class="css-1dcdqdg"><code>          loadScript(<span class="code-keyword">this</span>.player.config.urls.googleIMA.sdk).then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6282" class="css-a4x74f"><span>6282</span></td><td id="LC6282" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.ready();
</code></td></tr><tr><td id="L6283" class="css-a4x74f"><span>6283</span></td><td id="LC6283" class="css-1dcdqdg"><code>          }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6284" class="css-a4x74f"><span>6284</span></td><td id="LC6284" class="css-1dcdqdg"><code>            <span class="code-comment">// Script failed to load or is blocked</span>
</code></td></tr><tr><td id="L6285" class="css-a4x74f"><span>6285</span></td><td id="LC6285" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.trigger(<span class="code-string">'error'</span>, <span class="code-keyword">new</span> <span class="code-built_in">Error</span>(<span class="code-string">'Google IMA SDK failed to load'</span>));
</code></td></tr><tr><td id="L6286" class="css-a4x74f"><span>6286</span></td><td id="LC6286" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6287" class="css-a4x74f"><span>6287</span></td><td id="LC6287" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6288" class="css-a4x74f"><span>6288</span></td><td id="LC6288" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.ready();
</code></td></tr><tr><td id="L6289" class="css-a4x74f"><span>6289</span></td><td id="LC6289" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6290" class="css-a4x74f"><span>6290</span></td><td id="LC6290" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6291" class="css-a4x74f"><span>6291</span></td><td id="LC6291" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6292" class="css-a4x74f"><span>6292</span></td><td id="LC6292" class="css-1dcdqdg"><code><span class="code-comment">       * Get the ads instance ready
</span></code></td></tr><tr><td id="L6293" class="css-a4x74f"><span>6293</span></td><td id="LC6293" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6294" class="css-a4x74f"><span>6294</span></td><td id="LC6294" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"ready"</span>, () =&gt; {
</code></td></tr><tr><td id="L6295" class="css-a4x74f"><span>6295</span></td><td id="LC6295" class="css-1dcdqdg"><code>        <span class="code-comment">// Double check we're enabled</span>
</code></td></tr><tr><td id="L6296" class="css-a4x74f"><span>6296</span></td><td id="LC6296" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L6297" class="css-a4x74f"><span>6297</span></td><td id="LC6297" class="css-1dcdqdg"><code>          destroy(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L6298" class="css-a4x74f"><span>6298</span></td><td id="LC6298" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6299" class="css-a4x74f"><span>6299</span></td><td id="LC6299" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6300" class="css-a4x74f"><span>6300</span></td><td id="LC6300" class="css-1dcdqdg"><code>        <span class="code-comment">// Start ticking our safety timer. If the whole advertisement</span>
</code></td></tr><tr><td id="L6301" class="css-a4x74f"><span>6301</span></td><td id="LC6301" class="css-1dcdqdg"><code>        <span class="code-comment">// thing doesn't resolve within our set time; we bail</span>
</code></td></tr><tr><td id="L6302" class="css-a4x74f"><span>6302</span></td><td id="LC6302" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.startSafetyTimer(<span class="code-number">12000</span>, <span class="code-string">'ready()'</span>);
</code></td></tr><tr><td id="L6303" class="css-a4x74f"><span>6303</span></td><td id="LC6303" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6304" class="css-a4x74f"><span>6304</span></td><td id="LC6304" class="css-1dcdqdg"><code>        <span class="code-comment">// Clear the safety timer</span>
</code></td></tr><tr><td id="L6305" class="css-a4x74f"><span>6305</span></td><td id="LC6305" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.managerPromise.then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6306" class="css-a4x74f"><span>6306</span></td><td id="LC6306" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.clearSafetyTimer(<span class="code-string">'onAdsManagerLoaded()'</span>);
</code></td></tr><tr><td id="L6307" class="css-a4x74f"><span>6307</span></td><td id="LC6307" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6308" class="css-a4x74f"><span>6308</span></td><td id="LC6308" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6309" class="css-a4x74f"><span>6309</span></td><td id="LC6309" class="css-1dcdqdg"><code>        <span class="code-comment">// Set listeners on the Plyr instance</span>
</code></td></tr><tr><td id="L6310" class="css-a4x74f"><span>6310</span></td><td id="LC6310" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.listeners();
</code></td></tr><tr><td id="L6311" class="css-a4x74f"><span>6311</span></td><td id="LC6311" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6312" class="css-a4x74f"><span>6312</span></td><td id="LC6312" class="css-1dcdqdg"><code>        <span class="code-comment">// Setup the IMA SDK</span>
</code></td></tr><tr><td id="L6313" class="css-a4x74f"><span>6313</span></td><td id="LC6313" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.setupIMA();
</code></td></tr><tr><td id="L6314" class="css-a4x74f"><span>6314</span></td><td id="LC6314" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6315" class="css-a4x74f"><span>6315</span></td><td id="LC6315" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6316" class="css-a4x74f"><span>6316</span></td><td id="LC6316" class="css-1dcdqdg"><code><span class="code-comment">       * In order for the SDK to display ads for our video, we need to tell it where to put them,
</span></code></td></tr><tr><td id="L6317" class="css-a4x74f"><span>6317</span></td><td id="LC6317" class="css-1dcdqdg"><code><span class="code-comment">       * so here we define our ad container. This div is set up to render on top of the video player.
</span></code></td></tr><tr><td id="L6318" class="css-a4x74f"><span>6318</span></td><td id="LC6318" class="css-1dcdqdg"><code><span class="code-comment">       * Using the code below, we tell the SDK to render ads within that div. We also provide a
</span></code></td></tr><tr><td id="L6319" class="css-a4x74f"><span>6319</span></td><td id="LC6319" class="css-1dcdqdg"><code><span class="code-comment">       * handle to the content video player - the SDK will poll the current time of our player to
</span></code></td></tr><tr><td id="L6320" class="css-a4x74f"><span>6320</span></td><td id="LC6320" class="css-1dcdqdg"><code><span class="code-comment">       * properly place mid-rolls. After we create the ad display container, we initialize it. On
</span></code></td></tr><tr><td id="L6321" class="css-a4x74f"><span>6321</span></td><td id="LC6321" class="css-1dcdqdg"><code><span class="code-comment">       * mobile devices, this initialization is done as the result of a user action.
</span></code></td></tr><tr><td id="L6322" class="css-a4x74f"><span>6322</span></td><td id="LC6322" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6323" class="css-a4x74f"><span>6323</span></td><td id="LC6323" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"setupIMA"</span>, () =&gt; {
</code></td></tr><tr><td id="L6324" class="css-a4x74f"><span>6324</span></td><td id="LC6324" class="css-1dcdqdg"><code>        <span class="code-comment">// Create the container for our advertisements</span>
</code></td></tr><tr><td id="L6325" class="css-a4x74f"><span>6325</span></td><td id="LC6325" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L6326" class="css-a4x74f"><span>6326</span></td><td id="LC6326" class="css-1dcdqdg"><code>          class: this.player.config.classNames.ads
</code></td></tr><tr><td id="L6327" class="css-a4x74f"><span>6327</span></td><td id="LC6327" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6328" class="css-a4x74f"><span>6328</span></td><td id="LC6328" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.elements.container.appendChild(<span class="code-keyword">this</span>.elements.container);
</code></td></tr><tr><td id="L6329" class="css-a4x74f"><span>6329</span></td><td id="LC6329" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6330" class="css-a4x74f"><span>6330</span></td><td id="LC6330" class="css-1dcdqdg"><code>        <span class="code-comment">// So we can run VPAID2</span>
</code></td></tr><tr><td id="L6331" class="css-a4x74f"><span>6331</span></td><td id="LC6331" class="css-1dcdqdg"><code>        google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);
</code></td></tr><tr><td id="L6332" class="css-a4x74f"><span>6332</span></td><td id="LC6332" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6333" class="css-a4x74f"><span>6333</span></td><td id="LC6333" class="css-1dcdqdg"><code>        <span class="code-comment">// Set language</span>
</code></td></tr><tr><td id="L6334" class="css-a4x74f"><span>6334</span></td><td id="LC6334" class="css-1dcdqdg"><code>        google.ima.settings.setLocale(<span class="code-keyword">this</span>.player.config.ads.language);
</code></td></tr><tr><td id="L6335" class="css-a4x74f"><span>6335</span></td><td id="LC6335" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6336" class="css-a4x74f"><span>6336</span></td><td id="LC6336" class="css-1dcdqdg"><code>        <span class="code-comment">// Set playback for iOS10+</span>
</code></td></tr><tr><td id="L6337" class="css-a4x74f"><span>6337</span></td><td id="LC6337" class="css-1dcdqdg"><code>        google.ima.settings.setDisableCustomPlaybackForIOS10Plus(<span class="code-keyword">this</span>.player.config.playsinline);
</code></td></tr><tr><td id="L6338" class="css-a4x74f"><span>6338</span></td><td id="LC6338" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6339" class="css-a4x74f"><span>6339</span></td><td id="LC6339" class="css-1dcdqdg"><code>        <span class="code-comment">// We assume the adContainer is the video container of the plyr element that will house the ads</span>
</code></td></tr><tr><td id="L6340" class="css-a4x74f"><span>6340</span></td><td id="LC6340" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.displayContainer = <span class="code-keyword">new</span> google.ima.AdDisplayContainer(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.player.media);
</code></td></tr><tr><td id="L6341" class="css-a4x74f"><span>6341</span></td><td id="LC6341" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6342" class="css-a4x74f"><span>6342</span></td><td id="LC6342" class="css-1dcdqdg"><code>        <span class="code-comment">// Create ads loader</span>
</code></td></tr><tr><td id="L6343" class="css-a4x74f"><span>6343</span></td><td id="LC6343" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.loader = <span class="code-keyword">new</span> google.ima.AdsLoader(<span class="code-keyword">this</span>.elements.displayContainer);
</code></td></tr><tr><td id="L6344" class="css-a4x74f"><span>6344</span></td><td id="LC6344" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6345" class="css-a4x74f"><span>6345</span></td><td id="LC6345" class="css-1dcdqdg"><code>        <span class="code-comment">// Listen and respond to ads loaded and error events</span>
</code></td></tr><tr><td id="L6346" class="css-a4x74f"><span>6346</span></td><td id="LC6346" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, event =&gt; <span class="code-keyword">this</span>.onAdsManagerLoaded(event), <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L6347" class="css-a4x74f"><span>6347</span></td><td id="LC6347" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, error =&gt; <span class="code-keyword">this</span>.onAdError(error), <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L6348" class="css-a4x74f"><span>6348</span></td><td id="LC6348" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6349" class="css-a4x74f"><span>6349</span></td><td id="LC6349" class="css-1dcdqdg"><code>        <span class="code-comment">// Request video ads to be pre-loaded</span>
</code></td></tr><tr><td id="L6350" class="css-a4x74f"><span>6350</span></td><td id="LC6350" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.requestAds();
</code></td></tr><tr><td id="L6351" class="css-a4x74f"><span>6351</span></td><td id="LC6351" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6352" class="css-a4x74f"><span>6352</span></td><td id="LC6352" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6353" class="css-a4x74f"><span>6353</span></td><td id="LC6353" class="css-1dcdqdg"><code><span class="code-comment">       * Request advertisements
</span></code></td></tr><tr><td id="L6354" class="css-a4x74f"><span>6354</span></td><td id="LC6354" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6355" class="css-a4x74f"><span>6355</span></td><td id="LC6355" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"requestAds"</span>, () =&gt; {
</code></td></tr><tr><td id="L6356" class="css-a4x74f"><span>6356</span></td><td id="LC6356" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6357" class="css-a4x74f"><span>6357</span></td><td id="LC6357" class="css-1dcdqdg"><code>          container
</code></td></tr><tr><td id="L6358" class="css-a4x74f"><span>6358</span></td><td id="LC6358" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.player.elements;
</code></td></tr><tr><td id="L6359" class="css-a4x74f"><span>6359</span></td><td id="LC6359" class="css-1dcdqdg"><code>        <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L6360" class="css-a4x74f"><span>6360</span></td><td id="LC6360" class="css-1dcdqdg"><code>          <span class="code-comment">// Request video ads</span>
</code></td></tr><tr><td id="L6361" class="css-a4x74f"><span>6361</span></td><td id="LC6361" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> request = <span class="code-keyword">new</span> google.ima.AdsRequest();
</code></td></tr><tr><td id="L6362" class="css-a4x74f"><span>6362</span></td><td id="LC6362" class="css-1dcdqdg"><code>          request.adTagUrl = <span class="code-keyword">this</span>.tagUrl;
</code></td></tr><tr><td id="L6363" class="css-a4x74f"><span>6363</span></td><td id="LC6363" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6364" class="css-a4x74f"><span>6364</span></td><td id="LC6364" class="css-1dcdqdg"><code>          <span class="code-comment">// Specify the linear and nonlinear slot sizes. This helps the SDK</span>
</code></td></tr><tr><td id="L6365" class="css-a4x74f"><span>6365</span></td><td id="LC6365" class="css-1dcdqdg"><code>          <span class="code-comment">// to select the correct creative if multiple are returned</span>
</code></td></tr><tr><td id="L6366" class="css-a4x74f"><span>6366</span></td><td id="LC6366" class="css-1dcdqdg"><code>          request.linearAdSlotWidth = container.offsetWidth;
</code></td></tr><tr><td id="L6367" class="css-a4x74f"><span>6367</span></td><td id="LC6367" class="css-1dcdqdg"><code>          request.linearAdSlotHeight = container.offsetHeight;
</code></td></tr><tr><td id="L6368" class="css-a4x74f"><span>6368</span></td><td id="LC6368" class="css-1dcdqdg"><code>          request.nonLinearAdSlotWidth = container.offsetWidth;
</code></td></tr><tr><td id="L6369" class="css-a4x74f"><span>6369</span></td><td id="LC6369" class="css-1dcdqdg"><code>          request.nonLinearAdSlotHeight = container.offsetHeight;
</code></td></tr><tr><td id="L6370" class="css-a4x74f"><span>6370</span></td><td id="LC6370" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6371" class="css-a4x74f"><span>6371</span></td><td id="LC6371" class="css-1dcdqdg"><code>          <span class="code-comment">// We only overlay ads as we only support video.</span>
</code></td></tr><tr><td id="L6372" class="css-a4x74f"><span>6372</span></td><td id="LC6372" class="css-1dcdqdg"><code>          request.forceNonLinearFullSlot = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6373" class="css-a4x74f"><span>6373</span></td><td id="LC6373" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6374" class="css-a4x74f"><span>6374</span></td><td id="LC6374" class="css-1dcdqdg"><code>          <span class="code-comment">// Mute based on current state</span>
</code></td></tr><tr><td id="L6375" class="css-a4x74f"><span>6375</span></td><td id="LC6375" class="css-1dcdqdg"><code>          request.setAdWillPlayMuted(!<span class="code-keyword">this</span>.player.muted);
</code></td></tr><tr><td id="L6376" class="css-a4x74f"><span>6376</span></td><td id="LC6376" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.loader.requestAds(request);
</code></td></tr><tr><td id="L6377" class="css-a4x74f"><span>6377</span></td><td id="LC6377" class="css-1dcdqdg"><code>        } <span class="code-keyword">catch</span> (error) {
</code></td></tr><tr><td id="L6378" class="css-a4x74f"><span>6378</span></td><td id="LC6378" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.onAdError(error);
</code></td></tr><tr><td id="L6379" class="css-a4x74f"><span>6379</span></td><td id="LC6379" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6380" class="css-a4x74f"><span>6380</span></td><td id="LC6380" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6381" class="css-a4x74f"><span>6381</span></td><td id="LC6381" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6382" class="css-a4x74f"><span>6382</span></td><td id="LC6382" class="css-1dcdqdg"><code><span class="code-comment">       * Update the ad countdown
</span></code></td></tr><tr><td id="L6383" class="css-a4x74f"><span>6383</span></td><td id="LC6383" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} start
</span></code></td></tr><tr><td id="L6384" class="css-a4x74f"><span>6384</span></td><td id="LC6384" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6385" class="css-a4x74f"><span>6385</span></td><td id="LC6385" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"pollCountdown"</span>, (start = <span class="code-literal">false</span>) =&gt; {
</code></td></tr><tr><td id="L6386" class="css-a4x74f"><span>6386</span></td><td id="LC6386" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!start) {
</code></td></tr><tr><td id="L6387" class="css-a4x74f"><span>6387</span></td><td id="LC6387" class="css-1dcdqdg"><code>          clearInterval(<span class="code-keyword">this</span>.countdownTimer);
</code></td></tr><tr><td id="L6388" class="css-a4x74f"><span>6388</span></td><td id="LC6388" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.container.removeAttribute(<span class="code-string">'data-badge-text'</span>);
</code></td></tr><tr><td id="L6389" class="css-a4x74f"><span>6389</span></td><td id="LC6389" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6390" class="css-a4x74f"><span>6390</span></td><td id="LC6390" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6391" class="css-a4x74f"><span>6391</span></td><td id="LC6391" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> update = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6392" class="css-a4x74f"><span>6392</span></td><td id="LC6392" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> time = formatTime(<span class="code-built_in">Math</span>.max(<span class="code-keyword">this</span>.manager.getRemainingTime(), <span class="code-number">0</span>));
</code></td></tr><tr><td id="L6393" class="css-a4x74f"><span>6393</span></td><td id="LC6393" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> label = <span class="code-string">`<span class="code-subst">${i18n.get(<span class="code-string">'advertisement'</span>, <span class="code-keyword">this</span>.player.config)}</span> - <span class="code-subst">${time}</span>`</span>;
</code></td></tr><tr><td id="L6394" class="css-a4x74f"><span>6394</span></td><td id="LC6394" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.container.setAttribute(<span class="code-string">'data-badge-text'</span>, label);
</code></td></tr><tr><td id="L6395" class="css-a4x74f"><span>6395</span></td><td id="LC6395" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L6396" class="css-a4x74f"><span>6396</span></td><td id="LC6396" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.countdownTimer = setInterval(update, <span class="code-number">100</span>);
</code></td></tr><tr><td id="L6397" class="css-a4x74f"><span>6397</span></td><td id="LC6397" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6398" class="css-a4x74f"><span>6398</span></td><td id="LC6398" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6399" class="css-a4x74f"><span>6399</span></td><td id="LC6399" class="css-1dcdqdg"><code><span class="code-comment">       * This method is called whenever the ads are ready inside the AdDisplayContainer
</span></code></td></tr><tr><td id="L6400" class="css-a4x74f"><span>6400</span></td><td id="LC6400" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Event} event - adsManagerLoadedEvent
</span></code></td></tr><tr><td id="L6401" class="css-a4x74f"><span>6401</span></td><td id="LC6401" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6402" class="css-a4x74f"><span>6402</span></td><td id="LC6402" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"onAdsManagerLoaded"</span>, event =&gt; {
</code></td></tr><tr><td id="L6403" class="css-a4x74f"><span>6403</span></td><td id="LC6403" class="css-1dcdqdg"><code>        <span class="code-comment">// Load could occur after a source change (race condition)</span>
</code></td></tr><tr><td id="L6404" class="css-a4x74f"><span>6404</span></td><td id="LC6404" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L6405" class="css-a4x74f"><span>6405</span></td><td id="LC6405" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6406" class="css-a4x74f"><span>6406</span></td><td id="LC6406" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6407" class="css-a4x74f"><span>6407</span></td><td id="LC6407" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6408" class="css-a4x74f"><span>6408</span></td><td id="LC6408" class="css-1dcdqdg"><code>        <span class="code-comment">// Get the ads manager</span>
</code></td></tr><tr><td id="L6409" class="css-a4x74f"><span>6409</span></td><td id="LC6409" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> settings = <span class="code-keyword">new</span> google.ima.AdsRenderingSettings();
</code></td></tr><tr><td id="L6410" class="css-a4x74f"><span>6410</span></td><td id="LC6410" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6411" class="css-a4x74f"><span>6411</span></td><td id="LC6411" class="css-1dcdqdg"><code>        <span class="code-comment">// Tell the SDK to save and restore content video state on our behalf</span>
</code></td></tr><tr><td id="L6412" class="css-a4x74f"><span>6412</span></td><td id="LC6412" class="css-1dcdqdg"><code>        settings.restoreCustomPlaybackStateOnAdBreakComplete = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6413" class="css-a4x74f"><span>6413</span></td><td id="LC6413" class="css-1dcdqdg"><code>        settings.enablePreloading = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6414" class="css-a4x74f"><span>6414</span></td><td id="LC6414" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6415" class="css-a4x74f"><span>6415</span></td><td id="LC6415" class="css-1dcdqdg"><code>        <span class="code-comment">// The SDK is polling currentTime on the contentPlayback. And needs a duration</span>
</code></td></tr><tr><td id="L6416" class="css-a4x74f"><span>6416</span></td><td id="LC6416" class="css-1dcdqdg"><code>        <span class="code-comment">// so it can determine when to start the mid- and post-roll</span>
</code></td></tr><tr><td id="L6417" class="css-a4x74f"><span>6417</span></td><td id="LC6417" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.manager = event.getAdsManager(<span class="code-keyword">this</span>.player, settings);
</code></td></tr><tr><td id="L6418" class="css-a4x74f"><span>6418</span></td><td id="LC6418" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6419" class="css-a4x74f"><span>6419</span></td><td id="LC6419" class="css-1dcdqdg"><code>        <span class="code-comment">// Get the cue points for any mid-rolls by filtering out the pre- and post-roll</span>
</code></td></tr><tr><td id="L6420" class="css-a4x74f"><span>6420</span></td><td id="LC6420" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.cuePoints = <span class="code-keyword">this</span>.manager.getCuePoints();
</code></td></tr><tr><td id="L6421" class="css-a4x74f"><span>6421</span></td><td id="LC6421" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6422" class="css-a4x74f"><span>6422</span></td><td id="LC6422" class="css-1dcdqdg"><code>        <span class="code-comment">// Add listeners to the required events</span>
</code></td></tr><tr><td id="L6423" class="css-a4x74f"><span>6423</span></td><td id="LC6423" class="css-1dcdqdg"><code>        <span class="code-comment">// Advertisement error events</span>
</code></td></tr><tr><td id="L6424" class="css-a4x74f"><span>6424</span></td><td id="LC6424" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, error =&gt; <span class="code-keyword">this</span>.onAdError(error));
</code></td></tr><tr><td id="L6425" class="css-a4x74f"><span>6425</span></td><td id="LC6425" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6426" class="css-a4x74f"><span>6426</span></td><td id="LC6426" class="css-1dcdqdg"><code>        <span class="code-comment">// Advertisement regular events</span>
</code></td></tr><tr><td id="L6427" class="css-a4x74f"><span>6427</span></td><td id="LC6427" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.keys(google.ima.AdEvent.Type).forEach(<span class="code-function"><span class="code-params">type</span> =&gt;</span> {
</code></td></tr><tr><td id="L6428" class="css-a4x74f"><span>6428</span></td><td id="LC6428" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.manager.addEventListener(google.ima.AdEvent.Type[type], e =&gt; <span class="code-keyword">this</span>.onAdEvent(e));
</code></td></tr><tr><td id="L6429" class="css-a4x74f"><span>6429</span></td><td id="LC6429" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6430" class="css-a4x74f"><span>6430</span></td><td id="LC6430" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6431" class="css-a4x74f"><span>6431</span></td><td id="LC6431" class="css-1dcdqdg"><code>        <span class="code-comment">// Resolve our adsManager</span>
</code></td></tr><tr><td id="L6432" class="css-a4x74f"><span>6432</span></td><td id="LC6432" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.trigger(<span class="code-string">'loaded'</span>);
</code></td></tr><tr><td id="L6433" class="css-a4x74f"><span>6433</span></td><td id="LC6433" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6434" class="css-a4x74f"><span>6434</span></td><td id="LC6434" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"addCuePoints"</span>, () =&gt; {
</code></td></tr><tr><td id="L6435" class="css-a4x74f"><span>6435</span></td><td id="LC6435" class="css-1dcdqdg"><code>        <span class="code-comment">// Add advertisement cue's within the time line if available</span>
</code></td></tr><tr><td id="L6436" class="css-a4x74f"><span>6436</span></td><td id="LC6436" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.cuePoints)) {
</code></td></tr><tr><td id="L6437" class="css-a4x74f"><span>6437</span></td><td id="LC6437" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.cuePoints.forEach(<span class="code-function"><span class="code-params">cuePoint</span> =&gt;</span> {
</code></td></tr><tr><td id="L6438" class="css-a4x74f"><span>6438</span></td><td id="LC6438" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (cuePoint !== <span class="code-number">0</span> &amp;&amp; cuePoint !== <span class="code-number">-1</span> &amp;&amp; cuePoint &lt; <span class="code-keyword">this</span>.player.duration) {
</code></td></tr><tr><td id="L6439" class="css-a4x74f"><span>6439</span></td><td id="LC6439" class="css-1dcdqdg"><code>              <span class="code-keyword">const</span> seekElement = <span class="code-keyword">this</span>.player.elements.progress;
</code></td></tr><tr><td id="L6440" class="css-a4x74f"><span>6440</span></td><td id="LC6440" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (is.element(seekElement)) {
</code></td></tr><tr><td id="L6441" class="css-a4x74f"><span>6441</span></td><td id="LC6441" class="css-1dcdqdg"><code>                <span class="code-keyword">const</span> cuePercentage = <span class="code-number">100</span> / <span class="code-keyword">this</span>.player.duration * cuePoint;
</code></td></tr><tr><td id="L6442" class="css-a4x74f"><span>6442</span></td><td id="LC6442" class="css-1dcdqdg"><code>                <span class="code-keyword">const</span> cue = createElement(<span class="code-string">'span'</span>, {
</code></td></tr><tr><td id="L6443" class="css-a4x74f"><span>6443</span></td><td id="LC6443" class="css-1dcdqdg"><code>                  class: this.player.config.classNames.cues
</code></td></tr><tr><td id="L6444" class="css-a4x74f"><span>6444</span></td><td id="LC6444" class="css-1dcdqdg"><code>                });
</code></td></tr><tr><td id="L6445" class="css-a4x74f"><span>6445</span></td><td id="LC6445" class="css-1dcdqdg"><code>                cue.style.left = <span class="code-string">`<span class="code-subst">${cuePercentage.toString()}</span>%`</span>;
</code></td></tr><tr><td id="L6446" class="css-a4x74f"><span>6446</span></td><td id="LC6446" class="css-1dcdqdg"><code>                seekElement.appendChild(cue);
</code></td></tr><tr><td id="L6447" class="css-a4x74f"><span>6447</span></td><td id="LC6447" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L6448" class="css-a4x74f"><span>6448</span></td><td id="LC6448" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6449" class="css-a4x74f"><span>6449</span></td><td id="LC6449" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6450" class="css-a4x74f"><span>6450</span></td><td id="LC6450" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6451" class="css-a4x74f"><span>6451</span></td><td id="LC6451" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6452" class="css-a4x74f"><span>6452</span></td><td id="LC6452" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6453" class="css-a4x74f"><span>6453</span></td><td id="LC6453" class="css-1dcdqdg"><code><span class="code-comment">       * This is where all the event handling takes place. Retrieve the ad from the event. Some
</span></code></td></tr><tr><td id="L6454" class="css-a4x74f"><span>6454</span></td><td id="LC6454" class="css-1dcdqdg"><code><span class="code-comment">       * events (e.g. ALL_ADS_COMPLETED) don't have the ad object associated
</span></code></td></tr><tr><td id="L6455" class="css-a4x74f"><span>6455</span></td><td id="LC6455" class="css-1dcdqdg"><code><span class="code-comment">       * https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdEvent.Type
</span></code></td></tr><tr><td id="L6456" class="css-a4x74f"><span>6456</span></td><td id="LC6456" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Event} event
</span></code></td></tr><tr><td id="L6457" class="css-a4x74f"><span>6457</span></td><td id="LC6457" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6458" class="css-a4x74f"><span>6458</span></td><td id="LC6458" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"onAdEvent"</span>, event =&gt; {
</code></td></tr><tr><td id="L6459" class="css-a4x74f"><span>6459</span></td><td id="LC6459" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6460" class="css-a4x74f"><span>6460</span></td><td id="LC6460" class="css-1dcdqdg"><code>          container
</code></td></tr><tr><td id="L6461" class="css-a4x74f"><span>6461</span></td><td id="LC6461" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.player.elements;
</code></td></tr><tr><td id="L6462" class="css-a4x74f"><span>6462</span></td><td id="LC6462" class="css-1dcdqdg"><code>        <span class="code-comment">// Retrieve the ad from the event. Some events (e.g. ALL_ADS_COMPLETED)</span>
</code></td></tr><tr><td id="L6463" class="css-a4x74f"><span>6463</span></td><td id="LC6463" class="css-1dcdqdg"><code>        <span class="code-comment">// don't have ad object associated</span>
</code></td></tr><tr><td id="L6464" class="css-a4x74f"><span>6464</span></td><td id="LC6464" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> ad = event.getAd();
</code></td></tr><tr><td id="L6465" class="css-a4x74f"><span>6465</span></td><td id="LC6465" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> adData = event.getAdData();
</code></td></tr><tr><td id="L6466" class="css-a4x74f"><span>6466</span></td><td id="LC6466" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6467" class="css-a4x74f"><span>6467</span></td><td id="LC6467" class="css-1dcdqdg"><code>        <span class="code-comment">// Proxy event</span>
</code></td></tr><tr><td id="L6468" class="css-a4x74f"><span>6468</span></td><td id="LC6468" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> dispatchEvent = <span class="code-function"><span class="code-params">type</span> =&gt;</span> {
</code></td></tr><tr><td id="L6469" class="css-a4x74f"><span>6469</span></td><td id="LC6469" class="css-1dcdqdg"><code>          triggerEvent.call(<span class="code-keyword">this</span>.player, <span class="code-keyword">this</span>.player.media, <span class="code-string">`ads<span class="code-subst">${type.replace(<span class="code-regexp">/_/g</span>, <span class="code-string">''</span>).toLowerCase()}</span>`</span>);
</code></td></tr><tr><td id="L6470" class="css-a4x74f"><span>6470</span></td><td id="LC6470" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L6471" class="css-a4x74f"><span>6471</span></td><td id="LC6471" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6472" class="css-a4x74f"><span>6472</span></td><td id="LC6472" class="css-1dcdqdg"><code>        <span class="code-comment">// Bubble the event</span>
</code></td></tr><tr><td id="L6473" class="css-a4x74f"><span>6473</span></td><td id="LC6473" class="css-1dcdqdg"><code>        dispatchEvent(event.type);
</code></td></tr><tr><td id="L6474" class="css-a4x74f"><span>6474</span></td><td id="LC6474" class="css-1dcdqdg"><code>        <span class="code-keyword">switch</span> (event.type) {
</code></td></tr><tr><td id="L6475" class="css-a4x74f"><span>6475</span></td><td id="LC6475" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.LOADED:
</code></td></tr><tr><td id="L6476" class="css-a4x74f"><span>6476</span></td><td id="LC6476" class="css-1dcdqdg"><code>            <span class="code-comment">// This is the first event sent for an ad - it is possible to determine whether the</span>
</code></td></tr><tr><td id="L6477" class="css-a4x74f"><span>6477</span></td><td id="LC6477" class="css-1dcdqdg"><code>            <span class="code-comment">// ad is a video ad or an overlay</span>
</code></td></tr><tr><td id="L6478" class="css-a4x74f"><span>6478</span></td><td id="LC6478" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.trigger(<span class="code-string">'loaded'</span>);
</code></td></tr><tr><td id="L6479" class="css-a4x74f"><span>6479</span></td><td id="LC6479" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6480" class="css-a4x74f"><span>6480</span></td><td id="LC6480" class="css-1dcdqdg"><code>            <span class="code-comment">// Start countdown</span>
</code></td></tr><tr><td id="L6481" class="css-a4x74f"><span>6481</span></td><td id="LC6481" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.pollCountdown(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L6482" class="css-a4x74f"><span>6482</span></td><td id="LC6482" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!ad.isLinear()) {
</code></td></tr><tr><td id="L6483" class="css-a4x74f"><span>6483</span></td><td id="LC6483" class="css-1dcdqdg"><code>              <span class="code-comment">// Position AdDisplayContainer correctly for overlay</span>
</code></td></tr><tr><td id="L6484" class="css-a4x74f"><span>6484</span></td><td id="LC6484" class="css-1dcdqdg"><code>              ad.width = container.offsetWidth;
</code></td></tr><tr><td id="L6485" class="css-a4x74f"><span>6485</span></td><td id="LC6485" class="css-1dcdqdg"><code>              ad.height = container.offsetHeight;
</code></td></tr><tr><td id="L6486" class="css-a4x74f"><span>6486</span></td><td id="LC6486" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6487" class="css-a4x74f"><span>6487</span></td><td id="LC6487" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6488" class="css-a4x74f"><span>6488</span></td><td id="LC6488" class="css-1dcdqdg"><code>            <span class="code-comment">// console.info('Ad type: ' + event.getAd().getAdPodInfo().getPodIndex());</span>
</code></td></tr><tr><td id="L6489" class="css-a4x74f"><span>6489</span></td><td id="LC6489" class="css-1dcdqdg"><code>            <span class="code-comment">// console.info('Ad time: ' + event.getAd().getAdPodInfo().getTimeOffset());</span>
</code></td></tr><tr><td id="L6490" class="css-a4x74f"><span>6490</span></td><td id="LC6490" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6491" class="css-a4x74f"><span>6491</span></td><td id="LC6491" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6492" class="css-a4x74f"><span>6492</span></td><td id="LC6492" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.STARTED:
</code></td></tr><tr><td id="L6493" class="css-a4x74f"><span>6493</span></td><td id="LC6493" class="css-1dcdqdg"><code>            <span class="code-comment">// Set volume to match player</span>
</code></td></tr><tr><td id="L6494" class="css-a4x74f"><span>6494</span></td><td id="LC6494" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.manager.setVolume(<span class="code-keyword">this</span>.player.volume);
</code></td></tr><tr><td id="L6495" class="css-a4x74f"><span>6495</span></td><td id="LC6495" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6496" class="css-a4x74f"><span>6496</span></td><td id="LC6496" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.ALL_ADS_COMPLETED:
</code></td></tr><tr><td id="L6497" class="css-a4x74f"><span>6497</span></td><td id="LC6497" class="css-1dcdqdg"><code>            <span class="code-comment">// All ads for the current videos are done. We can now request new advertisements</span>
</code></td></tr><tr><td id="L6498" class="css-a4x74f"><span>6498</span></td><td id="LC6498" class="css-1dcdqdg"><code>            <span class="code-comment">// in case the video is re-played</span>
</code></td></tr><tr><td id="L6499" class="css-a4x74f"><span>6499</span></td><td id="LC6499" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6500" class="css-a4x74f"><span>6500</span></td><td id="LC6500" class="css-1dcdqdg"><code>            <span class="code-comment">// <span class="code-doctag">TODO:</span> Example for what happens when a next video in a playlist would be loaded.</span>
</code></td></tr><tr><td id="L6501" class="css-a4x74f"><span>6501</span></td><td id="LC6501" class="css-1dcdqdg"><code>            <span class="code-comment">// So here we load a new video when all ads are done.</span>
</code></td></tr><tr><td id="L6502" class="css-a4x74f"><span>6502</span></td><td id="LC6502" class="css-1dcdqdg"><code>            <span class="code-comment">// Then we load new ads within a new adsManager. When the video</span>
</code></td></tr><tr><td id="L6503" class="css-a4x74f"><span>6503</span></td><td id="LC6503" class="css-1dcdqdg"><code>            <span class="code-comment">// Is started - after - the ads are loaded, then we get ads.</span>
</code></td></tr><tr><td id="L6504" class="css-a4x74f"><span>6504</span></td><td id="LC6504" class="css-1dcdqdg"><code>            <span class="code-comment">// You can also easily test cancelling and reloading by running</span>
</code></td></tr><tr><td id="L6505" class="css-a4x74f"><span>6505</span></td><td id="LC6505" class="css-1dcdqdg"><code>            <span class="code-comment">// player.ads.cancel() and player.ads.play from the console I guess.</span>
</code></td></tr><tr><td id="L6506" class="css-a4x74f"><span>6506</span></td><td id="LC6506" class="css-1dcdqdg"><code>            <span class="code-comment">// this.player.source = {</span>
</code></td></tr><tr><td id="L6507" class="css-a4x74f"><span>6507</span></td><td id="LC6507" class="css-1dcdqdg"><code>            <span class="code-comment">//     type: 'video',</span>
</code></td></tr><tr><td id="L6508" class="css-a4x74f"><span>6508</span></td><td id="LC6508" class="css-1dcdqdg"><code>            <span class="code-comment">//     title: 'View From A Blue Moon',</span>
</code></td></tr><tr><td id="L6509" class="css-a4x74f"><span>6509</span></td><td id="LC6509" class="css-1dcdqdg"><code>            <span class="code-comment">//     sources: [{</span>
</code></td></tr><tr><td id="L6510" class="css-a4x74f"><span>6510</span></td><td id="LC6510" class="css-1dcdqdg"><code>            <span class="code-comment">//         src:</span>
</code></td></tr><tr><td id="L6511" class="css-a4x74f"><span>6511</span></td><td id="LC6511" class="css-1dcdqdg"><code>            <span class="code-comment">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.mp4', type:</span>
</code></td></tr><tr><td id="L6512" class="css-a4x74f"><span>6512</span></td><td id="LC6512" class="css-1dcdqdg"><code>            <span class="code-comment">// 'video/mp4', }], poster:</span>
</code></td></tr><tr><td id="L6513" class="css-a4x74f"><span>6513</span></td><td id="LC6513" class="css-1dcdqdg"><code>            <span class="code-comment">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.jpg', tracks:</span>
</code></td></tr><tr><td id="L6514" class="css-a4x74f"><span>6514</span></td><td id="LC6514" class="css-1dcdqdg"><code>            <span class="code-comment">// [ { kind: 'captions', label: 'English', srclang: 'en', src:</span>
</code></td></tr><tr><td id="L6515" class="css-a4x74f"><span>6515</span></td><td id="LC6515" class="css-1dcdqdg"><code>            <span class="code-comment">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.en.vtt',</span>
</code></td></tr><tr><td id="L6516" class="css-a4x74f"><span>6516</span></td><td id="LC6516" class="css-1dcdqdg"><code>            <span class="code-comment">// default: true, }, { kind: 'captions', label: 'French', srclang: 'fr', src:</span>
</code></td></tr><tr><td id="L6517" class="css-a4x74f"><span>6517</span></td><td id="LC6517" class="css-1dcdqdg"><code>            <span class="code-comment">// 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-HD.fr.vtt', }, ],</span>
</code></td></tr><tr><td id="L6518" class="css-a4x74f"><span>6518</span></td><td id="LC6518" class="css-1dcdqdg"><code>            <span class="code-comment">// };</span>
</code></td></tr><tr><td id="L6519" class="css-a4x74f"><span>6519</span></td><td id="LC6519" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6520" class="css-a4x74f"><span>6520</span></td><td id="LC6520" class="css-1dcdqdg"><code>            <span class="code-comment">// <span class="code-doctag">TODO:</span> So there is still this thing where a video should only be allowed to start</span>
</code></td></tr><tr><td id="L6521" class="css-a4x74f"><span>6521</span></td><td id="LC6521" class="css-1dcdqdg"><code>            <span class="code-comment">// playing when the IMA SDK is ready or has failed</span>
</code></td></tr><tr><td id="L6522" class="css-a4x74f"><span>6522</span></td><td id="LC6522" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6523" class="css-a4x74f"><span>6523</span></td><td id="LC6523" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.player.ended) {
</code></td></tr><tr><td id="L6524" class="css-a4x74f"><span>6524</span></td><td id="LC6524" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.loadAds();
</code></td></tr><tr><td id="L6525" class="css-a4x74f"><span>6525</span></td><td id="LC6525" class="css-1dcdqdg"><code>            } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6526" class="css-a4x74f"><span>6526</span></td><td id="LC6526" class="css-1dcdqdg"><code>              <span class="code-comment">// The SDK won't allow new ads to be called without receiving a contentComplete()</span>
</code></td></tr><tr><td id="L6527" class="css-a4x74f"><span>6527</span></td><td id="LC6527" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.loader.contentComplete();
</code></td></tr><tr><td id="L6528" class="css-a4x74f"><span>6528</span></td><td id="LC6528" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6529" class="css-a4x74f"><span>6529</span></td><td id="LC6529" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6530" class="css-a4x74f"><span>6530</span></td><td id="LC6530" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:
</code></td></tr><tr><td id="L6531" class="css-a4x74f"><span>6531</span></td><td id="LC6531" class="css-1dcdqdg"><code>            <span class="code-comment">// This event indicates the ad has started - the video player can adjust the UI,</span>
</code></td></tr><tr><td id="L6532" class="css-a4x74f"><span>6532</span></td><td id="LC6532" class="css-1dcdqdg"><code>            <span class="code-comment">// for example display a pause button and remaining time. Fired when content should</span>
</code></td></tr><tr><td id="L6533" class="css-a4x74f"><span>6533</span></td><td id="LC6533" class="css-1dcdqdg"><code>            <span class="code-comment">// be paused. This usually happens right before an ad is about to cover the content</span>
</code></td></tr><tr><td id="L6534" class="css-a4x74f"><span>6534</span></td><td id="LC6534" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6535" class="css-a4x74f"><span>6535</span></td><td id="LC6535" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.pauseContent();
</code></td></tr><tr><td id="L6536" class="css-a4x74f"><span>6536</span></td><td id="LC6536" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6537" class="css-a4x74f"><span>6537</span></td><td id="LC6537" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:
</code></td></tr><tr><td id="L6538" class="css-a4x74f"><span>6538</span></td><td id="LC6538" class="css-1dcdqdg"><code>            <span class="code-comment">// This event indicates the ad has finished - the video player can perform</span>
</code></td></tr><tr><td id="L6539" class="css-a4x74f"><span>6539</span></td><td id="LC6539" class="css-1dcdqdg"><code>            <span class="code-comment">// appropriate UI actions, such as removing the timer for remaining time detection.</span>
</code></td></tr><tr><td id="L6540" class="css-a4x74f"><span>6540</span></td><td id="LC6540" class="css-1dcdqdg"><code>            <span class="code-comment">// Fired when content should be resumed. This usually happens when an ad finishes</span>
</code></td></tr><tr><td id="L6541" class="css-a4x74f"><span>6541</span></td><td id="LC6541" class="css-1dcdqdg"><code>            <span class="code-comment">// or collapses</span>
</code></td></tr><tr><td id="L6542" class="css-a4x74f"><span>6542</span></td><td id="LC6542" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6543" class="css-a4x74f"><span>6543</span></td><td id="LC6543" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.pollCountdown();
</code></td></tr><tr><td id="L6544" class="css-a4x74f"><span>6544</span></td><td id="LC6544" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.resumeContent();
</code></td></tr><tr><td id="L6545" class="css-a4x74f"><span>6545</span></td><td id="LC6545" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6546" class="css-a4x74f"><span>6546</span></td><td id="LC6546" class="css-1dcdqdg"><code>          <span class="code-keyword">case</span> google.ima.AdEvent.Type.LOG:
</code></td></tr><tr><td id="L6547" class="css-a4x74f"><span>6547</span></td><td id="LC6547" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (adData.adError) {
</code></td></tr><tr><td id="L6548" class="css-a4x74f"><span>6548</span></td><td id="LC6548" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.player.debug.warn(<span class="code-string">`Non-fatal ad error: <span class="code-subst">${adData.adError.getMessage()}</span>`</span>);
</code></td></tr><tr><td id="L6549" class="css-a4x74f"><span>6549</span></td><td id="LC6549" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6550" class="css-a4x74f"><span>6550</span></td><td id="LC6550" class="css-1dcdqdg"><code>            <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L6551" class="css-a4x74f"><span>6551</span></td><td id="LC6551" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6552" class="css-a4x74f"><span>6552</span></td><td id="LC6552" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6553" class="css-a4x74f"><span>6553</span></td><td id="LC6553" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6554" class="css-a4x74f"><span>6554</span></td><td id="LC6554" class="css-1dcdqdg"><code><span class="code-comment">       * Any ad error handling comes through here
</span></code></td></tr><tr><td id="L6555" class="css-a4x74f"><span>6555</span></td><td id="LC6555" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Event} event
</span></code></td></tr><tr><td id="L6556" class="css-a4x74f"><span>6556</span></td><td id="LC6556" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6557" class="css-a4x74f"><span>6557</span></td><td id="LC6557" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"onAdError"</span>, event =&gt; {
</code></td></tr><tr><td id="L6558" class="css-a4x74f"><span>6558</span></td><td id="LC6558" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.cancel();
</code></td></tr><tr><td id="L6559" class="css-a4x74f"><span>6559</span></td><td id="LC6559" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.debug.warn(<span class="code-string">'Ads error'</span>, event);
</code></td></tr><tr><td id="L6560" class="css-a4x74f"><span>6560</span></td><td id="LC6560" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6561" class="css-a4x74f"><span>6561</span></td><td id="LC6561" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6562" class="css-a4x74f"><span>6562</span></td><td id="LC6562" class="css-1dcdqdg"><code><span class="code-comment">       * Setup hooks for Plyr and window events. This ensures
</span></code></td></tr><tr><td id="L6563" class="css-a4x74f"><span>6563</span></td><td id="LC6563" class="css-1dcdqdg"><code><span class="code-comment">       * the mid- and post-roll launch at the correct time. And
</span></code></td></tr><tr><td id="L6564" class="css-a4x74f"><span>6564</span></td><td id="LC6564" class="css-1dcdqdg"><code><span class="code-comment">       * resize the advertisement when the player resizes
</span></code></td></tr><tr><td id="L6565" class="css-a4x74f"><span>6565</span></td><td id="LC6565" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6566" class="css-a4x74f"><span>6566</span></td><td id="LC6566" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"listeners"</span>, () =&gt; {
</code></td></tr><tr><td id="L6567" class="css-a4x74f"><span>6567</span></td><td id="LC6567" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6568" class="css-a4x74f"><span>6568</span></td><td id="LC6568" class="css-1dcdqdg"><code>          container
</code></td></tr><tr><td id="L6569" class="css-a4x74f"><span>6569</span></td><td id="LC6569" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.player.elements;
</code></td></tr><tr><td id="L6570" class="css-a4x74f"><span>6570</span></td><td id="LC6570" class="css-1dcdqdg"><code>        <span class="code-keyword">let</span> time;
</code></td></tr><tr><td id="L6571" class="css-a4x74f"><span>6571</span></td><td id="LC6571" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'canplay'</span>, () =&gt; {
</code></td></tr><tr><td id="L6572" class="css-a4x74f"><span>6572</span></td><td id="LC6572" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.addCuePoints();
</code></td></tr><tr><td id="L6573" class="css-a4x74f"><span>6573</span></td><td id="LC6573" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6574" class="css-a4x74f"><span>6574</span></td><td id="LC6574" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'ended'</span>, () =&gt; {
</code></td></tr><tr><td id="L6575" class="css-a4x74f"><span>6575</span></td><td id="LC6575" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.loader.contentComplete();
</code></td></tr><tr><td id="L6576" class="css-a4x74f"><span>6576</span></td><td id="LC6576" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6577" class="css-a4x74f"><span>6577</span></td><td id="LC6577" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'timeupdate'</span>, () =&gt; {
</code></td></tr><tr><td id="L6578" class="css-a4x74f"><span>6578</span></td><td id="LC6578" class="css-1dcdqdg"><code>          time = <span class="code-keyword">this</span>.player.currentTime;
</code></td></tr><tr><td id="L6579" class="css-a4x74f"><span>6579</span></td><td id="LC6579" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6580" class="css-a4x74f"><span>6580</span></td><td id="LC6580" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'seeked'</span>, () =&gt; {
</code></td></tr><tr><td id="L6581" class="css-a4x74f"><span>6581</span></td><td id="LC6581" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> seekedTime = <span class="code-keyword">this</span>.player.currentTime;
</code></td></tr><tr><td id="L6582" class="css-a4x74f"><span>6582</span></td><td id="LC6582" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(<span class="code-keyword">this</span>.cuePoints)) {
</code></td></tr><tr><td id="L6583" class="css-a4x74f"><span>6583</span></td><td id="LC6583" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6584" class="css-a4x74f"><span>6584</span></td><td id="LC6584" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6585" class="css-a4x74f"><span>6585</span></td><td id="LC6585" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.cuePoints.forEach(<span class="code-function">(<span class="code-params">cuePoint, index</span>) =&gt;</span> {
</code></td></tr><tr><td id="L6586" class="css-a4x74f"><span>6586</span></td><td id="LC6586" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (time &lt; cuePoint &amp;&amp; cuePoint &lt; seekedTime) {
</code></td></tr><tr><td id="L6587" class="css-a4x74f"><span>6587</span></td><td id="LC6587" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.manager.discardAdBreak();
</code></td></tr><tr><td id="L6588" class="css-a4x74f"><span>6588</span></td><td id="LC6588" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.cuePoints.splice(index, <span class="code-number">1</span>);
</code></td></tr><tr><td id="L6589" class="css-a4x74f"><span>6589</span></td><td id="LC6589" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6590" class="css-a4x74f"><span>6590</span></td><td id="LC6590" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6591" class="css-a4x74f"><span>6591</span></td><td id="LC6591" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6592" class="css-a4x74f"><span>6592</span></td><td id="LC6592" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6593" class="css-a4x74f"><span>6593</span></td><td id="LC6593" class="css-1dcdqdg"><code>        <span class="code-comment">// Listen to the resizing of the window. And resize ad accordingly</span>
</code></td></tr><tr><td id="L6594" class="css-a4x74f"><span>6594</span></td><td id="LC6594" class="css-1dcdqdg"><code>        <span class="code-comment">// <span class="code-doctag">TODO:</span> eventually implement ResizeObserver</span>
</code></td></tr><tr><td id="L6595" class="css-a4x74f"><span>6595</span></td><td id="LC6595" class="css-1dcdqdg"><code>        <span class="code-built_in">window</span>.addEventListener(<span class="code-string">'resize'</span>, () =&gt; {
</code></td></tr><tr><td id="L6596" class="css-a4x74f"><span>6596</span></td><td id="LC6596" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.manager) {
</code></td></tr><tr><td id="L6597" class="css-a4x74f"><span>6597</span></td><td id="LC6597" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.manager.resize(container.offsetWidth, container.offsetHeight, google.ima.ViewMode.NORMAL);
</code></td></tr><tr><td id="L6598" class="css-a4x74f"><span>6598</span></td><td id="LC6598" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6599" class="css-a4x74f"><span>6599</span></td><td id="LC6599" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6600" class="css-a4x74f"><span>6600</span></td><td id="LC6600" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6601" class="css-a4x74f"><span>6601</span></td><td id="LC6601" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6602" class="css-a4x74f"><span>6602</span></td><td id="LC6602" class="css-1dcdqdg"><code><span class="code-comment">       * Initialize the adsManager and start playing advertisements
</span></code></td></tr><tr><td id="L6603" class="css-a4x74f"><span>6603</span></td><td id="LC6603" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6604" class="css-a4x74f"><span>6604</span></td><td id="LC6604" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"play"</span>, () =&gt; {
</code></td></tr><tr><td id="L6605" class="css-a4x74f"><span>6605</span></td><td id="LC6605" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6606" class="css-a4x74f"><span>6606</span></td><td id="LC6606" class="css-1dcdqdg"><code>          container
</code></td></tr><tr><td id="L6607" class="css-a4x74f"><span>6607</span></td><td id="LC6607" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.player.elements;
</code></td></tr><tr><td id="L6608" class="css-a4x74f"><span>6608</span></td><td id="LC6608" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.managerPromise) {
</code></td></tr><tr><td id="L6609" class="css-a4x74f"><span>6609</span></td><td id="LC6609" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.resumeContent();
</code></td></tr><tr><td id="L6610" class="css-a4x74f"><span>6610</span></td><td id="LC6610" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6611" class="css-a4x74f"><span>6611</span></td><td id="LC6611" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6612" class="css-a4x74f"><span>6612</span></td><td id="LC6612" class="css-1dcdqdg"><code>        <span class="code-comment">// Play the requested advertisement whenever the adsManager is ready</span>
</code></td></tr><tr><td id="L6613" class="css-a4x74f"><span>6613</span></td><td id="LC6613" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.managerPromise.then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6614" class="css-a4x74f"><span>6614</span></td><td id="LC6614" class="css-1dcdqdg"><code>          <span class="code-comment">// Set volume to match player</span>
</code></td></tr><tr><td id="L6615" class="css-a4x74f"><span>6615</span></td><td id="LC6615" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.manager.setVolume(<span class="code-keyword">this</span>.player.volume);
</code></td></tr><tr><td id="L6616" class="css-a4x74f"><span>6616</span></td><td id="LC6616" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6617" class="css-a4x74f"><span>6617</span></td><td id="LC6617" class="css-1dcdqdg"><code>          <span class="code-comment">// Initialize the container. Must be done via a user action on mobile devices</span>
</code></td></tr><tr><td id="L6618" class="css-a4x74f"><span>6618</span></td><td id="LC6618" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.displayContainer.initialize();
</code></td></tr><tr><td id="L6619" class="css-a4x74f"><span>6619</span></td><td id="LC6619" class="css-1dcdqdg"><code>          <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L6620" class="css-a4x74f"><span>6620</span></td><td id="LC6620" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.initialized) {
</code></td></tr><tr><td id="L6621" class="css-a4x74f"><span>6621</span></td><td id="LC6621" class="css-1dcdqdg"><code>              <span class="code-comment">// Initialize the ads manager. Ad rules playlist will start at this time</span>
</code></td></tr><tr><td id="L6622" class="css-a4x74f"><span>6622</span></td><td id="LC6622" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.manager.init(container.offsetWidth, container.offsetHeight, google.ima.ViewMode.NORMAL);
</code></td></tr><tr><td id="L6623" class="css-a4x74f"><span>6623</span></td><td id="LC6623" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6624" class="css-a4x74f"><span>6624</span></td><td id="LC6624" class="css-1dcdqdg"><code>              <span class="code-comment">// Call play to start showing the ad. Single video and overlay ads will</span>
</code></td></tr><tr><td id="L6625" class="css-a4x74f"><span>6625</span></td><td id="LC6625" class="css-1dcdqdg"><code>              <span class="code-comment">// start at this time; the call will be ignored for ad rules</span>
</code></td></tr><tr><td id="L6626" class="css-a4x74f"><span>6626</span></td><td id="LC6626" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.manager.start();
</code></td></tr><tr><td id="L6627" class="css-a4x74f"><span>6627</span></td><td id="LC6627" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6628" class="css-a4x74f"><span>6628</span></td><td id="LC6628" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.initialized = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6629" class="css-a4x74f"><span>6629</span></td><td id="LC6629" class="css-1dcdqdg"><code>          } <span class="code-keyword">catch</span> (adError) {
</code></td></tr><tr><td id="L6630" class="css-a4x74f"><span>6630</span></td><td id="LC6630" class="css-1dcdqdg"><code>            <span class="code-comment">// An error may be thrown if there was a problem with the</span>
</code></td></tr><tr><td id="L6631" class="css-a4x74f"><span>6631</span></td><td id="LC6631" class="css-1dcdqdg"><code>            <span class="code-comment">// VAST response</span>
</code></td></tr><tr><td id="L6632" class="css-a4x74f"><span>6632</span></td><td id="LC6632" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.onAdError(adError);
</code></td></tr><tr><td id="L6633" class="css-a4x74f"><span>6633</span></td><td id="LC6633" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6634" class="css-a4x74f"><span>6634</span></td><td id="LC6634" class="css-1dcdqdg"><code>        }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L6635" class="css-a4x74f"><span>6635</span></td><td id="LC6635" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6636" class="css-a4x74f"><span>6636</span></td><td id="LC6636" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6637" class="css-a4x74f"><span>6637</span></td><td id="LC6637" class="css-1dcdqdg"><code><span class="code-comment">       * Resume our video
</span></code></td></tr><tr><td id="L6638" class="css-a4x74f"><span>6638</span></td><td id="LC6638" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6639" class="css-a4x74f"><span>6639</span></td><td id="LC6639" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"resumeContent"</span>, () =&gt; {
</code></td></tr><tr><td id="L6640" class="css-a4x74f"><span>6640</span></td><td id="LC6640" class="css-1dcdqdg"><code>        <span class="code-comment">// Hide the advertisement container</span>
</code></td></tr><tr><td id="L6641" class="css-a4x74f"><span>6641</span></td><td id="LC6641" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container.style.zIndex = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L6642" class="css-a4x74f"><span>6642</span></td><td id="LC6642" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6643" class="css-a4x74f"><span>6643</span></td><td id="LC6643" class="css-1dcdqdg"><code>        <span class="code-comment">// Ad is stopped</span>
</code></td></tr><tr><td id="L6644" class="css-a4x74f"><span>6644</span></td><td id="LC6644" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.playing = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6645" class="css-a4x74f"><span>6645</span></td><td id="LC6645" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6646" class="css-a4x74f"><span>6646</span></td><td id="LC6646" class="css-1dcdqdg"><code>        <span class="code-comment">// Play video</span>
</code></td></tr><tr><td id="L6647" class="css-a4x74f"><span>6647</span></td><td id="LC6647" class="css-1dcdqdg"><code>        silencePromise(<span class="code-keyword">this</span>.player.media.play());
</code></td></tr><tr><td id="L6648" class="css-a4x74f"><span>6648</span></td><td id="LC6648" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6649" class="css-a4x74f"><span>6649</span></td><td id="LC6649" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6650" class="css-a4x74f"><span>6650</span></td><td id="LC6650" class="css-1dcdqdg"><code><span class="code-comment">       * Pause our video
</span></code></td></tr><tr><td id="L6651" class="css-a4x74f"><span>6651</span></td><td id="LC6651" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6652" class="css-a4x74f"><span>6652</span></td><td id="LC6652" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"pauseContent"</span>, () =&gt; {
</code></td></tr><tr><td id="L6653" class="css-a4x74f"><span>6653</span></td><td id="LC6653" class="css-1dcdqdg"><code>        <span class="code-comment">// Show the advertisement container</span>
</code></td></tr><tr><td id="L6654" class="css-a4x74f"><span>6654</span></td><td id="LC6654" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container.style.zIndex = <span class="code-number">3</span>;
</code></td></tr><tr><td id="L6655" class="css-a4x74f"><span>6655</span></td><td id="LC6655" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6656" class="css-a4x74f"><span>6656</span></td><td id="LC6656" class="css-1dcdqdg"><code>        <span class="code-comment">// Ad is playing</span>
</code></td></tr><tr><td id="L6657" class="css-a4x74f"><span>6657</span></td><td id="LC6657" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.playing = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6658" class="css-a4x74f"><span>6658</span></td><td id="LC6658" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6659" class="css-a4x74f"><span>6659</span></td><td id="LC6659" class="css-1dcdqdg"><code>        <span class="code-comment">// Pause our video.</span>
</code></td></tr><tr><td id="L6660" class="css-a4x74f"><span>6660</span></td><td id="LC6660" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.media.pause();
</code></td></tr><tr><td id="L6661" class="css-a4x74f"><span>6661</span></td><td id="LC6661" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6662" class="css-a4x74f"><span>6662</span></td><td id="LC6662" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6663" class="css-a4x74f"><span>6663</span></td><td id="LC6663" class="css-1dcdqdg"><code><span class="code-comment">       * Destroy the adsManager so we can grab new ads after this. If we don't then we're not
</span></code></td></tr><tr><td id="L6664" class="css-a4x74f"><span>6664</span></td><td id="LC6664" class="css-1dcdqdg"><code><span class="code-comment">       * allowed to call new ads based on google policies, as they interpret this as an accidental
</span></code></td></tr><tr><td id="L6665" class="css-a4x74f"><span>6665</span></td><td id="LC6665" class="css-1dcdqdg"><code><span class="code-comment">       * video requests. https://developers.google.com/interactive-
</span></code></td></tr><tr><td id="L6666" class="css-a4x74f"><span>6666</span></td><td id="LC6666" class="css-1dcdqdg"><code><span class="code-comment">       * media-ads/docs/sdks/android/faq#8
</span></code></td></tr><tr><td id="L6667" class="css-a4x74f"><span>6667</span></td><td id="LC6667" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6668" class="css-a4x74f"><span>6668</span></td><td id="LC6668" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"cancel"</span>, () =&gt; {
</code></td></tr><tr><td id="L6669" class="css-a4x74f"><span>6669</span></td><td id="LC6669" class="css-1dcdqdg"><code>        <span class="code-comment">// Pause our video</span>
</code></td></tr><tr><td id="L6670" class="css-a4x74f"><span>6670</span></td><td id="LC6670" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.initialized) {
</code></td></tr><tr><td id="L6671" class="css-a4x74f"><span>6671</span></td><td id="LC6671" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.resumeContent();
</code></td></tr><tr><td id="L6672" class="css-a4x74f"><span>6672</span></td><td id="LC6672" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6673" class="css-a4x74f"><span>6673</span></td><td id="LC6673" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6674" class="css-a4x74f"><span>6674</span></td><td id="LC6674" class="css-1dcdqdg"><code>        <span class="code-comment">// Tell our instance that we're done for now</span>
</code></td></tr><tr><td id="L6675" class="css-a4x74f"><span>6675</span></td><td id="LC6675" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.trigger(<span class="code-string">'error'</span>);
</code></td></tr><tr><td id="L6676" class="css-a4x74f"><span>6676</span></td><td id="LC6676" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6677" class="css-a4x74f"><span>6677</span></td><td id="LC6677" class="css-1dcdqdg"><code>        <span class="code-comment">// Re-create our adsManager</span>
</code></td></tr><tr><td id="L6678" class="css-a4x74f"><span>6678</span></td><td id="LC6678" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.loadAds();
</code></td></tr><tr><td id="L6679" class="css-a4x74f"><span>6679</span></td><td id="LC6679" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6680" class="css-a4x74f"><span>6680</span></td><td id="LC6680" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6681" class="css-a4x74f"><span>6681</span></td><td id="LC6681" class="css-1dcdqdg"><code><span class="code-comment">       * Re-create our adsManager
</span></code></td></tr><tr><td id="L6682" class="css-a4x74f"><span>6682</span></td><td id="LC6682" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6683" class="css-a4x74f"><span>6683</span></td><td id="LC6683" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"loadAds"</span>, () =&gt; {
</code></td></tr><tr><td id="L6684" class="css-a4x74f"><span>6684</span></td><td id="LC6684" class="css-1dcdqdg"><code>        <span class="code-comment">// Tell our adsManager to go bye bye</span>
</code></td></tr><tr><td id="L6685" class="css-a4x74f"><span>6685</span></td><td id="LC6685" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.managerPromise.then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6686" class="css-a4x74f"><span>6686</span></td><td id="LC6686" class="css-1dcdqdg"><code>          <span class="code-comment">// Destroy our adsManager</span>
</code></td></tr><tr><td id="L6687" class="css-a4x74f"><span>6687</span></td><td id="LC6687" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.manager) {
</code></td></tr><tr><td id="L6688" class="css-a4x74f"><span>6688</span></td><td id="LC6688" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.manager.destroy();
</code></td></tr><tr><td id="L6689" class="css-a4x74f"><span>6689</span></td><td id="LC6689" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6690" class="css-a4x74f"><span>6690</span></td><td id="LC6690" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6691" class="css-a4x74f"><span>6691</span></td><td id="LC6691" class="css-1dcdqdg"><code>          <span class="code-comment">// Re-set our adsManager promises</span>
</code></td></tr><tr><td id="L6692" class="css-a4x74f"><span>6692</span></td><td id="LC6692" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.managerPromise = <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function"><span class="code-params">resolve</span> =&gt;</span> {
</code></td></tr><tr><td id="L6693" class="css-a4x74f"><span>6693</span></td><td id="LC6693" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.on(<span class="code-string">'loaded'</span>, resolve);
</code></td></tr><tr><td id="L6694" class="css-a4x74f"><span>6694</span></td><td id="LC6694" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.player.debug.log(<span class="code-keyword">this</span>.manager);
</code></td></tr><tr><td id="L6695" class="css-a4x74f"><span>6695</span></td><td id="LC6695" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6696" class="css-a4x74f"><span>6696</span></td><td id="LC6696" class="css-1dcdqdg"><code>          <span class="code-comment">// Now that the manager has been destroyed set it to also be un-initialized</span>
</code></td></tr><tr><td id="L6697" class="css-a4x74f"><span>6697</span></td><td id="LC6697" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.initialized = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6698" class="css-a4x74f"><span>6698</span></td><td id="LC6698" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6699" class="css-a4x74f"><span>6699</span></td><td id="LC6699" class="css-1dcdqdg"><code>          <span class="code-comment">// Now request some new advertisements</span>
</code></td></tr><tr><td id="L6700" class="css-a4x74f"><span>6700</span></td><td id="LC6700" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.requestAds();
</code></td></tr><tr><td id="L6701" class="css-a4x74f"><span>6701</span></td><td id="LC6701" class="css-1dcdqdg"><code>        }).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L6702" class="css-a4x74f"><span>6702</span></td><td id="LC6702" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6703" class="css-a4x74f"><span>6703</span></td><td id="LC6703" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6704" class="css-a4x74f"><span>6704</span></td><td id="LC6704" class="css-1dcdqdg"><code><span class="code-comment">       * Handles callbacks after an ad event was invoked
</span></code></td></tr><tr><td id="L6705" class="css-a4x74f"><span>6705</span></td><td id="LC6705" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} event - Event type
</span></code></td></tr><tr><td id="L6706" class="css-a4x74f"><span>6706</span></td><td id="LC6706" class="css-1dcdqdg"><code><span class="code-comment">       * @param args
</span></code></td></tr><tr><td id="L6707" class="css-a4x74f"><span>6707</span></td><td id="LC6707" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6708" class="css-a4x74f"><span>6708</span></td><td id="LC6708" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"trigger"</span>, (event, ...args) =&gt; {
</code></td></tr><tr><td id="L6709" class="css-a4x74f"><span>6709</span></td><td id="LC6709" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> handlers = <span class="code-keyword">this</span>.events[event];
</code></td></tr><tr><td id="L6710" class="css-a4x74f"><span>6710</span></td><td id="LC6710" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.array(handlers)) {
</code></td></tr><tr><td id="L6711" class="css-a4x74f"><span>6711</span></td><td id="LC6711" class="css-1dcdqdg"><code>          handlers.forEach(<span class="code-function"><span class="code-params">handler</span> =&gt;</span> {
</code></td></tr><tr><td id="L6712" class="css-a4x74f"><span>6712</span></td><td id="LC6712" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (is.function(handler)) {
</code></td></tr><tr><td id="L6713" class="css-a4x74f"><span>6713</span></td><td id="LC6713" class="css-1dcdqdg"><code>              handler.apply(<span class="code-keyword">this</span>, args);
</code></td></tr><tr><td id="L6714" class="css-a4x74f"><span>6714</span></td><td id="LC6714" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6715" class="css-a4x74f"><span>6715</span></td><td id="LC6715" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6716" class="css-a4x74f"><span>6716</span></td><td id="LC6716" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6717" class="css-a4x74f"><span>6717</span></td><td id="LC6717" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6718" class="css-a4x74f"><span>6718</span></td><td id="LC6718" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6719" class="css-a4x74f"><span>6719</span></td><td id="LC6719" class="css-1dcdqdg"><code><span class="code-comment">       * Add event listeners
</span></code></td></tr><tr><td id="L6720" class="css-a4x74f"><span>6720</span></td><td id="LC6720" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} event - Event type
</span></code></td></tr><tr><td id="L6721" class="css-a4x74f"><span>6721</span></td><td id="LC6721" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callback - Callback for when event occurs
</span></code></td></tr><tr><td id="L6722" class="css-a4x74f"><span>6722</span></td><td id="LC6722" class="css-1dcdqdg"><code><span class="code-comment">       * @return {Ads}
</span></code></td></tr><tr><td id="L6723" class="css-a4x74f"><span>6723</span></td><td id="LC6723" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6724" class="css-a4x74f"><span>6724</span></td><td id="LC6724" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"on"</span>, (event, callback) =&gt; {
</code></td></tr><tr><td id="L6725" class="css-a4x74f"><span>6725</span></td><td id="LC6725" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.array(<span class="code-keyword">this</span>.events[event])) {
</code></td></tr><tr><td id="L6726" class="css-a4x74f"><span>6726</span></td><td id="LC6726" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.events[event] = [];
</code></td></tr><tr><td id="L6727" class="css-a4x74f"><span>6727</span></td><td id="LC6727" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6728" class="css-a4x74f"><span>6728</span></td><td id="LC6728" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.events[event].push(callback);
</code></td></tr><tr><td id="L6729" class="css-a4x74f"><span>6729</span></td><td id="LC6729" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L6730" class="css-a4x74f"><span>6730</span></td><td id="LC6730" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6731" class="css-a4x74f"><span>6731</span></td><td id="LC6731" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6732" class="css-a4x74f"><span>6732</span></td><td id="LC6732" class="css-1dcdqdg"><code><span class="code-comment">       * Setup a safety timer for when the ad network doesn't respond for whatever reason.
</span></code></td></tr><tr><td id="L6733" class="css-a4x74f"><span>6733</span></td><td id="LC6733" class="css-1dcdqdg"><code><span class="code-comment">       * The advertisement has 12 seconds to get its things together. We stop this timer when the
</span></code></td></tr><tr><td id="L6734" class="css-a4x74f"><span>6734</span></td><td id="LC6734" class="css-1dcdqdg"><code><span class="code-comment">       * advertisement is playing, or when a user action is required to start, then we clear the
</span></code></td></tr><tr><td id="L6735" class="css-a4x74f"><span>6735</span></td><td id="LC6735" class="css-1dcdqdg"><code><span class="code-comment">       * timer on ad ready
</span></code></td></tr><tr><td id="L6736" class="css-a4x74f"><span>6736</span></td><td id="LC6736" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Number} time
</span></code></td></tr><tr><td id="L6737" class="css-a4x74f"><span>6737</span></td><td id="LC6737" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} from
</span></code></td></tr><tr><td id="L6738" class="css-a4x74f"><span>6738</span></td><td id="LC6738" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6739" class="css-a4x74f"><span>6739</span></td><td id="LC6739" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"startSafetyTimer"</span>, (time, <span class="code-keyword">from</span>) =&gt; {
</code></td></tr><tr><td id="L6740" class="css-a4x74f"><span>6740</span></td><td id="LC6740" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Safety timer invoked from: <span class="code-subst">${<span class="code-keyword">from</span>}</span>`</span>);
</code></td></tr><tr><td id="L6741" class="css-a4x74f"><span>6741</span></td><td id="LC6741" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.safetyTimer = setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6742" class="css-a4x74f"><span>6742</span></td><td id="LC6742" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.cancel();
</code></td></tr><tr><td id="L6743" class="css-a4x74f"><span>6743</span></td><td id="LC6743" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.clearSafetyTimer(<span class="code-string">'startSafetyTimer()'</span>);
</code></td></tr><tr><td id="L6744" class="css-a4x74f"><span>6744</span></td><td id="LC6744" class="css-1dcdqdg"><code>        }, time);
</code></td></tr><tr><td id="L6745" class="css-a4x74f"><span>6745</span></td><td id="LC6745" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6746" class="css-a4x74f"><span>6746</span></td><td id="LC6746" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6747" class="css-a4x74f"><span>6747</span></td><td id="LC6747" class="css-1dcdqdg"><code><span class="code-comment">       * Clear our safety timer(s)
</span></code></td></tr><tr><td id="L6748" class="css-a4x74f"><span>6748</span></td><td id="LC6748" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} from
</span></code></td></tr><tr><td id="L6749" class="css-a4x74f"><span>6749</span></td><td id="LC6749" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L6750" class="css-a4x74f"><span>6750</span></td><td id="LC6750" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"clearSafetyTimer"</span>, <span class="code-keyword">from</span> =&gt; {
</code></td></tr><tr><td id="L6751" class="css-a4x74f"><span>6751</span></td><td id="LC6751" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.nullOrUndefined(<span class="code-keyword">this</span>.safetyTimer)) {
</code></td></tr><tr><td id="L6752" class="css-a4x74f"><span>6752</span></td><td id="LC6752" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Safety timer cleared from: <span class="code-subst">${<span class="code-keyword">from</span>}</span>`</span>);
</code></td></tr><tr><td id="L6753" class="css-a4x74f"><span>6753</span></td><td id="LC6753" class="css-1dcdqdg"><code>          clearTimeout(<span class="code-keyword">this</span>.safetyTimer);
</code></td></tr><tr><td id="L6754" class="css-a4x74f"><span>6754</span></td><td id="LC6754" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.safetyTimer = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6755" class="css-a4x74f"><span>6755</span></td><td id="LC6755" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6756" class="css-a4x74f"><span>6756</span></td><td id="LC6756" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6757" class="css-a4x74f"><span>6757</span></td><td id="LC6757" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player = player;
</code></td></tr><tr><td id="L6758" class="css-a4x74f"><span>6758</span></td><td id="LC6758" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config = player.config.ads;
</code></td></tr><tr><td id="L6759" class="css-a4x74f"><span>6759</span></td><td id="LC6759" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.playing = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6760" class="css-a4x74f"><span>6760</span></td><td id="LC6760" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.initialized = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L6761" class="css-a4x74f"><span>6761</span></td><td id="LC6761" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements = {
</code></td></tr><tr><td id="L6762" class="css-a4x74f"><span>6762</span></td><td id="LC6762" class="css-1dcdqdg"><code>        container: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L6763" class="css-a4x74f"><span>6763</span></td><td id="LC6763" class="css-1dcdqdg"><code>        displayContainer: <span class="code-literal">null</span>
</code></td></tr><tr><td id="L6764" class="css-a4x74f"><span>6764</span></td><td id="LC6764" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L6765" class="css-a4x74f"><span>6765</span></td><td id="LC6765" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.manager = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6766" class="css-a4x74f"><span>6766</span></td><td id="LC6766" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loader = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6767" class="css-a4x74f"><span>6767</span></td><td id="LC6767" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.cuePoints = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6768" class="css-a4x74f"><span>6768</span></td><td id="LC6768" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.events = {};
</code></td></tr><tr><td id="L6769" class="css-a4x74f"><span>6769</span></td><td id="LC6769" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.safetyTimer = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6770" class="css-a4x74f"><span>6770</span></td><td id="LC6770" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.countdownTimer = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L6771" class="css-a4x74f"><span>6771</span></td><td id="LC6771" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6772" class="css-a4x74f"><span>6772</span></td><td id="LC6772" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup a promise to resolve when the IMA manager is ready</span>
</code></td></tr><tr><td id="L6773" class="css-a4x74f"><span>6773</span></td><td id="LC6773" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.managerPromise = <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function">(<span class="code-params">resolve, reject</span>) =&gt;</span> {
</code></td></tr><tr><td id="L6774" class="css-a4x74f"><span>6774</span></td><td id="LC6774" class="css-1dcdqdg"><code>        <span class="code-comment">// The ad is loaded and ready</span>
</code></td></tr><tr><td id="L6775" class="css-a4x74f"><span>6775</span></td><td id="LC6775" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.on(<span class="code-string">'loaded'</span>, resolve);
</code></td></tr><tr><td id="L6776" class="css-a4x74f"><span>6776</span></td><td id="LC6776" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6777" class="css-a4x74f"><span>6777</span></td><td id="LC6777" class="css-1dcdqdg"><code>        <span class="code-comment">// Ads failed</span>
</code></td></tr><tr><td id="L6778" class="css-a4x74f"><span>6778</span></td><td id="LC6778" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.on(<span class="code-string">'error'</span>, reject);
</code></td></tr><tr><td id="L6779" class="css-a4x74f"><span>6779</span></td><td id="LC6779" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6780" class="css-a4x74f"><span>6780</span></td><td id="LC6780" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.load();
</code></td></tr><tr><td id="L6781" class="css-a4x74f"><span>6781</span></td><td id="LC6781" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6782" class="css-a4x74f"><span>6782</span></td><td id="LC6782" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> enabled() {
</code></td></tr><tr><td id="L6783" class="css-a4x74f"><span>6783</span></td><td id="LC6783" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6784" class="css-a4x74f"><span>6784</span></td><td id="LC6784" class="css-1dcdqdg"><code>        config
</code></td></tr><tr><td id="L6785" class="css-a4x74f"><span>6785</span></td><td id="LC6785" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L6786" class="css-a4x74f"><span>6786</span></td><td id="LC6786" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.player.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.player.isVideo &amp;&amp; config.enabled &amp;&amp; (!is.empty(config.publisherId) || is.url(config.tagUrl));
</code></td></tr><tr><td id="L6787" class="css-a4x74f"><span>6787</span></td><td id="LC6787" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6788" class="css-a4x74f"><span>6788</span></td><td id="LC6788" class="css-1dcdqdg"><code>    <span class="code-comment">// Build the tag URL</span>
</code></td></tr><tr><td id="L6789" class="css-a4x74f"><span>6789</span></td><td id="LC6789" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> tagUrl() {
</code></td></tr><tr><td id="L6790" class="css-a4x74f"><span>6790</span></td><td id="LC6790" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6791" class="css-a4x74f"><span>6791</span></td><td id="LC6791" class="css-1dcdqdg"><code>        config
</code></td></tr><tr><td id="L6792" class="css-a4x74f"><span>6792</span></td><td id="LC6792" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L6793" class="css-a4x74f"><span>6793</span></td><td id="LC6793" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.url(config.tagUrl)) {
</code></td></tr><tr><td id="L6794" class="css-a4x74f"><span>6794</span></td><td id="LC6794" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> config.tagUrl;
</code></td></tr><tr><td id="L6795" class="css-a4x74f"><span>6795</span></td><td id="LC6795" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6796" class="css-a4x74f"><span>6796</span></td><td id="LC6796" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> params = {
</code></td></tr><tr><td id="L6797" class="css-a4x74f"><span>6797</span></td><td id="LC6797" class="css-1dcdqdg"><code>        AV_PUBLISHERID: <span class="code-string">'58c25bb0073ef448b1087ad6'</span>,
</code></td></tr><tr><td id="L6798" class="css-a4x74f"><span>6798</span></td><td id="LC6798" class="css-1dcdqdg"><code>        AV_CHANNELID: <span class="code-string">'5a0458dc28a06145e4519d21'</span>,
</code></td></tr><tr><td id="L6799" class="css-a4x74f"><span>6799</span></td><td id="LC6799" class="css-1dcdqdg"><code>        AV_URL: <span class="code-built_in">window</span>.location.hostname,
</code></td></tr><tr><td id="L6800" class="css-a4x74f"><span>6800</span></td><td id="LC6800" class="css-1dcdqdg"><code>        cb: <span class="code-built_in">Date</span>.now(),
</code></td></tr><tr><td id="L6801" class="css-a4x74f"><span>6801</span></td><td id="LC6801" class="css-1dcdqdg"><code>        AV_WIDTH: <span class="code-number">640</span>,
</code></td></tr><tr><td id="L6802" class="css-a4x74f"><span>6802</span></td><td id="LC6802" class="css-1dcdqdg"><code>        AV_HEIGHT: <span class="code-number">480</span>,
</code></td></tr><tr><td id="L6803" class="css-a4x74f"><span>6803</span></td><td id="LC6803" class="css-1dcdqdg"><code>        AV_CDIM2: config.publisherId
</code></td></tr><tr><td id="L6804" class="css-a4x74f"><span>6804</span></td><td id="LC6804" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L6805" class="css-a4x74f"><span>6805</span></td><td id="LC6805" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> base = <span class="code-string">'https://go.aniview.com/api/adserver6/vast/'</span>;
</code></td></tr><tr><td id="L6806" class="css-a4x74f"><span>6806</span></td><td id="LC6806" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-string">`<span class="code-subst">${base}</span>?<span class="code-subst">${buildUrlParams(params)}</span>`</span>;
</code></td></tr><tr><td id="L6807" class="css-a4x74f"><span>6807</span></td><td id="LC6807" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6808" class="css-a4x74f"><span>6808</span></td><td id="LC6808" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L6809" class="css-a4x74f"><span>6809</span></td><td id="LC6809" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6810" class="css-a4x74f"><span>6810</span></td><td id="LC6810" class="css-1dcdqdg"><code>  <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6811" class="css-a4x74f"><span>6811</span></td><td id="LC6811" class="css-1dcdqdg"><code><span class="code-comment">   * Returns a number whose value is limited to the given range.
</span></code></td></tr><tr><td id="L6812" class="css-a4x74f"><span>6812</span></td><td id="LC6812" class="css-1dcdqdg"><code><span class="code-comment">   *
</span></code></td></tr><tr><td id="L6813" class="css-a4x74f"><span>6813</span></td><td id="LC6813" class="css-1dcdqdg"><code><span class="code-comment">   * Example: limit the output of this computation to between 0 and 255
</span></code></td></tr><tr><td id="L6814" class="css-a4x74f"><span>6814</span></td><td id="LC6814" class="css-1dcdqdg"><code><span class="code-comment">   * (x * 255).clamp(0, 255)
</span></code></td></tr><tr><td id="L6815" class="css-a4x74f"><span>6815</span></td><td id="LC6815" class="css-1dcdqdg"><code><span class="code-comment">   *
</span></code></td></tr><tr><td id="L6816" class="css-a4x74f"><span>6816</span></td><td id="LC6816" class="css-1dcdqdg"><code><span class="code-comment">   * @param {Number} input
</span></code></td></tr><tr><td id="L6817" class="css-a4x74f"><span>6817</span></td><td id="LC6817" class="css-1dcdqdg"><code><span class="code-comment">   * @param {Number} min The lower boundary of the output range
</span></code></td></tr><tr><td id="L6818" class="css-a4x74f"><span>6818</span></td><td id="LC6818" class="css-1dcdqdg"><code><span class="code-comment">   * @param {Number} max The upper boundary of the output range
</span></code></td></tr><tr><td id="L6819" class="css-a4x74f"><span>6819</span></td><td id="LC6819" class="css-1dcdqdg"><code><span class="code-comment">   * @returns A number within the bounds of min and max
</span></code></td></tr><tr><td id="L6820" class="css-a4x74f"><span>6820</span></td><td id="LC6820" class="css-1dcdqdg"><code><span class="code-comment">   * @type Number
</span></code></td></tr><tr><td id="L6821" class="css-a4x74f"><span>6821</span></td><td id="LC6821" class="css-1dcdqdg"><code><span class="code-comment">   */</span>
</code></td></tr><tr><td id="L6822" class="css-a4x74f"><span>6822</span></td><td id="LC6822" class="css-1dcdqdg"><code>  <span class="code-function"><span class="code-keyword">function</span> <span class="code-title">clamp</span>(<span class="code-params">input = <span class="code-number">0</span>, min = <span class="code-number">0</span>, max = <span class="code-number">255</span></span>) </span>{
</code></td></tr><tr><td id="L6823" class="css-a4x74f"><span>6823</span></td><td id="LC6823" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> <span class="code-built_in">Math</span>.min(<span class="code-built_in">Math</span>.max(input, min), max);
</code></td></tr><tr><td id="L6824" class="css-a4x74f"><span>6824</span></td><td id="LC6824" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L6825" class="css-a4x74f"><span>6825</span></td><td id="LC6825" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6826" class="css-a4x74f"><span>6826</span></td><td id="LC6826" class="css-1dcdqdg"><code>  <span class="code-comment">// Arg: vttDataString example: "WEBVTT\n\n1\n00:00:05.000 --&gt; 00:00:10.000\n1080p-00001.jpg"</span>
</code></td></tr><tr><td id="L6827" class="css-a4x74f"><span>6827</span></td><td id="LC6827" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> parseVtt = <span class="code-function"><span class="code-params">vttDataString</span> =&gt;</span> {
</code></td></tr><tr><td id="L6828" class="css-a4x74f"><span>6828</span></td><td id="LC6828" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> processedList = [];
</code></td></tr><tr><td id="L6829" class="css-a4x74f"><span>6829</span></td><td id="LC6829" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> frames = vttDataString.split(<span class="code-regexp">/\r\n\r\n|\n\n|\r\r/</span>);
</code></td></tr><tr><td id="L6830" class="css-a4x74f"><span>6830</span></td><td id="LC6830" class="css-1dcdqdg"><code>    frames.forEach(<span class="code-function"><span class="code-params">frame</span> =&gt;</span> {
</code></td></tr><tr><td id="L6831" class="css-a4x74f"><span>6831</span></td><td id="LC6831" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> result = {};
</code></td></tr><tr><td id="L6832" class="css-a4x74f"><span>6832</span></td><td id="LC6832" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> lines = frame.split(<span class="code-regexp">/\r\n|\n|\r/</span>);
</code></td></tr><tr><td id="L6833" class="css-a4x74f"><span>6833</span></td><td id="LC6833" class="css-1dcdqdg"><code>      lines.forEach(<span class="code-function"><span class="code-params">line</span> =&gt;</span> {
</code></td></tr><tr><td id="L6834" class="css-a4x74f"><span>6834</span></td><td id="LC6834" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.number(result.startTime)) {
</code></td></tr><tr><td id="L6835" class="css-a4x74f"><span>6835</span></td><td id="LC6835" class="css-1dcdqdg"><code>          <span class="code-comment">// The line with start and end times on it is the first line of interest</span>
</code></td></tr><tr><td id="L6836" class="css-a4x74f"><span>6836</span></td><td id="LC6836" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> matchTimes = line.match(<span class="code-regexp">/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--&gt; ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/</span>); <span class="code-comment">// Note that this currently ignores caption formatting directives that are optionally on the end of this line - fine for non-captions VTT</span>
</code></td></tr><tr><td id="L6837" class="css-a4x74f"><span>6837</span></td><td id="LC6837" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6838" class="css-a4x74f"><span>6838</span></td><td id="LC6838" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (matchTimes) {
</code></td></tr><tr><td id="L6839" class="css-a4x74f"><span>6839</span></td><td id="LC6839" class="css-1dcdqdg"><code>            result.startTime = <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">1</span>] || <span class="code-number">0</span>) * <span class="code-number">60</span> * <span class="code-number">60</span> + <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">2</span>]) * <span class="code-number">60</span> + <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">3</span>]) + <span class="code-built_in">Number</span>(<span class="code-string">`0.<span class="code-subst">${matchTimes[<span class="code-number">4</span>]}</span>`</span>);
</code></td></tr><tr><td id="L6840" class="css-a4x74f"><span>6840</span></td><td id="LC6840" class="css-1dcdqdg"><code>            result.endTime = <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">6</span>] || <span class="code-number">0</span>) * <span class="code-number">60</span> * <span class="code-number">60</span> + <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">7</span>]) * <span class="code-number">60</span> + <span class="code-built_in">Number</span>(matchTimes[<span class="code-number">8</span>]) + <span class="code-built_in">Number</span>(<span class="code-string">`0.<span class="code-subst">${matchTimes[<span class="code-number">9</span>]}</span>`</span>);
</code></td></tr><tr><td id="L6841" class="css-a4x74f"><span>6841</span></td><td id="LC6841" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6842" class="css-a4x74f"><span>6842</span></td><td id="LC6842" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!is.empty(line.trim()) &amp;&amp; is.empty(result.text)) {
</code></td></tr><tr><td id="L6843" class="css-a4x74f"><span>6843</span></td><td id="LC6843" class="css-1dcdqdg"><code>          <span class="code-comment">// If we already have the startTime, then we're definitely up to the text line(s)</span>
</code></td></tr><tr><td id="L6844" class="css-a4x74f"><span>6844</span></td><td id="LC6844" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> lineSplit = line.trim().split(<span class="code-string">'#xywh='</span>);
</code></td></tr><tr><td id="L6845" class="css-a4x74f"><span>6845</span></td><td id="LC6845" class="css-1dcdqdg"><code>          [result.text] = lineSplit;
</code></td></tr><tr><td id="L6846" class="css-a4x74f"><span>6846</span></td><td id="LC6846" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6847" class="css-a4x74f"><span>6847</span></td><td id="LC6847" class="css-1dcdqdg"><code>          <span class="code-comment">// If there's content in lineSplit[1], then we have sprites. If not, then it's just one frame per image</span>
</code></td></tr><tr><td id="L6848" class="css-a4x74f"><span>6848</span></td><td id="LC6848" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (lineSplit[<span class="code-number">1</span>]) {
</code></td></tr><tr><td id="L6849" class="css-a4x74f"><span>6849</span></td><td id="LC6849" class="css-1dcdqdg"><code>            [result.x, result.y, result.w, result.h] = lineSplit[<span class="code-number">1</span>].split(<span class="code-string">','</span>);
</code></td></tr><tr><td id="L6850" class="css-a4x74f"><span>6850</span></td><td id="LC6850" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6851" class="css-a4x74f"><span>6851</span></td><td id="LC6851" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6852" class="css-a4x74f"><span>6852</span></td><td id="LC6852" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6853" class="css-a4x74f"><span>6853</span></td><td id="LC6853" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (result.text) {
</code></td></tr><tr><td id="L6854" class="css-a4x74f"><span>6854</span></td><td id="LC6854" class="css-1dcdqdg"><code>        processedList.push(result);
</code></td></tr><tr><td id="L6855" class="css-a4x74f"><span>6855</span></td><td id="LC6855" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L6856" class="css-a4x74f"><span>6856</span></td><td id="LC6856" class="css-1dcdqdg"><code>    });
</code></td></tr><tr><td id="L6857" class="css-a4x74f"><span>6857</span></td><td id="LC6857" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> processedList;
</code></td></tr><tr><td id="L6858" class="css-a4x74f"><span>6858</span></td><td id="LC6858" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L6859" class="css-a4x74f"><span>6859</span></td><td id="LC6859" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6860" class="css-a4x74f"><span>6860</span></td><td id="LC6860" class="css-1dcdqdg"><code>  <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6861" class="css-a4x74f"><span>6861</span></td><td id="LC6861" class="css-1dcdqdg"><code><span class="code-comment">   * Preview thumbnails for seek hover and scrubbing
</span></code></td></tr><tr><td id="L6862" class="css-a4x74f"><span>6862</span></td><td id="LC6862" class="css-1dcdqdg"><code><span class="code-comment">   * Seeking: Hover over the seek bar (desktop only): shows a small preview container above the seek bar
</span></code></td></tr><tr><td id="L6863" class="css-a4x74f"><span>6863</span></td><td id="LC6863" class="css-1dcdqdg"><code><span class="code-comment">   * Scrubbing: Click and drag the seek bar (desktop and mobile): shows the preview image over the entire video, as if the video is scrubbing at very high speed
</span></code></td></tr><tr><td id="L6864" class="css-a4x74f"><span>6864</span></td><td id="LC6864" class="css-1dcdqdg"><code><span class="code-comment">   *
</span></code></td></tr><tr><td id="L6865" class="css-a4x74f"><span>6865</span></td><td id="LC6865" class="css-1dcdqdg"><code><span class="code-comment">   * Notes:
</span></code></td></tr><tr><td id="L6866" class="css-a4x74f"><span>6866</span></td><td id="LC6866" class="css-1dcdqdg"><code><span class="code-comment">   * - Thumbs are set via JS settings on Plyr init, not HTML5 'track' property. Using the track property would be a bit gross, because it doesn't support custom 'kinds'. kind=metadata might be used for something else, and we want to allow multiple thumbnails tracks. Tracks must have a unique combination of 'kind' and 'label'. We would have to do something like kind=metadata,label=thumbnails1 / kind=metadata,label=thumbnails2. Square peg, round hole
</span></code></td></tr><tr><td id="L6867" class="css-a4x74f"><span>6867</span></td><td id="LC6867" class="css-1dcdqdg"><code><span class="code-comment">   * - VTT info: the image URL is relative to the VTT, not the current document. But if the url starts with a slash, it will naturally be relative to the current domain. https://support.jwplayer.com/articles/how-to-add-preview-thumbnails
</span></code></td></tr><tr><td id="L6868" class="css-a4x74f"><span>6868</span></td><td id="LC6868" class="css-1dcdqdg"><code><span class="code-comment">   * - This implementation uses multiple separate img elements. Other implementations use background-image on one element. This would be nice and simple, but Firefox and Safari have flickering issues with replacing backgrounds of larger images. It seems that YouTube perhaps only avoids this because they don't have the option for high-res previews (even the fullscreen ones, when mousedown/seeking). Images appear over the top of each other, and previous ones are discarded once the new ones have been rendered
</span></code></td></tr><tr><td id="L6869" class="css-a4x74f"><span>6869</span></td><td id="LC6869" class="css-1dcdqdg"><code><span class="code-comment">   */</span>
</code></td></tr><tr><td id="L6870" class="css-a4x74f"><span>6870</span></td><td id="LC6870" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6871" class="css-a4x74f"><span>6871</span></td><td id="LC6871" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> fitRatio = <span class="code-function">(<span class="code-params">ratio, outer</span>) =&gt;</span> {
</code></td></tr><tr><td id="L6872" class="css-a4x74f"><span>6872</span></td><td id="LC6872" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> targetRatio = outer.width / outer.height;
</code></td></tr><tr><td id="L6873" class="css-a4x74f"><span>6873</span></td><td id="LC6873" class="css-1dcdqdg"><code>    <span class="code-keyword">const</span> result = {};
</code></td></tr><tr><td id="L6874" class="css-a4x74f"><span>6874</span></td><td id="LC6874" class="css-1dcdqdg"><code>    <span class="code-keyword">if</span> (ratio &gt; targetRatio) {
</code></td></tr><tr><td id="L6875" class="css-a4x74f"><span>6875</span></td><td id="LC6875" class="css-1dcdqdg"><code>      result.width = outer.width;
</code></td></tr><tr><td id="L6876" class="css-a4x74f"><span>6876</span></td><td id="LC6876" class="css-1dcdqdg"><code>      result.height = <span class="code-number">1</span> / ratio * outer.width;
</code></td></tr><tr><td id="L6877" class="css-a4x74f"><span>6877</span></td><td id="LC6877" class="css-1dcdqdg"><code>    } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6878" class="css-a4x74f"><span>6878</span></td><td id="LC6878" class="css-1dcdqdg"><code>      result.height = outer.height;
</code></td></tr><tr><td id="L6879" class="css-a4x74f"><span>6879</span></td><td id="LC6879" class="css-1dcdqdg"><code>      result.width = ratio * outer.height;
</code></td></tr><tr><td id="L6880" class="css-a4x74f"><span>6880</span></td><td id="LC6880" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L6881" class="css-a4x74f"><span>6881</span></td><td id="LC6881" class="css-1dcdqdg"><code>    <span class="code-keyword">return</span> result;
</code></td></tr><tr><td id="L6882" class="css-a4x74f"><span>6882</span></td><td id="LC6882" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L6883" class="css-a4x74f"><span>6883</span></td><td id="LC6883" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">PreviewThumbnails</span> </span>{
</code></td></tr><tr><td id="L6884" class="css-a4x74f"><span>6884</span></td><td id="LC6884" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L6885" class="css-a4x74f"><span>6885</span></td><td id="LC6885" class="css-1dcdqdg"><code><span class="code-comment">     * PreviewThumbnails constructor.
</span></code></td></tr><tr><td id="L6886" class="css-a4x74f"><span>6886</span></td><td id="LC6886" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Plyr} player
</span></code></td></tr><tr><td id="L6887" class="css-a4x74f"><span>6887</span></td><td id="LC6887" class="css-1dcdqdg"><code><span class="code-comment">     * @return {PreviewThumbnails}
</span></code></td></tr><tr><td id="L6888" class="css-a4x74f"><span>6888</span></td><td id="LC6888" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L6889" class="css-a4x74f"><span>6889</span></td><td id="LC6889" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(player) {
</code></td></tr><tr><td id="L6890" class="css-a4x74f"><span>6890</span></td><td id="LC6890" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"load"</span>, () =&gt; {
</code></td></tr><tr><td id="L6891" class="css-a4x74f"><span>6891</span></td><td id="LC6891" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle the regular seek tooltip</span>
</code></td></tr><tr><td id="L6892" class="css-a4x74f"><span>6892</span></td><td id="LC6892" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.player.elements.display.seekTooltip) {
</code></td></tr><tr><td id="L6893" class="css-a4x74f"><span>6893</span></td><td id="LC6893" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.elements.display.seekTooltip.hidden = <span class="code-keyword">this</span>.enabled;
</code></td></tr><tr><td id="L6894" class="css-a4x74f"><span>6894</span></td><td id="LC6894" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L6895" class="css-a4x74f"><span>6895</span></td><td id="LC6895" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.enabled) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6896" class="css-a4x74f"><span>6896</span></td><td id="LC6896" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.getThumbnails().then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6897" class="css-a4x74f"><span>6897</span></td><td id="LC6897" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.enabled) {
</code></td></tr><tr><td id="L6898" class="css-a4x74f"><span>6898</span></td><td id="LC6898" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6899" class="css-a4x74f"><span>6899</span></td><td id="LC6899" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6900" class="css-a4x74f"><span>6900</span></td><td id="LC6900" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6901" class="css-a4x74f"><span>6901</span></td><td id="LC6901" class="css-1dcdqdg"><code>          <span class="code-comment">// Render DOM elements</span>
</code></td></tr><tr><td id="L6902" class="css-a4x74f"><span>6902</span></td><td id="LC6902" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.render();
</code></td></tr><tr><td id="L6903" class="css-a4x74f"><span>6903</span></td><td id="LC6903" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6904" class="css-a4x74f"><span>6904</span></td><td id="LC6904" class="css-1dcdqdg"><code>          <span class="code-comment">// Check to see if thumb container size was specified manually in CSS</span>
</code></td></tr><tr><td id="L6905" class="css-a4x74f"><span>6905</span></td><td id="LC6905" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.determineContainerAutoSizing();
</code></td></tr><tr><td id="L6906" class="css-a4x74f"><span>6906</span></td><td id="LC6906" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6907" class="css-a4x74f"><span>6907</span></td><td id="LC6907" class="css-1dcdqdg"><code>          <span class="code-comment">// Set up listeners</span>
</code></td></tr><tr><td id="L6908" class="css-a4x74f"><span>6908</span></td><td id="LC6908" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.listeners();
</code></td></tr><tr><td id="L6909" class="css-a4x74f"><span>6909</span></td><td id="LC6909" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.loaded = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L6910" class="css-a4x74f"><span>6910</span></td><td id="LC6910" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6911" class="css-a4x74f"><span>6911</span></td><td id="LC6911" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6912" class="css-a4x74f"><span>6912</span></td><td id="LC6912" class="css-1dcdqdg"><code>      <span class="code-comment">// Download VTT files and parse them</span>
</code></td></tr><tr><td id="L6913" class="css-a4x74f"><span>6913</span></td><td id="LC6913" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"getThumbnails"</span>, () =&gt; {
</code></td></tr><tr><td id="L6914" class="css-a4x74f"><span>6914</span></td><td id="LC6914" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function"><span class="code-params">resolve</span> =&gt;</span> {
</code></td></tr><tr><td id="L6915" class="css-a4x74f"><span>6915</span></td><td id="LC6915" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L6916" class="css-a4x74f"><span>6916</span></td><td id="LC6916" class="css-1dcdqdg"><code>            src
</code></td></tr><tr><td id="L6917" class="css-a4x74f"><span>6917</span></td><td id="LC6917" class="css-1dcdqdg"><code>          } = <span class="code-keyword">this</span>.player.config.previewThumbnails;
</code></td></tr><tr><td id="L6918" class="css-a4x74f"><span>6918</span></td><td id="LC6918" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(src)) {
</code></td></tr><tr><td id="L6919" class="css-a4x74f"><span>6919</span></td><td id="LC6919" class="css-1dcdqdg"><code>            <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-built_in">Error</span>(<span class="code-string">'Missing previewThumbnails.src config attribute'</span>);
</code></td></tr><tr><td id="L6920" class="css-a4x74f"><span>6920</span></td><td id="LC6920" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6921" class="css-a4x74f"><span>6921</span></td><td id="LC6921" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6922" class="css-a4x74f"><span>6922</span></td><td id="LC6922" class="css-1dcdqdg"><code>          <span class="code-comment">// Resolve promise</span>
</code></td></tr><tr><td id="L6923" class="css-a4x74f"><span>6923</span></td><td id="LC6923" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> sortAndResolve = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6924" class="css-a4x74f"><span>6924</span></td><td id="LC6924" class="css-1dcdqdg"><code>            <span class="code-comment">// Sort smallest to biggest (e.g., [120p, 480p, 1080p])</span>
</code></td></tr><tr><td id="L6925" class="css-a4x74f"><span>6925</span></td><td id="LC6925" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.thumbnails.sort(<span class="code-function">(<span class="code-params">x, y</span>) =&gt;</span> x.height - y.height);
</code></td></tr><tr><td id="L6926" class="css-a4x74f"><span>6926</span></td><td id="LC6926" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">'Preview thumbnails'</span>, <span class="code-keyword">this</span>.thumbnails);
</code></td></tr><tr><td id="L6927" class="css-a4x74f"><span>6927</span></td><td id="LC6927" class="css-1dcdqdg"><code>            resolve();
</code></td></tr><tr><td id="L6928" class="css-a4x74f"><span>6928</span></td><td id="LC6928" class="css-1dcdqdg"><code>          };
</code></td></tr><tr><td id="L6929" class="css-a4x74f"><span>6929</span></td><td id="LC6929" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6930" class="css-a4x74f"><span>6930</span></td><td id="LC6930" class="css-1dcdqdg"><code>          <span class="code-comment">// Via callback()</span>
</code></td></tr><tr><td id="L6931" class="css-a4x74f"><span>6931</span></td><td id="LC6931" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.function(src)) {
</code></td></tr><tr><td id="L6932" class="css-a4x74f"><span>6932</span></td><td id="LC6932" class="css-1dcdqdg"><code>            src(<span class="code-function"><span class="code-params">thumbnails</span> =&gt;</span> {
</code></td></tr><tr><td id="L6933" class="css-a4x74f"><span>6933</span></td><td id="LC6933" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.thumbnails = thumbnails;
</code></td></tr><tr><td id="L6934" class="css-a4x74f"><span>6934</span></td><td id="LC6934" class="css-1dcdqdg"><code>              sortAndResolve();
</code></td></tr><tr><td id="L6935" class="css-a4x74f"><span>6935</span></td><td id="LC6935" class="css-1dcdqdg"><code>            });
</code></td></tr><tr><td id="L6936" class="css-a4x74f"><span>6936</span></td><td id="LC6936" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6937" class="css-a4x74f"><span>6937</span></td><td id="LC6937" class="css-1dcdqdg"><code>          <span class="code-comment">// VTT urls</span>
</code></td></tr><tr><td id="L6938" class="css-a4x74f"><span>6938</span></td><td id="LC6938" class="css-1dcdqdg"><code>          <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6939" class="css-a4x74f"><span>6939</span></td><td id="LC6939" class="css-1dcdqdg"><code>            <span class="code-comment">// If string, convert into single-element list</span>
</code></td></tr><tr><td id="L6940" class="css-a4x74f"><span>6940</span></td><td id="LC6940" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> urls = is.string(src) ? [src] : src;
</code></td></tr><tr><td id="L6941" class="css-a4x74f"><span>6941</span></td><td id="LC6941" class="css-1dcdqdg"><code>            <span class="code-comment">// Loop through each src URL. Download and process the VTT file, storing the resulting data in this.thumbnails</span>
</code></td></tr><tr><td id="L6942" class="css-a4x74f"><span>6942</span></td><td id="LC6942" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> promises = urls.map(<span class="code-function"><span class="code-params">u</span> =&gt;</span> <span class="code-keyword">this</span>.getThumbnail(u));
</code></td></tr><tr><td id="L6943" class="css-a4x74f"><span>6943</span></td><td id="LC6943" class="css-1dcdqdg"><code>            <span class="code-comment">// Resolve</span>
</code></td></tr><tr><td id="L6944" class="css-a4x74f"><span>6944</span></td><td id="LC6944" class="css-1dcdqdg"><code>            <span class="code-built_in">Promise</span>.all(promises).then(sortAndResolve);
</code></td></tr><tr><td id="L6945" class="css-a4x74f"><span>6945</span></td><td id="LC6945" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6946" class="css-a4x74f"><span>6946</span></td><td id="LC6946" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6947" class="css-a4x74f"><span>6947</span></td><td id="LC6947" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6948" class="css-a4x74f"><span>6948</span></td><td id="LC6948" class="css-1dcdqdg"><code>      <span class="code-comment">// Process individual VTT file</span>
</code></td></tr><tr><td id="L6949" class="css-a4x74f"><span>6949</span></td><td id="LC6949" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"getThumbnail"</span>, url =&gt; {
</code></td></tr><tr><td id="L6950" class="css-a4x74f"><span>6950</span></td><td id="LC6950" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function"><span class="code-params">resolve</span> =&gt;</span> {
</code></td></tr><tr><td id="L6951" class="css-a4x74f"><span>6951</span></td><td id="LC6951" class="css-1dcdqdg"><code>          fetch(url).then(<span class="code-function"><span class="code-params">response</span> =&gt;</span> {
</code></td></tr><tr><td id="L6952" class="css-a4x74f"><span>6952</span></td><td id="LC6952" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> thumbnail = {
</code></td></tr><tr><td id="L6953" class="css-a4x74f"><span>6953</span></td><td id="LC6953" class="css-1dcdqdg"><code>              frames: parseVtt(response),
</code></td></tr><tr><td id="L6954" class="css-a4x74f"><span>6954</span></td><td id="LC6954" class="css-1dcdqdg"><code>              height: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L6955" class="css-a4x74f"><span>6955</span></td><td id="LC6955" class="css-1dcdqdg"><code>              urlPrefix: <span class="code-string">''</span>
</code></td></tr><tr><td id="L6956" class="css-a4x74f"><span>6956</span></td><td id="LC6956" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L6957" class="css-a4x74f"><span>6957</span></td><td id="LC6957" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6958" class="css-a4x74f"><span>6958</span></td><td id="LC6958" class="css-1dcdqdg"><code>            <span class="code-comment">// If the URLs don't start with '/', then we need to set their relative path to be the location of the VTT file</span>
</code></td></tr><tr><td id="L6959" class="css-a4x74f"><span>6959</span></td><td id="LC6959" class="css-1dcdqdg"><code>            <span class="code-comment">// If the URLs do start with '/', then they obviously don't need a prefix, so it will remain blank</span>
</code></td></tr><tr><td id="L6960" class="css-a4x74f"><span>6960</span></td><td id="LC6960" class="css-1dcdqdg"><code>            <span class="code-comment">// If the thumbnail URLs start with with none of '/', 'http://' or 'https://', then we need to set their relative path to be the location of the VTT file</span>
</code></td></tr><tr><td id="L6961" class="css-a4x74f"><span>6961</span></td><td id="LC6961" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!thumbnail.frames[<span class="code-number">0</span>].text.startsWith(<span class="code-string">'/'</span>) &amp;&amp; !thumbnail.frames[<span class="code-number">0</span>].text.startsWith(<span class="code-string">'http://'</span>) &amp;&amp; !thumbnail.frames[<span class="code-number">0</span>].text.startsWith(<span class="code-string">'https://'</span>)) {
</code></td></tr><tr><td id="L6962" class="css-a4x74f"><span>6962</span></td><td id="LC6962" class="css-1dcdqdg"><code>              thumbnail.urlPrefix = url.substring(<span class="code-number">0</span>, url.lastIndexOf(<span class="code-string">'/'</span>) + <span class="code-number">1</span>);
</code></td></tr><tr><td id="L6963" class="css-a4x74f"><span>6963</span></td><td id="LC6963" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L6964" class="css-a4x74f"><span>6964</span></td><td id="LC6964" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6965" class="css-a4x74f"><span>6965</span></td><td id="LC6965" class="css-1dcdqdg"><code>            <span class="code-comment">// Download the first frame, so that we can determine/set the height of this thumbnailsDef</span>
</code></td></tr><tr><td id="L6966" class="css-a4x74f"><span>6966</span></td><td id="LC6966" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> tempImage = <span class="code-keyword">new</span> Image();
</code></td></tr><tr><td id="L6967" class="css-a4x74f"><span>6967</span></td><td id="LC6967" class="css-1dcdqdg"><code>            tempImage.onload = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L6968" class="css-a4x74f"><span>6968</span></td><td id="LC6968" class="css-1dcdqdg"><code>              thumbnail.height = tempImage.naturalHeight;
</code></td></tr><tr><td id="L6969" class="css-a4x74f"><span>6969</span></td><td id="LC6969" class="css-1dcdqdg"><code>              thumbnail.width = tempImage.naturalWidth;
</code></td></tr><tr><td id="L6970" class="css-a4x74f"><span>6970</span></td><td id="LC6970" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.thumbnails.push(thumbnail);
</code></td></tr><tr><td id="L6971" class="css-a4x74f"><span>6971</span></td><td id="LC6971" class="css-1dcdqdg"><code>              resolve();
</code></td></tr><tr><td id="L6972" class="css-a4x74f"><span>6972</span></td><td id="LC6972" class="css-1dcdqdg"><code>            };
</code></td></tr><tr><td id="L6973" class="css-a4x74f"><span>6973</span></td><td id="LC6973" class="css-1dcdqdg"><code>            tempImage.src = thumbnail.urlPrefix + thumbnail.frames[<span class="code-number">0</span>].text;
</code></td></tr><tr><td id="L6974" class="css-a4x74f"><span>6974</span></td><td id="LC6974" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L6975" class="css-a4x74f"><span>6975</span></td><td id="LC6975" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L6976" class="css-a4x74f"><span>6976</span></td><td id="LC6976" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L6977" class="css-a4x74f"><span>6977</span></td><td id="LC6977" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"startMove"</span>, event =&gt; {
</code></td></tr><tr><td id="L6978" class="css-a4x74f"><span>6978</span></td><td id="LC6978" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.loaded) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6979" class="css-a4x74f"><span>6979</span></td><td id="LC6979" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.event(event) || ![<span class="code-string">'touchmove'</span>, <span class="code-string">'mousemove'</span>].includes(event.type)) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6980" class="css-a4x74f"><span>6980</span></td><td id="LC6980" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L6981" class="css-a4x74f"><span>6981</span></td><td id="LC6981" class="css-1dcdqdg"><code>        <span class="code-comment">// Wait until media has a duration</span>
</code></td></tr><tr><td id="L6982" class="css-a4x74f"><span>6982</span></td><td id="LC6982" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.player.media.duration) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L6983" class="css-a4x74f"><span>6983</span></td><td id="LC6983" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (event.type === <span class="code-string">'touchmove'</span>) {
</code></td></tr><tr><td id="L6984" class="css-a4x74f"><span>6984</span></td><td id="LC6984" class="css-1dcdqdg"><code>          <span class="code-comment">// Calculate seek hover position as approx video seconds</span>
</code></td></tr><tr><td id="L6985" class="css-a4x74f"><span>6985</span></td><td id="LC6985" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.seekTime = <span class="code-keyword">this</span>.player.media.duration * (<span class="code-keyword">this</span>.player.elements.inputs.seek.value / <span class="code-number">100</span>);
</code></td></tr><tr><td id="L6986" class="css-a4x74f"><span>6986</span></td><td id="LC6986" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L6987" class="css-a4x74f"><span>6987</span></td><td id="LC6987" class="css-1dcdqdg"><code>          <span class="code-keyword">var</span> _this$player$config$m, _this$player$config$m2;
</code></td></tr><tr><td id="L6988" class="css-a4x74f"><span>6988</span></td><td id="LC6988" class="css-1dcdqdg"><code>          <span class="code-comment">// Calculate seek hover position as approx video seconds</span>
</code></td></tr><tr><td id="L6989" class="css-a4x74f"><span>6989</span></td><td id="LC6989" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> clientRect = <span class="code-keyword">this</span>.player.elements.progress.getBoundingClientRect();
</code></td></tr><tr><td id="L6990" class="css-a4x74f"><span>6990</span></td><td id="LC6990" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> percentage = <span class="code-number">100</span> / clientRect.width * (event.pageX - clientRect.left);
</code></td></tr><tr><td id="L6991" class="css-a4x74f"><span>6991</span></td><td id="LC6991" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.seekTime = <span class="code-keyword">this</span>.player.media.duration * (percentage / <span class="code-number">100</span>);
</code></td></tr><tr><td id="L6992" class="css-a4x74f"><span>6992</span></td><td id="LC6992" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.seekTime &lt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L6993" class="css-a4x74f"><span>6993</span></td><td id="LC6993" class="css-1dcdqdg"><code>            <span class="code-comment">// The mousemove fires for 10+px out to the left</span>
</code></td></tr><tr><td id="L6994" class="css-a4x74f"><span>6994</span></td><td id="LC6994" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.seekTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L6995" class="css-a4x74f"><span>6995</span></td><td id="LC6995" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L6996" class="css-a4x74f"><span>6996</span></td><td id="LC6996" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.seekTime &gt; <span class="code-keyword">this</span>.player.media.duration - <span class="code-number">1</span>) {
</code></td></tr><tr><td id="L6997" class="css-a4x74f"><span>6997</span></td><td id="LC6997" class="css-1dcdqdg"><code>            <span class="code-comment">// Took 1 second off the duration for safety, because different players can disagree on the real duration of a video</span>
</code></td></tr><tr><td id="L6998" class="css-a4x74f"><span>6998</span></td><td id="LC6998" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.seekTime = <span class="code-keyword">this</span>.player.media.duration - <span class="code-number">1</span>;
</code></td></tr><tr><td id="L6999" class="css-a4x74f"><span>6999</span></td><td id="LC6999" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7000" class="css-a4x74f"><span>7000</span></td><td id="LC7000" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.mousePosX = event.pageX;
</code></td></tr><tr><td id="L7001" class="css-a4x74f"><span>7001</span></td><td id="LC7001" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7002" class="css-a4x74f"><span>7002</span></td><td id="LC7002" class="css-1dcdqdg"><code>          <span class="code-comment">// Set time text inside image container</span>
</code></td></tr><tr><td id="L7003" class="css-a4x74f"><span>7003</span></td><td id="LC7003" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.thumb.time.innerText = formatTime(<span class="code-keyword">this</span>.seekTime);
</code></td></tr><tr><td id="L7004" class="css-a4x74f"><span>7004</span></td><td id="LC7004" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7005" class="css-a4x74f"><span>7005</span></td><td id="LC7005" class="css-1dcdqdg"><code>          <span class="code-comment">// Get marker point for time</span>
</code></td></tr><tr><td id="L7006" class="css-a4x74f"><span>7006</span></td><td id="LC7006" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> point = (_this$player$config$m = <span class="code-keyword">this</span>.player.config.markers) === <span class="code-literal">null</span> || _this$player$config$m === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : (_this$player$config$m2 = _this$player$config$m.points) === <span class="code-literal">null</span> || _this$player$config$m2 === <span class="code-keyword">void</span> <span class="code-number">0</span> ? <span class="code-keyword">void</span> <span class="code-number">0</span> : _this$player$config$m2.find(({
</code></td></tr><tr><td id="L7007" class="css-a4x74f"><span>7007</span></td><td id="LC7007" class="css-1dcdqdg"><code>            time: t
</code></td></tr><tr><td id="L7008" class="css-a4x74f"><span>7008</span></td><td id="LC7008" class="css-1dcdqdg"><code>          }) =&gt; t === <span class="code-built_in">Math</span>.round(<span class="code-keyword">this</span>.seekTime));
</code></td></tr><tr><td id="L7009" class="css-a4x74f"><span>7009</span></td><td id="LC7009" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7010" class="css-a4x74f"><span>7010</span></td><td id="LC7010" class="css-1dcdqdg"><code>          <span class="code-comment">// Append the point label to the tooltip</span>
</code></td></tr><tr><td id="L7011" class="css-a4x74f"><span>7011</span></td><td id="LC7011" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (point) {
</code></td></tr><tr><td id="L7012" class="css-a4x74f"><span>7012</span></td><td id="LC7012" class="css-1dcdqdg"><code>            <span class="code-comment">// this.elements.thumb.time.innerText.concat('\n');</span>
</code></td></tr><tr><td id="L7013" class="css-a4x74f"><span>7013</span></td><td id="LC7013" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.thumb.time.insertAdjacentHTML(<span class="code-string">'afterbegin'</span>, <span class="code-string">`<span class="code-subst">${point.label}</span>&lt;br&gt;`</span>);
</code></td></tr><tr><td id="L7014" class="css-a4x74f"><span>7014</span></td><td id="LC7014" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7015" class="css-a4x74f"><span>7015</span></td><td id="LC7015" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7016" class="css-a4x74f"><span>7016</span></td><td id="LC7016" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7017" class="css-a4x74f"><span>7017</span></td><td id="LC7017" class="css-1dcdqdg"><code>        <span class="code-comment">// Download and show image</span>
</code></td></tr><tr><td id="L7018" class="css-a4x74f"><span>7018</span></td><td id="LC7018" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.showImageAtCurrentTime();
</code></td></tr><tr><td id="L7019" class="css-a4x74f"><span>7019</span></td><td id="LC7019" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7020" class="css-a4x74f"><span>7020</span></td><td id="LC7020" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"endMove"</span>, () =&gt; {
</code></td></tr><tr><td id="L7021" class="css-a4x74f"><span>7021</span></td><td id="LC7021" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.toggleThumbContainer(<span class="code-literal">false</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7022" class="css-a4x74f"><span>7022</span></td><td id="LC7022" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7023" class="css-a4x74f"><span>7023</span></td><td id="LC7023" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"startScrubbing"</span>, event =&gt; {
</code></td></tr><tr><td id="L7024" class="css-a4x74f"><span>7024</span></td><td id="LC7024" class="css-1dcdqdg"><code>        <span class="code-comment">// Only act on left mouse button (0), or touch device (event.button does not exist or is false)</span>
</code></td></tr><tr><td id="L7025" class="css-a4x74f"><span>7025</span></td><td id="LC7025" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.nullOrUndefined(event.button) || event.button === <span class="code-literal">false</span> || event.button === <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L7026" class="css-a4x74f"><span>7026</span></td><td id="LC7026" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.mouseDown = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7027" class="css-a4x74f"><span>7027</span></td><td id="LC7027" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7028" class="css-a4x74f"><span>7028</span></td><td id="LC7028" class="css-1dcdqdg"><code>          <span class="code-comment">// Wait until media has a duration</span>
</code></td></tr><tr><td id="L7029" class="css-a4x74f"><span>7029</span></td><td id="LC7029" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.player.media.duration) {
</code></td></tr><tr><td id="L7030" class="css-a4x74f"><span>7030</span></td><td id="LC7030" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.toggleScrubbingContainer(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7031" class="css-a4x74f"><span>7031</span></td><td id="LC7031" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.toggleThumbContainer(<span class="code-literal">false</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7032" class="css-a4x74f"><span>7032</span></td><td id="LC7032" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7033" class="css-a4x74f"><span>7033</span></td><td id="LC7033" class="css-1dcdqdg"><code>            <span class="code-comment">// Download and show image</span>
</code></td></tr><tr><td id="L7034" class="css-a4x74f"><span>7034</span></td><td id="LC7034" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.showImageAtCurrentTime();
</code></td></tr><tr><td id="L7035" class="css-a4x74f"><span>7035</span></td><td id="LC7035" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7036" class="css-a4x74f"><span>7036</span></td><td id="LC7036" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7037" class="css-a4x74f"><span>7037</span></td><td id="LC7037" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7038" class="css-a4x74f"><span>7038</span></td><td id="LC7038" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"endScrubbing"</span>, () =&gt; {
</code></td></tr><tr><td id="L7039" class="css-a4x74f"><span>7039</span></td><td id="LC7039" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.mouseDown = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7040" class="css-a4x74f"><span>7040</span></td><td id="LC7040" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7041" class="css-a4x74f"><span>7041</span></td><td id="LC7041" class="css-1dcdqdg"><code>        <span class="code-comment">// Hide scrubbing preview. But wait until the video has successfully seeked before hiding the scrubbing preview</span>
</code></td></tr><tr><td id="L7042" class="css-a4x74f"><span>7042</span></td><td id="LC7042" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-built_in">Math</span>.ceil(<span class="code-keyword">this</span>.lastTime) === <span class="code-built_in">Math</span>.ceil(<span class="code-keyword">this</span>.player.media.currentTime)) {
</code></td></tr><tr><td id="L7043" class="css-a4x74f"><span>7043</span></td><td id="LC7043" class="css-1dcdqdg"><code>          <span class="code-comment">// The video was already seeked/loaded at the chosen time - hide immediately</span>
</code></td></tr><tr><td id="L7044" class="css-a4x74f"><span>7044</span></td><td id="LC7044" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleScrubbingContainer(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L7045" class="css-a4x74f"><span>7045</span></td><td id="LC7045" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7046" class="css-a4x74f"><span>7046</span></td><td id="LC7046" class="css-1dcdqdg"><code>          <span class="code-comment">// The video hasn't seeked yet. Wait for that</span>
</code></td></tr><tr><td id="L7047" class="css-a4x74f"><span>7047</span></td><td id="LC7047" class="css-1dcdqdg"><code>          once.call(<span class="code-keyword">this</span>.player, <span class="code-keyword">this</span>.player.media, <span class="code-string">'timeupdate'</span>, () =&gt; {
</code></td></tr><tr><td id="L7048" class="css-a4x74f"><span>7048</span></td><td id="LC7048" class="css-1dcdqdg"><code>            <span class="code-comment">// Re-check mousedown - we might have already started scrubbing again</span>
</code></td></tr><tr><td id="L7049" class="css-a4x74f"><span>7049</span></td><td id="LC7049" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.mouseDown) {
</code></td></tr><tr><td id="L7050" class="css-a4x74f"><span>7050</span></td><td id="LC7050" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.toggleScrubbingContainer(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L7051" class="css-a4x74f"><span>7051</span></td><td id="LC7051" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7052" class="css-a4x74f"><span>7052</span></td><td id="LC7052" class="css-1dcdqdg"><code>          });
</code></td></tr><tr><td id="L7053" class="css-a4x74f"><span>7053</span></td><td id="LC7053" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7054" class="css-a4x74f"><span>7054</span></td><td id="LC7054" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7055" class="css-a4x74f"><span>7055</span></td><td id="LC7055" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7056" class="css-a4x74f"><span>7056</span></td><td id="LC7056" class="css-1dcdqdg"><code><span class="code-comment">       * Setup hooks for Plyr and window events
</span></code></td></tr><tr><td id="L7057" class="css-a4x74f"><span>7057</span></td><td id="LC7057" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7058" class="css-a4x74f"><span>7058</span></td><td id="LC7058" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"listeners"</span>, () =&gt; {
</code></td></tr><tr><td id="L7059" class="css-a4x74f"><span>7059</span></td><td id="LC7059" class="css-1dcdqdg"><code>        <span class="code-comment">// Hide thumbnail preview - on mouse click, mouse leave (in listeners.js for now), and video play/seek. All four are required, e.g., for buffering</span>
</code></td></tr><tr><td id="L7060" class="css-a4x74f"><span>7060</span></td><td id="LC7060" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'play'</span>, () =&gt; {
</code></td></tr><tr><td id="L7061" class="css-a4x74f"><span>7061</span></td><td id="LC7061" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleThumbContainer(<span class="code-literal">false</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7062" class="css-a4x74f"><span>7062</span></td><td id="LC7062" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7063" class="css-a4x74f"><span>7063</span></td><td id="LC7063" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'seeked'</span>, () =&gt; {
</code></td></tr><tr><td id="L7064" class="css-a4x74f"><span>7064</span></td><td id="LC7064" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleThumbContainer(<span class="code-literal">false</span>);
</code></td></tr><tr><td id="L7065" class="css-a4x74f"><span>7065</span></td><td id="LC7065" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7066" class="css-a4x74f"><span>7066</span></td><td id="LC7066" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.on(<span class="code-string">'timeupdate'</span>, () =&gt; {
</code></td></tr><tr><td id="L7067" class="css-a4x74f"><span>7067</span></td><td id="LC7067" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.lastTime = <span class="code-keyword">this</span>.player.media.currentTime;
</code></td></tr><tr><td id="L7068" class="css-a4x74f"><span>7068</span></td><td id="LC7068" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7069" class="css-a4x74f"><span>7069</span></td><td id="LC7069" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7070" class="css-a4x74f"><span>7070</span></td><td id="LC7070" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7071" class="css-a4x74f"><span>7071</span></td><td id="LC7071" class="css-1dcdqdg"><code><span class="code-comment">       * Create HTML elements for image containers
</span></code></td></tr><tr><td id="L7072" class="css-a4x74f"><span>7072</span></td><td id="LC7072" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7073" class="css-a4x74f"><span>7073</span></td><td id="LC7073" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"render"</span>, () =&gt; {
</code></td></tr><tr><td id="L7074" class="css-a4x74f"><span>7074</span></td><td id="LC7074" class="css-1dcdqdg"><code>        <span class="code-comment">// Create HTML element: plyr__preview-thumbnail-container</span>
</code></td></tr><tr><td id="L7075" class="css-a4x74f"><span>7075</span></td><td id="LC7075" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.container = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L7076" class="css-a4x74f"><span>7076</span></td><td id="LC7076" class="css-1dcdqdg"><code>          class: this.player.config.classNames.previewThumbnails.thumbContainer
</code></td></tr><tr><td id="L7077" class="css-a4x74f"><span>7077</span></td><td id="LC7077" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7078" class="css-a4x74f"><span>7078</span></td><td id="LC7078" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7079" class="css-a4x74f"><span>7079</span></td><td id="LC7079" class="css-1dcdqdg"><code>        <span class="code-comment">// Wrapper for the image for styling</span>
</code></td></tr><tr><td id="L7080" class="css-a4x74f"><span>7080</span></td><td id="LC7080" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.imageContainer = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L7081" class="css-a4x74f"><span>7081</span></td><td id="LC7081" class="css-1dcdqdg"><code>          class: this.player.config.classNames.previewThumbnails.imageContainer
</code></td></tr><tr><td id="L7082" class="css-a4x74f"><span>7082</span></td><td id="LC7082" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7083" class="css-a4x74f"><span>7083</span></td><td id="LC7083" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.container.appendChild(<span class="code-keyword">this</span>.elements.thumb.imageContainer);
</code></td></tr><tr><td id="L7084" class="css-a4x74f"><span>7084</span></td><td id="LC7084" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7085" class="css-a4x74f"><span>7085</span></td><td id="LC7085" class="css-1dcdqdg"><code>        <span class="code-comment">// Create HTML element, parent+span: time text (e.g., 01:32:00)</span>
</code></td></tr><tr><td id="L7086" class="css-a4x74f"><span>7086</span></td><td id="LC7086" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> timeContainer = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L7087" class="css-a4x74f"><span>7087</span></td><td id="LC7087" class="css-1dcdqdg"><code>          class: this.player.config.classNames.previewThumbnails.timeContainer
</code></td></tr><tr><td id="L7088" class="css-a4x74f"><span>7088</span></td><td id="LC7088" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7089" class="css-a4x74f"><span>7089</span></td><td id="LC7089" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.time = createElement(<span class="code-string">'span'</span>, {}, <span class="code-string">'00:00'</span>);
</code></td></tr><tr><td id="L7090" class="css-a4x74f"><span>7090</span></td><td id="LC7090" class="css-1dcdqdg"><code>        timeContainer.appendChild(<span class="code-keyword">this</span>.elements.thumb.time);
</code></td></tr><tr><td id="L7091" class="css-a4x74f"><span>7091</span></td><td id="LC7091" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.imageContainer.appendChild(timeContainer);
</code></td></tr><tr><td id="L7092" class="css-a4x74f"><span>7092</span></td><td id="LC7092" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7093" class="css-a4x74f"><span>7093</span></td><td id="LC7093" class="css-1dcdqdg"><code>        <span class="code-comment">// Inject the whole thumb</span>
</code></td></tr><tr><td id="L7094" class="css-a4x74f"><span>7094</span></td><td id="LC7094" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.player.elements.progress)) {
</code></td></tr><tr><td id="L7095" class="css-a4x74f"><span>7095</span></td><td id="LC7095" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.elements.progress.appendChild(<span class="code-keyword">this</span>.elements.thumb.container);
</code></td></tr><tr><td id="L7096" class="css-a4x74f"><span>7096</span></td><td id="LC7096" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7097" class="css-a4x74f"><span>7097</span></td><td id="LC7097" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7098" class="css-a4x74f"><span>7098</span></td><td id="LC7098" class="css-1dcdqdg"><code>        <span class="code-comment">// Create HTML element: plyr__preview-scrubbing-container</span>
</code></td></tr><tr><td id="L7099" class="css-a4x74f"><span>7099</span></td><td id="LC7099" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.scrubbing.container = createElement(<span class="code-string">'div'</span>, {
</code></td></tr><tr><td id="L7100" class="css-a4x74f"><span>7100</span></td><td id="LC7100" class="css-1dcdqdg"><code>          class: this.player.config.classNames.previewThumbnails.scrubbingContainer
</code></td></tr><tr><td id="L7101" class="css-a4x74f"><span>7101</span></td><td id="LC7101" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7102" class="css-a4x74f"><span>7102</span></td><td id="LC7102" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.elements.wrapper.appendChild(<span class="code-keyword">this</span>.elements.scrubbing.container);
</code></td></tr><tr><td id="L7103" class="css-a4x74f"><span>7103</span></td><td id="LC7103" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7104" class="css-a4x74f"><span>7104</span></td><td id="LC7104" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"destroy"</span>, () =&gt; {
</code></td></tr><tr><td id="L7105" class="css-a4x74f"><span>7105</span></td><td id="LC7105" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements.thumb.container) {
</code></td></tr><tr><td id="L7106" class="css-a4x74f"><span>7106</span></td><td id="LC7106" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.thumb.container.remove();
</code></td></tr><tr><td id="L7107" class="css-a4x74f"><span>7107</span></td><td id="LC7107" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7108" class="css-a4x74f"><span>7108</span></td><td id="LC7108" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements.scrubbing.container) {
</code></td></tr><tr><td id="L7109" class="css-a4x74f"><span>7109</span></td><td id="LC7109" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.scrubbing.container.remove();
</code></td></tr><tr><td id="L7110" class="css-a4x74f"><span>7110</span></td><td id="LC7110" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7111" class="css-a4x74f"><span>7111</span></td><td id="LC7111" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7112" class="css-a4x74f"><span>7112</span></td><td id="LC7112" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"showImageAtCurrentTime"</span>, () =&gt; {
</code></td></tr><tr><td id="L7113" class="css-a4x74f"><span>7113</span></td><td id="LC7113" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.mouseDown) {
</code></td></tr><tr><td id="L7114" class="css-a4x74f"><span>7114</span></td><td id="LC7114" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.setScrubbingContainerSize();
</code></td></tr><tr><td id="L7115" class="css-a4x74f"><span>7115</span></td><td id="LC7115" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7116" class="css-a4x74f"><span>7116</span></td><td id="LC7116" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.setThumbContainerSizeAndPos();
</code></td></tr><tr><td id="L7117" class="css-a4x74f"><span>7117</span></td><td id="LC7117" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7118" class="css-a4x74f"><span>7118</span></td><td id="LC7118" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7119" class="css-a4x74f"><span>7119</span></td><td id="LC7119" class="css-1dcdqdg"><code>        <span class="code-comment">// Find the desired thumbnail index</span>
</code></td></tr><tr><td id="L7120" class="css-a4x74f"><span>7120</span></td><td id="LC7120" class="css-1dcdqdg"><code>        <span class="code-comment">// <span class="code-doctag">TODO:</span> Handle a video longer than the thumbs where thumbNum is null</span>
</code></td></tr><tr><td id="L7121" class="css-a4x74f"><span>7121</span></td><td id="LC7121" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> thumbNum = <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames.findIndex(<span class="code-function"><span class="code-params">frame</span> =&gt;</span> <span class="code-keyword">this</span>.seekTime &gt;= frame.startTime &amp;&amp; <span class="code-keyword">this</span>.seekTime &lt;= frame.endTime);
</code></td></tr><tr><td id="L7122" class="css-a4x74f"><span>7122</span></td><td id="LC7122" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> hasThumb = thumbNum &gt;= <span class="code-number">0</span>;
</code></td></tr><tr><td id="L7123" class="css-a4x74f"><span>7123</span></td><td id="LC7123" class="css-1dcdqdg"><code>        <span class="code-keyword">let</span> qualityIndex = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L7124" class="css-a4x74f"><span>7124</span></td><td id="LC7124" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7125" class="css-a4x74f"><span>7125</span></td><td id="LC7125" class="css-1dcdqdg"><code>        <span class="code-comment">// Show the thumb container if we're not scrubbing</span>
</code></td></tr><tr><td id="L7126" class="css-a4x74f"><span>7126</span></td><td id="LC7126" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.mouseDown) {
</code></td></tr><tr><td id="L7127" class="css-a4x74f"><span>7127</span></td><td id="LC7127" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.toggleThumbContainer(hasThumb);
</code></td></tr><tr><td id="L7128" class="css-a4x74f"><span>7128</span></td><td id="LC7128" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7129" class="css-a4x74f"><span>7129</span></td><td id="LC7129" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7130" class="css-a4x74f"><span>7130</span></td><td id="LC7130" class="css-1dcdqdg"><code>        <span class="code-comment">// No matching thumb found</span>
</code></td></tr><tr><td id="L7131" class="css-a4x74f"><span>7131</span></td><td id="LC7131" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!hasThumb) {
</code></td></tr><tr><td id="L7132" class="css-a4x74f"><span>7132</span></td><td id="LC7132" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7133" class="css-a4x74f"><span>7133</span></td><td id="LC7133" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7134" class="css-a4x74f"><span>7134</span></td><td id="LC7134" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7135" class="css-a4x74f"><span>7135</span></td><td id="LC7135" class="css-1dcdqdg"><code>        <span class="code-comment">// Check to see if we've already downloaded higher quality versions of this image</span>
</code></td></tr><tr><td id="L7136" class="css-a4x74f"><span>7136</span></td><td id="LC7136" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.thumbnails.forEach(<span class="code-function">(<span class="code-params">thumbnail, index</span>) =&gt;</span> {
</code></td></tr><tr><td id="L7137" class="css-a4x74f"><span>7137</span></td><td id="LC7137" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.loadedImages.includes(thumbnail.frames[thumbNum].text)) {
</code></td></tr><tr><td id="L7138" class="css-a4x74f"><span>7138</span></td><td id="LC7138" class="css-1dcdqdg"><code>            qualityIndex = index;
</code></td></tr><tr><td id="L7139" class="css-a4x74f"><span>7139</span></td><td id="LC7139" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7140" class="css-a4x74f"><span>7140</span></td><td id="LC7140" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7141" class="css-a4x74f"><span>7141</span></td><td id="LC7141" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7142" class="css-a4x74f"><span>7142</span></td><td id="LC7142" class="css-1dcdqdg"><code>        <span class="code-comment">// Only proceed if either thumb num or thumbfilename has changed</span>
</code></td></tr><tr><td id="L7143" class="css-a4x74f"><span>7143</span></td><td id="LC7143" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (thumbNum !== <span class="code-keyword">this</span>.showingThumb) {
</code></td></tr><tr><td id="L7144" class="css-a4x74f"><span>7144</span></td><td id="LC7144" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumb = thumbNum;
</code></td></tr><tr><td id="L7145" class="css-a4x74f"><span>7145</span></td><td id="LC7145" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.loadImage(qualityIndex);
</code></td></tr><tr><td id="L7146" class="css-a4x74f"><span>7146</span></td><td id="LC7146" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7147" class="css-a4x74f"><span>7147</span></td><td id="LC7147" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7148" class="css-a4x74f"><span>7148</span></td><td id="LC7148" class="css-1dcdqdg"><code>      <span class="code-comment">// Show the image that's currently specified in this.showingThumb</span>
</code></td></tr><tr><td id="L7149" class="css-a4x74f"><span>7149</span></td><td id="LC7149" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"loadImage"</span>, (qualityIndex = <span class="code-number">0</span>) =&gt; {
</code></td></tr><tr><td id="L7150" class="css-a4x74f"><span>7150</span></td><td id="LC7150" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> thumbNum = <span class="code-keyword">this</span>.showingThumb;
</code></td></tr><tr><td id="L7151" class="css-a4x74f"><span>7151</span></td><td id="LC7151" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> thumbnail = <span class="code-keyword">this</span>.thumbnails[qualityIndex];
</code></td></tr><tr><td id="L7152" class="css-a4x74f"><span>7152</span></td><td id="LC7152" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7153" class="css-a4x74f"><span>7153</span></td><td id="LC7153" class="css-1dcdqdg"><code>          urlPrefix
</code></td></tr><tr><td id="L7154" class="css-a4x74f"><span>7154</span></td><td id="LC7154" class="css-1dcdqdg"><code>        } = thumbnail;
</code></td></tr><tr><td id="L7155" class="css-a4x74f"><span>7155</span></td><td id="LC7155" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> frame = thumbnail.frames[thumbNum];
</code></td></tr><tr><td id="L7156" class="css-a4x74f"><span>7156</span></td><td id="LC7156" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> thumbFilename = thumbnail.frames[thumbNum].text;
</code></td></tr><tr><td id="L7157" class="css-a4x74f"><span>7157</span></td><td id="LC7157" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> thumbUrl = urlPrefix + thumbFilename;
</code></td></tr><tr><td id="L7158" class="css-a4x74f"><span>7158</span></td><td id="LC7158" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.currentImageElement || <span class="code-keyword">this</span>.currentImageElement.dataset.filename !== thumbFilename) {
</code></td></tr><tr><td id="L7159" class="css-a4x74f"><span>7159</span></td><td id="LC7159" class="css-1dcdqdg"><code>          <span class="code-comment">// If we're already loading a previous image, remove its onload handler - we don't want it to load after this one</span>
</code></td></tr><tr><td id="L7160" class="css-a4x74f"><span>7160</span></td><td id="LC7160" class="css-1dcdqdg"><code>          <span class="code-comment">// Only do this if not using sprites. Without sprites we really want to show as many images as possible, as a best-effort</span>
</code></td></tr><tr><td id="L7161" class="css-a4x74f"><span>7161</span></td><td id="LC7161" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.loadingImage &amp;&amp; <span class="code-keyword">this</span>.usingSprites) {
</code></td></tr><tr><td id="L7162" class="css-a4x74f"><span>7162</span></td><td id="LC7162" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.loadingImage.onload = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7163" class="css-a4x74f"><span>7163</span></td><td id="LC7163" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7164" class="css-a4x74f"><span>7164</span></td><td id="LC7164" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7165" class="css-a4x74f"><span>7165</span></td><td id="LC7165" class="css-1dcdqdg"><code>          <span class="code-comment">// We're building and adding a new image. In other implementations of similar functionality (YouTube), background image</span>
</code></td></tr><tr><td id="L7166" class="css-a4x74f"><span>7166</span></td><td id="LC7166" class="css-1dcdqdg"><code>          <span class="code-comment">// is instead used. But this causes issues with larger images in Firefox and Safari - switching between background</span>
</code></td></tr><tr><td id="L7167" class="css-a4x74f"><span>7167</span></td><td id="LC7167" class="css-1dcdqdg"><code>          <span class="code-comment">// images causes a flicker. Putting a new image over the top does not</span>
</code></td></tr><tr><td id="L7168" class="css-a4x74f"><span>7168</span></td><td id="LC7168" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> previewImage = <span class="code-keyword">new</span> Image();
</code></td></tr><tr><td id="L7169" class="css-a4x74f"><span>7169</span></td><td id="LC7169" class="css-1dcdqdg"><code>          previewImage.src = thumbUrl;
</code></td></tr><tr><td id="L7170" class="css-a4x74f"><span>7170</span></td><td id="LC7170" class="css-1dcdqdg"><code>          previewImage.dataset.index = thumbNum;
</code></td></tr><tr><td id="L7171" class="css-a4x74f"><span>7171</span></td><td id="LC7171" class="css-1dcdqdg"><code>          previewImage.dataset.filename = thumbFilename;
</code></td></tr><tr><td id="L7172" class="css-a4x74f"><span>7172</span></td><td id="LC7172" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumbFilename = thumbFilename;
</code></td></tr><tr><td id="L7173" class="css-a4x74f"><span>7173</span></td><td id="LC7173" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Loading image: <span class="code-subst">${thumbUrl}</span>`</span>);
</code></td></tr><tr><td id="L7174" class="css-a4x74f"><span>7174</span></td><td id="LC7174" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7175" class="css-a4x74f"><span>7175</span></td><td id="LC7175" class="css-1dcdqdg"><code>          <span class="code-comment">// For some reason, passing the named function directly causes it to execute immediately. So I've wrapped it in an anonymous function...</span>
</code></td></tr><tr><td id="L7176" class="css-a4x74f"><span>7176</span></td><td id="LC7176" class="css-1dcdqdg"><code>          previewImage.onload = <span class="code-function"><span class="code-params">()</span> =&gt;</span> <span class="code-keyword">this</span>.showImage(previewImage, frame, qualityIndex, thumbNum, thumbFilename, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7177" class="css-a4x74f"><span>7177</span></td><td id="LC7177" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.loadingImage = previewImage;
</code></td></tr><tr><td id="L7178" class="css-a4x74f"><span>7178</span></td><td id="LC7178" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.removeOldImages(previewImage);
</code></td></tr><tr><td id="L7179" class="css-a4x74f"><span>7179</span></td><td id="LC7179" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7180" class="css-a4x74f"><span>7180</span></td><td id="LC7180" class="css-1dcdqdg"><code>          <span class="code-comment">// Update the existing image</span>
</code></td></tr><tr><td id="L7181" class="css-a4x74f"><span>7181</span></td><td id="LC7181" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showImage(<span class="code-keyword">this</span>.currentImageElement, frame, qualityIndex, thumbNum, thumbFilename, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L7182" class="css-a4x74f"><span>7182</span></td><td id="LC7182" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.currentImageElement.dataset.index = thumbNum;
</code></td></tr><tr><td id="L7183" class="css-a4x74f"><span>7183</span></td><td id="LC7183" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.removeOldImages(<span class="code-keyword">this</span>.currentImageElement);
</code></td></tr><tr><td id="L7184" class="css-a4x74f"><span>7184</span></td><td id="LC7184" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7185" class="css-a4x74f"><span>7185</span></td><td id="LC7185" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7186" class="css-a4x74f"><span>7186</span></td><td id="LC7186" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"showImage"</span>, (previewImage, frame, qualityIndex, thumbNum, thumbFilename, newImage = <span class="code-literal">true</span>) =&gt; {
</code></td></tr><tr><td id="L7187" class="css-a4x74f"><span>7187</span></td><td id="LC7187" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Showing thumb: <span class="code-subst">${thumbFilename}</span>. num: <span class="code-subst">${thumbNum}</span>. qual: <span class="code-subst">${qualityIndex}</span>. newimg: <span class="code-subst">${newImage}</span>`</span>);
</code></td></tr><tr><td id="L7188" class="css-a4x74f"><span>7188</span></td><td id="LC7188" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.setImageSizeAndOffset(previewImage, frame);
</code></td></tr><tr><td id="L7189" class="css-a4x74f"><span>7189</span></td><td id="LC7189" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (newImage) {
</code></td></tr><tr><td id="L7190" class="css-a4x74f"><span>7190</span></td><td id="LC7190" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.currentImageContainer.appendChild(previewImage);
</code></td></tr><tr><td id="L7191" class="css-a4x74f"><span>7191</span></td><td id="LC7191" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.currentImageElement = previewImage;
</code></td></tr><tr><td id="L7192" class="css-a4x74f"><span>7192</span></td><td id="LC7192" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.loadedImages.includes(thumbFilename)) {
</code></td></tr><tr><td id="L7193" class="css-a4x74f"><span>7193</span></td><td id="LC7193" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.loadedImages.push(thumbFilename);
</code></td></tr><tr><td id="L7194" class="css-a4x74f"><span>7194</span></td><td id="LC7194" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7195" class="css-a4x74f"><span>7195</span></td><td id="LC7195" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7196" class="css-a4x74f"><span>7196</span></td><td id="LC7196" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7197" class="css-a4x74f"><span>7197</span></td><td id="LC7197" class="css-1dcdqdg"><code>        <span class="code-comment">// Preload images before and after the current one</span>
</code></td></tr><tr><td id="L7198" class="css-a4x74f"><span>7198</span></td><td id="LC7198" class="css-1dcdqdg"><code>        <span class="code-comment">// Show higher quality of the same frame</span>
</code></td></tr><tr><td id="L7199" class="css-a4x74f"><span>7199</span></td><td id="LC7199" class="css-1dcdqdg"><code>        <span class="code-comment">// Each step here has a short time delay, and only continues if still hovering/seeking the same spot. This is to protect slow connections from overloading</span>
</code></td></tr><tr><td id="L7200" class="css-a4x74f"><span>7200</span></td><td id="LC7200" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.preloadNearby(thumbNum, <span class="code-literal">true</span>).then(<span class="code-keyword">this</span>.preloadNearby(thumbNum, <span class="code-literal">false</span>)).then(<span class="code-keyword">this</span>.getHigherQuality(qualityIndex, previewImage, frame, thumbFilename));
</code></td></tr><tr><td id="L7201" class="css-a4x74f"><span>7201</span></td><td id="LC7201" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7202" class="css-a4x74f"><span>7202</span></td><td id="LC7202" class="css-1dcdqdg"><code>      <span class="code-comment">// Remove all preview images that aren't the designated current image</span>
</code></td></tr><tr><td id="L7203" class="css-a4x74f"><span>7203</span></td><td id="LC7203" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"removeOldImages"</span>, currentImage =&gt; {
</code></td></tr><tr><td id="L7204" class="css-a4x74f"><span>7204</span></td><td id="LC7204" class="css-1dcdqdg"><code>        <span class="code-comment">// Get a list of all images, convert it from a DOM list to an array</span>
</code></td></tr><tr><td id="L7205" class="css-a4x74f"><span>7205</span></td><td id="LC7205" class="css-1dcdqdg"><code>        <span class="code-built_in">Array</span>.from(<span class="code-keyword">this</span>.currentImageContainer.children).forEach(<span class="code-function"><span class="code-params">image</span> =&gt;</span> {
</code></td></tr><tr><td id="L7206" class="css-a4x74f"><span>7206</span></td><td id="LC7206" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (image.tagName.toLowerCase() !== <span class="code-string">'img'</span>) {
</code></td></tr><tr><td id="L7207" class="css-a4x74f"><span>7207</span></td><td id="LC7207" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7208" class="css-a4x74f"><span>7208</span></td><td id="LC7208" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7209" class="css-a4x74f"><span>7209</span></td><td id="LC7209" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> removeDelay = <span class="code-keyword">this</span>.usingSprites ? <span class="code-number">500</span> : <span class="code-number">1000</span>;
</code></td></tr><tr><td id="L7210" class="css-a4x74f"><span>7210</span></td><td id="LC7210" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (image.dataset.index !== currentImage.dataset.index &amp;&amp; !image.dataset.deleting) {
</code></td></tr><tr><td id="L7211" class="css-a4x74f"><span>7211</span></td><td id="LC7211" class="css-1dcdqdg"><code>            <span class="code-comment">// Wait 200ms, as the new image can take some time to show on certain browsers (even though it was downloaded before showing). This will prevent flicker, and show some generosity towards slower clients</span>
</code></td></tr><tr><td id="L7212" class="css-a4x74f"><span>7212</span></td><td id="LC7212" class="css-1dcdqdg"><code>            <span class="code-comment">// First set attribute 'deleting' to prevent multi-handling of this on repeat firing of this function</span>
</code></td></tr><tr><td id="L7213" class="css-a4x74f"><span>7213</span></td><td id="LC7213" class="css-1dcdqdg"><code>            <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L7214" class="css-a4x74f"><span>7214</span></td><td id="LC7214" class="css-1dcdqdg"><code>            image.dataset.deleting = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7215" class="css-a4x74f"><span>7215</span></td><td id="LC7215" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7216" class="css-a4x74f"><span>7216</span></td><td id="LC7216" class="css-1dcdqdg"><code>            <span class="code-comment">// This has to be set before the timeout - to prevent issues switching between hover and scrub</span>
</code></td></tr><tr><td id="L7217" class="css-a4x74f"><span>7217</span></td><td id="LC7217" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7218" class="css-a4x74f"><span>7218</span></td><td id="LC7218" class="css-1dcdqdg"><code>              currentImageContainer
</code></td></tr><tr><td id="L7219" class="css-a4x74f"><span>7219</span></td><td id="LC7219" class="css-1dcdqdg"><code>            } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L7220" class="css-a4x74f"><span>7220</span></td><td id="LC7220" class="css-1dcdqdg"><code>            setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7221" class="css-a4x74f"><span>7221</span></td><td id="LC7221" class="css-1dcdqdg"><code>              currentImageContainer.removeChild(image);
</code></td></tr><tr><td id="L7222" class="css-a4x74f"><span>7222</span></td><td id="LC7222" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Removing thumb: <span class="code-subst">${image.dataset.filename}</span>`</span>);
</code></td></tr><tr><td id="L7223" class="css-a4x74f"><span>7223</span></td><td id="LC7223" class="css-1dcdqdg"><code>            }, removeDelay);
</code></td></tr><tr><td id="L7224" class="css-a4x74f"><span>7224</span></td><td id="LC7224" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7225" class="css-a4x74f"><span>7225</span></td><td id="LC7225" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7226" class="css-a4x74f"><span>7226</span></td><td id="LC7226" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7227" class="css-a4x74f"><span>7227</span></td><td id="LC7227" class="css-1dcdqdg"><code>      <span class="code-comment">// Preload images before and after the current one. Only if the user is still hovering/seeking the same frame</span>
</code></td></tr><tr><td id="L7228" class="css-a4x74f"><span>7228</span></td><td id="LC7228" class="css-1dcdqdg"><code>      <span class="code-comment">// This will only preload the lowest quality</span>
</code></td></tr><tr><td id="L7229" class="css-a4x74f"><span>7229</span></td><td id="LC7229" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"preloadNearby"</span>, (thumbNum, forward = <span class="code-literal">true</span>) =&gt; {
</code></td></tr><tr><td id="L7230" class="css-a4x74f"><span>7230</span></td><td id="LC7230" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">new</span> <span class="code-built_in">Promise</span>(<span class="code-function"><span class="code-params">resolve</span> =&gt;</span> {
</code></td></tr><tr><td id="L7231" class="css-a4x74f"><span>7231</span></td><td id="LC7231" class="css-1dcdqdg"><code>          setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7232" class="css-a4x74f"><span>7232</span></td><td id="LC7232" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> oldThumbFilename = <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames[thumbNum].text;
</code></td></tr><tr><td id="L7233" class="css-a4x74f"><span>7233</span></td><td id="LC7233" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.showingThumbFilename === oldThumbFilename) {
</code></td></tr><tr><td id="L7234" class="css-a4x74f"><span>7234</span></td><td id="LC7234" class="css-1dcdqdg"><code>              <span class="code-comment">// Find the nearest thumbs with different filenames. Sometimes it'll be the next index, but in the case of sprites, it might be 100+ away</span>
</code></td></tr><tr><td id="L7235" class="css-a4x74f"><span>7235</span></td><td id="LC7235" class="css-1dcdqdg"><code>              <span class="code-keyword">let</span> thumbnailsClone;
</code></td></tr><tr><td id="L7236" class="css-a4x74f"><span>7236</span></td><td id="LC7236" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (forward) {
</code></td></tr><tr><td id="L7237" class="css-a4x74f"><span>7237</span></td><td id="LC7237" class="css-1dcdqdg"><code>                thumbnailsClone = <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames.slice(thumbNum);
</code></td></tr><tr><td id="L7238" class="css-a4x74f"><span>7238</span></td><td id="LC7238" class="css-1dcdqdg"><code>              } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7239" class="css-a4x74f"><span>7239</span></td><td id="LC7239" class="css-1dcdqdg"><code>                thumbnailsClone = <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames.slice(<span class="code-number">0</span>, thumbNum).reverse();
</code></td></tr><tr><td id="L7240" class="css-a4x74f"><span>7240</span></td><td id="LC7240" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7241" class="css-a4x74f"><span>7241</span></td><td id="LC7241" class="css-1dcdqdg"><code>              <span class="code-keyword">let</span> foundOne = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7242" class="css-a4x74f"><span>7242</span></td><td id="LC7242" class="css-1dcdqdg"><code>              thumbnailsClone.forEach(<span class="code-function"><span class="code-params">frame</span> =&gt;</span> {
</code></td></tr><tr><td id="L7243" class="css-a4x74f"><span>7243</span></td><td id="LC7243" class="css-1dcdqdg"><code>                <span class="code-keyword">const</span> newThumbFilename = frame.text;
</code></td></tr><tr><td id="L7244" class="css-a4x74f"><span>7244</span></td><td id="LC7244" class="css-1dcdqdg"><code>                <span class="code-keyword">if</span> (newThumbFilename !== oldThumbFilename) {
</code></td></tr><tr><td id="L7245" class="css-a4x74f"><span>7245</span></td><td id="LC7245" class="css-1dcdqdg"><code>                  <span class="code-comment">// Found one with a different filename. Make sure it hasn't already been loaded on this page visit</span>
</code></td></tr><tr><td id="L7246" class="css-a4x74f"><span>7246</span></td><td id="LC7246" class="css-1dcdqdg"><code>                  <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.loadedImages.includes(newThumbFilename)) {
</code></td></tr><tr><td id="L7247" class="css-a4x74f"><span>7247</span></td><td id="LC7247" class="css-1dcdqdg"><code>                    foundOne = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7248" class="css-a4x74f"><span>7248</span></td><td id="LC7248" class="css-1dcdqdg"><code>                    <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Preloading thumb filename: <span class="code-subst">${newThumbFilename}</span>`</span>);
</code></td></tr><tr><td id="L7249" class="css-a4x74f"><span>7249</span></td><td id="LC7249" class="css-1dcdqdg"><code>                    <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7250" class="css-a4x74f"><span>7250</span></td><td id="LC7250" class="css-1dcdqdg"><code>                      urlPrefix
</code></td></tr><tr><td id="L7251" class="css-a4x74f"><span>7251</span></td><td id="LC7251" class="css-1dcdqdg"><code>                    } = <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>];
</code></td></tr><tr><td id="L7252" class="css-a4x74f"><span>7252</span></td><td id="LC7252" class="css-1dcdqdg"><code>                    <span class="code-keyword">const</span> thumbURL = urlPrefix + newThumbFilename;
</code></td></tr><tr><td id="L7253" class="css-a4x74f"><span>7253</span></td><td id="LC7253" class="css-1dcdqdg"><code>                    <span class="code-keyword">const</span> previewImage = <span class="code-keyword">new</span> Image();
</code></td></tr><tr><td id="L7254" class="css-a4x74f"><span>7254</span></td><td id="LC7254" class="css-1dcdqdg"><code>                    previewImage.src = thumbURL;
</code></td></tr><tr><td id="L7255" class="css-a4x74f"><span>7255</span></td><td id="LC7255" class="css-1dcdqdg"><code>                    previewImage.onload = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7256" class="css-a4x74f"><span>7256</span></td><td id="LC7256" class="css-1dcdqdg"><code>                      <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Preloaded thumb filename: <span class="code-subst">${newThumbFilename}</span>`</span>);
</code></td></tr><tr><td id="L7257" class="css-a4x74f"><span>7257</span></td><td id="LC7257" class="css-1dcdqdg"><code>                      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.loadedImages.includes(newThumbFilename)) <span class="code-keyword">this</span>.loadedImages.push(newThumbFilename);
</code></td></tr><tr><td id="L7258" class="css-a4x74f"><span>7258</span></td><td id="LC7258" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7259" class="css-a4x74f"><span>7259</span></td><td id="LC7259" class="css-1dcdqdg"><code>                      <span class="code-comment">// We don't resolve until the thumb is loaded</span>
</code></td></tr><tr><td id="L7260" class="css-a4x74f"><span>7260</span></td><td id="LC7260" class="css-1dcdqdg"><code>                      resolve();
</code></td></tr><tr><td id="L7261" class="css-a4x74f"><span>7261</span></td><td id="LC7261" class="css-1dcdqdg"><code>                    };
</code></td></tr><tr><td id="L7262" class="css-a4x74f"><span>7262</span></td><td id="LC7262" class="css-1dcdqdg"><code>                  }
</code></td></tr><tr><td id="L7263" class="css-a4x74f"><span>7263</span></td><td id="LC7263" class="css-1dcdqdg"><code>                }
</code></td></tr><tr><td id="L7264" class="css-a4x74f"><span>7264</span></td><td id="LC7264" class="css-1dcdqdg"><code>              });
</code></td></tr><tr><td id="L7265" class="css-a4x74f"><span>7265</span></td><td id="LC7265" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7266" class="css-a4x74f"><span>7266</span></td><td id="LC7266" class="css-1dcdqdg"><code>              <span class="code-comment">// If there are none to preload then we want to resolve immediately</span>
</code></td></tr><tr><td id="L7267" class="css-a4x74f"><span>7267</span></td><td id="LC7267" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (!foundOne) {
</code></td></tr><tr><td id="L7268" class="css-a4x74f"><span>7268</span></td><td id="LC7268" class="css-1dcdqdg"><code>                resolve();
</code></td></tr><tr><td id="L7269" class="css-a4x74f"><span>7269</span></td><td id="LC7269" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7270" class="css-a4x74f"><span>7270</span></td><td id="LC7270" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7271" class="css-a4x74f"><span>7271</span></td><td id="LC7271" class="css-1dcdqdg"><code>          }, <span class="code-number">300</span>);
</code></td></tr><tr><td id="L7272" class="css-a4x74f"><span>7272</span></td><td id="LC7272" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7273" class="css-a4x74f"><span>7273</span></td><td id="LC7273" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7274" class="css-a4x74f"><span>7274</span></td><td id="LC7274" class="css-1dcdqdg"><code>      <span class="code-comment">// If user has been hovering current image for half a second, look for a higher quality one</span>
</code></td></tr><tr><td id="L7275" class="css-a4x74f"><span>7275</span></td><td id="LC7275" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"getHigherQuality"</span>, (currentQualityIndex, previewImage, frame, thumbFilename) =&gt; {
</code></td></tr><tr><td id="L7276" class="css-a4x74f"><span>7276</span></td><td id="LC7276" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (currentQualityIndex &lt; <span class="code-keyword">this</span>.thumbnails.length - <span class="code-number">1</span>) {
</code></td></tr><tr><td id="L7277" class="css-a4x74f"><span>7277</span></td><td id="LC7277" class="css-1dcdqdg"><code>          <span class="code-comment">// Only use the higher quality version if it's going to look any better - if the current thumb is of a lower pixel density than the thumbnail container</span>
</code></td></tr><tr><td id="L7278" class="css-a4x74f"><span>7278</span></td><td id="LC7278" class="css-1dcdqdg"><code>          <span class="code-keyword">let</span> previewImageHeight = previewImage.naturalHeight;
</code></td></tr><tr><td id="L7279" class="css-a4x74f"><span>7279</span></td><td id="LC7279" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.usingSprites) {
</code></td></tr><tr><td id="L7280" class="css-a4x74f"><span>7280</span></td><td id="LC7280" class="css-1dcdqdg"><code>            previewImageHeight = frame.h;
</code></td></tr><tr><td id="L7281" class="css-a4x74f"><span>7281</span></td><td id="LC7281" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7282" class="css-a4x74f"><span>7282</span></td><td id="LC7282" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (previewImageHeight &lt; <span class="code-keyword">this</span>.thumbContainerHeight) {
</code></td></tr><tr><td id="L7283" class="css-a4x74f"><span>7283</span></td><td id="LC7283" class="css-1dcdqdg"><code>            <span class="code-comment">// Recurse back to the loadImage function - show a higher quality one, but only if the viewer is on this frame for a while</span>
</code></td></tr><tr><td id="L7284" class="css-a4x74f"><span>7284</span></td><td id="LC7284" class="css-1dcdqdg"><code>            setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7285" class="css-a4x74f"><span>7285</span></td><td id="LC7285" class="css-1dcdqdg"><code>              <span class="code-comment">// Make sure the mouse hasn't already moved on and started hovering at another image</span>
</code></td></tr><tr><td id="L7286" class="css-a4x74f"><span>7286</span></td><td id="LC7286" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.showingThumbFilename === thumbFilename) {
</code></td></tr><tr><td id="L7287" class="css-a4x74f"><span>7287</span></td><td id="LC7287" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.player.debug.log(<span class="code-string">`Showing higher quality thumb for: <span class="code-subst">${thumbFilename}</span>`</span>);
</code></td></tr><tr><td id="L7288" class="css-a4x74f"><span>7288</span></td><td id="LC7288" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.loadImage(currentQualityIndex + <span class="code-number">1</span>);
</code></td></tr><tr><td id="L7289" class="css-a4x74f"><span>7289</span></td><td id="LC7289" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7290" class="css-a4x74f"><span>7290</span></td><td id="LC7290" class="css-1dcdqdg"><code>            }, <span class="code-number">300</span>);
</code></td></tr><tr><td id="L7291" class="css-a4x74f"><span>7291</span></td><td id="LC7291" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7292" class="css-a4x74f"><span>7292</span></td><td id="LC7292" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7293" class="css-a4x74f"><span>7293</span></td><td id="LC7293" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7294" class="css-a4x74f"><span>7294</span></td><td id="LC7294" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"toggleThumbContainer"</span>, (toggle = <span class="code-literal">false</span>, clearShowing = <span class="code-literal">false</span>) =&gt; {
</code></td></tr><tr><td id="L7295" class="css-a4x74f"><span>7295</span></td><td id="LC7295" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> className = <span class="code-keyword">this</span>.player.config.classNames.previewThumbnails.thumbContainerShown;
</code></td></tr><tr><td id="L7296" class="css-a4x74f"><span>7296</span></td><td id="LC7296" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.thumb.container.classList.toggle(className, toggle);
</code></td></tr><tr><td id="L7297" class="css-a4x74f"><span>7297</span></td><td id="LC7297" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!toggle &amp;&amp; clearShowing) {
</code></td></tr><tr><td id="L7298" class="css-a4x74f"><span>7298</span></td><td id="LC7298" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumb = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7299" class="css-a4x74f"><span>7299</span></td><td id="LC7299" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumbFilename = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7300" class="css-a4x74f"><span>7300</span></td><td id="LC7300" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7301" class="css-a4x74f"><span>7301</span></td><td id="LC7301" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7302" class="css-a4x74f"><span>7302</span></td><td id="LC7302" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"toggleScrubbingContainer"</span>, (toggle = <span class="code-literal">false</span>) =&gt; {
</code></td></tr><tr><td id="L7303" class="css-a4x74f"><span>7303</span></td><td id="LC7303" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> className = <span class="code-keyword">this</span>.player.config.classNames.previewThumbnails.scrubbingContainerShown;
</code></td></tr><tr><td id="L7304" class="css-a4x74f"><span>7304</span></td><td id="LC7304" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.scrubbing.container.classList.toggle(className, toggle);
</code></td></tr><tr><td id="L7305" class="css-a4x74f"><span>7305</span></td><td id="LC7305" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!toggle) {
</code></td></tr><tr><td id="L7306" class="css-a4x74f"><span>7306</span></td><td id="LC7306" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumb = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7307" class="css-a4x74f"><span>7307</span></td><td id="LC7307" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.showingThumbFilename = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7308" class="css-a4x74f"><span>7308</span></td><td id="LC7308" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7309" class="css-a4x74f"><span>7309</span></td><td id="LC7309" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7310" class="css-a4x74f"><span>7310</span></td><td id="LC7310" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"determineContainerAutoSizing"</span>, () =&gt; {
</code></td></tr><tr><td id="L7311" class="css-a4x74f"><span>7311</span></td><td id="LC7311" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.elements.thumb.imageContainer.clientHeight &gt; <span class="code-number">20</span> || <span class="code-keyword">this</span>.elements.thumb.imageContainer.clientWidth &gt; <span class="code-number">20</span>) {
</code></td></tr><tr><td id="L7312" class="css-a4x74f"><span>7312</span></td><td id="LC7312" class="css-1dcdqdg"><code>          <span class="code-comment">// This will prevent auto sizing in this.setThumbContainerSizeAndPos()</span>
</code></td></tr><tr><td id="L7313" class="css-a4x74f"><span>7313</span></td><td id="LC7313" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.sizeSpecifiedInCSS = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7314" class="css-a4x74f"><span>7314</span></td><td id="LC7314" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7315" class="css-a4x74f"><span>7315</span></td><td id="LC7315" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7316" class="css-a4x74f"><span>7316</span></td><td id="LC7316" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the size to be about a quarter of the size of video. Unless option dynamicSize === false, in which case it needs to be set in CSS</span>
</code></td></tr><tr><td id="L7317" class="css-a4x74f"><span>7317</span></td><td id="LC7317" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"setThumbContainerSizeAndPos"</span>, () =&gt; {
</code></td></tr><tr><td id="L7318" class="css-a4x74f"><span>7318</span></td><td id="LC7318" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7319" class="css-a4x74f"><span>7319</span></td><td id="LC7319" class="css-1dcdqdg"><code>          imageContainer
</code></td></tr><tr><td id="L7320" class="css-a4x74f"><span>7320</span></td><td id="LC7320" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.elements.thumb;
</code></td></tr><tr><td id="L7321" class="css-a4x74f"><span>7321</span></td><td id="LC7321" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.sizeSpecifiedInCSS) {
</code></td></tr><tr><td id="L7322" class="css-a4x74f"><span>7322</span></td><td id="LC7322" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> thumbWidth = <span class="code-built_in">Math</span>.floor(<span class="code-keyword">this</span>.thumbContainerHeight * <span class="code-keyword">this</span>.thumbAspectRatio);
</code></td></tr><tr><td id="L7323" class="css-a4x74f"><span>7323</span></td><td id="LC7323" class="css-1dcdqdg"><code>          imageContainer.style.height = <span class="code-string">`<span class="code-subst">${<span class="code-keyword">this</span>.thumbContainerHeight}</span>px`</span>;
</code></td></tr><tr><td id="L7324" class="css-a4x74f"><span>7324</span></td><td id="LC7324" class="css-1dcdqdg"><code>          imageContainer.style.width = <span class="code-string">`<span class="code-subst">${thumbWidth}</span>px`</span>;
</code></td></tr><tr><td id="L7325" class="css-a4x74f"><span>7325</span></td><td id="LC7325" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (imageContainer.clientHeight &gt; <span class="code-number">20</span> &amp;&amp; imageContainer.clientWidth &lt; <span class="code-number">20</span>) {
</code></td></tr><tr><td id="L7326" class="css-a4x74f"><span>7326</span></td><td id="LC7326" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> thumbWidth = <span class="code-built_in">Math</span>.floor(imageContainer.clientHeight * <span class="code-keyword">this</span>.thumbAspectRatio);
</code></td></tr><tr><td id="L7327" class="css-a4x74f"><span>7327</span></td><td id="LC7327" class="css-1dcdqdg"><code>          imageContainer.style.width = <span class="code-string">`<span class="code-subst">${thumbWidth}</span>px`</span>;
</code></td></tr><tr><td id="L7328" class="css-a4x74f"><span>7328</span></td><td id="LC7328" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (imageContainer.clientHeight &lt; <span class="code-number">20</span> &amp;&amp; imageContainer.clientWidth &gt; <span class="code-number">20</span>) {
</code></td></tr><tr><td id="L7329" class="css-a4x74f"><span>7329</span></td><td id="LC7329" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> thumbHeight = <span class="code-built_in">Math</span>.floor(imageContainer.clientWidth / <span class="code-keyword">this</span>.thumbAspectRatio);
</code></td></tr><tr><td id="L7330" class="css-a4x74f"><span>7330</span></td><td id="LC7330" class="css-1dcdqdg"><code>          imageContainer.style.height = <span class="code-string">`<span class="code-subst">${thumbHeight}</span>px`</span>;
</code></td></tr><tr><td id="L7331" class="css-a4x74f"><span>7331</span></td><td id="LC7331" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7332" class="css-a4x74f"><span>7332</span></td><td id="LC7332" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.setThumbContainerPos();
</code></td></tr><tr><td id="L7333" class="css-a4x74f"><span>7333</span></td><td id="LC7333" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7334" class="css-a4x74f"><span>7334</span></td><td id="LC7334" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"setThumbContainerPos"</span>, () =&gt; {
</code></td></tr><tr><td id="L7335" class="css-a4x74f"><span>7335</span></td><td id="LC7335" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> scrubberRect = <span class="code-keyword">this</span>.player.elements.progress.getBoundingClientRect();
</code></td></tr><tr><td id="L7336" class="css-a4x74f"><span>7336</span></td><td id="LC7336" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> containerRect = <span class="code-keyword">this</span>.player.elements.container.getBoundingClientRect();
</code></td></tr><tr><td id="L7337" class="css-a4x74f"><span>7337</span></td><td id="LC7337" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7338" class="css-a4x74f"><span>7338</span></td><td id="LC7338" class="css-1dcdqdg"><code>          container
</code></td></tr><tr><td id="L7339" class="css-a4x74f"><span>7339</span></td><td id="LC7339" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.elements.thumb;
</code></td></tr><tr><td id="L7340" class="css-a4x74f"><span>7340</span></td><td id="LC7340" class="css-1dcdqdg"><code>        <span class="code-comment">// Find the lowest and highest desired left-position, so we don't slide out the side of the video container</span>
</code></td></tr><tr><td id="L7341" class="css-a4x74f"><span>7341</span></td><td id="LC7341" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> min = containerRect.left - scrubberRect.left + <span class="code-number">10</span>;
</code></td></tr><tr><td id="L7342" class="css-a4x74f"><span>7342</span></td><td id="LC7342" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> max = containerRect.right - scrubberRect.left - container.clientWidth - <span class="code-number">10</span>;
</code></td></tr><tr><td id="L7343" class="css-a4x74f"><span>7343</span></td><td id="LC7343" class="css-1dcdqdg"><code>        <span class="code-comment">// Set preview container position to: mousepos, minus seekbar.left, minus half of previewContainer.clientWidth</span>
</code></td></tr><tr><td id="L7344" class="css-a4x74f"><span>7344</span></td><td id="LC7344" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> position = <span class="code-keyword">this</span>.mousePosX - scrubberRect.left - container.clientWidth / <span class="code-number">2</span>;
</code></td></tr><tr><td id="L7345" class="css-a4x74f"><span>7345</span></td><td id="LC7345" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> clamped = clamp(position, min, max);
</code></td></tr><tr><td id="L7346" class="css-a4x74f"><span>7346</span></td><td id="LC7346" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7347" class="css-a4x74f"><span>7347</span></td><td id="LC7347" class="css-1dcdqdg"><code>        <span class="code-comment">// Move the popover position</span>
</code></td></tr><tr><td id="L7348" class="css-a4x74f"><span>7348</span></td><td id="LC7348" class="css-1dcdqdg"><code>        container.style.left = <span class="code-string">`<span class="code-subst">${clamped}</span>px`</span>;
</code></td></tr><tr><td id="L7349" class="css-a4x74f"><span>7349</span></td><td id="LC7349" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7350" class="css-a4x74f"><span>7350</span></td><td id="LC7350" class="css-1dcdqdg"><code>        <span class="code-comment">// The arrow can follow the cursor</span>
</code></td></tr><tr><td id="L7351" class="css-a4x74f"><span>7351</span></td><td id="LC7351" class="css-1dcdqdg"><code>        container.style.setProperty(<span class="code-string">'--preview-arrow-offset'</span>, <span class="code-string">`<span class="code-subst">${position - clamped}</span>px`</span>);
</code></td></tr><tr><td id="L7352" class="css-a4x74f"><span>7352</span></td><td id="LC7352" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7353" class="css-a4x74f"><span>7353</span></td><td id="LC7353" class="css-1dcdqdg"><code>      <span class="code-comment">// Can't use 100% width, in case the video is a different aspect ratio to the video container</span>
</code></td></tr><tr><td id="L7354" class="css-a4x74f"><span>7354</span></td><td id="LC7354" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"setScrubbingContainerSize"</span>, () =&gt; {
</code></td></tr><tr><td id="L7355" class="css-a4x74f"><span>7355</span></td><td id="LC7355" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7356" class="css-a4x74f"><span>7356</span></td><td id="LC7356" class="css-1dcdqdg"><code>          width,
</code></td></tr><tr><td id="L7357" class="css-a4x74f"><span>7357</span></td><td id="LC7357" class="css-1dcdqdg"><code>          height
</code></td></tr><tr><td id="L7358" class="css-a4x74f"><span>7358</span></td><td id="LC7358" class="css-1dcdqdg"><code>        } = fitRatio(<span class="code-keyword">this</span>.thumbAspectRatio, {
</code></td></tr><tr><td id="L7359" class="css-a4x74f"><span>7359</span></td><td id="LC7359" class="css-1dcdqdg"><code>          width: <span class="code-keyword">this</span>.player.media.clientWidth,
</code></td></tr><tr><td id="L7360" class="css-a4x74f"><span>7360</span></td><td id="LC7360" class="css-1dcdqdg"><code>          height: <span class="code-keyword">this</span>.player.media.clientHeight
</code></td></tr><tr><td id="L7361" class="css-a4x74f"><span>7361</span></td><td id="LC7361" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7362" class="css-a4x74f"><span>7362</span></td><td id="LC7362" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.scrubbing.container.style.width = <span class="code-string">`<span class="code-subst">${width}</span>px`</span>;
</code></td></tr><tr><td id="L7363" class="css-a4x74f"><span>7363</span></td><td id="LC7363" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.scrubbing.container.style.height = <span class="code-string">`<span class="code-subst">${height}</span>px`</span>;
</code></td></tr><tr><td id="L7364" class="css-a4x74f"><span>7364</span></td><td id="LC7364" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7365" class="css-a4x74f"><span>7365</span></td><td id="LC7365" class="css-1dcdqdg"><code>      <span class="code-comment">// Sprites need to be offset to the correct location</span>
</code></td></tr><tr><td id="L7366" class="css-a4x74f"><span>7366</span></td><td id="LC7366" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"setImageSizeAndOffset"</span>, (previewImage, frame) =&gt; {
</code></td></tr><tr><td id="L7367" class="css-a4x74f"><span>7367</span></td><td id="LC7367" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.usingSprites) <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7368" class="css-a4x74f"><span>7368</span></td><td id="LC7368" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7369" class="css-a4x74f"><span>7369</span></td><td id="LC7369" class="css-1dcdqdg"><code>        <span class="code-comment">// Find difference between height and preview container height</span>
</code></td></tr><tr><td id="L7370" class="css-a4x74f"><span>7370</span></td><td id="LC7370" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> multiplier = <span class="code-keyword">this</span>.thumbContainerHeight / frame.h;
</code></td></tr><tr><td id="L7371" class="css-a4x74f"><span>7371</span></td><td id="LC7371" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7372" class="css-a4x74f"><span>7372</span></td><td id="LC7372" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L7373" class="css-a4x74f"><span>7373</span></td><td id="LC7373" class="css-1dcdqdg"><code>        previewImage.style.height = <span class="code-string">`<span class="code-subst">${previewImage.naturalHeight * multiplier}</span>px`</span>;
</code></td></tr><tr><td id="L7374" class="css-a4x74f"><span>7374</span></td><td id="LC7374" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L7375" class="css-a4x74f"><span>7375</span></td><td id="LC7375" class="css-1dcdqdg"><code>        previewImage.style.width = <span class="code-string">`<span class="code-subst">${previewImage.naturalWidth * multiplier}</span>px`</span>;
</code></td></tr><tr><td id="L7376" class="css-a4x74f"><span>7376</span></td><td id="LC7376" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L7377" class="css-a4x74f"><span>7377</span></td><td id="LC7377" class="css-1dcdqdg"><code>        previewImage.style.left = <span class="code-string">`-<span class="code-subst">${frame.x * multiplier}</span>px`</span>;
</code></td></tr><tr><td id="L7378" class="css-a4x74f"><span>7378</span></td><td id="LC7378" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line no-param-reassign</span>
</code></td></tr><tr><td id="L7379" class="css-a4x74f"><span>7379</span></td><td id="LC7379" class="css-1dcdqdg"><code>        previewImage.style.top = <span class="code-string">`-<span class="code-subst">${frame.y * multiplier}</span>px`</span>;
</code></td></tr><tr><td id="L7380" class="css-a4x74f"><span>7380</span></td><td id="LC7380" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7381" class="css-a4x74f"><span>7381</span></td><td id="LC7381" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.player = player;
</code></td></tr><tr><td id="L7382" class="css-a4x74f"><span>7382</span></td><td id="LC7382" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.thumbnails = [];
</code></td></tr><tr><td id="L7383" class="css-a4x74f"><span>7383</span></td><td id="LC7383" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loaded = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7384" class="css-a4x74f"><span>7384</span></td><td id="LC7384" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.lastMouseMoveTime = <span class="code-built_in">Date</span>.now();
</code></td></tr><tr><td id="L7385" class="css-a4x74f"><span>7385</span></td><td id="LC7385" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.mouseDown = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7386" class="css-a4x74f"><span>7386</span></td><td id="LC7386" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loadedImages = [];
</code></td></tr><tr><td id="L7387" class="css-a4x74f"><span>7387</span></td><td id="LC7387" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements = {
</code></td></tr><tr><td id="L7388" class="css-a4x74f"><span>7388</span></td><td id="LC7388" class="css-1dcdqdg"><code>        thumb: {},
</code></td></tr><tr><td id="L7389" class="css-a4x74f"><span>7389</span></td><td id="LC7389" class="css-1dcdqdg"><code>        scrubbing: {}
</code></td></tr><tr><td id="L7390" class="css-a4x74f"><span>7390</span></td><td id="LC7390" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L7391" class="css-a4x74f"><span>7391</span></td><td id="LC7391" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.load();
</code></td></tr><tr><td id="L7392" class="css-a4x74f"><span>7392</span></td><td id="LC7392" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7393" class="css-a4x74f"><span>7393</span></td><td id="LC7393" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> enabled() {
</code></td></tr><tr><td id="L7394" class="css-a4x74f"><span>7394</span></td><td id="LC7394" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.player.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.player.isVideo &amp;&amp; <span class="code-keyword">this</span>.player.config.previewThumbnails.enabled;
</code></td></tr><tr><td id="L7395" class="css-a4x74f"><span>7395</span></td><td id="LC7395" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7396" class="css-a4x74f"><span>7396</span></td><td id="LC7396" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> currentImageContainer() {
</code></td></tr><tr><td id="L7397" class="css-a4x74f"><span>7397</span></td><td id="LC7397" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.mouseDown ? <span class="code-keyword">this</span>.elements.scrubbing.container : <span class="code-keyword">this</span>.elements.thumb.imageContainer;
</code></td></tr><tr><td id="L7398" class="css-a4x74f"><span>7398</span></td><td id="LC7398" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7399" class="css-a4x74f"><span>7399</span></td><td id="LC7399" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> usingSprites() {
</code></td></tr><tr><td id="L7400" class="css-a4x74f"><span>7400</span></td><td id="LC7400" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Object</span>.keys(<span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames[<span class="code-number">0</span>]).includes(<span class="code-string">'w'</span>);
</code></td></tr><tr><td id="L7401" class="css-a4x74f"><span>7401</span></td><td id="LC7401" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7402" class="css-a4x74f"><span>7402</span></td><td id="LC7402" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> thumbAspectRatio() {
</code></td></tr><tr><td id="L7403" class="css-a4x74f"><span>7403</span></td><td id="LC7403" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.usingSprites) {
</code></td></tr><tr><td id="L7404" class="css-a4x74f"><span>7404</span></td><td id="LC7404" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames[<span class="code-number">0</span>].w / <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].frames[<span class="code-number">0</span>].h;
</code></td></tr><tr><td id="L7405" class="css-a4x74f"><span>7405</span></td><td id="LC7405" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7406" class="css-a4x74f"><span>7406</span></td><td id="LC7406" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].width / <span class="code-keyword">this</span>.thumbnails[<span class="code-number">0</span>].height;
</code></td></tr><tr><td id="L7407" class="css-a4x74f"><span>7407</span></td><td id="LC7407" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7408" class="css-a4x74f"><span>7408</span></td><td id="LC7408" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> thumbContainerHeight() {
</code></td></tr><tr><td id="L7409" class="css-a4x74f"><span>7409</span></td><td id="LC7409" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.mouseDown) {
</code></td></tr><tr><td id="L7410" class="css-a4x74f"><span>7410</span></td><td id="LC7410" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7411" class="css-a4x74f"><span>7411</span></td><td id="LC7411" class="css-1dcdqdg"><code>          height
</code></td></tr><tr><td id="L7412" class="css-a4x74f"><span>7412</span></td><td id="LC7412" class="css-1dcdqdg"><code>        } = fitRatio(<span class="code-keyword">this</span>.thumbAspectRatio, {
</code></td></tr><tr><td id="L7413" class="css-a4x74f"><span>7413</span></td><td id="LC7413" class="css-1dcdqdg"><code>          width: <span class="code-keyword">this</span>.player.media.clientWidth,
</code></td></tr><tr><td id="L7414" class="css-a4x74f"><span>7414</span></td><td id="LC7414" class="css-1dcdqdg"><code>          height: <span class="code-keyword">this</span>.player.media.clientHeight
</code></td></tr><tr><td id="L7415" class="css-a4x74f"><span>7415</span></td><td id="LC7415" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7416" class="css-a4x74f"><span>7416</span></td><td id="LC7416" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> height;
</code></td></tr><tr><td id="L7417" class="css-a4x74f"><span>7417</span></td><td id="LC7417" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7418" class="css-a4x74f"><span>7418</span></td><td id="LC7418" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7419" class="css-a4x74f"><span>7419</span></td><td id="LC7419" class="css-1dcdqdg"><code>      <span class="code-comment">// If css is used this needs to return the css height for sprites to work (see setImageSizeAndOffset)</span>
</code></td></tr><tr><td id="L7420" class="css-a4x74f"><span>7420</span></td><td id="LC7420" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.sizeSpecifiedInCSS) {
</code></td></tr><tr><td id="L7421" class="css-a4x74f"><span>7421</span></td><td id="LC7421" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.elements.thumb.imageContainer.clientHeight;
</code></td></tr><tr><td id="L7422" class="css-a4x74f"><span>7422</span></td><td id="LC7422" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7423" class="css-a4x74f"><span>7423</span></td><td id="LC7423" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Math</span>.floor(<span class="code-keyword">this</span>.player.media.clientWidth / <span class="code-keyword">this</span>.thumbAspectRatio / <span class="code-number">4</span>);
</code></td></tr><tr><td id="L7424" class="css-a4x74f"><span>7424</span></td><td id="LC7424" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7425" class="css-a4x74f"><span>7425</span></td><td id="LC7425" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> currentImageElement() {
</code></td></tr><tr><td id="L7426" class="css-a4x74f"><span>7426</span></td><td id="LC7426" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.mouseDown ? <span class="code-keyword">this</span>.currentScrubbingImageElement : <span class="code-keyword">this</span>.currentThumbnailImageElement;
</code></td></tr><tr><td id="L7427" class="css-a4x74f"><span>7427</span></td><td id="LC7427" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7428" class="css-a4x74f"><span>7428</span></td><td id="LC7428" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> currentImageElement(element) {
</code></td></tr><tr><td id="L7429" class="css-a4x74f"><span>7429</span></td><td id="LC7429" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.mouseDown) {
</code></td></tr><tr><td id="L7430" class="css-a4x74f"><span>7430</span></td><td id="LC7430" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.currentScrubbingImageElement = element;
</code></td></tr><tr><td id="L7431" class="css-a4x74f"><span>7431</span></td><td id="LC7431" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7432" class="css-a4x74f"><span>7432</span></td><td id="LC7432" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.currentThumbnailImageElement = element;
</code></td></tr><tr><td id="L7433" class="css-a4x74f"><span>7433</span></td><td id="LC7433" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7434" class="css-a4x74f"><span>7434</span></td><td id="LC7434" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7435" class="css-a4x74f"><span>7435</span></td><td id="LC7435" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L7436" class="css-a4x74f"><span>7436</span></td><td id="LC7436" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7437" class="css-a4x74f"><span>7437</span></td><td id="LC7437" class="css-1dcdqdg"><code>  <span class="code-comment">// ==========================================================================</span>
</code></td></tr><tr><td id="L7438" class="css-a4x74f"><span>7438</span></td><td id="LC7438" class="css-1dcdqdg"><code>  <span class="code-keyword">const</span> source = {
</code></td></tr><tr><td id="L7439" class="css-a4x74f"><span>7439</span></td><td id="LC7439" class="css-1dcdqdg"><code>    <span class="code-comment">// Add elements to HTML5 media (source, tracks, etc)</span>
</code></td></tr><tr><td id="L7440" class="css-a4x74f"><span>7440</span></td><td id="LC7440" class="css-1dcdqdg"><code>    insertElements(type, attributes) {
</code></td></tr><tr><td id="L7441" class="css-a4x74f"><span>7441</span></td><td id="LC7441" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(attributes)) {
</code></td></tr><tr><td id="L7442" class="css-a4x74f"><span>7442</span></td><td id="LC7442" class="css-1dcdqdg"><code>        insertElement(type, <span class="code-keyword">this</span>.media, {
</code></td></tr><tr><td id="L7443" class="css-a4x74f"><span>7443</span></td><td id="LC7443" class="css-1dcdqdg"><code>          src: attributes
</code></td></tr><tr><td id="L7444" class="css-a4x74f"><span>7444</span></td><td id="LC7444" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7445" class="css-a4x74f"><span>7445</span></td><td id="LC7445" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.array(attributes)) {
</code></td></tr><tr><td id="L7446" class="css-a4x74f"><span>7446</span></td><td id="LC7446" class="css-1dcdqdg"><code>        attributes.forEach(<span class="code-function"><span class="code-params">attribute</span> =&gt;</span> {
</code></td></tr><tr><td id="L7447" class="css-a4x74f"><span>7447</span></td><td id="LC7447" class="css-1dcdqdg"><code>          insertElement(type, <span class="code-keyword">this</span>.media, attribute);
</code></td></tr><tr><td id="L7448" class="css-a4x74f"><span>7448</span></td><td id="LC7448" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7449" class="css-a4x74f"><span>7449</span></td><td id="LC7449" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7450" class="css-a4x74f"><span>7450</span></td><td id="LC7450" class="css-1dcdqdg"><code>    },
</code></td></tr><tr><td id="L7451" class="css-a4x74f"><span>7451</span></td><td id="LC7451" class="css-1dcdqdg"><code>    <span class="code-comment">// Update source</span>
</code></td></tr><tr><td id="L7452" class="css-a4x74f"><span>7452</span></td><td id="LC7452" class="css-1dcdqdg"><code>    <span class="code-comment">// Sources are not checked for support so be careful</span>
</code></td></tr><tr><td id="L7453" class="css-a4x74f"><span>7453</span></td><td id="LC7453" class="css-1dcdqdg"><code>    change(input) {
</code></td></tr><tr><td id="L7454" class="css-a4x74f"><span>7454</span></td><td id="LC7454" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!getDeep(input, <span class="code-string">'sources.length'</span>)) {
</code></td></tr><tr><td id="L7455" class="css-a4x74f"><span>7455</span></td><td id="LC7455" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Invalid source format'</span>);
</code></td></tr><tr><td id="L7456" class="css-a4x74f"><span>7456</span></td><td id="LC7456" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7457" class="css-a4x74f"><span>7457</span></td><td id="LC7457" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7458" class="css-a4x74f"><span>7458</span></td><td id="LC7458" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7459" class="css-a4x74f"><span>7459</span></td><td id="LC7459" class="css-1dcdqdg"><code>      <span class="code-comment">// Cancel current network requests</span>
</code></td></tr><tr><td id="L7460" class="css-a4x74f"><span>7460</span></td><td id="LC7460" class="css-1dcdqdg"><code>      html5.cancelRequests.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7461" class="css-a4x74f"><span>7461</span></td><td id="LC7461" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7462" class="css-a4x74f"><span>7462</span></td><td id="LC7462" class="css-1dcdqdg"><code>      <span class="code-comment">// Destroy instance and re-setup</span>
</code></td></tr><tr><td id="L7463" class="css-a4x74f"><span>7463</span></td><td id="LC7463" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.destroy.call(<span class="code-keyword">this</span>, () =&gt; {
</code></td></tr><tr><td id="L7464" class="css-a4x74f"><span>7464</span></td><td id="LC7464" class="css-1dcdqdg"><code>        <span class="code-comment">// Reset quality options</span>
</code></td></tr><tr><td id="L7465" class="css-a4x74f"><span>7465</span></td><td id="LC7465" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.options.quality = [];
</code></td></tr><tr><td id="L7466" class="css-a4x74f"><span>7466</span></td><td id="LC7466" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7467" class="css-a4x74f"><span>7467</span></td><td id="LC7467" class="css-1dcdqdg"><code>        <span class="code-comment">// Remove elements</span>
</code></td></tr><tr><td id="L7468" class="css-a4x74f"><span>7468</span></td><td id="LC7468" class="css-1dcdqdg"><code>        removeElement(<span class="code-keyword">this</span>.media);
</code></td></tr><tr><td id="L7469" class="css-a4x74f"><span>7469</span></td><td id="LC7469" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7470" class="css-a4x74f"><span>7470</span></td><td id="LC7470" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7471" class="css-a4x74f"><span>7471</span></td><td id="LC7471" class="css-1dcdqdg"><code>        <span class="code-comment">// Reset class name</span>
</code></td></tr><tr><td id="L7472" class="css-a4x74f"><span>7472</span></td><td id="LC7472" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.element(<span class="code-keyword">this</span>.elements.container)) {
</code></td></tr><tr><td id="L7473" class="css-a4x74f"><span>7473</span></td><td id="LC7473" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.elements.container.removeAttribute(<span class="code-string">'class'</span>);
</code></td></tr><tr><td id="L7474" class="css-a4x74f"><span>7474</span></td><td id="LC7474" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7475" class="css-a4x74f"><span>7475</span></td><td id="LC7475" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7476" class="css-a4x74f"><span>7476</span></td><td id="LC7476" class="css-1dcdqdg"><code>        <span class="code-comment">// Set the type and provider</span>
</code></td></tr><tr><td id="L7477" class="css-a4x74f"><span>7477</span></td><td id="LC7477" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L7478" class="css-a4x74f"><span>7478</span></td><td id="LC7478" class="css-1dcdqdg"><code>          sources,
</code></td></tr><tr><td id="L7479" class="css-a4x74f"><span>7479</span></td><td id="LC7479" class="css-1dcdqdg"><code>          type
</code></td></tr><tr><td id="L7480" class="css-a4x74f"><span>7480</span></td><td id="LC7480" class="css-1dcdqdg"><code>        } = input;
</code></td></tr><tr><td id="L7481" class="css-a4x74f"><span>7481</span></td><td id="LC7481" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> [{
</code></td></tr><tr><td id="L7482" class="css-a4x74f"><span>7482</span></td><td id="LC7482" class="css-1dcdqdg"><code>          provider = providers.html5,
</code></td></tr><tr><td id="L7483" class="css-a4x74f"><span>7483</span></td><td id="LC7483" class="css-1dcdqdg"><code>          src
</code></td></tr><tr><td id="L7484" class="css-a4x74f"><span>7484</span></td><td id="LC7484" class="css-1dcdqdg"><code>        }] = sources;
</code></td></tr><tr><td id="L7485" class="css-a4x74f"><span>7485</span></td><td id="LC7485" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> tagName = provider === <span class="code-string">'html5'</span> ? type : <span class="code-string">'div'</span>;
</code></td></tr><tr><td id="L7486" class="css-a4x74f"><span>7486</span></td><td id="LC7486" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> attributes = provider === <span class="code-string">'html5'</span> ? {} : {
</code></td></tr><tr><td id="L7487" class="css-a4x74f"><span>7487</span></td><td id="LC7487" class="css-1dcdqdg"><code>          src
</code></td></tr><tr><td id="L7488" class="css-a4x74f"><span>7488</span></td><td id="LC7488" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L7489" class="css-a4x74f"><span>7489</span></td><td id="LC7489" class="css-1dcdqdg"><code>        <span class="code-built_in">Object</span>.assign(<span class="code-keyword">this</span>, {
</code></td></tr><tr><td id="L7490" class="css-a4x74f"><span>7490</span></td><td id="LC7490" class="css-1dcdqdg"><code>          provider,
</code></td></tr><tr><td id="L7491" class="css-a4x74f"><span>7491</span></td><td id="LC7491" class="css-1dcdqdg"><code>          type,
</code></td></tr><tr><td id="L7492" class="css-a4x74f"><span>7492</span></td><td id="LC7492" class="css-1dcdqdg"><code>          <span class="code-comment">// Check for support</span>
</code></td></tr><tr><td id="L7493" class="css-a4x74f"><span>7493</span></td><td id="LC7493" class="css-1dcdqdg"><code>          supported: support.check(type, provider, <span class="code-keyword">this</span>.config.playsinline),
</code></td></tr><tr><td id="L7494" class="css-a4x74f"><span>7494</span></td><td id="LC7494" class="css-1dcdqdg"><code>          <span class="code-comment">// Create new element</span>
</code></td></tr><tr><td id="L7495" class="css-a4x74f"><span>7495</span></td><td id="LC7495" class="css-1dcdqdg"><code>          media: createElement(tagName, attributes)
</code></td></tr><tr><td id="L7496" class="css-a4x74f"><span>7496</span></td><td id="LC7496" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L7497" class="css-a4x74f"><span>7497</span></td><td id="LC7497" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7498" class="css-a4x74f"><span>7498</span></td><td id="LC7498" class="css-1dcdqdg"><code>        <span class="code-comment">// Inject the new element</span>
</code></td></tr><tr><td id="L7499" class="css-a4x74f"><span>7499</span></td><td id="LC7499" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container.appendChild(<span class="code-keyword">this</span>.media);
</code></td></tr><tr><td id="L7500" class="css-a4x74f"><span>7500</span></td><td id="LC7500" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7501" class="css-a4x74f"><span>7501</span></td><td id="LC7501" class="css-1dcdqdg"><code>        <span class="code-comment">// Autoplay the new source?</span>
</code></td></tr><tr><td id="L7502" class="css-a4x74f"><span>7502</span></td><td id="LC7502" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (is.boolean(input.autoplay)) {
</code></td></tr><tr><td id="L7503" class="css-a4x74f"><span>7503</span></td><td id="LC7503" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.config.autoplay = input.autoplay;
</code></td></tr><tr><td id="L7504" class="css-a4x74f"><span>7504</span></td><td id="LC7504" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7505" class="css-a4x74f"><span>7505</span></td><td id="LC7505" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7506" class="css-a4x74f"><span>7506</span></td><td id="LC7506" class="css-1dcdqdg"><code>        <span class="code-comment">// Set attributes for audio and video</span>
</code></td></tr><tr><td id="L7507" class="css-a4x74f"><span>7507</span></td><td id="LC7507" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7508" class="css-a4x74f"><span>7508</span></td><td id="LC7508" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.crossorigin) {
</code></td></tr><tr><td id="L7509" class="css-a4x74f"><span>7509</span></td><td id="LC7509" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'crossorigin'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L7510" class="css-a4x74f"><span>7510</span></td><td id="LC7510" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7511" class="css-a4x74f"><span>7511</span></td><td id="LC7511" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.autoplay) {
</code></td></tr><tr><td id="L7512" class="css-a4x74f"><span>7512</span></td><td id="LC7512" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'autoplay'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L7513" class="css-a4x74f"><span>7513</span></td><td id="LC7513" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7514" class="css-a4x74f"><span>7514</span></td><td id="LC7514" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (!is.empty(input.poster)) {
</code></td></tr><tr><td id="L7515" class="css-a4x74f"><span>7515</span></td><td id="LC7515" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.poster = input.poster;
</code></td></tr><tr><td id="L7516" class="css-a4x74f"><span>7516</span></td><td id="LC7516" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7517" class="css-a4x74f"><span>7517</span></td><td id="LC7517" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.loop.active) {
</code></td></tr><tr><td id="L7518" class="css-a4x74f"><span>7518</span></td><td id="LC7518" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'loop'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L7519" class="css-a4x74f"><span>7519</span></td><td id="LC7519" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7520" class="css-a4x74f"><span>7520</span></td><td id="LC7520" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.muted) {
</code></td></tr><tr><td id="L7521" class="css-a4x74f"><span>7521</span></td><td id="LC7521" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'muted'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L7522" class="css-a4x74f"><span>7522</span></td><td id="LC7522" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7523" class="css-a4x74f"><span>7523</span></td><td id="LC7523" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.playsinline) {
</code></td></tr><tr><td id="L7524" class="css-a4x74f"><span>7524</span></td><td id="LC7524" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.setAttribute(<span class="code-string">'playsinline'</span>, <span class="code-string">''</span>);
</code></td></tr><tr><td id="L7525" class="css-a4x74f"><span>7525</span></td><td id="LC7525" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7526" class="css-a4x74f"><span>7526</span></td><td id="LC7526" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7527" class="css-a4x74f"><span>7527</span></td><td id="LC7527" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7528" class="css-a4x74f"><span>7528</span></td><td id="LC7528" class="css-1dcdqdg"><code>        <span class="code-comment">// Restore class hook</span>
</code></td></tr><tr><td id="L7529" class="css-a4x74f"><span>7529</span></td><td id="LC7529" class="css-1dcdqdg"><code>        ui.addStyleHook.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7530" class="css-a4x74f"><span>7530</span></td><td id="LC7530" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7531" class="css-a4x74f"><span>7531</span></td><td id="LC7531" class="css-1dcdqdg"><code>        <span class="code-comment">// Set new sources for html5</span>
</code></td></tr><tr><td id="L7532" class="css-a4x74f"><span>7532</span></td><td id="LC7532" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7533" class="css-a4x74f"><span>7533</span></td><td id="LC7533" class="css-1dcdqdg"><code>          source.insertElements.call(<span class="code-keyword">this</span>, <span class="code-string">'source'</span>, sources);
</code></td></tr><tr><td id="L7534" class="css-a4x74f"><span>7534</span></td><td id="LC7534" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7535" class="css-a4x74f"><span>7535</span></td><td id="LC7535" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7536" class="css-a4x74f"><span>7536</span></td><td id="LC7536" class="css-1dcdqdg"><code>        <span class="code-comment">// Set video title</span>
</code></td></tr><tr><td id="L7537" class="css-a4x74f"><span>7537</span></td><td id="LC7537" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.config.title = input.title;
</code></td></tr><tr><td id="L7538" class="css-a4x74f"><span>7538</span></td><td id="LC7538" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7539" class="css-a4x74f"><span>7539</span></td><td id="LC7539" class="css-1dcdqdg"><code>        <span class="code-comment">// Set up from scratch</span>
</code></td></tr><tr><td id="L7540" class="css-a4x74f"><span>7540</span></td><td id="LC7540" class="css-1dcdqdg"><code>        media.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7541" class="css-a4x74f"><span>7541</span></td><td id="LC7541" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7542" class="css-a4x74f"><span>7542</span></td><td id="LC7542" class="css-1dcdqdg"><code>        <span class="code-comment">// HTML5 stuff</span>
</code></td></tr><tr><td id="L7543" class="css-a4x74f"><span>7543</span></td><td id="LC7543" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7544" class="css-a4x74f"><span>7544</span></td><td id="LC7544" class="css-1dcdqdg"><code>          <span class="code-comment">// Setup captions</span>
</code></td></tr><tr><td id="L7545" class="css-a4x74f"><span>7545</span></td><td id="LC7545" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(input).includes(<span class="code-string">'tracks'</span>)) {
</code></td></tr><tr><td id="L7546" class="css-a4x74f"><span>7546</span></td><td id="LC7546" class="css-1dcdqdg"><code>            source.insertElements.call(<span class="code-keyword">this</span>, <span class="code-string">'track'</span>, input.tracks);
</code></td></tr><tr><td id="L7547" class="css-a4x74f"><span>7547</span></td><td id="LC7547" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7548" class="css-a4x74f"><span>7548</span></td><td id="LC7548" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7549" class="css-a4x74f"><span>7549</span></td><td id="LC7549" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7550" class="css-a4x74f"><span>7550</span></td><td id="LC7550" class="css-1dcdqdg"><code>        <span class="code-comment">// If HTML5 or embed but not fully supported, setupInterface and call ready now</span>
</code></td></tr><tr><td id="L7551" class="css-a4x74f"><span>7551</span></td><td id="LC7551" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5 || <span class="code-keyword">this</span>.isEmbed &amp;&amp; !<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L7552" class="css-a4x74f"><span>7552</span></td><td id="LC7552" class="css-1dcdqdg"><code>          <span class="code-comment">// Setup interface</span>
</code></td></tr><tr><td id="L7553" class="css-a4x74f"><span>7553</span></td><td id="LC7553" class="css-1dcdqdg"><code>          ui.build.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7554" class="css-a4x74f"><span>7554</span></td><td id="LC7554" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7555" class="css-a4x74f"><span>7555</span></td><td id="LC7555" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7556" class="css-a4x74f"><span>7556</span></td><td id="LC7556" class="css-1dcdqdg"><code>        <span class="code-comment">// Load HTML5 sources</span>
</code></td></tr><tr><td id="L7557" class="css-a4x74f"><span>7557</span></td><td id="LC7557" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7558" class="css-a4x74f"><span>7558</span></td><td id="LC7558" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.media.load();
</code></td></tr><tr><td id="L7559" class="css-a4x74f"><span>7559</span></td><td id="LC7559" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7560" class="css-a4x74f"><span>7560</span></td><td id="LC7560" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7561" class="css-a4x74f"><span>7561</span></td><td id="LC7561" class="css-1dcdqdg"><code>        <span class="code-comment">// Update previewThumbnails config &amp; reload plugin</span>
</code></td></tr><tr><td id="L7562" class="css-a4x74f"><span>7562</span></td><td id="LC7562" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.empty(input.previewThumbnails)) {
</code></td></tr><tr><td id="L7563" class="css-a4x74f"><span>7563</span></td><td id="LC7563" class="css-1dcdqdg"><code>          <span class="code-built_in">Object</span>.assign(<span class="code-keyword">this</span>.config.previewThumbnails, input.previewThumbnails);
</code></td></tr><tr><td id="L7564" class="css-a4x74f"><span>7564</span></td><td id="LC7564" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7565" class="css-a4x74f"><span>7565</span></td><td id="LC7565" class="css-1dcdqdg"><code>          <span class="code-comment">// Cleanup previewThumbnails plugin if it was loaded</span>
</code></td></tr><tr><td id="L7566" class="css-a4x74f"><span>7566</span></td><td id="LC7566" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.previewThumbnails &amp;&amp; <span class="code-keyword">this</span>.previewThumbnails.loaded) {
</code></td></tr><tr><td id="L7567" class="css-a4x74f"><span>7567</span></td><td id="LC7567" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.previewThumbnails.destroy();
</code></td></tr><tr><td id="L7568" class="css-a4x74f"><span>7568</span></td><td id="LC7568" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.previewThumbnails = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7569" class="css-a4x74f"><span>7569</span></td><td id="LC7569" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7570" class="css-a4x74f"><span>7570</span></td><td id="LC7570" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7571" class="css-a4x74f"><span>7571</span></td><td id="LC7571" class="css-1dcdqdg"><code>          <span class="code-comment">// Create new instance if it is still enabled</span>
</code></td></tr><tr><td id="L7572" class="css-a4x74f"><span>7572</span></td><td id="LC7572" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.previewThumbnails.enabled) {
</code></td></tr><tr><td id="L7573" class="css-a4x74f"><span>7573</span></td><td id="LC7573" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.previewThumbnails = <span class="code-keyword">new</span> PreviewThumbnails(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7574" class="css-a4x74f"><span>7574</span></td><td id="LC7574" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7575" class="css-a4x74f"><span>7575</span></td><td id="LC7575" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7576" class="css-a4x74f"><span>7576</span></td><td id="LC7576" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7577" class="css-a4x74f"><span>7577</span></td><td id="LC7577" class="css-1dcdqdg"><code>        <span class="code-comment">// Update the fullscreen support</span>
</code></td></tr><tr><td id="L7578" class="css-a4x74f"><span>7578</span></td><td id="LC7578" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.fullscreen.update();
</code></td></tr><tr><td id="L7579" class="css-a4x74f"><span>7579</span></td><td id="LC7579" class="css-1dcdqdg"><code>      }, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7580" class="css-a4x74f"><span>7580</span></td><td id="LC7580" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L7581" class="css-a4x74f"><span>7581</span></td><td id="LC7581" class="css-1dcdqdg"><code>  };
</code></td></tr><tr><td id="L7582" class="css-a4x74f"><span>7582</span></td><td id="LC7582" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7583" class="css-a4x74f"><span>7583</span></td><td id="LC7583" class="css-1dcdqdg"><code>  <span class="code-comment">// Private properties</span>
</code></td></tr><tr><td id="L7584" class="css-a4x74f"><span>7584</span></td><td id="LC7584" class="css-1dcdqdg"><code>  <span class="code-comment">// <span class="code-doctag">TODO:</span> Use a WeakMap for private globals</span>
</code></td></tr><tr><td id="L7585" class="css-a4x74f"><span>7585</span></td><td id="LC7585" class="css-1dcdqdg"><code>  <span class="code-comment">// const globals = new WeakMap();</span>
</code></td></tr><tr><td id="L7586" class="css-a4x74f"><span>7586</span></td><td id="LC7586" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7587" class="css-a4x74f"><span>7587</span></td><td id="LC7587" class="css-1dcdqdg"><code>  <span class="code-comment">// Plyr instance</span>
</code></td></tr><tr><td id="L7588" class="css-a4x74f"><span>7588</span></td><td id="LC7588" class="css-1dcdqdg"><code>  <span class="code-class"><span class="code-keyword">class</span> <span class="code-title">Plyr</span> </span>{
</code></td></tr><tr><td id="L7589" class="css-a4x74f"><span>7589</span></td><td id="LC7589" class="css-1dcdqdg"><code>    <span class="code-keyword">constructor</span>(target, options) {
</code></td></tr><tr><td id="L7590" class="css-a4x74f"><span>7590</span></td><td id="LC7590" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7591" class="css-a4x74f"><span>7591</span></td><td id="LC7591" class="css-1dcdqdg"><code><span class="code-comment">       * Play the media, or play the advertisement (if they are not blocked)
</span></code></td></tr><tr><td id="L7592" class="css-a4x74f"><span>7592</span></td><td id="LC7592" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7593" class="css-a4x74f"><span>7593</span></td><td id="LC7593" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"play"</span>, () =&gt; {
</code></td></tr><tr><td id="L7594" class="css-a4x74f"><span>7594</span></td><td id="LC7594" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!is.function(<span class="code-keyword">this</span>.media.play)) {
</code></td></tr><tr><td id="L7595" class="css-a4x74f"><span>7595</span></td><td id="LC7595" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7596" class="css-a4x74f"><span>7596</span></td><td id="LC7596" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7597" class="css-a4x74f"><span>7597</span></td><td id="LC7597" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7598" class="css-a4x74f"><span>7598</span></td><td id="LC7598" class="css-1dcdqdg"><code>        <span class="code-comment">// Intecept play with ads</span>
</code></td></tr><tr><td id="L7599" class="css-a4x74f"><span>7599</span></td><td id="LC7599" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.ads &amp;&amp; <span class="code-keyword">this</span>.ads.enabled) {
</code></td></tr><tr><td id="L7600" class="css-a4x74f"><span>7600</span></td><td id="LC7600" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.ads.managerPromise.then(<span class="code-function"><span class="code-params">()</span> =&gt;</span> <span class="code-keyword">this</span>.ads.play()).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> silencePromise(<span class="code-keyword">this</span>.media.play()));
</code></td></tr><tr><td id="L7601" class="css-a4x74f"><span>7601</span></td><td id="LC7601" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7602" class="css-a4x74f"><span>7602</span></td><td id="LC7602" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7603" class="css-a4x74f"><span>7603</span></td><td id="LC7603" class="css-1dcdqdg"><code>        <span class="code-comment">// Return the promise (for HTML5)</span>
</code></td></tr><tr><td id="L7604" class="css-a4x74f"><span>7604</span></td><td id="LC7604" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.play();
</code></td></tr><tr><td id="L7605" class="css-a4x74f"><span>7605</span></td><td id="LC7605" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7606" class="css-a4x74f"><span>7606</span></td><td id="LC7606" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7607" class="css-a4x74f"><span>7607</span></td><td id="LC7607" class="css-1dcdqdg"><code><span class="code-comment">       * Pause the media
</span></code></td></tr><tr><td id="L7608" class="css-a4x74f"><span>7608</span></td><td id="LC7608" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7609" class="css-a4x74f"><span>7609</span></td><td id="LC7609" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"pause"</span>, () =&gt; {
</code></td></tr><tr><td id="L7610" class="css-a4x74f"><span>7610</span></td><td id="LC7610" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.playing || !is.function(<span class="code-keyword">this</span>.media.pause)) {
</code></td></tr><tr><td id="L7611" class="css-a4x74f"><span>7611</span></td><td id="LC7611" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7612" class="css-a4x74f"><span>7612</span></td><td id="LC7612" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7613" class="css-a4x74f"><span>7613</span></td><td id="LC7613" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.pause();
</code></td></tr><tr><td id="L7614" class="css-a4x74f"><span>7614</span></td><td id="LC7614" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7615" class="css-a4x74f"><span>7615</span></td><td id="LC7615" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7616" class="css-a4x74f"><span>7616</span></td><td id="LC7616" class="css-1dcdqdg"><code><span class="code-comment">       * Toggle playback based on current status
</span></code></td></tr><tr><td id="L7617" class="css-a4x74f"><span>7617</span></td><td id="LC7617" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} input
</span></code></td></tr><tr><td id="L7618" class="css-a4x74f"><span>7618</span></td><td id="LC7618" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7619" class="css-a4x74f"><span>7619</span></td><td id="LC7619" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"togglePlay"</span>, input =&gt; {
</code></td></tr><tr><td id="L7620" class="css-a4x74f"><span>7620</span></td><td id="LC7620" class="css-1dcdqdg"><code>        <span class="code-comment">// Toggle based on current state if nothing passed</span>
</code></td></tr><tr><td id="L7621" class="css-a4x74f"><span>7621</span></td><td id="LC7621" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : !<span class="code-keyword">this</span>.playing;
</code></td></tr><tr><td id="L7622" class="css-a4x74f"><span>7622</span></td><td id="LC7622" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (toggle) {
</code></td></tr><tr><td id="L7623" class="css-a4x74f"><span>7623</span></td><td id="LC7623" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-keyword">this</span>.play();
</code></td></tr><tr><td id="L7624" class="css-a4x74f"><span>7624</span></td><td id="LC7624" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7625" class="css-a4x74f"><span>7625</span></td><td id="LC7625" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.pause();
</code></td></tr><tr><td id="L7626" class="css-a4x74f"><span>7626</span></td><td id="LC7626" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7627" class="css-a4x74f"><span>7627</span></td><td id="LC7627" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7628" class="css-a4x74f"><span>7628</span></td><td id="LC7628" class="css-1dcdqdg"><code><span class="code-comment">       * Stop playback
</span></code></td></tr><tr><td id="L7629" class="css-a4x74f"><span>7629</span></td><td id="LC7629" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7630" class="css-a4x74f"><span>7630</span></td><td id="LC7630" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"stop"</span>, () =&gt; {
</code></td></tr><tr><td id="L7631" class="css-a4x74f"><span>7631</span></td><td id="LC7631" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7632" class="css-a4x74f"><span>7632</span></td><td id="LC7632" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.pause();
</code></td></tr><tr><td id="L7633" class="css-a4x74f"><span>7633</span></td><td id="LC7633" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.restart();
</code></td></tr><tr><td id="L7634" class="css-a4x74f"><span>7634</span></td><td id="LC7634" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.function(<span class="code-keyword">this</span>.media.stop)) {
</code></td></tr><tr><td id="L7635" class="css-a4x74f"><span>7635</span></td><td id="LC7635" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.media.stop();
</code></td></tr><tr><td id="L7636" class="css-a4x74f"><span>7636</span></td><td id="LC7636" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7637" class="css-a4x74f"><span>7637</span></td><td id="LC7637" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7638" class="css-a4x74f"><span>7638</span></td><td id="LC7638" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7639" class="css-a4x74f"><span>7639</span></td><td id="LC7639" class="css-1dcdqdg"><code><span class="code-comment">       * Restart playback
</span></code></td></tr><tr><td id="L7640" class="css-a4x74f"><span>7640</span></td><td id="LC7640" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7641" class="css-a4x74f"><span>7641</span></td><td id="LC7641" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"restart"</span>, () =&gt; {
</code></td></tr><tr><td id="L7642" class="css-a4x74f"><span>7642</span></td><td id="LC7642" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.currentTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L7643" class="css-a4x74f"><span>7643</span></td><td id="LC7643" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7644" class="css-a4x74f"><span>7644</span></td><td id="LC7644" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7645" class="css-a4x74f"><span>7645</span></td><td id="LC7645" class="css-1dcdqdg"><code><span class="code-comment">       * Rewind
</span></code></td></tr><tr><td id="L7646" class="css-a4x74f"><span>7646</span></td><td id="LC7646" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Number} seekTime - how far to rewind in seconds. Defaults to the config.seekTime
</span></code></td></tr><tr><td id="L7647" class="css-a4x74f"><span>7647</span></td><td id="LC7647" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7648" class="css-a4x74f"><span>7648</span></td><td id="LC7648" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"rewind"</span>, seekTime =&gt; {
</code></td></tr><tr><td id="L7649" class="css-a4x74f"><span>7649</span></td><td id="LC7649" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.currentTime -= is.number(seekTime) ? seekTime : <span class="code-keyword">this</span>.config.seekTime;
</code></td></tr><tr><td id="L7650" class="css-a4x74f"><span>7650</span></td><td id="LC7650" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7651" class="css-a4x74f"><span>7651</span></td><td id="LC7651" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7652" class="css-a4x74f"><span>7652</span></td><td id="LC7652" class="css-1dcdqdg"><code><span class="code-comment">       * Fast forward
</span></code></td></tr><tr><td id="L7653" class="css-a4x74f"><span>7653</span></td><td id="LC7653" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Number} seekTime - how far to fast forward in seconds. Defaults to the config.seekTime
</span></code></td></tr><tr><td id="L7654" class="css-a4x74f"><span>7654</span></td><td id="LC7654" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7655" class="css-a4x74f"><span>7655</span></td><td id="LC7655" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"forward"</span>, seekTime =&gt; {
</code></td></tr><tr><td id="L7656" class="css-a4x74f"><span>7656</span></td><td id="LC7656" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.currentTime += is.number(seekTime) ? seekTime : <span class="code-keyword">this</span>.config.seekTime;
</code></td></tr><tr><td id="L7657" class="css-a4x74f"><span>7657</span></td><td id="LC7657" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7658" class="css-a4x74f"><span>7658</span></td><td id="LC7658" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7659" class="css-a4x74f"><span>7659</span></td><td id="LC7659" class="css-1dcdqdg"><code><span class="code-comment">       * Increase volume
</span></code></td></tr><tr><td id="L7660" class="css-a4x74f"><span>7660</span></td><td id="LC7660" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} step - How much to decrease by (between 0 and 1)
</span></code></td></tr><tr><td id="L7661" class="css-a4x74f"><span>7661</span></td><td id="LC7661" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7662" class="css-a4x74f"><span>7662</span></td><td id="LC7662" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"increaseVolume"</span>, step =&gt; {
</code></td></tr><tr><td id="L7663" class="css-a4x74f"><span>7663</span></td><td id="LC7663" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> volume = <span class="code-keyword">this</span>.media.muted ? <span class="code-number">0</span> : <span class="code-keyword">this</span>.volume;
</code></td></tr><tr><td id="L7664" class="css-a4x74f"><span>7664</span></td><td id="LC7664" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.volume = volume + (is.number(step) ? step : <span class="code-number">0</span>);
</code></td></tr><tr><td id="L7665" class="css-a4x74f"><span>7665</span></td><td id="LC7665" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7666" class="css-a4x74f"><span>7666</span></td><td id="LC7666" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7667" class="css-a4x74f"><span>7667</span></td><td id="LC7667" class="css-1dcdqdg"><code><span class="code-comment">       * Decrease volume
</span></code></td></tr><tr><td id="L7668" class="css-a4x74f"><span>7668</span></td><td id="LC7668" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} step - How much to decrease by (between 0 and 1)
</span></code></td></tr><tr><td id="L7669" class="css-a4x74f"><span>7669</span></td><td id="LC7669" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7670" class="css-a4x74f"><span>7670</span></td><td id="LC7670" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"decreaseVolume"</span>, step =&gt; {
</code></td></tr><tr><td id="L7671" class="css-a4x74f"><span>7671</span></td><td id="LC7671" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.increaseVolume(-step);
</code></td></tr><tr><td id="L7672" class="css-a4x74f"><span>7672</span></td><td id="LC7672" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7673" class="css-a4x74f"><span>7673</span></td><td id="LC7673" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7674" class="css-a4x74f"><span>7674</span></td><td id="LC7674" class="css-1dcdqdg"><code><span class="code-comment">       * Trigger the airplay dialog
</span></code></td></tr><tr><td id="L7675" class="css-a4x74f"><span>7675</span></td><td id="LC7675" class="css-1dcdqdg"><code><span class="code-comment">       * <span class="code-doctag">TODO:</span> update player with state, support, enabled
</span></code></td></tr><tr><td id="L7676" class="css-a4x74f"><span>7676</span></td><td id="LC7676" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7677" class="css-a4x74f"><span>7677</span></td><td id="LC7677" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"airplay"</span>, () =&gt; {
</code></td></tr><tr><td id="L7678" class="css-a4x74f"><span>7678</span></td><td id="LC7678" class="css-1dcdqdg"><code>        <span class="code-comment">// Show dialog if supported</span>
</code></td></tr><tr><td id="L7679" class="css-a4x74f"><span>7679</span></td><td id="LC7679" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (support.airplay) {
</code></td></tr><tr><td id="L7680" class="css-a4x74f"><span>7680</span></td><td id="LC7680" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.media.webkitShowPlaybackTargetPicker();
</code></td></tr><tr><td id="L7681" class="css-a4x74f"><span>7681</span></td><td id="LC7681" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7682" class="css-a4x74f"><span>7682</span></td><td id="LC7682" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7683" class="css-a4x74f"><span>7683</span></td><td id="LC7683" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7684" class="css-a4x74f"><span>7684</span></td><td id="LC7684" class="css-1dcdqdg"><code><span class="code-comment">       * Toggle the player controls
</span></code></td></tr><tr><td id="L7685" class="css-a4x74f"><span>7685</span></td><td id="LC7685" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} [toggle] - Whether to show the controls
</span></code></td></tr><tr><td id="L7686" class="css-a4x74f"><span>7686</span></td><td id="LC7686" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7687" class="css-a4x74f"><span>7687</span></td><td id="LC7687" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"toggleControls"</span>, toggle =&gt; {
</code></td></tr><tr><td id="L7688" class="css-a4x74f"><span>7688</span></td><td id="LC7688" class="css-1dcdqdg"><code>        <span class="code-comment">// Don't toggle if missing UI support or if it's audio</span>
</code></td></tr><tr><td id="L7689" class="css-a4x74f"><span>7689</span></td><td id="LC7689" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.supported.ui &amp;&amp; !<span class="code-keyword">this</span>.isAudio) {
</code></td></tr><tr><td id="L7690" class="css-a4x74f"><span>7690</span></td><td id="LC7690" class="css-1dcdqdg"><code>          <span class="code-comment">// Get state before change</span>
</code></td></tr><tr><td id="L7691" class="css-a4x74f"><span>7691</span></td><td id="LC7691" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> isHidden = hasClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.hideControls);
</code></td></tr><tr><td id="L7692" class="css-a4x74f"><span>7692</span></td><td id="LC7692" class="css-1dcdqdg"><code>          <span class="code-comment">// Negate the argument if not undefined since adding the class to hides the controls</span>
</code></td></tr><tr><td id="L7693" class="css-a4x74f"><span>7693</span></td><td id="LC7693" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> force = <span class="code-keyword">typeof</span> toggle === <span class="code-string">'undefined'</span> ? <span class="code-literal">undefined</span> : !toggle;
</code></td></tr><tr><td id="L7694" class="css-a4x74f"><span>7694</span></td><td id="LC7694" class="css-1dcdqdg"><code>          <span class="code-comment">// Apply and get updated state</span>
</code></td></tr><tr><td id="L7695" class="css-a4x74f"><span>7695</span></td><td id="LC7695" class="css-1dcdqdg"><code>          <span class="code-keyword">const</span> hiding = toggleClass(<span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.classNames.hideControls, force);
</code></td></tr><tr><td id="L7696" class="css-a4x74f"><span>7696</span></td><td id="LC7696" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7697" class="css-a4x74f"><span>7697</span></td><td id="LC7697" class="css-1dcdqdg"><code>          <span class="code-comment">// Close menu</span>
</code></td></tr><tr><td id="L7698" class="css-a4x74f"><span>7698</span></td><td id="LC7698" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (hiding &amp;&amp; is.array(<span class="code-keyword">this</span>.config.controls) &amp;&amp; <span class="code-keyword">this</span>.config.controls.includes(<span class="code-string">'settings'</span>) &amp;&amp; !is.empty(<span class="code-keyword">this</span>.config.settings)) {
</code></td></tr><tr><td id="L7699" class="css-a4x74f"><span>7699</span></td><td id="LC7699" class="css-1dcdqdg"><code>            controls.toggleMenu.call(<span class="code-keyword">this</span>, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L7700" class="css-a4x74f"><span>7700</span></td><td id="LC7700" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7701" class="css-a4x74f"><span>7701</span></td><td id="LC7701" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7702" class="css-a4x74f"><span>7702</span></td><td id="LC7702" class="css-1dcdqdg"><code>          <span class="code-comment">// Trigger event on change</span>
</code></td></tr><tr><td id="L7703" class="css-a4x74f"><span>7703</span></td><td id="LC7703" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (hiding !== isHidden) {
</code></td></tr><tr><td id="L7704" class="css-a4x74f"><span>7704</span></td><td id="LC7704" class="css-1dcdqdg"><code>            <span class="code-keyword">const</span> eventName = hiding ? <span class="code-string">'controlshidden'</span> : <span class="code-string">'controlsshown'</span>;
</code></td></tr><tr><td id="L7705" class="css-a4x74f"><span>7705</span></td><td id="LC7705" class="css-1dcdqdg"><code>            triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.media, eventName);
</code></td></tr><tr><td id="L7706" class="css-a4x74f"><span>7706</span></td><td id="LC7706" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7707" class="css-a4x74f"><span>7707</span></td><td id="LC7707" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> !hiding;
</code></td></tr><tr><td id="L7708" class="css-a4x74f"><span>7708</span></td><td id="LC7708" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7709" class="css-a4x74f"><span>7709</span></td><td id="LC7709" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7710" class="css-a4x74f"><span>7710</span></td><td id="LC7710" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7711" class="css-a4x74f"><span>7711</span></td><td id="LC7711" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7712" class="css-a4x74f"><span>7712</span></td><td id="LC7712" class="css-1dcdqdg"><code><span class="code-comment">       * Add event listeners
</span></code></td></tr><tr><td id="L7713" class="css-a4x74f"><span>7713</span></td><td id="LC7713" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} event - Event type
</span></code></td></tr><tr><td id="L7714" class="css-a4x74f"><span>7714</span></td><td id="LC7714" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callback - Callback for when event occurs
</span></code></td></tr><tr><td id="L7715" class="css-a4x74f"><span>7715</span></td><td id="LC7715" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7716" class="css-a4x74f"><span>7716</span></td><td id="LC7716" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"on"</span>, (event, callback) =&gt; {
</code></td></tr><tr><td id="L7717" class="css-a4x74f"><span>7717</span></td><td id="LC7717" class="css-1dcdqdg"><code>        on.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.container, event, callback);
</code></td></tr><tr><td id="L7718" class="css-a4x74f"><span>7718</span></td><td id="LC7718" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7719" class="css-a4x74f"><span>7719</span></td><td id="LC7719" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7720" class="css-a4x74f"><span>7720</span></td><td id="LC7720" class="css-1dcdqdg"><code><span class="code-comment">       * Add event listeners once
</span></code></td></tr><tr><td id="L7721" class="css-a4x74f"><span>7721</span></td><td id="LC7721" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} event - Event type
</span></code></td></tr><tr><td id="L7722" class="css-a4x74f"><span>7722</span></td><td id="LC7722" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callback - Callback for when event occurs
</span></code></td></tr><tr><td id="L7723" class="css-a4x74f"><span>7723</span></td><td id="LC7723" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7724" class="css-a4x74f"><span>7724</span></td><td id="LC7724" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"once"</span>, (event, callback) =&gt; {
</code></td></tr><tr><td id="L7725" class="css-a4x74f"><span>7725</span></td><td id="LC7725" class="css-1dcdqdg"><code>        once.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.container, event, callback);
</code></td></tr><tr><td id="L7726" class="css-a4x74f"><span>7726</span></td><td id="LC7726" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7727" class="css-a4x74f"><span>7727</span></td><td id="LC7727" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7728" class="css-a4x74f"><span>7728</span></td><td id="LC7728" class="css-1dcdqdg"><code><span class="code-comment">       * Remove event listeners
</span></code></td></tr><tr><td id="L7729" class="css-a4x74f"><span>7729</span></td><td id="LC7729" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} event - Event type
</span></code></td></tr><tr><td id="L7730" class="css-a4x74f"><span>7730</span></td><td id="LC7730" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callback - Callback for when event occurs
</span></code></td></tr><tr><td id="L7731" class="css-a4x74f"><span>7731</span></td><td id="LC7731" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7732" class="css-a4x74f"><span>7732</span></td><td id="LC7732" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"off"</span>, (event, callback) =&gt; {
</code></td></tr><tr><td id="L7733" class="css-a4x74f"><span>7733</span></td><td id="LC7733" class="css-1dcdqdg"><code>        off(<span class="code-keyword">this</span>.elements.container, event, callback);
</code></td></tr><tr><td id="L7734" class="css-a4x74f"><span>7734</span></td><td id="LC7734" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7735" class="css-a4x74f"><span>7735</span></td><td id="LC7735" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7736" class="css-a4x74f"><span>7736</span></td><td id="LC7736" class="css-1dcdqdg"><code><span class="code-comment">       * Destroy an instance
</span></code></td></tr><tr><td id="L7737" class="css-a4x74f"><span>7737</span></td><td id="LC7737" class="css-1dcdqdg"><code><span class="code-comment">       * Event listeners are removed when elements are removed
</span></code></td></tr><tr><td id="L7738" class="css-a4x74f"><span>7738</span></td><td id="LC7738" class="css-1dcdqdg"><code><span class="code-comment">       * http://stackoverflow.com/questions/12528049/if-a-dom-element-is-removed-are-its-listeners-also-removed-from-memory
</span></code></td></tr><tr><td id="L7739" class="css-a4x74f"><span>7739</span></td><td id="LC7739" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Function} callback - Callback for when destroy is complete
</span></code></td></tr><tr><td id="L7740" class="css-a4x74f"><span>7740</span></td><td id="LC7740" class="css-1dcdqdg"><code><span class="code-comment">       * @param {Boolean} soft - Whether it's a soft destroy (for source changes etc)
</span></code></td></tr><tr><td id="L7741" class="css-a4x74f"><span>7741</span></td><td id="LC7741" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7742" class="css-a4x74f"><span>7742</span></td><td id="LC7742" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"destroy"</span>, (callback, soft = <span class="code-literal">false</span>) =&gt; {
</code></td></tr><tr><td id="L7743" class="css-a4x74f"><span>7743</span></td><td id="LC7743" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.ready) {
</code></td></tr><tr><td id="L7744" class="css-a4x74f"><span>7744</span></td><td id="LC7744" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7745" class="css-a4x74f"><span>7745</span></td><td id="LC7745" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7746" class="css-a4x74f"><span>7746</span></td><td id="LC7746" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> done = <span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7747" class="css-a4x74f"><span>7747</span></td><td id="LC7747" class="css-1dcdqdg"><code>          <span class="code-comment">// Reset overflow (incase destroyed while in fullscreen)</span>
</code></td></tr><tr><td id="L7748" class="css-a4x74f"><span>7748</span></td><td id="LC7748" class="css-1dcdqdg"><code>          <span class="code-built_in">document</span>.body.style.overflow = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L7749" class="css-a4x74f"><span>7749</span></td><td id="LC7749" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7750" class="css-a4x74f"><span>7750</span></td><td id="LC7750" class="css-1dcdqdg"><code>          <span class="code-comment">// GC for embed</span>
</code></td></tr><tr><td id="L7751" class="css-a4x74f"><span>7751</span></td><td id="LC7751" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.embed = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7752" class="css-a4x74f"><span>7752</span></td><td id="LC7752" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7753" class="css-a4x74f"><span>7753</span></td><td id="LC7753" class="css-1dcdqdg"><code>          <span class="code-comment">// If it's a soft destroy, make minimal changes</span>
</code></td></tr><tr><td id="L7754" class="css-a4x74f"><span>7754</span></td><td id="LC7754" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (soft) {
</code></td></tr><tr><td id="L7755" class="css-a4x74f"><span>7755</span></td><td id="LC7755" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (<span class="code-built_in">Object</span>.keys(<span class="code-keyword">this</span>.elements).length) {
</code></td></tr><tr><td id="L7756" class="css-a4x74f"><span>7756</span></td><td id="LC7756" class="css-1dcdqdg"><code>              <span class="code-comment">// Remove elements</span>
</code></td></tr><tr><td id="L7757" class="css-a4x74f"><span>7757</span></td><td id="LC7757" class="css-1dcdqdg"><code>              removeElement(<span class="code-keyword">this</span>.elements.buttons.play);
</code></td></tr><tr><td id="L7758" class="css-a4x74f"><span>7758</span></td><td id="LC7758" class="css-1dcdqdg"><code>              removeElement(<span class="code-keyword">this</span>.elements.captions);
</code></td></tr><tr><td id="L7759" class="css-a4x74f"><span>7759</span></td><td id="LC7759" class="css-1dcdqdg"><code>              removeElement(<span class="code-keyword">this</span>.elements.controls);
</code></td></tr><tr><td id="L7760" class="css-a4x74f"><span>7760</span></td><td id="LC7760" class="css-1dcdqdg"><code>              removeElement(<span class="code-keyword">this</span>.elements.wrapper);
</code></td></tr><tr><td id="L7761" class="css-a4x74f"><span>7761</span></td><td id="LC7761" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7762" class="css-a4x74f"><span>7762</span></td><td id="LC7762" class="css-1dcdqdg"><code>              <span class="code-comment">// Clear for GC</span>
</code></td></tr><tr><td id="L7763" class="css-a4x74f"><span>7763</span></td><td id="LC7763" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.elements.buttons.play = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7764" class="css-a4x74f"><span>7764</span></td><td id="LC7764" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.elements.captions = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7765" class="css-a4x74f"><span>7765</span></td><td id="LC7765" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.elements.controls = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7766" class="css-a4x74f"><span>7766</span></td><td id="LC7766" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.elements.wrapper = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7767" class="css-a4x74f"><span>7767</span></td><td id="LC7767" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7768" class="css-a4x74f"><span>7768</span></td><td id="LC7768" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7769" class="css-a4x74f"><span>7769</span></td><td id="LC7769" class="css-1dcdqdg"><code>            <span class="code-comment">// Callback</span>
</code></td></tr><tr><td id="L7770" class="css-a4x74f"><span>7770</span></td><td id="LC7770" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (is.function(callback)) {
</code></td></tr><tr><td id="L7771" class="css-a4x74f"><span>7771</span></td><td id="LC7771" class="css-1dcdqdg"><code>              callback();
</code></td></tr><tr><td id="L7772" class="css-a4x74f"><span>7772</span></td><td id="LC7772" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7773" class="css-a4x74f"><span>7773</span></td><td id="LC7773" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7774" class="css-a4x74f"><span>7774</span></td><td id="LC7774" class="css-1dcdqdg"><code>            <span class="code-comment">// Unbind listeners</span>
</code></td></tr><tr><td id="L7775" class="css-a4x74f"><span>7775</span></td><td id="LC7775" class="css-1dcdqdg"><code>            unbindListeners.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7776" class="css-a4x74f"><span>7776</span></td><td id="LC7776" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7777" class="css-a4x74f"><span>7777</span></td><td id="LC7777" class="css-1dcdqdg"><code>            <span class="code-comment">// Cancel current network requests</span>
</code></td></tr><tr><td id="L7778" class="css-a4x74f"><span>7778</span></td><td id="LC7778" class="css-1dcdqdg"><code>            html5.cancelRequests.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L7779" class="css-a4x74f"><span>7779</span></td><td id="LC7779" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7780" class="css-a4x74f"><span>7780</span></td><td id="LC7780" class="css-1dcdqdg"><code>            <span class="code-comment">// Replace the container with the original element provided</span>
</code></td></tr><tr><td id="L7781" class="css-a4x74f"><span>7781</span></td><td id="LC7781" class="css-1dcdqdg"><code>            replaceElement(<span class="code-keyword">this</span>.elements.original, <span class="code-keyword">this</span>.elements.container);
</code></td></tr><tr><td id="L7782" class="css-a4x74f"><span>7782</span></td><td id="LC7782" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7783" class="css-a4x74f"><span>7783</span></td><td id="LC7783" class="css-1dcdqdg"><code>            <span class="code-comment">// Event</span>
</code></td></tr><tr><td id="L7784" class="css-a4x74f"><span>7784</span></td><td id="LC7784" class="css-1dcdqdg"><code>            triggerEvent.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.original, <span class="code-string">'destroyed'</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7785" class="css-a4x74f"><span>7785</span></td><td id="LC7785" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7786" class="css-a4x74f"><span>7786</span></td><td id="LC7786" class="css-1dcdqdg"><code>            <span class="code-comment">// Callback</span>
</code></td></tr><tr><td id="L7787" class="css-a4x74f"><span>7787</span></td><td id="LC7787" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (is.function(callback)) {
</code></td></tr><tr><td id="L7788" class="css-a4x74f"><span>7788</span></td><td id="LC7788" class="css-1dcdqdg"><code>              callback.call(<span class="code-keyword">this</span>.elements.original);
</code></td></tr><tr><td id="L7789" class="css-a4x74f"><span>7789</span></td><td id="LC7789" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7790" class="css-a4x74f"><span>7790</span></td><td id="LC7790" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7791" class="css-a4x74f"><span>7791</span></td><td id="LC7791" class="css-1dcdqdg"><code>            <span class="code-comment">// Reset state</span>
</code></td></tr><tr><td id="L7792" class="css-a4x74f"><span>7792</span></td><td id="LC7792" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.ready = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7793" class="css-a4x74f"><span>7793</span></td><td id="LC7793" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7794" class="css-a4x74f"><span>7794</span></td><td id="LC7794" class="css-1dcdqdg"><code>            <span class="code-comment">// Clear for garbage collection</span>
</code></td></tr><tr><td id="L7795" class="css-a4x74f"><span>7795</span></td><td id="LC7795" class="css-1dcdqdg"><code>            setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7796" class="css-a4x74f"><span>7796</span></td><td id="LC7796" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.elements = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7797" class="css-a4x74f"><span>7797</span></td><td id="LC7797" class="css-1dcdqdg"><code>              <span class="code-keyword">this</span>.media = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7798" class="css-a4x74f"><span>7798</span></td><td id="LC7798" class="css-1dcdqdg"><code>            }, <span class="code-number">200</span>);
</code></td></tr><tr><td id="L7799" class="css-a4x74f"><span>7799</span></td><td id="LC7799" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7800" class="css-a4x74f"><span>7800</span></td><td id="LC7800" class="css-1dcdqdg"><code>        };
</code></td></tr><tr><td id="L7801" class="css-a4x74f"><span>7801</span></td><td id="LC7801" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7802" class="css-a4x74f"><span>7802</span></td><td id="LC7802" class="css-1dcdqdg"><code>        <span class="code-comment">// Stop playback</span>
</code></td></tr><tr><td id="L7803" class="css-a4x74f"><span>7803</span></td><td id="LC7803" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.stop();
</code></td></tr><tr><td id="L7804" class="css-a4x74f"><span>7804</span></td><td id="LC7804" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7805" class="css-a4x74f"><span>7805</span></td><td id="LC7805" class="css-1dcdqdg"><code>        <span class="code-comment">// Clear timeouts</span>
</code></td></tr><tr><td id="L7806" class="css-a4x74f"><span>7806</span></td><td id="LC7806" class="css-1dcdqdg"><code>        clearTimeout(<span class="code-keyword">this</span>.timers.loading);
</code></td></tr><tr><td id="L7807" class="css-a4x74f"><span>7807</span></td><td id="LC7807" class="css-1dcdqdg"><code>        clearTimeout(<span class="code-keyword">this</span>.timers.controls);
</code></td></tr><tr><td id="L7808" class="css-a4x74f"><span>7808</span></td><td id="LC7808" class="css-1dcdqdg"><code>        clearTimeout(<span class="code-keyword">this</span>.timers.resized);
</code></td></tr><tr><td id="L7809" class="css-a4x74f"><span>7809</span></td><td id="LC7809" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7810" class="css-a4x74f"><span>7810</span></td><td id="LC7810" class="css-1dcdqdg"><code>        <span class="code-comment">// Provider specific stuff</span>
</code></td></tr><tr><td id="L7811" class="css-a4x74f"><span>7811</span></td><td id="LC7811" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L7812" class="css-a4x74f"><span>7812</span></td><td id="LC7812" class="css-1dcdqdg"><code>          <span class="code-comment">// Restore native video controls</span>
</code></td></tr><tr><td id="L7813" class="css-a4x74f"><span>7813</span></td><td id="LC7813" class="css-1dcdqdg"><code>          ui.toggleNativeControls.call(<span class="code-keyword">this</span>, <span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7814" class="css-a4x74f"><span>7814</span></td><td id="LC7814" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7815" class="css-a4x74f"><span>7815</span></td><td id="LC7815" class="css-1dcdqdg"><code>          <span class="code-comment">// Clean up</span>
</code></td></tr><tr><td id="L7816" class="css-a4x74f"><span>7816</span></td><td id="LC7816" class="css-1dcdqdg"><code>          done();
</code></td></tr><tr><td id="L7817" class="css-a4x74f"><span>7817</span></td><td id="LC7817" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isYouTube) {
</code></td></tr><tr><td id="L7818" class="css-a4x74f"><span>7818</span></td><td id="LC7818" class="css-1dcdqdg"><code>          <span class="code-comment">// Clear timers</span>
</code></td></tr><tr><td id="L7819" class="css-a4x74f"><span>7819</span></td><td id="LC7819" class="css-1dcdqdg"><code>          clearInterval(<span class="code-keyword">this</span>.timers.buffering);
</code></td></tr><tr><td id="L7820" class="css-a4x74f"><span>7820</span></td><td id="LC7820" class="css-1dcdqdg"><code>          clearInterval(<span class="code-keyword">this</span>.timers.playing);
</code></td></tr><tr><td id="L7821" class="css-a4x74f"><span>7821</span></td><td id="LC7821" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7822" class="css-a4x74f"><span>7822</span></td><td id="LC7822" class="css-1dcdqdg"><code>          <span class="code-comment">// Destroy YouTube API</span>
</code></td></tr><tr><td id="L7823" class="css-a4x74f"><span>7823</span></td><td id="LC7823" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.embed !== <span class="code-literal">null</span> &amp;&amp; is.function(<span class="code-keyword">this</span>.embed.destroy)) {
</code></td></tr><tr><td id="L7824" class="css-a4x74f"><span>7824</span></td><td id="LC7824" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.embed.destroy();
</code></td></tr><tr><td id="L7825" class="css-a4x74f"><span>7825</span></td><td id="LC7825" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7826" class="css-a4x74f"><span>7826</span></td><td id="LC7826" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7827" class="css-a4x74f"><span>7827</span></td><td id="LC7827" class="css-1dcdqdg"><code>          <span class="code-comment">// Clean up</span>
</code></td></tr><tr><td id="L7828" class="css-a4x74f"><span>7828</span></td><td id="LC7828" class="css-1dcdqdg"><code>          done();
</code></td></tr><tr><td id="L7829" class="css-a4x74f"><span>7829</span></td><td id="LC7829" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo) {
</code></td></tr><tr><td id="L7830" class="css-a4x74f"><span>7830</span></td><td id="LC7830" class="css-1dcdqdg"><code>          <span class="code-comment">// Destroy Vimeo API</span>
</code></td></tr><tr><td id="L7831" class="css-a4x74f"><span>7831</span></td><td id="LC7831" class="css-1dcdqdg"><code>          <span class="code-comment">// then clean up (wait, to prevent postmessage errors)</span>
</code></td></tr><tr><td id="L7832" class="css-a4x74f"><span>7832</span></td><td id="LC7832" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.embed !== <span class="code-literal">null</span>) {
</code></td></tr><tr><td id="L7833" class="css-a4x74f"><span>7833</span></td><td id="LC7833" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.embed.unload().then(done);
</code></td></tr><tr><td id="L7834" class="css-a4x74f"><span>7834</span></td><td id="LC7834" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L7835" class="css-a4x74f"><span>7835</span></td><td id="LC7835" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7836" class="css-a4x74f"><span>7836</span></td><td id="LC7836" class="css-1dcdqdg"><code>          <span class="code-comment">// Vimeo does not always return</span>
</code></td></tr><tr><td id="L7837" class="css-a4x74f"><span>7837</span></td><td id="LC7837" class="css-1dcdqdg"><code>          setTimeout(done, <span class="code-number">200</span>);
</code></td></tr><tr><td id="L7838" class="css-a4x74f"><span>7838</span></td><td id="LC7838" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7839" class="css-a4x74f"><span>7839</span></td><td id="LC7839" class="css-1dcdqdg"><code>      });
</code></td></tr><tr><td id="L7840" class="css-a4x74f"><span>7840</span></td><td id="LC7840" class="css-1dcdqdg"><code>      <span class="code-comment">/**
</span></code></td></tr><tr><td id="L7841" class="css-a4x74f"><span>7841</span></td><td id="LC7841" class="css-1dcdqdg"><code><span class="code-comment">       * Check for support for a mime type (HTML5 only)
</span></code></td></tr><tr><td id="L7842" class="css-a4x74f"><span>7842</span></td><td id="LC7842" class="css-1dcdqdg"><code><span class="code-comment">       * @param {String} type - Mime type
</span></code></td></tr><tr><td id="L7843" class="css-a4x74f"><span>7843</span></td><td id="LC7843" class="css-1dcdqdg"><code><span class="code-comment">       */</span>
</code></td></tr><tr><td id="L7844" class="css-a4x74f"><span>7844</span></td><td id="LC7844" class="css-1dcdqdg"><code>      _defineProperty$<span class="code-number">1</span>(<span class="code-keyword">this</span>, <span class="code-string">"supports"</span>, type =&gt; support.mime.call(<span class="code-keyword">this</span>, type));
</code></td></tr><tr><td id="L7845" class="css-a4x74f"><span>7845</span></td><td id="LC7845" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.timers = {};
</code></td></tr><tr><td id="L7846" class="css-a4x74f"><span>7846</span></td><td id="LC7846" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7847" class="css-a4x74f"><span>7847</span></td><td id="LC7847" class="css-1dcdqdg"><code>      <span class="code-comment">// State</span>
</code></td></tr><tr><td id="L7848" class="css-a4x74f"><span>7848</span></td><td id="LC7848" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.ready = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7849" class="css-a4x74f"><span>7849</span></td><td id="LC7849" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.loading = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7850" class="css-a4x74f"><span>7850</span></td><td id="LC7850" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.failed = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7851" class="css-a4x74f"><span>7851</span></td><td id="LC7851" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7852" class="css-a4x74f"><span>7852</span></td><td id="LC7852" class="css-1dcdqdg"><code>      <span class="code-comment">// Touch device</span>
</code></td></tr><tr><td id="L7853" class="css-a4x74f"><span>7853</span></td><td id="LC7853" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.touch = support.touch;
</code></td></tr><tr><td id="L7854" class="css-a4x74f"><span>7854</span></td><td id="LC7854" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7855" class="css-a4x74f"><span>7855</span></td><td id="LC7855" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the media element</span>
</code></td></tr><tr><td id="L7856" class="css-a4x74f"><span>7856</span></td><td id="LC7856" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media = target;
</code></td></tr><tr><td id="L7857" class="css-a4x74f"><span>7857</span></td><td id="LC7857" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7858" class="css-a4x74f"><span>7858</span></td><td id="LC7858" class="css-1dcdqdg"><code>      <span class="code-comment">// String selector passed</span>
</code></td></tr><tr><td id="L7859" class="css-a4x74f"><span>7859</span></td><td id="LC7859" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(<span class="code-keyword">this</span>.media)) {
</code></td></tr><tr><td id="L7860" class="css-a4x74f"><span>7860</span></td><td id="LC7860" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media = <span class="code-built_in">document</span>.querySelectorAll(<span class="code-keyword">this</span>.media);
</code></td></tr><tr><td id="L7861" class="css-a4x74f"><span>7861</span></td><td id="LC7861" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7862" class="css-a4x74f"><span>7862</span></td><td id="LC7862" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7863" class="css-a4x74f"><span>7863</span></td><td id="LC7863" class="css-1dcdqdg"><code>      <span class="code-comment">// jQuery, NodeList or Array passed, use first element</span>
</code></td></tr><tr><td id="L7864" class="css-a4x74f"><span>7864</span></td><td id="LC7864" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-built_in">window</span>.jQuery &amp;&amp; <span class="code-keyword">this</span>.media <span class="code-keyword">instanceof</span> jQuery || is.nodeList(<span class="code-keyword">this</span>.media) || is.array(<span class="code-keyword">this</span>.media)) {
</code></td></tr><tr><td id="L7865" class="css-a4x74f"><span>7865</span></td><td id="LC7865" class="css-1dcdqdg"><code>        <span class="code-comment">// eslint-disable-next-line</span>
</code></td></tr><tr><td id="L7866" class="css-a4x74f"><span>7866</span></td><td id="LC7866" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media = <span class="code-keyword">this</span>.media[<span class="code-number">0</span>];
</code></td></tr><tr><td id="L7867" class="css-a4x74f"><span>7867</span></td><td id="LC7867" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7868" class="css-a4x74f"><span>7868</span></td><td id="LC7868" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7869" class="css-a4x74f"><span>7869</span></td><td id="LC7869" class="css-1dcdqdg"><code>      <span class="code-comment">// Set config</span>
</code></td></tr><tr><td id="L7870" class="css-a4x74f"><span>7870</span></td><td id="LC7870" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config = extend({}, defaults, Plyr.defaults, options || {}, (<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L7871" class="css-a4x74f"><span>7871</span></td><td id="LC7871" class="css-1dcdqdg"><code>        <span class="code-keyword">try</span> {
</code></td></tr><tr><td id="L7872" class="css-a4x74f"><span>7872</span></td><td id="LC7872" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> <span class="code-built_in">JSON</span>.parse(<span class="code-keyword">this</span>.media.getAttribute(<span class="code-string">'data-plyr-config'</span>));
</code></td></tr><tr><td id="L7873" class="css-a4x74f"><span>7873</span></td><td id="LC7873" class="css-1dcdqdg"><code>        } <span class="code-keyword">catch</span> (_) {
</code></td></tr><tr><td id="L7874" class="css-a4x74f"><span>7874</span></td><td id="LC7874" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span> {};
</code></td></tr><tr><td id="L7875" class="css-a4x74f"><span>7875</span></td><td id="LC7875" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7876" class="css-a4x74f"><span>7876</span></td><td id="LC7876" class="css-1dcdqdg"><code>      })());
</code></td></tr><tr><td id="L7877" class="css-a4x74f"><span>7877</span></td><td id="LC7877" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7878" class="css-a4x74f"><span>7878</span></td><td id="LC7878" class="css-1dcdqdg"><code>      <span class="code-comment">// Elements cache</span>
</code></td></tr><tr><td id="L7879" class="css-a4x74f"><span>7879</span></td><td id="LC7879" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements = {
</code></td></tr><tr><td id="L7880" class="css-a4x74f"><span>7880</span></td><td id="LC7880" class="css-1dcdqdg"><code>        container: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7881" class="css-a4x74f"><span>7881</span></td><td id="LC7881" class="css-1dcdqdg"><code>        fullscreen: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7882" class="css-a4x74f"><span>7882</span></td><td id="LC7882" class="css-1dcdqdg"><code>        captions: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7883" class="css-a4x74f"><span>7883</span></td><td id="LC7883" class="css-1dcdqdg"><code>        buttons: {},
</code></td></tr><tr><td id="L7884" class="css-a4x74f"><span>7884</span></td><td id="LC7884" class="css-1dcdqdg"><code>        display: {},
</code></td></tr><tr><td id="L7885" class="css-a4x74f"><span>7885</span></td><td id="LC7885" class="css-1dcdqdg"><code>        progress: {},
</code></td></tr><tr><td id="L7886" class="css-a4x74f"><span>7886</span></td><td id="LC7886" class="css-1dcdqdg"><code>        inputs: {},
</code></td></tr><tr><td id="L7887" class="css-a4x74f"><span>7887</span></td><td id="LC7887" class="css-1dcdqdg"><code>        settings: {
</code></td></tr><tr><td id="L7888" class="css-a4x74f"><span>7888</span></td><td id="LC7888" class="css-1dcdqdg"><code>          popup: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7889" class="css-a4x74f"><span>7889</span></td><td id="LC7889" class="css-1dcdqdg"><code>          menu: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7890" class="css-a4x74f"><span>7890</span></td><td id="LC7890" class="css-1dcdqdg"><code>          panels: {},
</code></td></tr><tr><td id="L7891" class="css-a4x74f"><span>7891</span></td><td id="LC7891" class="css-1dcdqdg"><code>          buttons: {}
</code></td></tr><tr><td id="L7892" class="css-a4x74f"><span>7892</span></td><td id="LC7892" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L7893" class="css-a4x74f"><span>7893</span></td><td id="LC7893" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L7894" class="css-a4x74f"><span>7894</span></td><td id="LC7894" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7895" class="css-a4x74f"><span>7895</span></td><td id="LC7895" class="css-1dcdqdg"><code>      <span class="code-comment">// Captions</span>
</code></td></tr><tr><td id="L7896" class="css-a4x74f"><span>7896</span></td><td id="LC7896" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.captions = {
</code></td></tr><tr><td id="L7897" class="css-a4x74f"><span>7897</span></td><td id="LC7897" class="css-1dcdqdg"><code>        active: <span class="code-literal">null</span>,
</code></td></tr><tr><td id="L7898" class="css-a4x74f"><span>7898</span></td><td id="LC7898" class="css-1dcdqdg"><code>        currentTrack: <span class="code-number">-1</span>,
</code></td></tr><tr><td id="L7899" class="css-a4x74f"><span>7899</span></td><td id="LC7899" class="css-1dcdqdg"><code>        meta: <span class="code-keyword">new</span> <span class="code-built_in">WeakMap</span>()
</code></td></tr><tr><td id="L7900" class="css-a4x74f"><span>7900</span></td><td id="LC7900" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L7901" class="css-a4x74f"><span>7901</span></td><td id="LC7901" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7902" class="css-a4x74f"><span>7902</span></td><td id="LC7902" class="css-1dcdqdg"><code>      <span class="code-comment">// Fullscreen</span>
</code></td></tr><tr><td id="L7903" class="css-a4x74f"><span>7903</span></td><td id="LC7903" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.fullscreen = {
</code></td></tr><tr><td id="L7904" class="css-a4x74f"><span>7904</span></td><td id="LC7904" class="css-1dcdqdg"><code>        active: <span class="code-literal">false</span>
</code></td></tr><tr><td id="L7905" class="css-a4x74f"><span>7905</span></td><td id="LC7905" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L7906" class="css-a4x74f"><span>7906</span></td><td id="LC7906" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7907" class="css-a4x74f"><span>7907</span></td><td id="LC7907" class="css-1dcdqdg"><code>      <span class="code-comment">// Options</span>
</code></td></tr><tr><td id="L7908" class="css-a4x74f"><span>7908</span></td><td id="LC7908" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.options = {
</code></td></tr><tr><td id="L7909" class="css-a4x74f"><span>7909</span></td><td id="LC7909" class="css-1dcdqdg"><code>        speed: [],
</code></td></tr><tr><td id="L7910" class="css-a4x74f"><span>7910</span></td><td id="LC7910" class="css-1dcdqdg"><code>        quality: []
</code></td></tr><tr><td id="L7911" class="css-a4x74f"><span>7911</span></td><td id="LC7911" class="css-1dcdqdg"><code>      };
</code></td></tr><tr><td id="L7912" class="css-a4x74f"><span>7912</span></td><td id="LC7912" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7913" class="css-a4x74f"><span>7913</span></td><td id="LC7913" class="css-1dcdqdg"><code>      <span class="code-comment">// Debugging</span>
</code></td></tr><tr><td id="L7914" class="css-a4x74f"><span>7914</span></td><td id="LC7914" class="css-1dcdqdg"><code>      <span class="code-comment">// <span class="code-doctag">TODO:</span> move to globals</span>
</code></td></tr><tr><td id="L7915" class="css-a4x74f"><span>7915</span></td><td id="LC7915" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.debug = <span class="code-keyword">new</span> Console(<span class="code-keyword">this</span>.config.debug);
</code></td></tr><tr><td id="L7916" class="css-a4x74f"><span>7916</span></td><td id="LC7916" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7917" class="css-a4x74f"><span>7917</span></td><td id="LC7917" class="css-1dcdqdg"><code>      <span class="code-comment">// Log config options and support</span>
</code></td></tr><tr><td id="L7918" class="css-a4x74f"><span>7918</span></td><td id="LC7918" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.debug.log(<span class="code-string">'Config'</span>, <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L7919" class="css-a4x74f"><span>7919</span></td><td id="LC7919" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.debug.log(<span class="code-string">'Support'</span>, support);
</code></td></tr><tr><td id="L7920" class="css-a4x74f"><span>7920</span></td><td id="LC7920" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7921" class="css-a4x74f"><span>7921</span></td><td id="LC7921" class="css-1dcdqdg"><code>      <span class="code-comment">// We need an element to setup</span>
</code></td></tr><tr><td id="L7922" class="css-a4x74f"><span>7922</span></td><td id="LC7922" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.nullOrUndefined(<span class="code-keyword">this</span>.media) || !is.element(<span class="code-keyword">this</span>.media)) {
</code></td></tr><tr><td id="L7923" class="css-a4x74f"><span>7923</span></td><td id="LC7923" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: no suitable element passed'</span>);
</code></td></tr><tr><td id="L7924" class="css-a4x74f"><span>7924</span></td><td id="LC7924" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7925" class="css-a4x74f"><span>7925</span></td><td id="LC7925" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7926" class="css-a4x74f"><span>7926</span></td><td id="LC7926" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7927" class="css-a4x74f"><span>7927</span></td><td id="LC7927" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if the element is initialized</span>
</code></td></tr><tr><td id="L7928" class="css-a4x74f"><span>7928</span></td><td id="LC7928" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.plyr) {
</code></td></tr><tr><td id="L7929" class="css-a4x74f"><span>7929</span></td><td id="LC7929" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Target already setup'</span>);
</code></td></tr><tr><td id="L7930" class="css-a4x74f"><span>7930</span></td><td id="LC7930" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7931" class="css-a4x74f"><span>7931</span></td><td id="LC7931" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7932" class="css-a4x74f"><span>7932</span></td><td id="LC7932" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7933" class="css-a4x74f"><span>7933</span></td><td id="LC7933" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if not enabled</span>
</code></td></tr><tr><td id="L7934" class="css-a4x74f"><span>7934</span></td><td id="LC7934" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.config.enabled) {
</code></td></tr><tr><td id="L7935" class="css-a4x74f"><span>7935</span></td><td id="LC7935" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: disabled by config'</span>);
</code></td></tr><tr><td id="L7936" class="css-a4x74f"><span>7936</span></td><td id="LC7936" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7937" class="css-a4x74f"><span>7937</span></td><td id="LC7937" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7938" class="css-a4x74f"><span>7938</span></td><td id="LC7938" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7939" class="css-a4x74f"><span>7939</span></td><td id="LC7939" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if disabled or no basic support</span>
</code></td></tr><tr><td id="L7940" class="css-a4x74f"><span>7940</span></td><td id="LC7940" class="css-1dcdqdg"><code>      <span class="code-comment">// You may want to disable certain UAs etc</span>
</code></td></tr><tr><td id="L7941" class="css-a4x74f"><span>7941</span></td><td id="LC7941" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!support.check().api) {
</code></td></tr><tr><td id="L7942" class="css-a4x74f"><span>7942</span></td><td id="LC7942" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: no support'</span>);
</code></td></tr><tr><td id="L7943" class="css-a4x74f"><span>7943</span></td><td id="LC7943" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L7944" class="css-a4x74f"><span>7944</span></td><td id="LC7944" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L7945" class="css-a4x74f"><span>7945</span></td><td id="LC7945" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7946" class="css-a4x74f"><span>7946</span></td><td id="LC7946" class="css-1dcdqdg"><code>      <span class="code-comment">// Cache original element state for .destroy()</span>
</code></td></tr><tr><td id="L7947" class="css-a4x74f"><span>7947</span></td><td id="LC7947" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> clone = <span class="code-keyword">this</span>.media.cloneNode(<span class="code-literal">true</span>);
</code></td></tr><tr><td id="L7948" class="css-a4x74f"><span>7948</span></td><td id="LC7948" class="css-1dcdqdg"><code>      clone.autoplay = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L7949" class="css-a4x74f"><span>7949</span></td><td id="LC7949" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.elements.original = clone;
</code></td></tr><tr><td id="L7950" class="css-a4x74f"><span>7950</span></td><td id="LC7950" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7951" class="css-a4x74f"><span>7951</span></td><td id="LC7951" class="css-1dcdqdg"><code>      <span class="code-comment">// Set media type based on tag or data attribute</span>
</code></td></tr><tr><td id="L7952" class="css-a4x74f"><span>7952</span></td><td id="LC7952" class="css-1dcdqdg"><code>      <span class="code-comment">// Supported: video, audio, vimeo, youtube</span>
</code></td></tr><tr><td id="L7953" class="css-a4x74f"><span>7953</span></td><td id="LC7953" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> _type = <span class="code-keyword">this</span>.media.tagName.toLowerCase();
</code></td></tr><tr><td id="L7954" class="css-a4x74f"><span>7954</span></td><td id="LC7954" class="css-1dcdqdg"><code>      <span class="code-comment">// Embed properties</span>
</code></td></tr><tr><td id="L7955" class="css-a4x74f"><span>7955</span></td><td id="LC7955" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> iframe = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7956" class="css-a4x74f"><span>7956</span></td><td id="LC7956" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> url = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L7957" class="css-a4x74f"><span>7957</span></td><td id="LC7957" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7958" class="css-a4x74f"><span>7958</span></td><td id="LC7958" class="css-1dcdqdg"><code>      <span class="code-comment">// Different setup based on type</span>
</code></td></tr><tr><td id="L7959" class="css-a4x74f"><span>7959</span></td><td id="LC7959" class="css-1dcdqdg"><code>      <span class="code-keyword">switch</span> (_type) {
</code></td></tr><tr><td id="L7960" class="css-a4x74f"><span>7960</span></td><td id="LC7960" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'div'</span>:
</code></td></tr><tr><td id="L7961" class="css-a4x74f"><span>7961</span></td><td id="LC7961" class="css-1dcdqdg"><code>          <span class="code-comment">// Find the frame</span>
</code></td></tr><tr><td id="L7962" class="css-a4x74f"><span>7962</span></td><td id="LC7962" class="css-1dcdqdg"><code>          iframe = <span class="code-keyword">this</span>.media.querySelector(<span class="code-string">'iframe'</span>);
</code></td></tr><tr><td id="L7963" class="css-a4x74f"><span>7963</span></td><td id="LC7963" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7964" class="css-a4x74f"><span>7964</span></td><td id="LC7964" class="css-1dcdqdg"><code>          <span class="code-comment">// &lt;iframe&gt; type</span>
</code></td></tr><tr><td id="L7965" class="css-a4x74f"><span>7965</span></td><td id="LC7965" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.element(iframe)) {
</code></td></tr><tr><td id="L7966" class="css-a4x74f"><span>7966</span></td><td id="LC7966" class="css-1dcdqdg"><code>            <span class="code-comment">// Detect provider</span>
</code></td></tr><tr><td id="L7967" class="css-a4x74f"><span>7967</span></td><td id="LC7967" class="css-1dcdqdg"><code>            url = parseUrl(iframe.getAttribute(<span class="code-string">'src'</span>));
</code></td></tr><tr><td id="L7968" class="css-a4x74f"><span>7968</span></td><td id="LC7968" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.provider = getProviderByUrl(url.toString());
</code></td></tr><tr><td id="L7969" class="css-a4x74f"><span>7969</span></td><td id="LC7969" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7970" class="css-a4x74f"><span>7970</span></td><td id="LC7970" class="css-1dcdqdg"><code>            <span class="code-comment">// Rework elements</span>
</code></td></tr><tr><td id="L7971" class="css-a4x74f"><span>7971</span></td><td id="LC7971" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.container = <span class="code-keyword">this</span>.media;
</code></td></tr><tr><td id="L7972" class="css-a4x74f"><span>7972</span></td><td id="LC7972" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media = iframe;
</code></td></tr><tr><td id="L7973" class="css-a4x74f"><span>7973</span></td><td id="LC7973" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7974" class="css-a4x74f"><span>7974</span></td><td id="LC7974" class="css-1dcdqdg"><code>            <span class="code-comment">// Reset classname</span>
</code></td></tr><tr><td id="L7975" class="css-a4x74f"><span>7975</span></td><td id="LC7975" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.elements.container.className = <span class="code-string">''</span>;
</code></td></tr><tr><td id="L7976" class="css-a4x74f"><span>7976</span></td><td id="LC7976" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7977" class="css-a4x74f"><span>7977</span></td><td id="LC7977" class="css-1dcdqdg"><code>            <span class="code-comment">// Get attributes from URL and set config</span>
</code></td></tr><tr><td id="L7978" class="css-a4x74f"><span>7978</span></td><td id="LC7978" class="css-1dcdqdg"><code>            <span class="code-keyword">if</span> (url.search.length) {
</code></td></tr><tr><td id="L7979" class="css-a4x74f"><span>7979</span></td><td id="LC7979" class="css-1dcdqdg"><code>              <span class="code-keyword">const</span> truthy = [<span class="code-string">'1'</span>, <span class="code-string">'true'</span>];
</code></td></tr><tr><td id="L7980" class="css-a4x74f"><span>7980</span></td><td id="LC7980" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (truthy.includes(url.searchParams.get(<span class="code-string">'autoplay'</span>))) {
</code></td></tr><tr><td id="L7981" class="css-a4x74f"><span>7981</span></td><td id="LC7981" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.config.autoplay = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7982" class="css-a4x74f"><span>7982</span></td><td id="LC7982" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7983" class="css-a4x74f"><span>7983</span></td><td id="LC7983" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (truthy.includes(url.searchParams.get(<span class="code-string">'loop'</span>))) {
</code></td></tr><tr><td id="L7984" class="css-a4x74f"><span>7984</span></td><td id="LC7984" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.config.loop.active = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7985" class="css-a4x74f"><span>7985</span></td><td id="LC7985" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7986" class="css-a4x74f"><span>7986</span></td><td id="LC7986" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L7987" class="css-a4x74f"><span>7987</span></td><td id="LC7987" class="css-1dcdqdg"><code>              <span class="code-comment">// <span class="code-doctag">TODO:</span> replace fullscreen.iosNative with this playsinline config option</span>
</code></td></tr><tr><td id="L7988" class="css-a4x74f"><span>7988</span></td><td id="LC7988" class="css-1dcdqdg"><code>              <span class="code-comment">// YouTube requires the playsinline in the URL</span>
</code></td></tr><tr><td id="L7989" class="css-a4x74f"><span>7989</span></td><td id="LC7989" class="css-1dcdqdg"><code>              <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isYouTube) {
</code></td></tr><tr><td id="L7990" class="css-a4x74f"><span>7990</span></td><td id="LC7990" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.config.playsinline = truthy.includes(url.searchParams.get(<span class="code-string">'playsinline'</span>));
</code></td></tr><tr><td id="L7991" class="css-a4x74f"><span>7991</span></td><td id="LC7991" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.config.youtube.hl = url.searchParams.get(<span class="code-string">'hl'</span>); <span class="code-comment">// <span class="code-doctag">TODO:</span> Should this be setting language?</span>
</code></td></tr><tr><td id="L7992" class="css-a4x74f"><span>7992</span></td><td id="LC7992" class="css-1dcdqdg"><code>              } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7993" class="css-a4x74f"><span>7993</span></td><td id="LC7993" class="css-1dcdqdg"><code>                <span class="code-keyword">this</span>.config.playsinline = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L7994" class="css-a4x74f"><span>7994</span></td><td id="LC7994" class="css-1dcdqdg"><code>              }
</code></td></tr><tr><td id="L7995" class="css-a4x74f"><span>7995</span></td><td id="LC7995" class="css-1dcdqdg"><code>            }
</code></td></tr><tr><td id="L7996" class="css-a4x74f"><span>7996</span></td><td id="LC7996" class="css-1dcdqdg"><code>          } <span class="code-keyword">else</span> {
</code></td></tr><tr><td id="L7997" class="css-a4x74f"><span>7997</span></td><td id="LC7997" class="css-1dcdqdg"><code>            <span class="code-comment">// &lt;div&gt; with attributes</span>
</code></td></tr><tr><td id="L7998" class="css-a4x74f"><span>7998</span></td><td id="LC7998" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.provider = <span class="code-keyword">this</span>.media.getAttribute(<span class="code-keyword">this</span>.config.attributes.embed.provider);
</code></td></tr><tr><td id="L7999" class="css-a4x74f"><span>7999</span></td><td id="LC7999" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8000" class="css-a4x74f"><span>8000</span></td><td id="LC8000" class="css-1dcdqdg"><code>            <span class="code-comment">// Remove attribute</span>
</code></td></tr><tr><td id="L8001" class="css-a4x74f"><span>8001</span></td><td id="LC8001" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.media.removeAttribute(<span class="code-keyword">this</span>.config.attributes.embed.provider);
</code></td></tr><tr><td id="L8002" class="css-a4x74f"><span>8002</span></td><td id="LC8002" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8003" class="css-a4x74f"><span>8003</span></td><td id="LC8003" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8004" class="css-a4x74f"><span>8004</span></td><td id="LC8004" class="css-1dcdqdg"><code>          <span class="code-comment">// Unsupported or missing provider</span>
</code></td></tr><tr><td id="L8005" class="css-a4x74f"><span>8005</span></td><td id="LC8005" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (is.empty(<span class="code-keyword">this</span>.provider) || !<span class="code-built_in">Object</span>.values(providers).includes(<span class="code-keyword">this</span>.provider)) {
</code></td></tr><tr><td id="L8006" class="css-a4x74f"><span>8006</span></td><td id="LC8006" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: Invalid provider'</span>);
</code></td></tr><tr><td id="L8007" class="css-a4x74f"><span>8007</span></td><td id="LC8007" class="css-1dcdqdg"><code>            <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8008" class="css-a4x74f"><span>8008</span></td><td id="LC8008" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8009" class="css-a4x74f"><span>8009</span></td><td id="LC8009" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8010" class="css-a4x74f"><span>8010</span></td><td id="LC8010" class="css-1dcdqdg"><code>          <span class="code-comment">// Audio will come later for external providers</span>
</code></td></tr><tr><td id="L8011" class="css-a4x74f"><span>8011</span></td><td id="LC8011" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.type = types.video;
</code></td></tr><tr><td id="L8012" class="css-a4x74f"><span>8012</span></td><td id="LC8012" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L8013" class="css-a4x74f"><span>8013</span></td><td id="LC8013" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'video'</span>:
</code></td></tr><tr><td id="L8014" class="css-a4x74f"><span>8014</span></td><td id="LC8014" class="css-1dcdqdg"><code>        <span class="code-keyword">case</span> <span class="code-string">'audio'</span>:
</code></td></tr><tr><td id="L8015" class="css-a4x74f"><span>8015</span></td><td id="LC8015" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.type = _type;
</code></td></tr><tr><td id="L8016" class="css-a4x74f"><span>8016</span></td><td id="LC8016" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.provider = providers.html5;
</code></td></tr><tr><td id="L8017" class="css-a4x74f"><span>8017</span></td><td id="LC8017" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8018" class="css-a4x74f"><span>8018</span></td><td id="LC8018" class="css-1dcdqdg"><code>          <span class="code-comment">// Get config from attributes</span>
</code></td></tr><tr><td id="L8019" class="css-a4x74f"><span>8019</span></td><td id="LC8019" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'crossorigin'</span>)) {
</code></td></tr><tr><td id="L8020" class="css-a4x74f"><span>8020</span></td><td id="LC8020" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.config.crossorigin = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8021" class="css-a4x74f"><span>8021</span></td><td id="LC8021" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8022" class="css-a4x74f"><span>8022</span></td><td id="LC8022" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'autoplay'</span>)) {
</code></td></tr><tr><td id="L8023" class="css-a4x74f"><span>8023</span></td><td id="LC8023" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.config.autoplay = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8024" class="css-a4x74f"><span>8024</span></td><td id="LC8024" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8025" class="css-a4x74f"><span>8025</span></td><td id="LC8025" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'playsinline'</span>) || <span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'webkit-playsinline'</span>)) {
</code></td></tr><tr><td id="L8026" class="css-a4x74f"><span>8026</span></td><td id="LC8026" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.config.playsinline = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8027" class="css-a4x74f"><span>8027</span></td><td id="LC8027" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8028" class="css-a4x74f"><span>8028</span></td><td id="LC8028" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'muted'</span>)) {
</code></td></tr><tr><td id="L8029" class="css-a4x74f"><span>8029</span></td><td id="LC8029" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.config.muted = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8030" class="css-a4x74f"><span>8030</span></td><td id="LC8030" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8031" class="css-a4x74f"><span>8031</span></td><td id="LC8031" class="css-1dcdqdg"><code>          <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media.hasAttribute(<span class="code-string">'loop'</span>)) {
</code></td></tr><tr><td id="L8032" class="css-a4x74f"><span>8032</span></td><td id="LC8032" class="css-1dcdqdg"><code>            <span class="code-keyword">this</span>.config.loop.active = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8033" class="css-a4x74f"><span>8033</span></td><td id="LC8033" class="css-1dcdqdg"><code>          }
</code></td></tr><tr><td id="L8034" class="css-a4x74f"><span>8034</span></td><td id="LC8034" class="css-1dcdqdg"><code>          <span class="code-keyword">break</span>;
</code></td></tr><tr><td id="L8035" class="css-a4x74f"><span>8035</span></td><td id="LC8035" class="css-1dcdqdg"><code>        <span class="code-keyword">default</span>:
</code></td></tr><tr><td id="L8036" class="css-a4x74f"><span>8036</span></td><td id="LC8036" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: unsupported type'</span>);
</code></td></tr><tr><td id="L8037" class="css-a4x74f"><span>8037</span></td><td id="LC8037" class="css-1dcdqdg"><code>          <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8038" class="css-a4x74f"><span>8038</span></td><td id="LC8038" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8039" class="css-a4x74f"><span>8039</span></td><td id="LC8039" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8040" class="css-a4x74f"><span>8040</span></td><td id="LC8040" class="css-1dcdqdg"><code>      <span class="code-comment">// Check for support again but with type</span>
</code></td></tr><tr><td id="L8041" class="css-a4x74f"><span>8041</span></td><td id="LC8041" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.supported = support.check(<span class="code-keyword">this</span>.type, <span class="code-keyword">this</span>.provider);
</code></td></tr><tr><td id="L8042" class="css-a4x74f"><span>8042</span></td><td id="LC8042" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8043" class="css-a4x74f"><span>8043</span></td><td id="LC8043" class="css-1dcdqdg"><code>      <span class="code-comment">// If no support for even API, bail</span>
</code></td></tr><tr><td id="L8044" class="css-a4x74f"><span>8044</span></td><td id="LC8044" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.supported.api) {
</code></td></tr><tr><td id="L8045" class="css-a4x74f"><span>8045</span></td><td id="LC8045" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.error(<span class="code-string">'Setup failed: no support'</span>);
</code></td></tr><tr><td id="L8046" class="css-a4x74f"><span>8046</span></td><td id="LC8046" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8047" class="css-a4x74f"><span>8047</span></td><td id="LC8047" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8048" class="css-a4x74f"><span>8048</span></td><td id="LC8048" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.eventListeners = [];
</code></td></tr><tr><td id="L8049" class="css-a4x74f"><span>8049</span></td><td id="LC8049" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8050" class="css-a4x74f"><span>8050</span></td><td id="LC8050" class="css-1dcdqdg"><code>      <span class="code-comment">// Create listeners</span>
</code></td></tr><tr><td id="L8051" class="css-a4x74f"><span>8051</span></td><td id="LC8051" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.listeners = <span class="code-keyword">new</span> Listeners(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8052" class="css-a4x74f"><span>8052</span></td><td id="LC8052" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8053" class="css-a4x74f"><span>8053</span></td><td id="LC8053" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup local storage for user settings</span>
</code></td></tr><tr><td id="L8054" class="css-a4x74f"><span>8054</span></td><td id="LC8054" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.storage = <span class="code-keyword">new</span> Storage(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8055" class="css-a4x74f"><span>8055</span></td><td id="LC8055" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8056" class="css-a4x74f"><span>8056</span></td><td id="LC8056" class="css-1dcdqdg"><code>      <span class="code-comment">// Store reference</span>
</code></td></tr><tr><td id="L8057" class="css-a4x74f"><span>8057</span></td><td id="LC8057" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.plyr = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L8058" class="css-a4x74f"><span>8058</span></td><td id="LC8058" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8059" class="css-a4x74f"><span>8059</span></td><td id="LC8059" class="css-1dcdqdg"><code>      <span class="code-comment">// Wrap media</span>
</code></td></tr><tr><td id="L8060" class="css-a4x74f"><span>8060</span></td><td id="LC8060" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.element(<span class="code-keyword">this</span>.elements.container)) {
</code></td></tr><tr><td id="L8061" class="css-a4x74f"><span>8061</span></td><td id="LC8061" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.elements.container = createElement(<span class="code-string">'div'</span>);
</code></td></tr><tr><td id="L8062" class="css-a4x74f"><span>8062</span></td><td id="LC8062" class="css-1dcdqdg"><code>        wrap(<span class="code-keyword">this</span>.media, <span class="code-keyword">this</span>.elements.container);
</code></td></tr><tr><td id="L8063" class="css-a4x74f"><span>8063</span></td><td id="LC8063" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8064" class="css-a4x74f"><span>8064</span></td><td id="LC8064" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8065" class="css-a4x74f"><span>8065</span></td><td id="LC8065" class="css-1dcdqdg"><code>      <span class="code-comment">// Migrate custom properties from media to container (so they work 😉)</span>
</code></td></tr><tr><td id="L8066" class="css-a4x74f"><span>8066</span></td><td id="LC8066" class="css-1dcdqdg"><code>      ui.migrateStyles.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8067" class="css-a4x74f"><span>8067</span></td><td id="LC8067" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8068" class="css-a4x74f"><span>8068</span></td><td id="LC8068" class="css-1dcdqdg"><code>      <span class="code-comment">// Add style hook</span>
</code></td></tr><tr><td id="L8069" class="css-a4x74f"><span>8069</span></td><td id="LC8069" class="css-1dcdqdg"><code>      ui.addStyleHook.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8070" class="css-a4x74f"><span>8070</span></td><td id="LC8070" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8071" class="css-a4x74f"><span>8071</span></td><td id="LC8071" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup media</span>
</code></td></tr><tr><td id="L8072" class="css-a4x74f"><span>8072</span></td><td id="LC8072" class="css-1dcdqdg"><code>      media.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8073" class="css-a4x74f"><span>8073</span></td><td id="LC8073" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8074" class="css-a4x74f"><span>8074</span></td><td id="LC8074" class="css-1dcdqdg"><code>      <span class="code-comment">// Listen for events if debugging</span>
</code></td></tr><tr><td id="L8075" class="css-a4x74f"><span>8075</span></td><td id="LC8075" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.debug) {
</code></td></tr><tr><td id="L8076" class="css-a4x74f"><span>8076</span></td><td id="LC8076" class="css-1dcdqdg"><code>        on.call(<span class="code-keyword">this</span>, <span class="code-keyword">this</span>.elements.container, <span class="code-keyword">this</span>.config.events.join(<span class="code-string">' '</span>), event =&gt; {
</code></td></tr><tr><td id="L8077" class="css-a4x74f"><span>8077</span></td><td id="LC8077" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.debug.log(<span class="code-string">`event: <span class="code-subst">${event.type}</span>`</span>);
</code></td></tr><tr><td id="L8078" class="css-a4x74f"><span>8078</span></td><td id="LC8078" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L8079" class="css-a4x74f"><span>8079</span></td><td id="LC8079" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8080" class="css-a4x74f"><span>8080</span></td><td id="LC8080" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8081" class="css-a4x74f"><span>8081</span></td><td id="LC8081" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup fullscreen</span>
</code></td></tr><tr><td id="L8082" class="css-a4x74f"><span>8082</span></td><td id="LC8082" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.fullscreen = <span class="code-keyword">new</span> Fullscreen(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8083" class="css-a4x74f"><span>8083</span></td><td id="LC8083" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8084" class="css-a4x74f"><span>8084</span></td><td id="LC8084" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup interface</span>
</code></td></tr><tr><td id="L8085" class="css-a4x74f"><span>8085</span></td><td id="LC8085" class="css-1dcdqdg"><code>      <span class="code-comment">// If embed but not fully supported, build interface now to avoid flash of controls</span>
</code></td></tr><tr><td id="L8086" class="css-a4x74f"><span>8086</span></td><td id="LC8086" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5 || <span class="code-keyword">this</span>.isEmbed &amp;&amp; !<span class="code-keyword">this</span>.supported.ui) {
</code></td></tr><tr><td id="L8087" class="css-a4x74f"><span>8087</span></td><td id="LC8087" class="css-1dcdqdg"><code>        ui.build.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8088" class="css-a4x74f"><span>8088</span></td><td id="LC8088" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8089" class="css-a4x74f"><span>8089</span></td><td id="LC8089" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8090" class="css-a4x74f"><span>8090</span></td><td id="LC8090" class="css-1dcdqdg"><code>      <span class="code-comment">// Container listeners</span>
</code></td></tr><tr><td id="L8091" class="css-a4x74f"><span>8091</span></td><td id="LC8091" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.listeners.container();
</code></td></tr><tr><td id="L8092" class="css-a4x74f"><span>8092</span></td><td id="LC8092" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8093" class="css-a4x74f"><span>8093</span></td><td id="LC8093" class="css-1dcdqdg"><code>      <span class="code-comment">// Global listeners</span>
</code></td></tr><tr><td id="L8094" class="css-a4x74f"><span>8094</span></td><td id="LC8094" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.listeners.global();
</code></td></tr><tr><td id="L8095" class="css-a4x74f"><span>8095</span></td><td id="LC8095" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8096" class="css-a4x74f"><span>8096</span></td><td id="LC8096" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup ads if provided</span>
</code></td></tr><tr><td id="L8097" class="css-a4x74f"><span>8097</span></td><td id="LC8097" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.ads.enabled) {
</code></td></tr><tr><td id="L8098" class="css-a4x74f"><span>8098</span></td><td id="LC8098" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.ads = <span class="code-keyword">new</span> Ads(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8099" class="css-a4x74f"><span>8099</span></td><td id="LC8099" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8100" class="css-a4x74f"><span>8100</span></td><td id="LC8100" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8101" class="css-a4x74f"><span>8101</span></td><td id="LC8101" class="css-1dcdqdg"><code>      <span class="code-comment">// Autoplay if required</span>
</code></td></tr><tr><td id="L8102" class="css-a4x74f"><span>8102</span></td><td id="LC8102" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isHTML5 &amp;&amp; <span class="code-keyword">this</span>.config.autoplay) {
</code></td></tr><tr><td id="L8103" class="css-a4x74f"><span>8103</span></td><td id="LC8103" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.once(<span class="code-string">'canplay'</span>, () =&gt; silencePromise(<span class="code-keyword">this</span>.play()));
</code></td></tr><tr><td id="L8104" class="css-a4x74f"><span>8104</span></td><td id="LC8104" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8105" class="css-a4x74f"><span>8105</span></td><td id="LC8105" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8106" class="css-a4x74f"><span>8106</span></td><td id="LC8106" class="css-1dcdqdg"><code>      <span class="code-comment">// Seek time will be recorded (in listeners.js) so we can prevent hiding controls for a few seconds after seek</span>
</code></td></tr><tr><td id="L8107" class="css-a4x74f"><span>8107</span></td><td id="LC8107" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.lastSeekTime = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L8108" class="css-a4x74f"><span>8108</span></td><td id="LC8108" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8109" class="css-a4x74f"><span>8109</span></td><td id="LC8109" class="css-1dcdqdg"><code>      <span class="code-comment">// Setup preview thumbnails if enabled</span>
</code></td></tr><tr><td id="L8110" class="css-a4x74f"><span>8110</span></td><td id="LC8110" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.previewThumbnails.enabled) {
</code></td></tr><tr><td id="L8111" class="css-a4x74f"><span>8111</span></td><td id="LC8111" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.previewThumbnails = <span class="code-keyword">new</span> PreviewThumbnails(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8112" class="css-a4x74f"><span>8112</span></td><td id="LC8112" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8113" class="css-a4x74f"><span>8113</span></td><td id="LC8113" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8114" class="css-a4x74f"><span>8114</span></td><td id="LC8114" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8115" class="css-a4x74f"><span>8115</span></td><td id="LC8115" class="css-1dcdqdg"><code>    <span class="code-comment">// ---------------------------------------</span>
</code></td></tr><tr><td id="L8116" class="css-a4x74f"><span>8116</span></td><td id="LC8116" class="css-1dcdqdg"><code>    <span class="code-comment">// API</span>
</code></td></tr><tr><td id="L8117" class="css-a4x74f"><span>8117</span></td><td id="LC8117" class="css-1dcdqdg"><code>    <span class="code-comment">// ---------------------------------------</span>
</code></td></tr><tr><td id="L8118" class="css-a4x74f"><span>8118</span></td><td id="LC8118" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8119" class="css-a4x74f"><span>8119</span></td><td id="LC8119" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8120" class="css-a4x74f"><span>8120</span></td><td id="LC8120" class="css-1dcdqdg"><code><span class="code-comment">     * Types and provider helpers
</span></code></td></tr><tr><td id="L8121" class="css-a4x74f"><span>8121</span></td><td id="LC8121" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8122" class="css-a4x74f"><span>8122</span></td><td id="LC8122" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isHTML5() {
</code></td></tr><tr><td id="L8123" class="css-a4x74f"><span>8123</span></td><td id="LC8123" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.provider === providers.html5;
</code></td></tr><tr><td id="L8124" class="css-a4x74f"><span>8124</span></td><td id="LC8124" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8125" class="css-a4x74f"><span>8125</span></td><td id="LC8125" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isEmbed() {
</code></td></tr><tr><td id="L8126" class="css-a4x74f"><span>8126</span></td><td id="LC8126" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.isYouTube || <span class="code-keyword">this</span>.isVimeo;
</code></td></tr><tr><td id="L8127" class="css-a4x74f"><span>8127</span></td><td id="LC8127" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8128" class="css-a4x74f"><span>8128</span></td><td id="LC8128" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isYouTube() {
</code></td></tr><tr><td id="L8129" class="css-a4x74f"><span>8129</span></td><td id="LC8129" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.provider === providers.youtube;
</code></td></tr><tr><td id="L8130" class="css-a4x74f"><span>8130</span></td><td id="LC8130" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8131" class="css-a4x74f"><span>8131</span></td><td id="LC8131" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isVimeo() {
</code></td></tr><tr><td id="L8132" class="css-a4x74f"><span>8132</span></td><td id="LC8132" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.provider === providers.vimeo;
</code></td></tr><tr><td id="L8133" class="css-a4x74f"><span>8133</span></td><td id="LC8133" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8134" class="css-a4x74f"><span>8134</span></td><td id="LC8134" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isVideo() {
</code></td></tr><tr><td id="L8135" class="css-a4x74f"><span>8135</span></td><td id="LC8135" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.type === types.video;
</code></td></tr><tr><td id="L8136" class="css-a4x74f"><span>8136</span></td><td id="LC8136" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8137" class="css-a4x74f"><span>8137</span></td><td id="LC8137" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> isAudio() {
</code></td></tr><tr><td id="L8138" class="css-a4x74f"><span>8138</span></td><td id="LC8138" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.type === types.audio;
</code></td></tr><tr><td id="L8139" class="css-a4x74f"><span>8139</span></td><td id="LC8139" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8140" class="css-a4x74f"><span>8140</span></td><td id="LC8140" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8141" class="css-a4x74f"><span>8141</span></td><td id="LC8141" class="css-1dcdqdg"><code><span class="code-comment">     * Get playing state
</span></code></td></tr><tr><td id="L8142" class="css-a4x74f"><span>8142</span></td><td id="LC8142" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8143" class="css-a4x74f"><span>8143</span></td><td id="LC8143" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> playing() {
</code></td></tr><tr><td id="L8144" class="css-a4x74f"><span>8144</span></td><td id="LC8144" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.ready &amp;&amp; !<span class="code-keyword">this</span>.paused &amp;&amp; !<span class="code-keyword">this</span>.ended);
</code></td></tr><tr><td id="L8145" class="css-a4x74f"><span>8145</span></td><td id="LC8145" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8146" class="css-a4x74f"><span>8146</span></td><td id="LC8146" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8147" class="css-a4x74f"><span>8147</span></td><td id="LC8147" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8148" class="css-a4x74f"><span>8148</span></td><td id="LC8148" class="css-1dcdqdg"><code><span class="code-comment">     * Get paused state
</span></code></td></tr><tr><td id="L8149" class="css-a4x74f"><span>8149</span></td><td id="LC8149" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8150" class="css-a4x74f"><span>8150</span></td><td id="LC8150" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> paused() {
</code></td></tr><tr><td id="L8151" class="css-a4x74f"><span>8151</span></td><td id="LC8151" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.paused);
</code></td></tr><tr><td id="L8152" class="css-a4x74f"><span>8152</span></td><td id="LC8152" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8153" class="css-a4x74f"><span>8153</span></td><td id="LC8153" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8154" class="css-a4x74f"><span>8154</span></td><td id="LC8154" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8155" class="css-a4x74f"><span>8155</span></td><td id="LC8155" class="css-1dcdqdg"><code><span class="code-comment">     * Get stopped state
</span></code></td></tr><tr><td id="L8156" class="css-a4x74f"><span>8156</span></td><td id="LC8156" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8157" class="css-a4x74f"><span>8157</span></td><td id="LC8157" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> stopped() {
</code></td></tr><tr><td id="L8158" class="css-a4x74f"><span>8158</span></td><td id="LC8158" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.paused &amp;&amp; <span class="code-keyword">this</span>.currentTime === <span class="code-number">0</span>);
</code></td></tr><tr><td id="L8159" class="css-a4x74f"><span>8159</span></td><td id="LC8159" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8160" class="css-a4x74f"><span>8160</span></td><td id="LC8160" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8161" class="css-a4x74f"><span>8161</span></td><td id="LC8161" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8162" class="css-a4x74f"><span>8162</span></td><td id="LC8162" class="css-1dcdqdg"><code><span class="code-comment">     * Get ended state
</span></code></td></tr><tr><td id="L8163" class="css-a4x74f"><span>8163</span></td><td id="LC8163" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8164" class="css-a4x74f"><span>8164</span></td><td id="LC8164" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> ended() {
</code></td></tr><tr><td id="L8165" class="css-a4x74f"><span>8165</span></td><td id="LC8165" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.ended);
</code></td></tr><tr><td id="L8166" class="css-a4x74f"><span>8166</span></td><td id="LC8166" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8167" class="css-a4x74f"><span>8167</span></td><td id="LC8167" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8168" class="css-a4x74f"><span>8168</span></td><td id="LC8168" class="css-1dcdqdg"><code><span class="code-comment">     * Seek to a time
</span></code></td></tr><tr><td id="L8169" class="css-a4x74f"><span>8169</span></td><td id="LC8169" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Number} input - where to seek to in seconds. Defaults to 0 (the start)
</span></code></td></tr><tr><td id="L8170" class="css-a4x74f"><span>8170</span></td><td id="LC8170" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8171" class="css-a4x74f"><span>8171</span></td><td id="LC8171" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> currentTime(input) {
</code></td></tr><tr><td id="L8172" class="css-a4x74f"><span>8172</span></td><td id="LC8172" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if media duration isn't available yet</span>
</code></td></tr><tr><td id="L8173" class="css-a4x74f"><span>8173</span></td><td id="LC8173" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.duration) {
</code></td></tr><tr><td id="L8174" class="css-a4x74f"><span>8174</span></td><td id="LC8174" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8175" class="css-a4x74f"><span>8175</span></td><td id="LC8175" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8176" class="css-a4x74f"><span>8176</span></td><td id="LC8176" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8177" class="css-a4x74f"><span>8177</span></td><td id="LC8177" class="css-1dcdqdg"><code>      <span class="code-comment">// Validate input</span>
</code></td></tr><tr><td id="L8178" class="css-a4x74f"><span>8178</span></td><td id="LC8178" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> inputIsValid = is.number(input) &amp;&amp; input &gt; <span class="code-number">0</span>;
</code></td></tr><tr><td id="L8179" class="css-a4x74f"><span>8179</span></td><td id="LC8179" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8180" class="css-a4x74f"><span>8180</span></td><td id="LC8180" class="css-1dcdqdg"><code>      <span class="code-comment">// Set</span>
</code></td></tr><tr><td id="L8181" class="css-a4x74f"><span>8181</span></td><td id="LC8181" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.currentTime = inputIsValid ? <span class="code-built_in">Math</span>.min(input, <span class="code-keyword">this</span>.duration) : <span class="code-number">0</span>;
</code></td></tr><tr><td id="L8182" class="css-a4x74f"><span>8182</span></td><td id="LC8182" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8183" class="css-a4x74f"><span>8183</span></td><td id="LC8183" class="css-1dcdqdg"><code>      <span class="code-comment">// Logging</span>
</code></td></tr><tr><td id="L8184" class="css-a4x74f"><span>8184</span></td><td id="LC8184" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.debug.log(<span class="code-string">`Seeking to <span class="code-subst">${<span class="code-keyword">this</span>.currentTime}</span> seconds`</span>);
</code></td></tr><tr><td id="L8185" class="css-a4x74f"><span>8185</span></td><td id="LC8185" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8186" class="css-a4x74f"><span>8186</span></td><td id="LC8186" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8187" class="css-a4x74f"><span>8187</span></td><td id="LC8187" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8188" class="css-a4x74f"><span>8188</span></td><td id="LC8188" class="css-1dcdqdg"><code><span class="code-comment">     * Get current time
</span></code></td></tr><tr><td id="L8189" class="css-a4x74f"><span>8189</span></td><td id="LC8189" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8190" class="css-a4x74f"><span>8190</span></td><td id="LC8190" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> currentTime() {
</code></td></tr><tr><td id="L8191" class="css-a4x74f"><span>8191</span></td><td id="LC8191" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Number</span>(<span class="code-keyword">this</span>.media.currentTime);
</code></td></tr><tr><td id="L8192" class="css-a4x74f"><span>8192</span></td><td id="LC8192" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8193" class="css-a4x74f"><span>8193</span></td><td id="LC8193" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8194" class="css-a4x74f"><span>8194</span></td><td id="LC8194" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8195" class="css-a4x74f"><span>8195</span></td><td id="LC8195" class="css-1dcdqdg"><code><span class="code-comment">     * Get buffered
</span></code></td></tr><tr><td id="L8196" class="css-a4x74f"><span>8196</span></td><td id="LC8196" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8197" class="css-a4x74f"><span>8197</span></td><td id="LC8197" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> buffered() {
</code></td></tr><tr><td id="L8198" class="css-a4x74f"><span>8198</span></td><td id="LC8198" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L8199" class="css-a4x74f"><span>8199</span></td><td id="LC8199" class="css-1dcdqdg"><code>        buffered
</code></td></tr><tr><td id="L8200" class="css-a4x74f"><span>8200</span></td><td id="LC8200" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.media;
</code></td></tr><tr><td id="L8201" class="css-a4x74f"><span>8201</span></td><td id="LC8201" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8202" class="css-a4x74f"><span>8202</span></td><td id="LC8202" class="css-1dcdqdg"><code>      <span class="code-comment">// YouTube / Vimeo return a float between 0-1</span>
</code></td></tr><tr><td id="L8203" class="css-a4x74f"><span>8203</span></td><td id="LC8203" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.number(buffered)) {
</code></td></tr><tr><td id="L8204" class="css-a4x74f"><span>8204</span></td><td id="LC8204" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> buffered;
</code></td></tr><tr><td id="L8205" class="css-a4x74f"><span>8205</span></td><td id="LC8205" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8206" class="css-a4x74f"><span>8206</span></td><td id="LC8206" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8207" class="css-a4x74f"><span>8207</span></td><td id="LC8207" class="css-1dcdqdg"><code>      <span class="code-comment">// HTML5</span>
</code></td></tr><tr><td id="L8208" class="css-a4x74f"><span>8208</span></td><td id="LC8208" class="css-1dcdqdg"><code>      <span class="code-comment">// <span class="code-doctag">TODO:</span> Handle buffered chunks of the media</span>
</code></td></tr><tr><td id="L8209" class="css-a4x74f"><span>8209</span></td><td id="LC8209" class="css-1dcdqdg"><code>      <span class="code-comment">// (i.e. seek to another section buffers only that section)</span>
</code></td></tr><tr><td id="L8210" class="css-a4x74f"><span>8210</span></td><td id="LC8210" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (buffered &amp;&amp; buffered.length &amp;&amp; <span class="code-keyword">this</span>.duration &gt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L8211" class="css-a4x74f"><span>8211</span></td><td id="LC8211" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> buffered.end(<span class="code-number">0</span>) / <span class="code-keyword">this</span>.duration;
</code></td></tr><tr><td id="L8212" class="css-a4x74f"><span>8212</span></td><td id="LC8212" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8213" class="css-a4x74f"><span>8213</span></td><td id="LC8213" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-number">0</span>;
</code></td></tr><tr><td id="L8214" class="css-a4x74f"><span>8214</span></td><td id="LC8214" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8215" class="css-a4x74f"><span>8215</span></td><td id="LC8215" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8216" class="css-a4x74f"><span>8216</span></td><td id="LC8216" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8217" class="css-a4x74f"><span>8217</span></td><td id="LC8217" class="css-1dcdqdg"><code><span class="code-comment">     * Get seeking status
</span></code></td></tr><tr><td id="L8218" class="css-a4x74f"><span>8218</span></td><td id="LC8218" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8219" class="css-a4x74f"><span>8219</span></td><td id="LC8219" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> seeking() {
</code></td></tr><tr><td id="L8220" class="css-a4x74f"><span>8220</span></td><td id="LC8220" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.seeking);
</code></td></tr><tr><td id="L8221" class="css-a4x74f"><span>8221</span></td><td id="LC8221" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8222" class="css-a4x74f"><span>8222</span></td><td id="LC8222" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8223" class="css-a4x74f"><span>8223</span></td><td id="LC8223" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8224" class="css-a4x74f"><span>8224</span></td><td id="LC8224" class="css-1dcdqdg"><code><span class="code-comment">     * Get the duration of the current media
</span></code></td></tr><tr><td id="L8225" class="css-a4x74f"><span>8225</span></td><td id="LC8225" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8226" class="css-a4x74f"><span>8226</span></td><td id="LC8226" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> duration() {
</code></td></tr><tr><td id="L8227" class="css-a4x74f"><span>8227</span></td><td id="LC8227" class="css-1dcdqdg"><code>      <span class="code-comment">// Faux duration set via config</span>
</code></td></tr><tr><td id="L8228" class="css-a4x74f"><span>8228</span></td><td id="LC8228" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> fauxDuration = <span class="code-built_in">parseFloat</span>(<span class="code-keyword">this</span>.config.duration);
</code></td></tr><tr><td id="L8229" class="css-a4x74f"><span>8229</span></td><td id="LC8229" class="css-1dcdqdg"><code>      <span class="code-comment">// Media duration can be NaN or Infinity before the media has loaded</span>
</code></td></tr><tr><td id="L8230" class="css-a4x74f"><span>8230</span></td><td id="LC8230" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> realDuration = (<span class="code-keyword">this</span>.media || {}).duration;
</code></td></tr><tr><td id="L8231" class="css-a4x74f"><span>8231</span></td><td id="LC8231" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> duration = !is.number(realDuration) || realDuration === <span class="code-literal">Infinity</span> ? <span class="code-number">0</span> : realDuration;
</code></td></tr><tr><td id="L8232" class="css-a4x74f"><span>8232</span></td><td id="LC8232" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8233" class="css-a4x74f"><span>8233</span></td><td id="LC8233" class="css-1dcdqdg"><code>      <span class="code-comment">// If config duration is funky, use regular duration</span>
</code></td></tr><tr><td id="L8234" class="css-a4x74f"><span>8234</span></td><td id="LC8234" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> fauxDuration || duration;
</code></td></tr><tr><td id="L8235" class="css-a4x74f"><span>8235</span></td><td id="LC8235" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8236" class="css-a4x74f"><span>8236</span></td><td id="LC8236" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8237" class="css-a4x74f"><span>8237</span></td><td id="LC8237" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8238" class="css-a4x74f"><span>8238</span></td><td id="LC8238" class="css-1dcdqdg"><code><span class="code-comment">     * Set the player volume
</span></code></td></tr><tr><td id="L8239" class="css-a4x74f"><span>8239</span></td><td id="LC8239" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Number} value - must be between 0 and 1. Defaults to the value from local storage and config.volume if not set in storage
</span></code></td></tr><tr><td id="L8240" class="css-a4x74f"><span>8240</span></td><td id="LC8240" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8241" class="css-a4x74f"><span>8241</span></td><td id="LC8241" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> volume(value) {
</code></td></tr><tr><td id="L8242" class="css-a4x74f"><span>8242</span></td><td id="LC8242" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> volume = value;
</code></td></tr><tr><td id="L8243" class="css-a4x74f"><span>8243</span></td><td id="LC8243" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> max = <span class="code-number">1</span>;
</code></td></tr><tr><td id="L8244" class="css-a4x74f"><span>8244</span></td><td id="LC8244" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> min = <span class="code-number">0</span>;
</code></td></tr><tr><td id="L8245" class="css-a4x74f"><span>8245</span></td><td id="LC8245" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(volume)) {
</code></td></tr><tr><td id="L8246" class="css-a4x74f"><span>8246</span></td><td id="LC8246" class="css-1dcdqdg"><code>        volume = <span class="code-built_in">Number</span>(volume);
</code></td></tr><tr><td id="L8247" class="css-a4x74f"><span>8247</span></td><td id="LC8247" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8248" class="css-a4x74f"><span>8248</span></td><td id="LC8248" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8249" class="css-a4x74f"><span>8249</span></td><td id="LC8249" class="css-1dcdqdg"><code>      <span class="code-comment">// Load volume from storage if no value specified</span>
</code></td></tr><tr><td id="L8250" class="css-a4x74f"><span>8250</span></td><td id="LC8250" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(volume)) {
</code></td></tr><tr><td id="L8251" class="css-a4x74f"><span>8251</span></td><td id="LC8251" class="css-1dcdqdg"><code>        volume = <span class="code-keyword">this</span>.storage.get(<span class="code-string">'volume'</span>);
</code></td></tr><tr><td id="L8252" class="css-a4x74f"><span>8252</span></td><td id="LC8252" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8253" class="css-a4x74f"><span>8253</span></td><td id="LC8253" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8254" class="css-a4x74f"><span>8254</span></td><td id="LC8254" class="css-1dcdqdg"><code>      <span class="code-comment">// Use config if all else fails</span>
</code></td></tr><tr><td id="L8255" class="css-a4x74f"><span>8255</span></td><td id="LC8255" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(volume)) {
</code></td></tr><tr><td id="L8256" class="css-a4x74f"><span>8256</span></td><td id="LC8256" class="css-1dcdqdg"><code>        ({
</code></td></tr><tr><td id="L8257" class="css-a4x74f"><span>8257</span></td><td id="LC8257" class="css-1dcdqdg"><code>          volume
</code></td></tr><tr><td id="L8258" class="css-a4x74f"><span>8258</span></td><td id="LC8258" class="css-1dcdqdg"><code>        } = <span class="code-keyword">this</span>.config);
</code></td></tr><tr><td id="L8259" class="css-a4x74f"><span>8259</span></td><td id="LC8259" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8260" class="css-a4x74f"><span>8260</span></td><td id="LC8260" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8261" class="css-a4x74f"><span>8261</span></td><td id="LC8261" class="css-1dcdqdg"><code>      <span class="code-comment">// Maximum is volumeMax</span>
</code></td></tr><tr><td id="L8262" class="css-a4x74f"><span>8262</span></td><td id="LC8262" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (volume &gt; max) {
</code></td></tr><tr><td id="L8263" class="css-a4x74f"><span>8263</span></td><td id="LC8263" class="css-1dcdqdg"><code>        volume = max;
</code></td></tr><tr><td id="L8264" class="css-a4x74f"><span>8264</span></td><td id="LC8264" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8265" class="css-a4x74f"><span>8265</span></td><td id="LC8265" class="css-1dcdqdg"><code>      <span class="code-comment">// Minimum is volumeMin</span>
</code></td></tr><tr><td id="L8266" class="css-a4x74f"><span>8266</span></td><td id="LC8266" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (volume &lt; min) {
</code></td></tr><tr><td id="L8267" class="css-a4x74f"><span>8267</span></td><td id="LC8267" class="css-1dcdqdg"><code>        volume = min;
</code></td></tr><tr><td id="L8268" class="css-a4x74f"><span>8268</span></td><td id="LC8268" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8269" class="css-a4x74f"><span>8269</span></td><td id="LC8269" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8270" class="css-a4x74f"><span>8270</span></td><td id="LC8270" class="css-1dcdqdg"><code>      <span class="code-comment">// Update config</span>
</code></td></tr><tr><td id="L8271" class="css-a4x74f"><span>8271</span></td><td id="LC8271" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.volume = volume;
</code></td></tr><tr><td id="L8272" class="css-a4x74f"><span>8272</span></td><td id="LC8272" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8273" class="css-a4x74f"><span>8273</span></td><td id="LC8273" class="css-1dcdqdg"><code>      <span class="code-comment">// Set the player volume</span>
</code></td></tr><tr><td id="L8274" class="css-a4x74f"><span>8274</span></td><td id="LC8274" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.volume = volume;
</code></td></tr><tr><td id="L8275" class="css-a4x74f"><span>8275</span></td><td id="LC8275" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8276" class="css-a4x74f"><span>8276</span></td><td id="LC8276" class="css-1dcdqdg"><code>      <span class="code-comment">// If muted, and we're increasing volume manually, reset muted state</span>
</code></td></tr><tr><td id="L8277" class="css-a4x74f"><span>8277</span></td><td id="LC8277" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(value) &amp;&amp; <span class="code-keyword">this</span>.muted &amp;&amp; volume &gt; <span class="code-number">0</span>) {
</code></td></tr><tr><td id="L8278" class="css-a4x74f"><span>8278</span></td><td id="LC8278" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.muted = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L8279" class="css-a4x74f"><span>8279</span></td><td id="LC8279" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8280" class="css-a4x74f"><span>8280</span></td><td id="LC8280" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8281" class="css-a4x74f"><span>8281</span></td><td id="LC8281" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8282" class="css-a4x74f"><span>8282</span></td><td id="LC8282" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8283" class="css-a4x74f"><span>8283</span></td><td id="LC8283" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current player volume
</span></code></td></tr><tr><td id="L8284" class="css-a4x74f"><span>8284</span></td><td id="LC8284" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8285" class="css-a4x74f"><span>8285</span></td><td id="LC8285" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> volume() {
</code></td></tr><tr><td id="L8286" class="css-a4x74f"><span>8286</span></td><td id="LC8286" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Number</span>(<span class="code-keyword">this</span>.media.volume);
</code></td></tr><tr><td id="L8287" class="css-a4x74f"><span>8287</span></td><td id="LC8287" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8288" class="css-a4x74f"><span>8288</span></td><td id="LC8288" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8289" class="css-a4x74f"><span>8289</span></td><td id="LC8289" class="css-1dcdqdg"><code><span class="code-comment">     * Set muted state
</span></code></td></tr><tr><td id="L8290" class="css-a4x74f"><span>8290</span></td><td id="LC8290" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Boolean} mute
</span></code></td></tr><tr><td id="L8291" class="css-a4x74f"><span>8291</span></td><td id="LC8291" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8292" class="css-a4x74f"><span>8292</span></td><td id="LC8292" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> muted(mute) {
</code></td></tr><tr><td id="L8293" class="css-a4x74f"><span>8293</span></td><td id="LC8293" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> toggle = mute;
</code></td></tr><tr><td id="L8294" class="css-a4x74f"><span>8294</span></td><td id="LC8294" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8295" class="css-a4x74f"><span>8295</span></td><td id="LC8295" class="css-1dcdqdg"><code>      <span class="code-comment">// Load muted state from storage</span>
</code></td></tr><tr><td id="L8296" class="css-a4x74f"><span>8296</span></td><td id="LC8296" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.boolean(toggle)) {
</code></td></tr><tr><td id="L8297" class="css-a4x74f"><span>8297</span></td><td id="LC8297" class="css-1dcdqdg"><code>        toggle = <span class="code-keyword">this</span>.storage.get(<span class="code-string">'muted'</span>);
</code></td></tr><tr><td id="L8298" class="css-a4x74f"><span>8298</span></td><td id="LC8298" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8299" class="css-a4x74f"><span>8299</span></td><td id="LC8299" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8300" class="css-a4x74f"><span>8300</span></td><td id="LC8300" class="css-1dcdqdg"><code>      <span class="code-comment">// Use config if all else fails</span>
</code></td></tr><tr><td id="L8301" class="css-a4x74f"><span>8301</span></td><td id="LC8301" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.boolean(toggle)) {
</code></td></tr><tr><td id="L8302" class="css-a4x74f"><span>8302</span></td><td id="LC8302" class="css-1dcdqdg"><code>        toggle = <span class="code-keyword">this</span>.config.muted;
</code></td></tr><tr><td id="L8303" class="css-a4x74f"><span>8303</span></td><td id="LC8303" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8304" class="css-a4x74f"><span>8304</span></td><td id="LC8304" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8305" class="css-a4x74f"><span>8305</span></td><td id="LC8305" class="css-1dcdqdg"><code>      <span class="code-comment">// Update config</span>
</code></td></tr><tr><td id="L8306" class="css-a4x74f"><span>8306</span></td><td id="LC8306" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.muted = toggle;
</code></td></tr><tr><td id="L8307" class="css-a4x74f"><span>8307</span></td><td id="LC8307" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8308" class="css-a4x74f"><span>8308</span></td><td id="LC8308" class="css-1dcdqdg"><code>      <span class="code-comment">// Set mute on the player</span>
</code></td></tr><tr><td id="L8309" class="css-a4x74f"><span>8309</span></td><td id="LC8309" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.muted = toggle;
</code></td></tr><tr><td id="L8310" class="css-a4x74f"><span>8310</span></td><td id="LC8310" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8311" class="css-a4x74f"><span>8311</span></td><td id="LC8311" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8312" class="css-a4x74f"><span>8312</span></td><td id="LC8312" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8313" class="css-a4x74f"><span>8313</span></td><td id="LC8313" class="css-1dcdqdg"><code><span class="code-comment">     * Get current muted state
</span></code></td></tr><tr><td id="L8314" class="css-a4x74f"><span>8314</span></td><td id="LC8314" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8315" class="css-a4x74f"><span>8315</span></td><td id="LC8315" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> muted() {
</code></td></tr><tr><td id="L8316" class="css-a4x74f"><span>8316</span></td><td id="LC8316" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.muted);
</code></td></tr><tr><td id="L8317" class="css-a4x74f"><span>8317</span></td><td id="LC8317" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8318" class="css-a4x74f"><span>8318</span></td><td id="LC8318" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8319" class="css-a4x74f"><span>8319</span></td><td id="LC8319" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8320" class="css-a4x74f"><span>8320</span></td><td id="LC8320" class="css-1dcdqdg"><code><span class="code-comment">     * Check if the media has audio
</span></code></td></tr><tr><td id="L8321" class="css-a4x74f"><span>8321</span></td><td id="LC8321" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8322" class="css-a4x74f"><span>8322</span></td><td id="LC8322" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> hasAudio() {
</code></td></tr><tr><td id="L8323" class="css-a4x74f"><span>8323</span></td><td id="LC8323" class="css-1dcdqdg"><code>      <span class="code-comment">// Assume yes for all non HTML5 (as we can't tell...)</span>
</code></td></tr><tr><td id="L8324" class="css-a4x74f"><span>8324</span></td><td id="LC8324" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isHTML5) {
</code></td></tr><tr><td id="L8325" class="css-a4x74f"><span>8325</span></td><td id="LC8325" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8326" class="css-a4x74f"><span>8326</span></td><td id="LC8326" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8327" class="css-a4x74f"><span>8327</span></td><td id="LC8327" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isAudio) {
</code></td></tr><tr><td id="L8328" class="css-a4x74f"><span>8328</span></td><td id="LC8328" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8329" class="css-a4x74f"><span>8329</span></td><td id="LC8329" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8330" class="css-a4x74f"><span>8330</span></td><td id="LC8330" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8331" class="css-a4x74f"><span>8331</span></td><td id="LC8331" class="css-1dcdqdg"><code>      <span class="code-comment">// Get audio tracks</span>
</code></td></tr><tr><td id="L8332" class="css-a4x74f"><span>8332</span></td><td id="LC8332" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.mozHasAudio) || <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.webkitAudioDecodedByteCount) || <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.audioTracks &amp;&amp; <span class="code-keyword">this</span>.media.audioTracks.length);
</code></td></tr><tr><td id="L8333" class="css-a4x74f"><span>8333</span></td><td id="LC8333" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8334" class="css-a4x74f"><span>8334</span></td><td id="LC8334" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8335" class="css-a4x74f"><span>8335</span></td><td id="LC8335" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8336" class="css-a4x74f"><span>8336</span></td><td id="LC8336" class="css-1dcdqdg"><code><span class="code-comment">     * Set playback speed
</span></code></td></tr><tr><td id="L8337" class="css-a4x74f"><span>8337</span></td><td id="LC8337" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Number} input - the speed of playback (0.5-2.0)
</span></code></td></tr><tr><td id="L8338" class="css-a4x74f"><span>8338</span></td><td id="LC8338" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8339" class="css-a4x74f"><span>8339</span></td><td id="LC8339" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> speed(input) {
</code></td></tr><tr><td id="L8340" class="css-a4x74f"><span>8340</span></td><td id="LC8340" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> speed = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8341" class="css-a4x74f"><span>8341</span></td><td id="LC8341" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.number(input)) {
</code></td></tr><tr><td id="L8342" class="css-a4x74f"><span>8342</span></td><td id="LC8342" class="css-1dcdqdg"><code>        speed = input;
</code></td></tr><tr><td id="L8343" class="css-a4x74f"><span>8343</span></td><td id="LC8343" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8344" class="css-a4x74f"><span>8344</span></td><td id="LC8344" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(speed)) {
</code></td></tr><tr><td id="L8345" class="css-a4x74f"><span>8345</span></td><td id="LC8345" class="css-1dcdqdg"><code>        speed = <span class="code-keyword">this</span>.storage.get(<span class="code-string">'speed'</span>);
</code></td></tr><tr><td id="L8346" class="css-a4x74f"><span>8346</span></td><td id="LC8346" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8347" class="css-a4x74f"><span>8347</span></td><td id="LC8347" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.number(speed)) {
</code></td></tr><tr><td id="L8348" class="css-a4x74f"><span>8348</span></td><td id="LC8348" class="css-1dcdqdg"><code>        speed = <span class="code-keyword">this</span>.config.speed.selected;
</code></td></tr><tr><td id="L8349" class="css-a4x74f"><span>8349</span></td><td id="LC8349" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8350" class="css-a4x74f"><span>8350</span></td><td id="LC8350" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8351" class="css-a4x74f"><span>8351</span></td><td id="LC8351" class="css-1dcdqdg"><code>      <span class="code-comment">// Clamp to min/max</span>
</code></td></tr><tr><td id="L8352" class="css-a4x74f"><span>8352</span></td><td id="LC8352" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L8353" class="css-a4x74f"><span>8353</span></td><td id="LC8353" class="css-1dcdqdg"><code>        minimumSpeed: min,
</code></td></tr><tr><td id="L8354" class="css-a4x74f"><span>8354</span></td><td id="LC8354" class="css-1dcdqdg"><code>        maximumSpeed: max
</code></td></tr><tr><td id="L8355" class="css-a4x74f"><span>8355</span></td><td id="LC8355" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>;
</code></td></tr><tr><td id="L8356" class="css-a4x74f"><span>8356</span></td><td id="LC8356" class="css-1dcdqdg"><code>      speed = clamp(speed, min, max);
</code></td></tr><tr><td id="L8357" class="css-a4x74f"><span>8357</span></td><td id="LC8357" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8358" class="css-a4x74f"><span>8358</span></td><td id="LC8358" class="css-1dcdqdg"><code>      <span class="code-comment">// Update config</span>
</code></td></tr><tr><td id="L8359" class="css-a4x74f"><span>8359</span></td><td id="LC8359" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.speed.selected = speed;
</code></td></tr><tr><td id="L8360" class="css-a4x74f"><span>8360</span></td><td id="LC8360" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8361" class="css-a4x74f"><span>8361</span></td><td id="LC8361" class="css-1dcdqdg"><code>      <span class="code-comment">// Set media speed</span>
</code></td></tr><tr><td id="L8362" class="css-a4x74f"><span>8362</span></td><td id="LC8362" class="css-1dcdqdg"><code>      setTimeout(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {
</code></td></tr><tr><td id="L8363" class="css-a4x74f"><span>8363</span></td><td id="LC8363" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.media) {
</code></td></tr><tr><td id="L8364" class="css-a4x74f"><span>8364</span></td><td id="LC8364" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.media.playbackRate = speed;
</code></td></tr><tr><td id="L8365" class="css-a4x74f"><span>8365</span></td><td id="LC8365" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L8366" class="css-a4x74f"><span>8366</span></td><td id="LC8366" class="css-1dcdqdg"><code>      }, <span class="code-number">0</span>);
</code></td></tr><tr><td id="L8367" class="css-a4x74f"><span>8367</span></td><td id="LC8367" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8368" class="css-a4x74f"><span>8368</span></td><td id="LC8368" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8369" class="css-a4x74f"><span>8369</span></td><td id="LC8369" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8370" class="css-a4x74f"><span>8370</span></td><td id="LC8370" class="css-1dcdqdg"><code><span class="code-comment">     * Get current playback speed
</span></code></td></tr><tr><td id="L8371" class="css-a4x74f"><span>8371</span></td><td id="LC8371" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8372" class="css-a4x74f"><span>8372</span></td><td id="LC8372" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> speed() {
</code></td></tr><tr><td id="L8373" class="css-a4x74f"><span>8373</span></td><td id="LC8373" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Number</span>(<span class="code-keyword">this</span>.media.playbackRate);
</code></td></tr><tr><td id="L8374" class="css-a4x74f"><span>8374</span></td><td id="LC8374" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8375" class="css-a4x74f"><span>8375</span></td><td id="LC8375" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8376" class="css-a4x74f"><span>8376</span></td><td id="LC8376" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8377" class="css-a4x74f"><span>8377</span></td><td id="LC8377" class="css-1dcdqdg"><code><span class="code-comment">     * Get the minimum allowed speed
</span></code></td></tr><tr><td id="L8378" class="css-a4x74f"><span>8378</span></td><td id="LC8378" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8379" class="css-a4x74f"><span>8379</span></td><td id="LC8379" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> minimumSpeed() {
</code></td></tr><tr><td id="L8380" class="css-a4x74f"><span>8380</span></td><td id="LC8380" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isYouTube) {
</code></td></tr><tr><td id="L8381" class="css-a4x74f"><span>8381</span></td><td id="LC8381" class="css-1dcdqdg"><code>        <span class="code-comment">// https://developers.google.com/youtube/iframe_api_reference#setPlaybackRate</span>
</code></td></tr><tr><td id="L8382" class="css-a4x74f"><span>8382</span></td><td id="LC8382" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-built_in">Math</span>.min(...this.options.speed);
</code></td></tr><tr><td id="L8383" class="css-a4x74f"><span>8383</span></td><td id="LC8383" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8384" class="css-a4x74f"><span>8384</span></td><td id="LC8384" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo) {
</code></td></tr><tr><td id="L8385" class="css-a4x74f"><span>8385</span></td><td id="LC8385" class="css-1dcdqdg"><code>        <span class="code-comment">// https://github.com/vimeo/player.js/#setplaybackrateplaybackrate-number-promisenumber-rangeerrorerror</span>
</code></td></tr><tr><td id="L8386" class="css-a4x74f"><span>8386</span></td><td id="LC8386" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-number">0.5</span>;
</code></td></tr><tr><td id="L8387" class="css-a4x74f"><span>8387</span></td><td id="LC8387" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8388" class="css-a4x74f"><span>8388</span></td><td id="LC8388" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8389" class="css-a4x74f"><span>8389</span></td><td id="LC8389" class="css-1dcdqdg"><code>      <span class="code-comment">// https://stackoverflow.com/a/32320020/1191319</span>
</code></td></tr><tr><td id="L8390" class="css-a4x74f"><span>8390</span></td><td id="LC8390" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-number">0.0625</span>;
</code></td></tr><tr><td id="L8391" class="css-a4x74f"><span>8391</span></td><td id="LC8391" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8392" class="css-a4x74f"><span>8392</span></td><td id="LC8392" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8393" class="css-a4x74f"><span>8393</span></td><td id="LC8393" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8394" class="css-a4x74f"><span>8394</span></td><td id="LC8394" class="css-1dcdqdg"><code><span class="code-comment">     * Get the maximum allowed speed
</span></code></td></tr><tr><td id="L8395" class="css-a4x74f"><span>8395</span></td><td id="LC8395" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8396" class="css-a4x74f"><span>8396</span></td><td id="LC8396" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> maximumSpeed() {
</code></td></tr><tr><td id="L8397" class="css-a4x74f"><span>8397</span></td><td id="LC8397" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isYouTube) {
</code></td></tr><tr><td id="L8398" class="css-a4x74f"><span>8398</span></td><td id="LC8398" class="css-1dcdqdg"><code>        <span class="code-comment">// https://developers.google.com/youtube/iframe_api_reference#setPlaybackRate</span>
</code></td></tr><tr><td id="L8399" class="css-a4x74f"><span>8399</span></td><td id="LC8399" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-built_in">Math</span>.max(...this.options.speed);
</code></td></tr><tr><td id="L8400" class="css-a4x74f"><span>8400</span></td><td id="LC8400" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8401" class="css-a4x74f"><span>8401</span></td><td id="LC8401" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.isVimeo) {
</code></td></tr><tr><td id="L8402" class="css-a4x74f"><span>8402</span></td><td id="LC8402" class="css-1dcdqdg"><code>        <span class="code-comment">// https://github.com/vimeo/player.js/#setplaybackrateplaybackrate-number-promisenumber-rangeerrorerror</span>
</code></td></tr><tr><td id="L8403" class="css-a4x74f"><span>8403</span></td><td id="LC8403" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-number">2</span>;
</code></td></tr><tr><td id="L8404" class="css-a4x74f"><span>8404</span></td><td id="LC8404" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8405" class="css-a4x74f"><span>8405</span></td><td id="LC8405" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8406" class="css-a4x74f"><span>8406</span></td><td id="LC8406" class="css-1dcdqdg"><code>      <span class="code-comment">// https://stackoverflow.com/a/32320020/1191319</span>
</code></td></tr><tr><td id="L8407" class="css-a4x74f"><span>8407</span></td><td id="LC8407" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-number">16</span>;
</code></td></tr><tr><td id="L8408" class="css-a4x74f"><span>8408</span></td><td id="LC8408" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8409" class="css-a4x74f"><span>8409</span></td><td id="LC8409" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8410" class="css-a4x74f"><span>8410</span></td><td id="LC8410" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8411" class="css-a4x74f"><span>8411</span></td><td id="LC8411" class="css-1dcdqdg"><code><span class="code-comment">     * Set playback quality
</span></code></td></tr><tr><td id="L8412" class="css-a4x74f"><span>8412</span></td><td id="LC8412" class="css-1dcdqdg"><code><span class="code-comment">     * Currently HTML5 &amp; YouTube only
</span></code></td></tr><tr><td id="L8413" class="css-a4x74f"><span>8413</span></td><td id="LC8413" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Number} input - Quality level
</span></code></td></tr><tr><td id="L8414" class="css-a4x74f"><span>8414</span></td><td id="LC8414" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8415" class="css-a4x74f"><span>8415</span></td><td id="LC8415" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> quality(input) {
</code></td></tr><tr><td id="L8416" class="css-a4x74f"><span>8416</span></td><td id="LC8416" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> config = <span class="code-keyword">this</span>.config.quality;
</code></td></tr><tr><td id="L8417" class="css-a4x74f"><span>8417</span></td><td id="LC8417" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> options = <span class="code-keyword">this</span>.options.quality;
</code></td></tr><tr><td id="L8418" class="css-a4x74f"><span>8418</span></td><td id="LC8418" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!options.length) {
</code></td></tr><tr><td id="L8419" class="css-a4x74f"><span>8419</span></td><td id="LC8419" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8420" class="css-a4x74f"><span>8420</span></td><td id="LC8420" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8421" class="css-a4x74f"><span>8421</span></td><td id="LC8421" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> quality = [!is.empty(input) &amp;&amp; <span class="code-built_in">Number</span>(input), <span class="code-keyword">this</span>.storage.get(<span class="code-string">'quality'</span>), config.selected, config.default].find(is.number);
</code></td></tr><tr><td id="L8422" class="css-a4x74f"><span>8422</span></td><td id="LC8422" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> updateStorage = <span class="code-literal">true</span>;
</code></td></tr><tr><td id="L8423" class="css-a4x74f"><span>8423</span></td><td id="LC8423" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!options.includes(quality)) {
</code></td></tr><tr><td id="L8424" class="css-a4x74f"><span>8424</span></td><td id="LC8424" class="css-1dcdqdg"><code>        <span class="code-keyword">const</span> value = closest(options, quality);
</code></td></tr><tr><td id="L8425" class="css-a4x74f"><span>8425</span></td><td id="LC8425" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">`Unsupported quality option: <span class="code-subst">${quality}</span>, using <span class="code-subst">${value}</span> instead`</span>);
</code></td></tr><tr><td id="L8426" class="css-a4x74f"><span>8426</span></td><td id="LC8426" class="css-1dcdqdg"><code>        quality = value;
</code></td></tr><tr><td id="L8427" class="css-a4x74f"><span>8427</span></td><td id="LC8427" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8428" class="css-a4x74f"><span>8428</span></td><td id="LC8428" class="css-1dcdqdg"><code>        <span class="code-comment">// Don't update storage if quality is not supported</span>
</code></td></tr><tr><td id="L8429" class="css-a4x74f"><span>8429</span></td><td id="LC8429" class="css-1dcdqdg"><code>        updateStorage = <span class="code-literal">false</span>;
</code></td></tr><tr><td id="L8430" class="css-a4x74f"><span>8430</span></td><td id="LC8430" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8431" class="css-a4x74f"><span>8431</span></td><td id="LC8431" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8432" class="css-a4x74f"><span>8432</span></td><td id="LC8432" class="css-1dcdqdg"><code>      <span class="code-comment">// Update config</span>
</code></td></tr><tr><td id="L8433" class="css-a4x74f"><span>8433</span></td><td id="LC8433" class="css-1dcdqdg"><code>      config.selected = quality;
</code></td></tr><tr><td id="L8434" class="css-a4x74f"><span>8434</span></td><td id="LC8434" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8435" class="css-a4x74f"><span>8435</span></td><td id="LC8435" class="css-1dcdqdg"><code>      <span class="code-comment">// Set quality</span>
</code></td></tr><tr><td id="L8436" class="css-a4x74f"><span>8436</span></td><td id="LC8436" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.quality = quality;
</code></td></tr><tr><td id="L8437" class="css-a4x74f"><span>8437</span></td><td id="LC8437" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8438" class="css-a4x74f"><span>8438</span></td><td id="LC8438" class="css-1dcdqdg"><code>      <span class="code-comment">// Save to storage</span>
</code></td></tr><tr><td id="L8439" class="css-a4x74f"><span>8439</span></td><td id="LC8439" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (updateStorage) {
</code></td></tr><tr><td id="L8440" class="css-a4x74f"><span>8440</span></td><td id="LC8440" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.storage.set({
</code></td></tr><tr><td id="L8441" class="css-a4x74f"><span>8441</span></td><td id="LC8441" class="css-1dcdqdg"><code>          quality
</code></td></tr><tr><td id="L8442" class="css-a4x74f"><span>8442</span></td><td id="LC8442" class="css-1dcdqdg"><code>        });
</code></td></tr><tr><td id="L8443" class="css-a4x74f"><span>8443</span></td><td id="LC8443" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8444" class="css-a4x74f"><span>8444</span></td><td id="LC8444" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8445" class="css-a4x74f"><span>8445</span></td><td id="LC8445" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8446" class="css-a4x74f"><span>8446</span></td><td id="LC8446" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8447" class="css-a4x74f"><span>8447</span></td><td id="LC8447" class="css-1dcdqdg"><code><span class="code-comment">     * Get current quality level
</span></code></td></tr><tr><td id="L8448" class="css-a4x74f"><span>8448</span></td><td id="LC8448" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8449" class="css-a4x74f"><span>8449</span></td><td id="LC8449" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> quality() {
</code></td></tr><tr><td id="L8450" class="css-a4x74f"><span>8450</span></td><td id="LC8450" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.quality;
</code></td></tr><tr><td id="L8451" class="css-a4x74f"><span>8451</span></td><td id="LC8451" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8452" class="css-a4x74f"><span>8452</span></td><td id="LC8452" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8453" class="css-a4x74f"><span>8453</span></td><td id="LC8453" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8454" class="css-a4x74f"><span>8454</span></td><td id="LC8454" class="css-1dcdqdg"><code><span class="code-comment">     * Toggle loop
</span></code></td></tr><tr><td id="L8455" class="css-a4x74f"><span>8455</span></td><td id="LC8455" class="css-1dcdqdg"><code><span class="code-comment">     * <span class="code-doctag">TODO:</span> Finish fancy new logic. Set the indicator on load as user may pass loop as config
</span></code></td></tr><tr><td id="L8456" class="css-a4x74f"><span>8456</span></td><td id="LC8456" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Boolean} input - Whether to loop or not
</span></code></td></tr><tr><td id="L8457" class="css-a4x74f"><span>8457</span></td><td id="LC8457" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8458" class="css-a4x74f"><span>8458</span></td><td id="LC8458" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> loop(input) {
</code></td></tr><tr><td id="L8459" class="css-a4x74f"><span>8459</span></td><td id="LC8459" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : <span class="code-keyword">this</span>.config.loop.active;
</code></td></tr><tr><td id="L8460" class="css-a4x74f"><span>8460</span></td><td id="LC8460" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.loop.active = toggle;
</code></td></tr><tr><td id="L8461" class="css-a4x74f"><span>8461</span></td><td id="LC8461" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.media.loop = toggle;
</code></td></tr><tr><td id="L8462" class="css-a4x74f"><span>8462</span></td><td id="LC8462" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8463" class="css-a4x74f"><span>8463</span></td><td id="LC8463" class="css-1dcdqdg"><code>      <span class="code-comment">// Set default to be a true toggle</span>
</code></td></tr><tr><td id="L8464" class="css-a4x74f"><span>8464</span></td><td id="LC8464" class="css-1dcdqdg"><code>      <span class="code-comment">/* const type = ['start', 'end', 'all', 'none', 'toggle'].includes(input) ? input : 'toggle';
</span></code></td></tr><tr><td id="L8465" class="css-a4x74f"><span>8465</span></td><td id="LC8465" class="css-1dcdqdg"><code><span class="code-comment">           switch (type) {
</span></code></td></tr><tr><td id="L8466" class="css-a4x74f"><span>8466</span></td><td id="LC8466" class="css-1dcdqdg"><code><span class="code-comment">              case 'start':
</span></code></td></tr><tr><td id="L8467" class="css-a4x74f"><span>8467</span></td><td id="LC8467" class="css-1dcdqdg"><code><span class="code-comment">                  if (this.config.loop.end &amp;&amp; this.config.loop.end &lt;= this.currentTime) {
</span></code></td></tr><tr><td id="L8468" class="css-a4x74f"><span>8468</span></td><td id="LC8468" class="css-1dcdqdg"><code><span class="code-comment">                      this.config.loop.end = null;
</span></code></td></tr><tr><td id="L8469" class="css-a4x74f"><span>8469</span></td><td id="LC8469" class="css-1dcdqdg"><code><span class="code-comment">                  }
</span></code></td></tr><tr><td id="L8470" class="css-a4x74f"><span>8470</span></td><td id="LC8470" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.start = this.currentTime;
</span></code></td></tr><tr><td id="L8471" class="css-a4x74f"><span>8471</span></td><td id="LC8471" class="css-1dcdqdg"><code><span class="code-comment">                  // this.config.loop.indicator.start = this.elements.display.played.value;
</span></code></td></tr><tr><td id="L8472" class="css-a4x74f"><span>8472</span></td><td id="LC8472" class="css-1dcdqdg"><code><span class="code-comment">                  break;
</span></code></td></tr><tr><td id="L8473" class="css-a4x74f"><span>8473</span></td><td id="LC8473" class="css-1dcdqdg"><code><span class="code-comment">               case 'end':
</span></code></td></tr><tr><td id="L8474" class="css-a4x74f"><span>8474</span></td><td id="LC8474" class="css-1dcdqdg"><code><span class="code-comment">                  if (this.config.loop.start &gt;= this.currentTime) {
</span></code></td></tr><tr><td id="L8475" class="css-a4x74f"><span>8475</span></td><td id="LC8475" class="css-1dcdqdg"><code><span class="code-comment">                      return this;
</span></code></td></tr><tr><td id="L8476" class="css-a4x74f"><span>8476</span></td><td id="LC8476" class="css-1dcdqdg"><code><span class="code-comment">                  }
</span></code></td></tr><tr><td id="L8477" class="css-a4x74f"><span>8477</span></td><td id="LC8477" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.end = this.currentTime;
</span></code></td></tr><tr><td id="L8478" class="css-a4x74f"><span>8478</span></td><td id="LC8478" class="css-1dcdqdg"><code><span class="code-comment">                  // this.config.loop.indicator.end = this.elements.display.played.value;
</span></code></td></tr><tr><td id="L8479" class="css-a4x74f"><span>8479</span></td><td id="LC8479" class="css-1dcdqdg"><code><span class="code-comment">                  break;
</span></code></td></tr><tr><td id="L8480" class="css-a4x74f"><span>8480</span></td><td id="LC8480" class="css-1dcdqdg"><code><span class="code-comment">               case 'all':
</span></code></td></tr><tr><td id="L8481" class="css-a4x74f"><span>8481</span></td><td id="LC8481" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.start = 0;
</span></code></td></tr><tr><td id="L8482" class="css-a4x74f"><span>8482</span></td><td id="LC8482" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.end = this.duration - 2;
</span></code></td></tr><tr><td id="L8483" class="css-a4x74f"><span>8483</span></td><td id="LC8483" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.indicator.start = 0;
</span></code></td></tr><tr><td id="L8484" class="css-a4x74f"><span>8484</span></td><td id="LC8484" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.indicator.end = 100;
</span></code></td></tr><tr><td id="L8485" class="css-a4x74f"><span>8485</span></td><td id="LC8485" class="css-1dcdqdg"><code><span class="code-comment">                  break;
</span></code></td></tr><tr><td id="L8486" class="css-a4x74f"><span>8486</span></td><td id="LC8486" class="css-1dcdqdg"><code><span class="code-comment">               case 'toggle':
</span></code></td></tr><tr><td id="L8487" class="css-a4x74f"><span>8487</span></td><td id="LC8487" class="css-1dcdqdg"><code><span class="code-comment">                  if (this.config.loop.active) {
</span></code></td></tr><tr><td id="L8488" class="css-a4x74f"><span>8488</span></td><td id="LC8488" class="css-1dcdqdg"><code><span class="code-comment">                      this.config.loop.start = 0;
</span></code></td></tr><tr><td id="L8489" class="css-a4x74f"><span>8489</span></td><td id="LC8489" class="css-1dcdqdg"><code><span class="code-comment">                      this.config.loop.end = null;
</span></code></td></tr><tr><td id="L8490" class="css-a4x74f"><span>8490</span></td><td id="LC8490" class="css-1dcdqdg"><code><span class="code-comment">                  } else {
</span></code></td></tr><tr><td id="L8491" class="css-a4x74f"><span>8491</span></td><td id="LC8491" class="css-1dcdqdg"><code><span class="code-comment">                      this.config.loop.start = 0;
</span></code></td></tr><tr><td id="L8492" class="css-a4x74f"><span>8492</span></td><td id="LC8492" class="css-1dcdqdg"><code><span class="code-comment">                      this.config.loop.end = this.duration - 2;
</span></code></td></tr><tr><td id="L8493" class="css-a4x74f"><span>8493</span></td><td id="LC8493" class="css-1dcdqdg"><code><span class="code-comment">                  }
</span></code></td></tr><tr><td id="L8494" class="css-a4x74f"><span>8494</span></td><td id="LC8494" class="css-1dcdqdg"><code><span class="code-comment">                  break;
</span></code></td></tr><tr><td id="L8495" class="css-a4x74f"><span>8495</span></td><td id="LC8495" class="css-1dcdqdg"><code><span class="code-comment">               default:
</span></code></td></tr><tr><td id="L8496" class="css-a4x74f"><span>8496</span></td><td id="LC8496" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.start = 0;
</span></code></td></tr><tr><td id="L8497" class="css-a4x74f"><span>8497</span></td><td id="LC8497" class="css-1dcdqdg"><code><span class="code-comment">                  this.config.loop.end = null;
</span></code></td></tr><tr><td id="L8498" class="css-a4x74f"><span>8498</span></td><td id="LC8498" class="css-1dcdqdg"><code><span class="code-comment">                  break;
</span></code></td></tr><tr><td id="L8499" class="css-a4x74f"><span>8499</span></td><td id="LC8499" class="css-1dcdqdg"><code><span class="code-comment">          } */</span>
</code></td></tr><tr><td id="L8500" class="css-a4x74f"><span>8500</span></td><td id="LC8500" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8501" class="css-a4x74f"><span>8501</span></td><td id="LC8501" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8502" class="css-a4x74f"><span>8502</span></td><td id="LC8502" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8503" class="css-a4x74f"><span>8503</span></td><td id="LC8503" class="css-1dcdqdg"><code><span class="code-comment">     * Get current loop state
</span></code></td></tr><tr><td id="L8504" class="css-a4x74f"><span>8504</span></td><td id="LC8504" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8505" class="css-a4x74f"><span>8505</span></td><td id="LC8505" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> loop() {
</code></td></tr><tr><td id="L8506" class="css-a4x74f"><span>8506</span></td><td id="LC8506" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.media.loop);
</code></td></tr><tr><td id="L8507" class="css-a4x74f"><span>8507</span></td><td id="LC8507" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8508" class="css-a4x74f"><span>8508</span></td><td id="LC8508" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8509" class="css-a4x74f"><span>8509</span></td><td id="LC8509" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8510" class="css-a4x74f"><span>8510</span></td><td id="LC8510" class="css-1dcdqdg"><code><span class="code-comment">     * Set new media source
</span></code></td></tr><tr><td id="L8511" class="css-a4x74f"><span>8511</span></td><td id="LC8511" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Object} input - The new source object (see docs)
</span></code></td></tr><tr><td id="L8512" class="css-a4x74f"><span>8512</span></td><td id="LC8512" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8513" class="css-a4x74f"><span>8513</span></td><td id="LC8513" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> source(input) {
</code></td></tr><tr><td id="L8514" class="css-a4x74f"><span>8514</span></td><td id="LC8514" class="css-1dcdqdg"><code>      source.change.call(<span class="code-keyword">this</span>, input);
</code></td></tr><tr><td id="L8515" class="css-a4x74f"><span>8515</span></td><td id="LC8515" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8516" class="css-a4x74f"><span>8516</span></td><td id="LC8516" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8517" class="css-a4x74f"><span>8517</span></td><td id="LC8517" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8518" class="css-a4x74f"><span>8518</span></td><td id="LC8518" class="css-1dcdqdg"><code><span class="code-comment">     * Get current source
</span></code></td></tr><tr><td id="L8519" class="css-a4x74f"><span>8519</span></td><td id="LC8519" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8520" class="css-a4x74f"><span>8520</span></td><td id="LC8520" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> source() {
</code></td></tr><tr><td id="L8521" class="css-a4x74f"><span>8521</span></td><td id="LC8521" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.currentSrc;
</code></td></tr><tr><td id="L8522" class="css-a4x74f"><span>8522</span></td><td id="LC8522" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8523" class="css-a4x74f"><span>8523</span></td><td id="LC8523" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8524" class="css-a4x74f"><span>8524</span></td><td id="LC8524" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8525" class="css-a4x74f"><span>8525</span></td><td id="LC8525" class="css-1dcdqdg"><code><span class="code-comment">     * Get a download URL (either source or custom)
</span></code></td></tr><tr><td id="L8526" class="css-a4x74f"><span>8526</span></td><td id="LC8526" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8527" class="css-a4x74f"><span>8527</span></td><td id="LC8527" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> download() {
</code></td></tr><tr><td id="L8528" class="css-a4x74f"><span>8528</span></td><td id="LC8528" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L8529" class="css-a4x74f"><span>8529</span></td><td id="LC8529" class="css-1dcdqdg"><code>        download
</code></td></tr><tr><td id="L8530" class="css-a4x74f"><span>8530</span></td><td id="LC8530" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.config.urls;
</code></td></tr><tr><td id="L8531" class="css-a4x74f"><span>8531</span></td><td id="LC8531" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> is.url(download) ? download : <span class="code-keyword">this</span>.source;
</code></td></tr><tr><td id="L8532" class="css-a4x74f"><span>8532</span></td><td id="LC8532" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8533" class="css-a4x74f"><span>8533</span></td><td id="LC8533" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8534" class="css-a4x74f"><span>8534</span></td><td id="LC8534" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8535" class="css-a4x74f"><span>8535</span></td><td id="LC8535" class="css-1dcdqdg"><code><span class="code-comment">     * Set the download URL
</span></code></td></tr><tr><td id="L8536" class="css-a4x74f"><span>8536</span></td><td id="LC8536" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8537" class="css-a4x74f"><span>8537</span></td><td id="LC8537" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> download(input) {
</code></td></tr><tr><td id="L8538" class="css-a4x74f"><span>8538</span></td><td id="LC8538" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.url(input)) {
</code></td></tr><tr><td id="L8539" class="css-a4x74f"><span>8539</span></td><td id="LC8539" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8540" class="css-a4x74f"><span>8540</span></td><td id="LC8540" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8541" class="css-a4x74f"><span>8541</span></td><td id="LC8541" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.urls.download = input;
</code></td></tr><tr><td id="L8542" class="css-a4x74f"><span>8542</span></td><td id="LC8542" class="css-1dcdqdg"><code>      controls.setDownloadUrl.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8543" class="css-a4x74f"><span>8543</span></td><td id="LC8543" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8544" class="css-a4x74f"><span>8544</span></td><td id="LC8544" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8545" class="css-a4x74f"><span>8545</span></td><td id="LC8545" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8546" class="css-a4x74f"><span>8546</span></td><td id="LC8546" class="css-1dcdqdg"><code><span class="code-comment">     * Set the poster image for a video
</span></code></td></tr><tr><td id="L8547" class="css-a4x74f"><span>8547</span></td><td id="LC8547" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} input - the URL for the new poster image
</span></code></td></tr><tr><td id="L8548" class="css-a4x74f"><span>8548</span></td><td id="LC8548" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8549" class="css-a4x74f"><span>8549</span></td><td id="LC8549" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> poster(input) {
</code></td></tr><tr><td id="L8550" class="css-a4x74f"><span>8550</span></td><td id="LC8550" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L8551" class="css-a4x74f"><span>8551</span></td><td id="LC8551" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Poster can only be set for video'</span>);
</code></td></tr><tr><td id="L8552" class="css-a4x74f"><span>8552</span></td><td id="LC8552" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8553" class="css-a4x74f"><span>8553</span></td><td id="LC8553" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8554" class="css-a4x74f"><span>8554</span></td><td id="LC8554" class="css-1dcdqdg"><code>      ui.setPoster.call(<span class="code-keyword">this</span>, input, <span class="code-literal">false</span>).catch(<span class="code-function"><span class="code-params">()</span> =&gt;</span> {});
</code></td></tr><tr><td id="L8555" class="css-a4x74f"><span>8555</span></td><td id="LC8555" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8556" class="css-a4x74f"><span>8556</span></td><td id="LC8556" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8557" class="css-a4x74f"><span>8557</span></td><td id="LC8557" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8558" class="css-a4x74f"><span>8558</span></td><td id="LC8558" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current poster image
</span></code></td></tr><tr><td id="L8559" class="css-a4x74f"><span>8559</span></td><td id="LC8559" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8560" class="css-a4x74f"><span>8560</span></td><td id="LC8560" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> poster() {
</code></td></tr><tr><td id="L8561" class="css-a4x74f"><span>8561</span></td><td id="LC8561" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L8562" class="css-a4x74f"><span>8562</span></td><td id="LC8562" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8563" class="css-a4x74f"><span>8563</span></td><td id="LC8563" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8564" class="css-a4x74f"><span>8564</span></td><td id="LC8564" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.getAttribute(<span class="code-string">'poster'</span>) || <span class="code-keyword">this</span>.media.getAttribute(<span class="code-string">'data-poster'</span>);
</code></td></tr><tr><td id="L8565" class="css-a4x74f"><span>8565</span></td><td id="LC8565" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8566" class="css-a4x74f"><span>8566</span></td><td id="LC8566" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8567" class="css-a4x74f"><span>8567</span></td><td id="LC8567" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8568" class="css-a4x74f"><span>8568</span></td><td id="LC8568" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current aspect ratio in use
</span></code></td></tr><tr><td id="L8569" class="css-a4x74f"><span>8569</span></td><td id="LC8569" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8570" class="css-a4x74f"><span>8570</span></td><td id="LC8570" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> ratio() {
</code></td></tr><tr><td id="L8571" class="css-a4x74f"><span>8571</span></td><td id="LC8571" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L8572" class="css-a4x74f"><span>8572</span></td><td id="LC8572" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8573" class="css-a4x74f"><span>8573</span></td><td id="LC8573" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8574" class="css-a4x74f"><span>8574</span></td><td id="LC8574" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> ratio = reduceAspectRatio(getAspectRatio.call(<span class="code-keyword">this</span>));
</code></td></tr><tr><td id="L8575" class="css-a4x74f"><span>8575</span></td><td id="LC8575" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> is.array(ratio) ? ratio.join(<span class="code-string">':'</span>) : ratio;
</code></td></tr><tr><td id="L8576" class="css-a4x74f"><span>8576</span></td><td id="LC8576" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8577" class="css-a4x74f"><span>8577</span></td><td id="LC8577" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8578" class="css-a4x74f"><span>8578</span></td><td id="LC8578" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8579" class="css-a4x74f"><span>8579</span></td><td id="LC8579" class="css-1dcdqdg"><code><span class="code-comment">     * Set video aspect ratio
</span></code></td></tr><tr><td id="L8580" class="css-a4x74f"><span>8580</span></td><td id="LC8580" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8581" class="css-a4x74f"><span>8581</span></td><td id="LC8581" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> ratio(input) {
</code></td></tr><tr><td id="L8582" class="css-a4x74f"><span>8582</span></td><td id="LC8582" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.isVideo) {
</code></td></tr><tr><td id="L8583" class="css-a4x74f"><span>8583</span></td><td id="LC8583" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.warn(<span class="code-string">'Aspect ratio can only be set for video'</span>);
</code></td></tr><tr><td id="L8584" class="css-a4x74f"><span>8584</span></td><td id="LC8584" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8585" class="css-a4x74f"><span>8585</span></td><td id="LC8585" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8586" class="css-a4x74f"><span>8586</span></td><td id="LC8586" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.string(input) || !validateAspectRatio(input)) {
</code></td></tr><tr><td id="L8587" class="css-a4x74f"><span>8587</span></td><td id="LC8587" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.debug.error(<span class="code-string">`Invalid aspect ratio specified (<span class="code-subst">${input}</span>)`</span>);
</code></td></tr><tr><td id="L8588" class="css-a4x74f"><span>8588</span></td><td id="LC8588" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8589" class="css-a4x74f"><span>8589</span></td><td id="LC8589" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8590" class="css-a4x74f"><span>8590</span></td><td id="LC8590" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.ratio = reduceAspectRatio(input);
</code></td></tr><tr><td id="L8591" class="css-a4x74f"><span>8591</span></td><td id="LC8591" class="css-1dcdqdg"><code>      setAspectRatio.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8592" class="css-a4x74f"><span>8592</span></td><td id="LC8592" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8593" class="css-a4x74f"><span>8593</span></td><td id="LC8593" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8594" class="css-a4x74f"><span>8594</span></td><td id="LC8594" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8595" class="css-a4x74f"><span>8595</span></td><td id="LC8595" class="css-1dcdqdg"><code><span class="code-comment">     * Set the autoplay state
</span></code></td></tr><tr><td id="L8596" class="css-a4x74f"><span>8596</span></td><td id="LC8596" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Boolean} input - Whether to autoplay or not
</span></code></td></tr><tr><td id="L8597" class="css-a4x74f"><span>8597</span></td><td id="LC8597" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8598" class="css-a4x74f"><span>8598</span></td><td id="LC8598" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> autoplay(input) {
</code></td></tr><tr><td id="L8599" class="css-a4x74f"><span>8599</span></td><td id="LC8599" class="css-1dcdqdg"><code>      <span class="code-keyword">this</span>.config.autoplay = is.boolean(input) ? input : <span class="code-keyword">this</span>.config.autoplay;
</code></td></tr><tr><td id="L8600" class="css-a4x74f"><span>8600</span></td><td id="LC8600" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8601" class="css-a4x74f"><span>8601</span></td><td id="LC8601" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8602" class="css-a4x74f"><span>8602</span></td><td id="LC8602" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8603" class="css-a4x74f"><span>8603</span></td><td id="LC8603" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current autoplay state
</span></code></td></tr><tr><td id="L8604" class="css-a4x74f"><span>8604</span></td><td id="LC8604" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8605" class="css-a4x74f"><span>8605</span></td><td id="LC8605" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> autoplay() {
</code></td></tr><tr><td id="L8606" class="css-a4x74f"><span>8606</span></td><td id="LC8606" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-built_in">Boolean</span>(<span class="code-keyword">this</span>.config.autoplay);
</code></td></tr><tr><td id="L8607" class="css-a4x74f"><span>8607</span></td><td id="LC8607" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8608" class="css-a4x74f"><span>8608</span></td><td id="LC8608" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8609" class="css-a4x74f"><span>8609</span></td><td id="LC8609" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8610" class="css-a4x74f"><span>8610</span></td><td id="LC8610" class="css-1dcdqdg"><code><span class="code-comment">     * Toggle captions
</span></code></td></tr><tr><td id="L8611" class="css-a4x74f"><span>8611</span></td><td id="LC8611" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Boolean} input - Whether to enable captions
</span></code></td></tr><tr><td id="L8612" class="css-a4x74f"><span>8612</span></td><td id="LC8612" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8613" class="css-a4x74f"><span>8613</span></td><td id="LC8613" class="css-1dcdqdg"><code>    toggleCaptions(input) {
</code></td></tr><tr><td id="L8614" class="css-a4x74f"><span>8614</span></td><td id="LC8614" class="css-1dcdqdg"><code>      captions.toggle.call(<span class="code-keyword">this</span>, input, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L8615" class="css-a4x74f"><span>8615</span></td><td id="LC8615" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8616" class="css-a4x74f"><span>8616</span></td><td id="LC8616" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8617" class="css-a4x74f"><span>8617</span></td><td id="LC8617" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8618" class="css-a4x74f"><span>8618</span></td><td id="LC8618" class="css-1dcdqdg"><code><span class="code-comment">     * Set the caption track by index
</span></code></td></tr><tr><td id="L8619" class="css-a4x74f"><span>8619</span></td><td id="LC8619" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Number} input - Caption index
</span></code></td></tr><tr><td id="L8620" class="css-a4x74f"><span>8620</span></td><td id="LC8620" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8621" class="css-a4x74f"><span>8621</span></td><td id="LC8621" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> currentTrack(input) {
</code></td></tr><tr><td id="L8622" class="css-a4x74f"><span>8622</span></td><td id="LC8622" class="css-1dcdqdg"><code>      captions.set.call(<span class="code-keyword">this</span>, input, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L8623" class="css-a4x74f"><span>8623</span></td><td id="LC8623" class="css-1dcdqdg"><code>      captions.setup.call(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8624" class="css-a4x74f"><span>8624</span></td><td id="LC8624" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8625" class="css-a4x74f"><span>8625</span></td><td id="LC8625" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8626" class="css-a4x74f"><span>8626</span></td><td id="LC8626" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8627" class="css-a4x74f"><span>8627</span></td><td id="LC8627" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current caption track index (-1 if disabled)
</span></code></td></tr><tr><td id="L8628" class="css-a4x74f"><span>8628</span></td><td id="LC8628" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8629" class="css-a4x74f"><span>8629</span></td><td id="LC8629" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> currentTrack() {
</code></td></tr><tr><td id="L8630" class="css-a4x74f"><span>8630</span></td><td id="LC8630" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> {
</code></td></tr><tr><td id="L8631" class="css-a4x74f"><span>8631</span></td><td id="LC8631" class="css-1dcdqdg"><code>        toggled,
</code></td></tr><tr><td id="L8632" class="css-a4x74f"><span>8632</span></td><td id="LC8632" class="css-1dcdqdg"><code>        currentTrack
</code></td></tr><tr><td id="L8633" class="css-a4x74f"><span>8633</span></td><td id="LC8633" class="css-1dcdqdg"><code>      } = <span class="code-keyword">this</span>.captions;
</code></td></tr><tr><td id="L8634" class="css-a4x74f"><span>8634</span></td><td id="LC8634" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> toggled ? currentTrack : <span class="code-number">-1</span>;
</code></td></tr><tr><td id="L8635" class="css-a4x74f"><span>8635</span></td><td id="LC8635" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8636" class="css-a4x74f"><span>8636</span></td><td id="LC8636" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8637" class="css-a4x74f"><span>8637</span></td><td id="LC8637" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8638" class="css-a4x74f"><span>8638</span></td><td id="LC8638" class="css-1dcdqdg"><code><span class="code-comment">     * Set the wanted language for captions
</span></code></td></tr><tr><td id="L8639" class="css-a4x74f"><span>8639</span></td><td id="LC8639" class="css-1dcdqdg"><code><span class="code-comment">     * Since tracks can be added later it won't update the actual caption track until there is a matching track
</span></code></td></tr><tr><td id="L8640" class="css-a4x74f"><span>8640</span></td><td id="LC8640" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} input - Two character ISO language code (e.g. EN, FR, PT, etc)
</span></code></td></tr><tr><td id="L8641" class="css-a4x74f"><span>8641</span></td><td id="LC8641" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8642" class="css-a4x74f"><span>8642</span></td><td id="LC8642" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> language(input) {
</code></td></tr><tr><td id="L8643" class="css-a4x74f"><span>8643</span></td><td id="LC8643" class="css-1dcdqdg"><code>      captions.setLanguage.call(<span class="code-keyword">this</span>, input, <span class="code-literal">false</span>);
</code></td></tr><tr><td id="L8644" class="css-a4x74f"><span>8644</span></td><td id="LC8644" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8645" class="css-a4x74f"><span>8645</span></td><td id="LC8645" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8646" class="css-a4x74f"><span>8646</span></td><td id="LC8646" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8647" class="css-a4x74f"><span>8647</span></td><td id="LC8647" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current track's language
</span></code></td></tr><tr><td id="L8648" class="css-a4x74f"><span>8648</span></td><td id="LC8648" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8649" class="css-a4x74f"><span>8649</span></td><td id="LC8649" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> language() {
</code></td></tr><tr><td id="L8650" class="css-a4x74f"><span>8650</span></td><td id="LC8650" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> (captions.getCurrentTrack.call(<span class="code-keyword">this</span>) || {}).language;
</code></td></tr><tr><td id="L8651" class="css-a4x74f"><span>8651</span></td><td id="LC8651" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8652" class="css-a4x74f"><span>8652</span></td><td id="LC8652" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8653" class="css-a4x74f"><span>8653</span></td><td id="LC8653" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8654" class="css-a4x74f"><span>8654</span></td><td id="LC8654" class="css-1dcdqdg"><code><span class="code-comment">     * Toggle picture-in-picture playback on WebKit/MacOS
</span></code></td></tr><tr><td id="L8655" class="css-a4x74f"><span>8655</span></td><td id="LC8655" class="css-1dcdqdg"><code><span class="code-comment">     * <span class="code-doctag">TODO:</span> update player with state, support, enabled
</span></code></td></tr><tr><td id="L8656" class="css-a4x74f"><span>8656</span></td><td id="LC8656" class="css-1dcdqdg"><code><span class="code-comment">     * <span class="code-doctag">TODO:</span> detect outside changes
</span></code></td></tr><tr><td id="L8657" class="css-a4x74f"><span>8657</span></td><td id="LC8657" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8658" class="css-a4x74f"><span>8658</span></td><td id="LC8658" class="css-1dcdqdg"><code>    <span class="code-keyword">set</span> pip(input) {
</code></td></tr><tr><td id="L8659" class="css-a4x74f"><span>8659</span></td><td id="LC8659" class="css-1dcdqdg"><code>      <span class="code-comment">// Bail if no support</span>
</code></td></tr><tr><td id="L8660" class="css-a4x74f"><span>8660</span></td><td id="LC8660" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!support.pip) {
</code></td></tr><tr><td id="L8661" class="css-a4x74f"><span>8661</span></td><td id="LC8661" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span>;
</code></td></tr><tr><td id="L8662" class="css-a4x74f"><span>8662</span></td><td id="LC8662" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8663" class="css-a4x74f"><span>8663</span></td><td id="LC8663" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8664" class="css-a4x74f"><span>8664</span></td><td id="LC8664" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle based on current state if not passed</span>
</code></td></tr><tr><td id="L8665" class="css-a4x74f"><span>8665</span></td><td id="LC8665" class="css-1dcdqdg"><code>      <span class="code-keyword">const</span> toggle = is.boolean(input) ? input : !<span class="code-keyword">this</span>.pip;
</code></td></tr><tr><td id="L8666" class="css-a4x74f"><span>8666</span></td><td id="LC8666" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8667" class="css-a4x74f"><span>8667</span></td><td id="LC8667" class="css-1dcdqdg"><code>      <span class="code-comment">// Toggle based on current state</span>
</code></td></tr><tr><td id="L8668" class="css-a4x74f"><span>8668</span></td><td id="LC8668" class="css-1dcdqdg"><code>      <span class="code-comment">// Safari</span>
</code></td></tr><tr><td id="L8669" class="css-a4x74f"><span>8669</span></td><td id="LC8669" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.function(<span class="code-keyword">this</span>.media.webkitSetPresentationMode)) {
</code></td></tr><tr><td id="L8670" class="css-a4x74f"><span>8670</span></td><td id="LC8670" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.media.webkitSetPresentationMode(toggle ? pip.active : pip.inactive);
</code></td></tr><tr><td id="L8671" class="css-a4x74f"><span>8671</span></td><td id="LC8671" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8672" class="css-a4x74f"><span>8672</span></td><td id="LC8672" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8673" class="css-a4x74f"><span>8673</span></td><td id="LC8673" class="css-1dcdqdg"><code>      <span class="code-comment">// Chrome</span>
</code></td></tr><tr><td id="L8674" class="css-a4x74f"><span>8674</span></td><td id="LC8674" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.function(<span class="code-keyword">this</span>.media.requestPictureInPicture)) {
</code></td></tr><tr><td id="L8675" class="css-a4x74f"><span>8675</span></td><td id="LC8675" class="css-1dcdqdg"><code>        <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.pip &amp;&amp; toggle) {
</code></td></tr><tr><td id="L8676" class="css-a4x74f"><span>8676</span></td><td id="LC8676" class="css-1dcdqdg"><code>          <span class="code-keyword">this</span>.media.requestPictureInPicture();
</code></td></tr><tr><td id="L8677" class="css-a4x74f"><span>8677</span></td><td id="LC8677" class="css-1dcdqdg"><code>        } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.pip &amp;&amp; !toggle) {
</code></td></tr><tr><td id="L8678" class="css-a4x74f"><span>8678</span></td><td id="LC8678" class="css-1dcdqdg"><code>          <span class="code-built_in">document</span>.exitPictureInPicture();
</code></td></tr><tr><td id="L8679" class="css-a4x74f"><span>8679</span></td><td id="LC8679" class="css-1dcdqdg"><code>        }
</code></td></tr><tr><td id="L8680" class="css-a4x74f"><span>8680</span></td><td id="LC8680" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8681" class="css-a4x74f"><span>8681</span></td><td id="LC8681" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8682" class="css-a4x74f"><span>8682</span></td><td id="LC8682" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8683" class="css-a4x74f"><span>8683</span></td><td id="LC8683" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8684" class="css-a4x74f"><span>8684</span></td><td id="LC8684" class="css-1dcdqdg"><code><span class="code-comment">     * Get the current picture-in-picture state
</span></code></td></tr><tr><td id="L8685" class="css-a4x74f"><span>8685</span></td><td id="LC8685" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8686" class="css-a4x74f"><span>8686</span></td><td id="LC8686" class="css-1dcdqdg"><code>    <span class="code-keyword">get</span> pip() {
</code></td></tr><tr><td id="L8687" class="css-a4x74f"><span>8687</span></td><td id="LC8687" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!support.pip) {
</code></td></tr><tr><td id="L8688" class="css-a4x74f"><span>8688</span></td><td id="LC8688" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8689" class="css-a4x74f"><span>8689</span></td><td id="LC8689" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8690" class="css-a4x74f"><span>8690</span></td><td id="LC8690" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8691" class="css-a4x74f"><span>8691</span></td><td id="LC8691" class="css-1dcdqdg"><code>      <span class="code-comment">// Safari</span>
</code></td></tr><tr><td id="L8692" class="css-a4x74f"><span>8692</span></td><td id="LC8692" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (!is.empty(<span class="code-keyword">this</span>.media.webkitPresentationMode)) {
</code></td></tr><tr><td id="L8693" class="css-a4x74f"><span>8693</span></td><td id="LC8693" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media.webkitPresentationMode === pip.active;
</code></td></tr><tr><td id="L8694" class="css-a4x74f"><span>8694</span></td><td id="LC8694" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8695" class="css-a4x74f"><span>8695</span></td><td id="LC8695" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8696" class="css-a4x74f"><span>8696</span></td><td id="LC8696" class="css-1dcdqdg"><code>      <span class="code-comment">// Chrome</span>
</code></td></tr><tr><td id="L8697" class="css-a4x74f"><span>8697</span></td><td id="LC8697" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> <span class="code-keyword">this</span>.media === <span class="code-built_in">document</span>.pictureInPictureElement;
</code></td></tr><tr><td id="L8698" class="css-a4x74f"><span>8698</span></td><td id="LC8698" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8699" class="css-a4x74f"><span>8699</span></td><td id="LC8699" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8700" class="css-a4x74f"><span>8700</span></td><td id="LC8700" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8701" class="css-a4x74f"><span>8701</span></td><td id="LC8701" class="css-1dcdqdg"><code><span class="code-comment">     * Sets the preview thumbnails for the current source
</span></code></td></tr><tr><td id="L8702" class="css-a4x74f"><span>8702</span></td><td id="LC8702" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8703" class="css-a4x74f"><span>8703</span></td><td id="LC8703" class="css-1dcdqdg"><code>    setPreviewThumbnails(thumbnailSource) {
</code></td></tr><tr><td id="L8704" class="css-a4x74f"><span>8704</span></td><td id="LC8704" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.previewThumbnails &amp;&amp; <span class="code-keyword">this</span>.previewThumbnails.loaded) {
</code></td></tr><tr><td id="L8705" class="css-a4x74f"><span>8705</span></td><td id="LC8705" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.previewThumbnails.destroy();
</code></td></tr><tr><td id="L8706" class="css-a4x74f"><span>8706</span></td><td id="LC8706" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.previewThumbnails = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8707" class="css-a4x74f"><span>8707</span></td><td id="LC8707" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8708" class="css-a4x74f"><span>8708</span></td><td id="LC8708" class="css-1dcdqdg"><code>      <span class="code-built_in">Object</span>.assign(<span class="code-keyword">this</span>.config.previewThumbnails, thumbnailSource);
</code></td></tr><tr><td id="L8709" class="css-a4x74f"><span>8709</span></td><td id="LC8709" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8710" class="css-a4x74f"><span>8710</span></td><td id="LC8710" class="css-1dcdqdg"><code>      <span class="code-comment">// Create new instance if it is still enabled</span>
</code></td></tr><tr><td id="L8711" class="css-a4x74f"><span>8711</span></td><td id="LC8711" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.config.previewThumbnails.enabled) {
</code></td></tr><tr><td id="L8712" class="css-a4x74f"><span>8712</span></td><td id="LC8712" class="css-1dcdqdg"><code>        <span class="code-keyword">this</span>.previewThumbnails = <span class="code-keyword">new</span> PreviewThumbnails(<span class="code-keyword">this</span>);
</code></td></tr><tr><td id="L8713" class="css-a4x74f"><span>8713</span></td><td id="LC8713" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8714" class="css-a4x74f"><span>8714</span></td><td id="LC8714" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8715" class="css-a4x74f"><span>8715</span></td><td id="LC8715" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8716" class="css-a4x74f"><span>8716</span></td><td id="LC8716" class="css-1dcdqdg"><code><span class="code-comment">     * Check for support
</span></code></td></tr><tr><td id="L8717" class="css-a4x74f"><span>8717</span></td><td id="LC8717" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} type - Player type (audio/video)
</span></code></td></tr><tr><td id="L8718" class="css-a4x74f"><span>8718</span></td><td id="LC8718" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} provider - Provider (html5/youtube/vimeo)
</span></code></td></tr><tr><td id="L8719" class="css-a4x74f"><span>8719</span></td><td id="LC8719" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8720" class="css-a4x74f"><span>8720</span></td><td id="LC8720" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> supported(type, provider) {
</code></td></tr><tr><td id="L8721" class="css-a4x74f"><span>8721</span></td><td id="LC8721" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> support.check(type, provider);
</code></td></tr><tr><td id="L8722" class="css-a4x74f"><span>8722</span></td><td id="LC8722" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8723" class="css-a4x74f"><span>8723</span></td><td id="LC8723" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8724" class="css-a4x74f"><span>8724</span></td><td id="LC8724" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8725" class="css-a4x74f"><span>8725</span></td><td id="LC8725" class="css-1dcdqdg"><code><span class="code-comment">     * Load an SVG sprite into the page
</span></code></td></tr><tr><td id="L8726" class="css-a4x74f"><span>8726</span></td><td id="LC8726" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} url - URL for the SVG sprite
</span></code></td></tr><tr><td id="L8727" class="css-a4x74f"><span>8727</span></td><td id="LC8727" class="css-1dcdqdg"><code><span class="code-comment">     * @param {String} [id] - Unique ID
</span></code></td></tr><tr><td id="L8728" class="css-a4x74f"><span>8728</span></td><td id="LC8728" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8729" class="css-a4x74f"><span>8729</span></td><td id="LC8729" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> loadSprite(url, id) {
</code></td></tr><tr><td id="L8730" class="css-a4x74f"><span>8730</span></td><td id="LC8730" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> loadSprite(url, id);
</code></td></tr><tr><td id="L8731" class="css-a4x74f"><span>8731</span></td><td id="LC8731" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8732" class="css-a4x74f"><span>8732</span></td><td id="LC8732" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8733" class="css-a4x74f"><span>8733</span></td><td id="LC8733" class="css-1dcdqdg"><code>    <span class="code-comment">/**
</span></code></td></tr><tr><td id="L8734" class="css-a4x74f"><span>8734</span></td><td id="LC8734" class="css-1dcdqdg"><code><span class="code-comment">     * Setup multiple instances
</span></code></td></tr><tr><td id="L8735" class="css-a4x74f"><span>8735</span></td><td id="LC8735" class="css-1dcdqdg"><code><span class="code-comment">     * @param {*} selector
</span></code></td></tr><tr><td id="L8736" class="css-a4x74f"><span>8736</span></td><td id="LC8736" class="css-1dcdqdg"><code><span class="code-comment">     * @param {Object} options
</span></code></td></tr><tr><td id="L8737" class="css-a4x74f"><span>8737</span></td><td id="LC8737" class="css-1dcdqdg"><code><span class="code-comment">     */</span>
</code></td></tr><tr><td id="L8738" class="css-a4x74f"><span>8738</span></td><td id="LC8738" class="css-1dcdqdg"><code>    <span class="code-keyword">static</span> setup(selector, options = {}) {
</code></td></tr><tr><td id="L8739" class="css-a4x74f"><span>8739</span></td><td id="LC8739" class="css-1dcdqdg"><code>      <span class="code-keyword">let</span> targets = <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8740" class="css-a4x74f"><span>8740</span></td><td id="LC8740" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.string(selector)) {
</code></td></tr><tr><td id="L8741" class="css-a4x74f"><span>8741</span></td><td id="LC8741" class="css-1dcdqdg"><code>        targets = <span class="code-built_in">Array</span>.from(<span class="code-built_in">document</span>.querySelectorAll(selector));
</code></td></tr><tr><td id="L8742" class="css-a4x74f"><span>8742</span></td><td id="LC8742" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.nodeList(selector)) {
</code></td></tr><tr><td id="L8743" class="css-a4x74f"><span>8743</span></td><td id="LC8743" class="css-1dcdqdg"><code>        targets = <span class="code-built_in">Array</span>.from(selector);
</code></td></tr><tr><td id="L8744" class="css-a4x74f"><span>8744</span></td><td id="LC8744" class="css-1dcdqdg"><code>      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (is.array(selector)) {
</code></td></tr><tr><td id="L8745" class="css-a4x74f"><span>8745</span></td><td id="LC8745" class="css-1dcdqdg"><code>        targets = selector.filter(is.element);
</code></td></tr><tr><td id="L8746" class="css-a4x74f"><span>8746</span></td><td id="LC8746" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8747" class="css-a4x74f"><span>8747</span></td><td id="LC8747" class="css-1dcdqdg"><code>      <span class="code-keyword">if</span> (is.empty(targets)) {
</code></td></tr><tr><td id="L8748" class="css-a4x74f"><span>8748</span></td><td id="LC8748" class="css-1dcdqdg"><code>        <span class="code-keyword">return</span> <span class="code-literal">null</span>;
</code></td></tr><tr><td id="L8749" class="css-a4x74f"><span>8749</span></td><td id="LC8749" class="css-1dcdqdg"><code>      }
</code></td></tr><tr><td id="L8750" class="css-a4x74f"><span>8750</span></td><td id="LC8750" class="css-1dcdqdg"><code>      <span class="code-keyword">return</span> targets.map(<span class="code-function"><span class="code-params">t</span> =&gt;</span> <span class="code-keyword">new</span> Plyr(t, options));
</code></td></tr><tr><td id="L8751" class="css-a4x74f"><span>8751</span></td><td id="LC8751" class="css-1dcdqdg"><code>    }
</code></td></tr><tr><td id="L8752" class="css-a4x74f"><span>8752</span></td><td id="LC8752" class="css-1dcdqdg"><code>  }
</code></td></tr><tr><td id="L8753" class="css-a4x74f"><span>8753</span></td><td id="LC8753" class="css-1dcdqdg"><code>  Plyr.defaults = cloneDeep(defaults);
</code></td></tr><tr><td id="L8754" class="css-a4x74f"><span>8754</span></td><td id="LC8754" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8755" class="css-a4x74f"><span>8755</span></td><td id="LC8755" class="css-1dcdqdg"><code>  <span class="code-keyword">return</span> Plyr;
</code></td></tr><tr><td id="L8756" class="css-a4x74f"><span>8756</span></td><td id="LC8756" class="css-1dcdqdg"><code>
</code></td></tr><tr><td id="L8757" class="css-a4x74f"><span>8757</span></td><td id="LC8757" class="css-1dcdqdg"><code>}));
</code></td></tr><tr><td id="L8758" class="css-a4x74f"><span>8758</span></td><td id="LC8758" class="css-1dcdqdg"><code><span class="code-comment">//# sourceMappingURL=plyr.js.map</span>
</code></td></tr></tbody></table></div></div></div></div><style data-emotion-css="1teho9j">.css-1teho9j{margin-top:5rem;background:black;color:#aaa;}</style><footer class="css-1teho9j"><style data-emotion-css="1ui8put">.css-1ui8put{max-width:940px;padding:10px 20px;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><div class="css-1ui8put"><p><span>Build: <!-- -->a7ebffa</span></p><p><span>© <!-- -->2023<!-- --> UNPKG</span></p><style data-emotion-css="la3nd4">.css-la3nd4{font-size:1.5rem;}</style><p class="css-la3nd4"><style data-emotion-css="bogekj">.css-bogekj{color:#aaa;display:inline-block;}.css-bogekj:hover{color:white;}</style><a href="https://twitter.com/unpkg" class="css-bogekj"><style data-emotion-css="i6dzq1">.css-i6dzq1{vertical-align:text-bottom;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-i6dzq1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><style data-emotion-css="3czw03">.css-3czw03{color:#aaa;display:inline-block;margin-left:1rem;}.css-3czw03:hover{color:white;}</style><a href="https://github.com/mjackson/unpkg" class="css-3czw03"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="css-i6dzq1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></p></div></footer></div><script src="/react@16.8.6/umd/react.production.min.js"></script><script src="/react-dom@16.8.6/umd/react-dom.production.min.js"></script><script src="/@emotion/core@10.0.6/dist/core.umd.min.js"></script><script>'use strict';(function(t,A,c){function w(){w=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var e=arguments[b],c;for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}return a};return w.apply(this,arguments)}function P(a,b){if(null==a)return{};var e={},c=Object.keys(a),d;for(d=0;d<c.length;d++){var h=c[d];0<=b.indexOf(h)||(e[h]=a[h])}return e}function Q(a,b){b||(b=a.slice(0));a.raw=b;return a}function R(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,
"default")?a["default"]:a}function D(a,b){return b={exports:{}},a(b,b.exports),b.exports}function J(a,b,e,c,d){for(var g in a)if(ua(a,g)){try{if("function"!==typeof a[g]){var r=Error((c||"React class")+": "+e+" type `"+g+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof a[g]+"`.");r.name="Invariant Violation";throw r;}var k=a[g](b,g,c,e,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(q){k=q}!k||k instanceof Error||K((c||"React class")+": type specification of "+
e+" `"+g+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof k+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).");if(k instanceof Error&&!(k.message in L)){L[k.message]=!0;var B=d?d():"";K("Failed "+e+" type: "+k.message+(null!=B?B:""))}}}function G(){return null}function S(a){var b,e=a.children;a=a.css;return c.jsx("div",{css:w((b={border:"1px solid #dfe2e5",
borderRadius:3},b["@media (max-width: 700px)"]={borderRightWidth:0,borderLeftWidth:0},b),a)},e)}function T(a){var b,e=a.children;a=a.css;return c.jsx("div",{css:w((b={padding:10,background:"#f6f8fa",color:"#424242",border:"1px solid #d1d5da",borderTopLeftRadius:3,borderTopRightRadius:3,margin:"-1px -1px 0",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},b["@media (max-width: 700px)"]={paddingRight:20,paddingLeft:20},b),a)},e)}function U(a){return a&&a.map(function(a,
c){return t.createElement(a.tag,z({key:c},a.attr),U(a.child))})}function E(a){return function(b){return t.createElement(va,z({attr:z({},a.attr)},b),U(a.child))}}function va(a){var b=function(b){var c=a.size||b.size||"1em";if(b.className)var e=b.className;a.className&&(e=(e?e+" ":"")+a.className);var h=a.attr,r=a.title,k=["attr","title"],B={},q;for(q in a)Object.prototype.hasOwnProperty.call(a,q)&&0>k.indexOf(q)&&(B[q]=a[q]);if(null!=a&&"function"===typeof Object.getOwnPropertySymbols){var p=0;for(q=
Object.getOwnPropertySymbols(a);p<q.length;p++)0>k.indexOf(q[p])&&(B[q[p]]=a[q[p]])}return t.createElement("svg",z({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},b.attr,h,B,{className:e,style:z({color:a.color||b.color},b.style,a.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),r&&t.createElement("title",null,r),a.children)};return void 0!==V?t.createElement(V.Consumer,null,function(a){return b(a)}):b(W)}function F(a,b){var e=b.css;b=P(b,["css"]);return c.jsx(a,w({css:w({},
e,{verticalAlign:"text-bottom"})},b))}function wa(a){return F(X,a)}function xa(a){return F(Y,a)}function ya(a){return F(Z,a)}function za(a){return F(aa,a)}function Aa(a){return F(ba,a)}function ca(a){var b=a.path,e=a.details,g=Object.keys(e).reduce(function(a,b){var c=a.subdirs,g=a.files;b=e[b];"directory"===b.type?c.push(b):"file"===b.type&&g.push(b);return a},{subdirs:[],files:[]});a=g.subdirs;g=g.files;a.sort(da("path"));g.sort(da("path"));var d=[];"/"!==b&&d.push(c.jsx("tr",{key:".."},c.jsx("td",
{css:M}),c.jsx("td",{css:y},c.jsx("a",{title:"Parent directory",href:"../",css:N},"..")),c.jsx("td",{css:y}),c.jsx("td",{css:O})));a.forEach(function(a){a=a.path.substr(1<b.length?b.length+1:1);var e=a+"/";d.push(c.jsx("tr",{key:a},c.jsx("td",{css:M},c.jsx(ya,null)),c.jsx("td",{css:y},c.jsx("a",{title:a,href:e,css:N},a)),c.jsx("td",{css:y},"-"),c.jsx("td",{css:O},"-")))});g.forEach(function(a){var e=a.size,g=a.contentType;a=a.path.substr(1<b.length?b.length+1:1);d.push(c.jsx("tr",{key:a},c.jsx("td",
{css:M},"text/plain"===g||"text/markdown"===g?c.jsx(wa,null):c.jsx(xa,null)),c.jsx("td",{css:y},c.jsx("a",{title:a,href:a,css:N},a)),c.jsx("td",{css:y},ea(e)),c.jsx("td",{css:O},g)))});var h=[];0<g.length&&h.push(g.length+" file"+(1===g.length?"":"s"));0<a.length&&h.push(a.length+" folder"+(1===a.length?"":"s"));return c.jsx(S,null,c.jsx(T,null,c.jsx("span",null,h.join(", "))),c.jsx("table",{css:{width:"100%",borderCollapse:"collapse",borderRadius:2,background:"#fff","@media (max-width: 700px)":{"& th + th + th + th, & td + td + td + td":{display:"none"}},
"& tr:first-of-type td":{borderTop:0}}},c.jsx("thead",null,c.jsx("tr",null,c.jsx("th",null,c.jsx(H,null,"Icon")),c.jsx("th",null,c.jsx(H,null,"Name")),c.jsx("th",null,c.jsx(H,null,"Size")),c.jsx("th",null,c.jsx(H,null,"Content Type")))),c.jsx("tbody",null,d)))}function Ba(a){a=a.split("/");return a[a.length-1]}function Ca(a){var b=a.uri;return c.jsx("div",{css:{padding:20,textAlign:"center"}},c.jsx("img",{alt:Ba(a.path),src:b}))}function Da(a){a=a.highlights.slice(0);var b=a.length&&""===a[a.length-
1];b&&a.pop();return c.jsx("div",{className:"code-listing",css:{overflowX:"auto",overflowY:"hidden",paddingTop:5,paddingBottom:5}},c.jsx("table",{css:{border:"none",borderCollapse:"collapse",borderSpacing:0}},c.jsx("tbody",null,a.map(function(a,b){var e=b+1;return c.jsx("tr",{key:b},c.jsx("td",{id:"L"+e,css:{paddingLeft:10,paddingRight:10,color:"rgba(27,31,35,.3)",textAlign:"right",verticalAlign:"top",width:"1%",minWidth:50,userSelect:"none"}},c.jsx("span",null,e)),c.jsx("td",{id:"LC"+e,css:{paddingLeft:10,
paddingRight:10,color:"#24292e",whiteSpace:"pre"}},c.jsx("code",{dangerouslySetInnerHTML:{__html:a}})))}),!b&&c.jsx("tr",{key:"no-newline"},c.jsx("td",{css:{paddingLeft:10,paddingRight:10,color:"rgba(27,31,35,.3)",textAlign:"right",verticalAlign:"top",width:"1%",minWidth:50,userSelect:"none"}},"\\"),c.jsx("td",{css:{paddingLeft:10,color:"rgba(27,31,35,.3)",userSelect:"none"}},"No newline at end of file")))))}function Ea(){return c.jsx("div",{css:{padding:20}},c.jsx("p",{css:{textAlign:"center"}},
"No preview available."))}function fa(a){var b=a.packageName,e=a.packageVersion,g=a.path;a=a.details;var d=a.highlights,h=a.uri,r=a.language;return c.jsx(S,null,c.jsx(T,null,c.jsx("span",null,ea(a.size)),c.jsx("span",null,r),c.jsx("span",null,c.jsx("a",{href:"/"+b+"@"+e+g,css:{display:"inline-block",marginLeft:8,padding:"2px 8px",textDecoration:"none",fontWeight:600,fontSize:"0.9rem",color:"#24292e",backgroundColor:"#eff3f6",border:"1px solid rgba(27,31,35,.2)",borderRadius:3,":hover":{backgroundColor:"#e6ebf1",
borderColor:"rgba(27,31,35,.35)"},":active":{backgroundColor:"#e9ecef",borderColor:"rgba(27,31,35,.35)",boxShadow:"inset 0 0.15em 0.3em rgba(27,31,35,.15)"}}},"View Raw"))),d?c.jsx(Da,{highlights:d}):h?c.jsx(Ca,{path:g,uri:h}):c.jsx(Ea,null))}function ha(){var a=Q(["\n  .code-listing {\n    background: #fbfdff;\n    color: #383a42;\n  }\n  .code-comment,\n  .code-quote {\n    color: #a0a1a7;\n    font-style: italic;\n  }\n  .code-doctag,\n  .code-keyword,\n  .code-link,\n  .code-formula {\n    color: #a626a4;\n  }\n  .code-section,\n  .code-name,\n  .code-selector-tag,\n  .code-deletion,\n  .code-subst {\n    color: #e45649;\n  }\n  .code-literal {\n    color: #0184bb;\n  }\n  .code-string,\n  .code-regexp,\n  .code-addition,\n  .code-attribute,\n  .code-meta-string {\n    color: #50a14f;\n  }\n  .code-built_in,\n  .code-class .code-title {\n    color: #c18401;\n  }\n  .code-attr,\n  .code-variable,\n  .code-template-variable,\n  .code-type,\n  .code-selector-class,\n  .code-selector-attr,\n  .code-selector-pseudo,\n  .code-number {\n    color: #986801;\n  }\n  .code-symbol,\n  .code-bullet,\n  .code-meta,\n  .code-selector-id,\n  .code-title {\n    color: #4078f2;\n  }\n  .code-emphasis {\n    font-style: italic;\n  }\n  .code-strong {\n    font-weight: bold;\n  }\n"]);
ha=function(){return a};return a}function ia(){var a=Q(["\n  html {\n    box-sizing: border-box;\n  }\n  *,\n  *:before,\n  *:after {\n    box-sizing: inherit;\n  }\n\n  html,\n  body,\n  #root {\n    height: 100%;\n    margin: 0;\n  }\n\n  body {\n    ","\n    font-size: 16px;\n    line-height: 1.5;\n    overflow-wrap: break-word;\n    background: white;\n    color: black;\n  }\n\n  code {\n    ","\n  }\n\n  th,\n  td {\n    padding: 0;\n  }\n\n  select {\n    font-size: inherit;\n  }\n\n  #root {\n    display: flex;\n    flex-direction: column;\n  }\n"]);
ia=function(){return a};return a}function ja(a){var b=a.css;a=P(a,["css"]);return c.jsx("a",w({},a,{css:w({color:"#0076ff",textDecoration:"none",":hover":{textDecoration:"underline"}},b)}))}function Fa(){return c.jsx("header",{css:{marginTop:"2rem"}},c.jsx("h1",{css:{textAlign:"center",fontSize:"3rem",letterSpacing:"0.05em"}},c.jsx("a",{href:"/",css:{color:"#000",textDecoration:"none"}},"UNPKG")))}function Ga(a){var b=a.packageName,e=a.packageVersion,g=a.availableVersions;a=a.filename;var d=[];if("/"===
a)d.push(b);else{var h="/browse/"+b+"@"+e;d.push(c.jsx(ja,{href:h+"/"},b));b=a.replace(/^\/+/,"").replace(/\/+$/,"").split("/");a=b.pop();b.forEach(function(a){h+="/"+a;d.push(c.jsx(ja,{href:h+"/"},a))});d.push(a)}return c.jsx("header",{css:{display:"flex",flexDirection:"row",alignItems:"center","@media (max-width: 700px)":{flexDirection:"column-reverse",alignItems:"flex-start"}}},c.jsx("h1",{css:{fontSize:"1.5rem",fontWeight:"normal",flex:1,wordBreak:"break-all"}},c.jsx("nav",null,d.map(function(a,
b,e){return c.jsx(t.Fragment,{key:b},0!==b&&c.jsx("span",{css:{paddingLeft:5,paddingRight:5}},"/"),b===e.length-1?c.jsx("strong",null,a):a)}))),c.jsx(Ha,{packageVersion:e,availableVersions:g,onChange:function(a){window.location.href=window.location.href.replace("@"+e,"@"+a)}}))}function Ha(a){var b=a.onChange;return c.jsx("p",{css:{marginLeft:20,"@media (max-width: 700px)":{marginLeft:0,marginBottom:0}}},c.jsx("label",null,"Version:"," ",c.jsx("select",{name:"version",defaultValue:a.packageVersion,
onChange:function(a){b&&b(a.target.value)},css:{appearance:"none",cursor:"pointer",padding:"4px 24px 4px 8px",fontWeight:600,fontSize:"0.9em",color:"#24292e",border:"1px solid rgba(27,31,35,.2)",borderRadius:3,backgroundColor:"#eff3f6",backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAKCAYAAAC9vt6cAAAAAXNSR0IArs4c6QAAARFJREFUKBVjZAACNS39RhBNKrh17WI9o4quoT3Dn78HSNUMUs/CzOTI/O7Vi4dCYpJ3/jP+92BkYGAlyiBGhm8MjIxJt65e3MQM0vDu9YvLYmISILYZELOBxHABRkaGr0yMzF23r12YDFIDNgDEePv65SEhEXENBkYGFSAXuyGMjF8Z/jOsvX3tYiFIDwgwQSgIaaijnvj/P8M5IO8HsjiY/f//D4b//88A1SQhywG9jQr09PS4v/1mPAeUUPzP8B8cJowMjL+Bqu6xMQmaXL164AuyDgwDQJLa2qYSP//9vARkCoMVMzK8YeVkNbh+9uxzMB+JwGoASF5Vx0jz/98/18BqmZi171w9D2EjaaYKEwAEK00XQLdJuwAAAABJRU5ErkJggg==)",
backgroundPosition:"right 8px center",backgroundRepeat:"no-repeat",backgroundSize:"auto 25%",":hover":{backgroundColor:"#e6ebf1",borderColor:"rgba(27,31,35,.35)"},":active":{backgroundColor:"#e9ecef",borderColor:"rgba(27,31,35,.35)",boxShadow:"inset 0 0.15em 0.3em rgba(27,31,35,.15)"}}},a.availableVersions.map(function(a){return c.jsx("option",{key:a,value:a},a)}))))}function Ia(a){var b=a.packageName,e=a.packageVersion;a=a.target;return"directory"===a.type?c.jsx(ca,{path:a.path,details:a.details}):
"file"===a.type?c.jsx(fa,{packageName:b,packageVersion:e,path:a.path,details:a.details}):null}function ka(a){var b=a.packageName,e=a.packageVersion,g=a.availableVersions;g=void 0===g?[]:g;var d=a.filename;a=a.target;return c.jsx(t.Fragment,null,c.jsx(c.Global,{styles:Ja}),c.jsx(c.Global,{styles:Ka}),c.jsx("div",{css:{flex:"1 0 auto"}},c.jsx("div",{css:{maxWidth:940,padding:"0 20px",margin:"0 auto"}},c.jsx(Fa,null)),c.jsx("div",{css:{maxWidth:940,padding:"0 20px",margin:"0 auto"}},c.jsx(Ga,{packageName:b,
packageVersion:e,availableVersions:g,filename:d})),c.jsx("div",{css:{maxWidth:940,padding:"0 20px",margin:"0 auto","@media (max-width: 700px)":{padding:0,margin:0}}},c.jsx(Ia,{packageName:b,packageVersion:e,target:a}))),c.jsx("footer",{css:{marginTop:"5rem",background:"black",color:"#aaa"}},c.jsx("div",{css:{maxWidth:940,padding:"10px 20px",margin:"0 auto",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},c.jsx("p",null,c.jsx("span",null,"Build: ","a7ebffa")),
c.jsx("p",null,c.jsx("span",null,"\u00a9 ",(new Date).getFullYear()," UNPKG")),c.jsx("p",{css:{fontSize:"1.5rem"}},c.jsx("a",{href:"https://twitter.com/unpkg",css:{color:"#aaa",display:"inline-block",":hover":{color:"white"}}},c.jsx(za,null)),c.jsx("a",{href:"https://github.com/mjackson/unpkg",css:{color:"#aaa",display:"inline-block",":hover":{color:"white"},marginLeft:"1rem"}},c.jsx(Aa,null))))))}var la="default"in t?t["default"]:t;A=A&&A.hasOwnProperty("default")?A["default"]:A;var La="undefined"!==
typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},m=D(function(a,b){function c(a){if("object"===typeof a&&null!==a){var b=a.$$typeof;switch(b){case d:switch(a=a.type,a){case l:case f:case r:case m:case k:case v:return a;default:switch(a=a&&a.$$typeof,a){case p:case n:case q:return a;default:return b}}case x:case u:case h:return b}}}function g(a){return c(a)===f}Object.defineProperty(b,"__esModule",{value:!0});var d=
(a="function"===typeof Symbol&&Symbol.for)?Symbol.for("react.element"):60103,h=a?Symbol.for("react.portal"):60106,r=a?Symbol.for("react.fragment"):60107,k=a?Symbol.for("react.strict_mode"):60108,m=a?Symbol.for("react.profiler"):60114,q=a?Symbol.for("react.provider"):60109,p=a?Symbol.for("react.context"):60110,l=a?Symbol.for("react.async_mode"):60111,f=a?Symbol.for("react.concurrent_mode"):60111,n=a?Symbol.for("react.forward_ref"):60112,v=a?Symbol.for("react.suspense"):60113,u=a?Symbol.for("react.memo"):
60115,x=a?Symbol.for("react.lazy"):60116;b.typeOf=c;b.AsyncMode=l;b.ConcurrentMode=f;b.ContextConsumer=p;b.ContextProvider=q;b.Element=d;b.ForwardRef=n;b.Fragment=r;b.Lazy=x;b.Memo=u;b.Portal=h;b.Profiler=m;b.StrictMode=k;b.Suspense=v;b.isValidElementType=function(a){return"string"===typeof a||"function"===typeof a||a===r||a===f||a===m||a===k||a===v||"object"===typeof a&&null!==a&&(a.$$typeof===x||a.$$typeof===u||a.$$typeof===q||a.$$typeof===p||a.$$typeof===n)};b.isAsyncMode=function(a){return g(a)||
c(a)===l};b.isConcurrentMode=g;b.isContextConsumer=function(a){return c(a)===p};b.isContextProvider=function(a){return c(a)===q};b.isElement=function(a){return"object"===typeof a&&null!==a&&a.$$typeof===d};b.isForwardRef=function(a){return c(a)===n};b.isFragment=function(a){return c(a)===r};b.isLazy=function(a){return c(a)===x};b.isMemo=function(a){return c(a)===u};b.isPortal=function(a){return c(a)===h};b.isProfiler=function(a){return c(a)===m};b.isStrictMode=function(a){return c(a)===k};b.isSuspense=
function(a){return c(a)===v}});R(m);var na=D(function(a,b){(function(){function a(a){if("object"===typeof a&&null!==a){var b=a.$$typeof;switch(b){case h:switch(a=a.type,a){case f:case n:case k:case q:case m:case u:return a;default:switch(a=a&&a.$$typeof,a){case l:case v:case p:return a;default:return b}}case I:case x:case r:return b}}}function c(b){return a(b)===n}Object.defineProperty(b,"__esModule",{value:!0});var d="function"===typeof Symbol&&Symbol.for,h=d?Symbol.for("react.element"):60103,r=
d?Symbol.for("react.portal"):60106,k=d?Symbol.for("react.fragment"):60107,m=d?Symbol.for("react.strict_mode"):60108,q=d?Symbol.for("react.profiler"):60114,p=d?Symbol.for("react.provider"):60109,l=d?Symbol.for("react.context"):60110,f=d?Symbol.for("react.async_mode"):60111,n=d?Symbol.for("react.concurrent_mode"):60111,v=d?Symbol.for("react.forward_ref"):60112,u=d?Symbol.for("react.suspense"):60113,x=d?Symbol.for("react.memo"):60115,I=d?Symbol.for("react.lazy"):60116;d=function(){};var Ma=function(a){for(var b=
arguments.length,f=Array(1<b?b-1:0),c=1;c<b;c++)f[c-1]=arguments[c];var n=0;b="Warning: "+a.replace(/%s/g,function(){return f[n++]});"undefined"!==typeof console&&console.warn(b);try{throw Error(b);}catch(Xa){}},Na=d=function(a,b){if(void 0===b)throw Error("`lowPriorityWarning(condition, format, ...args)` requires a warning message argument");if(!a){for(var f=arguments.length,c=Array(2<f?f-2:0),n=2;n<f;n++)c[n-2]=arguments[n];Ma.apply(void 0,[b].concat(c))}},ma=!1;b.typeOf=a;b.AsyncMode=f;b.ConcurrentMode=
n;b.ContextConsumer=l;b.ContextProvider=p;b.Element=h;b.ForwardRef=v;b.Fragment=k;b.Lazy=I;b.Memo=x;b.Portal=r;b.Profiler=q;b.StrictMode=m;b.Suspense=u;b.isValidElementType=function(a){return"string"===typeof a||"function"===typeof a||a===k||a===n||a===q||a===m||a===u||"object"===typeof a&&null!==a&&(a.$$typeof===I||a.$$typeof===x||a.$$typeof===p||a.$$typeof===l||a.$$typeof===v)};b.isAsyncMode=function(b){ma||(ma=!0,Na(!1,"The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API."));
return c(b)||a(b)===f};b.isConcurrentMode=c;b.isContextConsumer=function(b){return a(b)===l};b.isContextProvider=function(b){return a(b)===p};b.isElement=function(a){return"object"===typeof a&&null!==a&&a.$$typeof===h};b.isForwardRef=function(b){return a(b)===v};b.isFragment=function(b){return a(b)===k};b.isLazy=function(b){return a(b)===I};b.isMemo=function(b){return a(b)===x};b.isPortal=function(b){return a(b)===r};b.isProfiler=function(b){return a(b)===q};b.isStrictMode=function(b){return a(b)===
m};b.isSuspense=function(b){return a(b)===u}})()});R(na);var oa=D(function(a){a.exports=na}),pa=Object.getOwnPropertySymbols,Oa=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,Qa=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=
a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,d=1;d<arguments.length;d++){var h=Object(arguments[d]);for(var r in h)Oa.call(h,r)&&(c[r]=h[r]);if(pa){g=pa(h);for(var k=0;k<g.length;k++)Pa.call(h,g[k])&&(c[g[k]]=h[g[k]])}}return c},K=function(){},L={},ua=Function.call.bind(Object.prototype.hasOwnProperty);
K=function(a){a="Warning: "+a;"undefined"!==typeof console&&console.error(a);try{throw Error(a);}catch(b){}};J.resetWarningCache=function(){L={}};var Ra=Function.call.bind(Object.prototype.hasOwnProperty),C=function(){};C=function(a){a="Warning: "+a;"undefined"!==typeof console&&console.error(a);try{throw Error(a);}catch(b){}};var Sa=function(a,b){function c(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}function g(a){this.message=a;this.stack=""}function d(a){function c(c,n,v,d,e,u,h){d=d||"<<anonymous>>";
u=u||v;if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==h){if(b)throw c=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),c.name="Invariant Violation",c;"undefined"!==typeof console&&(h=d+":"+v,!f[h]&&3>l&&(C("You are manually calling a React.PropTypes validation function for the `"+u+"` prop on `"+d+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),
f[h]=!0,l++))}return null==n[v]?c?null===n[v]?new g("The "+e+" `"+u+"` is marked as required "+("in `"+d+"`, but its value is `null`.")):new g("The "+e+" `"+u+"` is marked as required in "+("`"+d+"`, but its value is `undefined`.")):null:a(n,v,d,e,u)}var f={},l=0,d=c.bind(null,!1);d.isRequired=c.bind(null,!0);return d}function h(a){return d(function(b,c,f,d,l,e){b=b[c];return k(b)!==a?(b=m(b),new g("Invalid "+d+" `"+l+"` of type "+("`"+b+"` supplied to `"+f+"`, expected ")+("`"+a+"`."))):null})}function r(b){switch(typeof b){case "number":case "string":case "undefined":return!0;
case "boolean":return!b;case "object":if(Array.isArray(b))return b.every(r);if(null===b||a(b))return!0;var c=b&&(p&&b[p]||b["@@iterator"]);var f="function"===typeof c?c:void 0;if(f)if(c=f.call(b),f!==b.entries)for(;!(b=c.next()).done;){if(!r(b.value))return!1}else for(;!(b=c.next()).done;){if((b=b.value)&&!r(b[1]))return!1}else return!1;return!0;default:return!1}}function k(a){var b=typeof a;return Array.isArray(a)?"array":a instanceof RegExp?"object":"symbol"===b||a&&("Symbol"===a["@@toStringTag"]||
"function"===typeof Symbol&&a instanceof Symbol)?"symbol":b}function m(a){if("undefined"===typeof a||null===a)return""+a;var b=k(a);if("object"===b){if(a instanceof Date)return"date";if(a instanceof RegExp)return"regexp"}return b}function q(a){a=m(a);switch(a){case "array":case "object":return"an "+a;case "boolean":case "date":case "regexp":return"a "+a;default:return a}}var p="function"===typeof Symbol&&Symbol.iterator,l={array:h("array"),bool:h("boolean"),func:h("function"),number:h("number"),object:h("object"),
string:h("string"),symbol:h("symbol"),any:d(G),arrayOf:function(a){return d(function(b,c,f,d,l){if("function"!==typeof a)return new g("Property `"+l+"` of component `"+f+"` has invalid PropType notation inside arrayOf.");b=b[c];if(!Array.isArray(b))return b=k(b),new g("Invalid "+d+" `"+l+"` of type "+("`"+b+"` supplied to `"+f+"`, expected an array."));for(c=0;c<b.length;c++){var n=a(b,c,f,d,l+"["+c+"]","SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(n instanceof Error)return n}return null})},
element:function(){return d(function(b,c,d,l,e){b=b[c];return a(b)?null:(b=k(b),new g("Invalid "+l+" `"+e+"` of type "+("`"+b+"` supplied to `"+d+"`, expected a single ReactElement.")))})}(),elementType:function(){return d(function(a,b,c,d,l){a=a[b];return oa.isValidElementType(a)?null:(a=k(a),new g("Invalid "+d+" `"+l+"` of type "+("`"+a+"` supplied to `"+c+"`, expected a single ReactElement type.")))})}(),instanceOf:function(a){return d(function(b,c,f,d,l){if(!(b[c]instanceof a)){var n=a.name||
"<<anonymous>>";b=b[c];b=b.constructor&&b.constructor.name?b.constructor.name:"<<anonymous>>";return new g("Invalid "+d+" `"+l+"` of type "+("`"+b+"` supplied to `"+f+"`, expected ")+("instance of `"+n+"`."))}return null})},node:function(){return d(function(a,b,c,d,l){return r(a[b])?null:new g("Invalid "+d+" `"+l+"` supplied to "+("`"+c+"`, expected a ReactNode."))})}(),objectOf:function(a){return d(function(b,c,f,d,l){if("function"!==typeof a)return new g("Property `"+l+"` of component `"+f+"` has invalid PropType notation inside objectOf.");
b=b[c];c=k(b);if("object"!==c)return new g("Invalid "+d+" `"+l+"` of type "+("`"+c+"` supplied to `"+f+"`, expected an object."));for(var n in b)if(Ra(b,n)&&(c=a(b,n,f,d,l+"."+n,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"),c instanceof Error))return c;return null})},oneOf:function(a){return Array.isArray(a)?d(function(b,f,d,l,e){b=b[f];for(f=0;f<a.length;f++)if(c(b,a[f]))return null;f=JSON.stringify(a,function(a,b){return"symbol"===m(b)?String(b):b});return new g("Invalid "+l+" `"+e+"` of value `"+
String(b)+"` "+("supplied to `"+d+"`, expected one of "+f+"."))}):(1<arguments.length?C("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):C("Invalid argument supplied to oneOf, expected an array."),G)},oneOfType:function(a){if(!Array.isArray(a))return C("Invalid argument supplied to oneOfType, expected an instance of array."),G;for(var b=0;b<a.length;b++){var c=a[b];if("function"!==
typeof c)return C("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+q(c)+" at index "+b+"."),G}return d(function(b,c,f,d,l){for(var e=0;e<a.length;e++)if(null==(0,a[e])(b,c,f,d,l,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"))return null;return new g("Invalid "+d+" `"+l+"` supplied to "+("`"+f+"`."))})},shape:function(a){return d(function(b,c,d,l,f){b=b[c];c=k(b);if("object"!==c)return new g("Invalid "+l+" `"+f+"` of type `"+c+"` "+("supplied to `"+d+"`, expected `object`."));
for(var e in a)if(c=a[e])if(c=c(b,e,d,l,f+"."+e,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"))return c;return null})},exact:function(a){return d(function(b,c,d,l,f){var e=b[c],n=k(e);if("object"!==n)return new g("Invalid "+l+" `"+f+"` of type `"+n+"` "+("supplied to `"+d+"`, expected `object`."));n=Qa({},b[c],a);for(var h in n){n=a[h];if(!n)return new g("Invalid "+l+" `"+f+"` key `"+h+"` supplied to `"+d+"`.\nBad object: "+JSON.stringify(b[c],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(a),
null,"  "));if(n=n(e,h,d,l,f+"."+h,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"))return n}return null})}};g.prototype=Error.prototype;l.checkPropTypes=J;l.resetWarningCache=J.resetWarningCache;return l.PropTypes=l};m=D(function(a){a.exports=Sa(oa.isElement,!0)});var Ta=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],g;for(g in c)Object.prototype.hasOwnProperty.call(c,g)&&(a[g]=c[g])}return a},Ua={border:0,clip:"rect(0 0 0 0)",height:"1px",width:"1px",margin:"-1px",
padding:0,overflow:"hidden",position:"absolute"},H=function(a){return la.createElement("div",Ta({style:Ua},a))},qa=D(function(a){(function(b,c){a.exports=c()})(La,function(){function a(a){if(!a)return!0;if(!d(a)||0!==a.length)for(var b in a)if(q.call(a,b))return!1;return!0}function c(a){return"number"===typeof a||"[object Number]"===t.call(a)}function g(a){return"string"===typeof a||"[object String]"===t.call(a)}function d(a){return"object"===typeof a&&"number"===typeof a.length&&"[object Array]"===
t.call(a)}function h(a){var b=parseInt(a);return b.toString()===a?b:a}function m(b,d,e,k){c(d)&&(d=[d]);if(a(d))return b;if(g(d))return m(b,d.split("."),e,k);var f=h(d[0]);if(1===d.length)return d=b[f],void 0!==d&&k||(b[f]=e),d;void 0===b[f]&&(c(f)?b[f]=[]:b[f]={});return m(b[f],d.slice(1),e,k)}function k(b,f){c(f)&&(f=[f]);if(!a(b)){if(a(f))return b;if(g(f))return k(b,f.split("."));var e=h(f[0]),l=b[e];if(1===f.length)void 0!==l&&(d(b)?b.splice(e,1):delete b[e]);else if(void 0!==b[e])return k(b[e],
f.slice(1));return b}}var t=Object.prototype.toString,q=Object.prototype.hasOwnProperty,p={ensureExists:function(a,b,c){return m(a,b,c,!0)},set:function(a,b,c,d){return m(a,b,c,d)},insert:function(a,b,c,e){var f=p.get(a,b);e=~~e;d(f)||(f=[],p.set(a,b,f));f.splice(e,0,c)},empty:function(b,f){if(a(f))return b;if(!a(b)){var e,h;if(!(e=p.get(b,f)))return b;if(g(e))return p.set(b,f,"");if("boolean"===typeof e||"[object Boolean]"===t.call(e))return p.set(b,f,!1);if(c(e))return p.set(b,f,0);if(d(e))e.length=
0;else if("object"===typeof e&&"[object Object]"===t.call(e))for(h in e)q.call(e,h)&&delete e[h];else return p.set(b,f,null)}},push:function(a,b){var c=p.get(a,b);d(c)||(c=[],p.set(a,b,c));c.push.apply(c,Array.prototype.slice.call(arguments,2))},coalesce:function(a,b,c){for(var d,e=0,f=b.length;e<f;e++)if(void 0!==(d=p.get(a,b[e])))return d;return c},get:function(b,d,e){c(d)&&(d=[d]);if(a(d))return b;if(a(b))return e;if(g(d))return p.get(b,d.split("."),e);var f=h(d[0]);return 1===d.length?void 0===
b[f]?e:b[f]:p.get(b[f],d.slice(1),e)},del:function(a,b){return k(a,b)}};return p})});var ra=function(a){return function(b){return typeof b===a}};var Va=function(a,b){var c=1,g=b||function(a,b){return b};"-"===a[0]&&(c=-1,a=a.substr(1));return function(b,e){var d;b=g(a,qa.get(b,a));e=g(a,qa.get(e,a));b<e&&(d=-1);b>e&&(d=1);b===e&&(d=0);return d*c}};var da=function(){var a=Array.prototype.slice.call(arguments),b=a.filter(ra("string")),c=a.filter(ra("function"))[0];return function(a,d){for(var e=b.length,
g=0,k=0;0===g&&k<e;)g=Va(b[k],c)(a,d),k++;return g}};let sa="B kB MB GB TB PB EB ZB YB".split(" "),ta=(a,b)=>{let c=a;"string"===typeof b?c=a.toLocaleString(b):!0===b&&(c=a.toLocaleString());return c};var ea=(a,b)=>{if(!Number.isFinite(a))throw new TypeError(`Expected a finite number, got ${typeof a}: ${a}`);b=Object.assign({},b);if(b.signed&&0===a)return" 0 B";var c=0>a;let g=c?"-":b.signed?"+":"";c&&(a=-a);if(1>a)return a=ta(a,b.locale),g+a+" B";c=Math.min(Math.floor(Math.log10(a)/3),sa.length-
1);a=Number((a/Math.pow(1E3,c)).toPrecision(3));a=ta(a,b.locale);return g+a+" "+sa[c]},W={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},V=t.createContext&&t.createContext(W),z=function(){z=Object.assign||function(a){for(var b,c=1,g=arguments.length;c<g;c++){b=arguments[c];for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])}return a};return z.apply(this,arguments)},Y=function(a){return E({tag:"svg",attr:{viewBox:"0 0 12 16"},child:[{tag:"path",attr:{fillRule:"evenodd",
d:"M8.5 1H1c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h10c.55 0 1-.45 1-1V4.5L8.5 1zM11 14H1V2h7l3 3v9zM5 6.98L3.5 8.5 5 10l-.5 1L2 8.5 4.5 6l.5.98zM7.5 6L10 8.5 7.5 11l-.5-.98L8.5 8.5 7 7l.5-1z"}}]})(a)};Y.displayName="GoFileCode";var Z=function(a){return E({tag:"svg",attr:{viewBox:"0 0 14 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M13 4H7V3c0-.66-.31-1-1-1H1c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1zM6 4H1V3h5v1z"}}]})(a)};Z.displayName="GoFileDirectory";var X=function(a){return E({tag:"svg",
attr:{viewBox:"0 0 12 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z"}}]})(a)};X.displayName="GoFile";var ba=function(a){return E({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"}}]})(a)};
ba.displayName="FaGithub";var aa=function(a){return E({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"}}]})(a)};
aa.displayName="FaTwitter";var N={color:"#0076ff",textDecoration:"none",":hover":{textDecoration:"underline"}},y={paddingTop:6,paddingRight:3,paddingBottom:6,paddingLeft:3,borderTop:"1px solid #eaecef"},M=w({},y,{color:"#424242",width:17,paddingRight:2,paddingLeft:10,"@media (max-width: 700px)":{paddingLeft:20}}),O=w({},y,{textAlign:"right",paddingRight:10,"@media (max-width: 700px)":{paddingRight:20}});ca.propTypes={path:m.string.isRequired,details:m.objectOf(m.shape({path:m.string.isRequired,type:m.oneOf(["directory",
"file"]).isRequired,contentType:m.string,integrity:m.string,size:m.number})).isRequired};fa.propTypes={path:m.string.isRequired,details:m.shape({contentType:m.string.isRequired,highlights:m.arrayOf(m.string),uri:m.string,integrity:m.string.isRequired,language:m.string.isRequired,size:m.number.isRequired}).isRequired};var Ja=c.css(ia(),'\nfont-family: -apple-system,\n  BlinkMacSystemFont,\n  "Segoe UI",\n  "Roboto",\n  "Oxygen",\n  "Ubuntu",\n  "Cantarell",\n  "Fira Sans",\n  "Droid Sans",\n  "Helvetica Neue",\n  sans-serif;\n',
"\nfont-family: Menlo,\n  Monaco,\n  Lucida Console,\n  Liberation Mono,\n  DejaVu Sans Mono,\n  Bitstream Vera Sans Mono,\n  Courier New,\n  monospace;\n"),Ka=c.css(ha()),Wa=m.shape({path:m.string.isRequired,type:m.oneOf(["directory","file"]).isRequired,details:m.object.isRequired});ka.propTypes={packageName:m.string.isRequired,packageVersion:m.string.isRequired,availableVersions:m.arrayOf(m.string),filename:m.string.isRequired,target:Wa.isRequired};A.hydrate(la.createElement(ka,window.__DATA__||
{}),document.getElementById("root"))})(React,ReactDOM,emotionCore);
</script></body></html>